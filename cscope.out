cscope 15 $HOME/zip -q 0000002696 0000639014
	@ioapi.c

13 #i‡
deföed
(
_WIN32
Ë&& (!(deföed(
_CRT_SECURE_NO_WARNINGS
)))

14 
	#_CRT_SECURE_NO_WARNINGS


	)

17 #i‡
deföed
(
__APPLE__
Ë|| deföed(
IOAPI_NO_64
)

19 
	#FOPEN_FUNC
(
fûíame
, 
mode
Ë
	`f›í
(fûíame, mode)

	)

20 
	#FTELLO_FUNC
(
°ªam
Ë
	`·ñlo
(°ªam)

	)

21 
	#FSEEKO_FUNC
(
°ªam
, 
off£t
, 
‹igö
Ë
	`f£eko
(°ªam, off£t, origö)

	)

23 
	#FOPEN_FUNC
(
fûíame
, 
mode
Ë
	`f›í64
(fûíame, mode)

	)

24 
	#FTELLO_FUNC
(
°ªam
Ë
	`·ñlo64
(°ªam)

	)

25 
	#FSEEKO_FUNC
(
°ªam
, 
off£t
, 
‹igö
Ë
	`f£eko64
(°ªam, off£t, origö)

	)

29 
	~"iﬂpi.h
"

31 
voidpf
 
	$ˇŒ_z›í64_Œ
 (c⁄° 
zlib_fûefunc64_32_def
* 
pfûefunc
,c⁄° *
fûíame
,c⁄° 
size_t
 
size
,
mode
)

33 i‡(
pfûefunc
->
zfûe_func64
.
z›í64_fûe
 !
NULL
)

34  (*(
pfûefunc
->
zfûe_func64
.
z›í64_fûe
)Ë’fûefunc->zfûe_func64.
›aque
,
fûíame
,
size
,
mode
);

37  (*(
pfûefunc
->
z›í32_fûe
))’fûefunc->
zfûe_func64
.
›aque
,(c⁄° *)
fûíame
,
mode
);

39 
	}
}

40 
voidpf
 
	$ˇŒ_z›í64
 (c⁄° 
zlib_fûefunc64_32_def
* 
pfûefunc
,c⁄° *
fûíame
,
mode
)

42 i‡(
pfûefunc
->
zfûe_func64
.
z›í64_fûe
 !
NULL
)

43  (*(
pfûefunc
->
zfûe_func64
.
z›í64_fûe
)Ë’fûefunc->zfûe_func64.
›aque
,
fûíame
,
mode
);

46  (*(
pfûefunc
->
z›í32_fûe
))’fûefunc->
zfûe_func64
.
›aque
,(c⁄° *)
fûíame
,
mode
);

48 
	}
}

50 
	$ˇŒ_z£ek64
 (c⁄° 
zlib_fûefunc64_32_def
* 
pfûefunc
,
voidpf
 
fûe°ªam
, 
ZPOS64_T
 
off£t
, 
‹igö
)

52 i‡(
pfûefunc
->
zfûe_func64
.
z£ek64_fûe
 !
NULL
)

53  (*(
pfûefunc
->
zfûe_func64
.
z£ek64_fûe
)Ë’fûefunc->zfûe_func64.
›aque
,
fûe°ªam
,
off£t
,
‹igö
);

56 
uL⁄g
 
off£tTrunˇãd
 = (uL⁄g)
off£t
;

57 i‡(
off£tTrunˇãd
 !
off£t
)

60  (*(
pfûefunc
->
z£ek32_fûe
))’fûefunc->
zfûe_func64
.
›aque
,
fûe°ªam
,
off£tTrunˇãd
,
‹igö
);

62 
	}
}

64 
ZPOS64_T
 
	$ˇŒ_zãŒ64
 (c⁄° 
zlib_fûefunc64_32_def
* 
pfûefunc
,
voidpf
 
fûe°ªam
)

66 i‡(
pfûefunc
->
zfûe_func64
.
z£ek64_fûe
 !
NULL
)

67  (*(
pfûefunc
->
zfûe_func64
.
zãŒ64_fûe
)Ë’fûefunc->zfûe_func64.
›aque
,
fûe°ªam
);

70 
uL⁄g
 
ãŒ_uL⁄g
 = (*(
pfûefunc
->
zãŒ32_fûe
))’fûefunc->
zfûe_func64
.
›aque
,
fûe°ªam
);

71 i‡((
ãŒ_uL⁄g
Ë=
MAXU32
)

72  (
ZPOS64_T
)-1;

74  
ãŒ_uL⁄g
;

76 
	}
}

78 
	$fûl_zlib_fûefunc64_32_def_‰om_fûefunc32
(
zlib_fûefunc64_32_def
* 
p_fûefunc64_32
,c⁄° 
zlib_fûefunc_def
* 
p_fûefunc32
)

80 
p_fûefunc64_32
->
zfûe_func64
.
z›í64_fûe
 = 
NULL
;

81 
p_fûefunc64_32
->
z›í32_fûe
 = 
p_fûefunc32
->
z›í_fûe
;

82 
p_fûefunc64_32
->
zfûe_func64
.
zîr‹_fûe
 = 
p_fûefunc32
->zerror_file;

83 
p_fûefunc64_32
->
zfûe_func64
.
zªad_fûe
 = 
p_fûefunc32
->zread_file;

84 
p_fûefunc64_32
->
zfûe_func64
.
zwrôe_fûe
 = 
p_fûefunc32
->zwrite_file;

85 
p_fûefunc64_32
->
zfûe_func64
.
zãŒ64_fûe
 = 
NULL
;

86 
p_fûefunc64_32
->
zfûe_func64
.
z£ek64_fûe
 = 
NULL
;

87 
p_fûefunc64_32
->
zfûe_func64
.
z˛o£_fûe
 = 
p_fûefunc32
->zclose_file;

88 
p_fûefunc64_32
->
zfûe_func64
.
zîr‹_fûe
 = 
p_fûefunc32
->zerror_file;

89 
p_fûefunc64_32
->
zfûe_func64
.
›aque
 = 
p_fûefunc32
->opaque;

90 
p_fûefunc64_32
->
z£ek32_fûe
 = 
p_fûefunc32
->
z£ek_fûe
;

91 
p_fûefunc64_32
->
zãŒ32_fûe
 = 
p_fûefunc32
->
zãŒ_fûe
;

92 
	}
}

96 
voidpf
 
ZCALLBACK
 
f›í_fûe_func
 
OF
((voidp‡
›aque
, c⁄° * 
fûíame
, 
mode
));

97 
uL⁄g
 
ZCALLBACK
 
‰ód_fûe_func
 
OF
((
voidpf
 
›aque
, voidp‡
°ªam
, * 
buf
, uL⁄g 
size
));

98 
uL⁄g
 
ZCALLBACK
 
fwrôe_fûe_func
 
OF
((
voidpf
 
›aque
, voidp‡
°ªam
, c⁄° * 
buf
,uL⁄g 
size
));

99 
ZPOS64_T
 
ZCALLBACK
 
·ñl64_fûe_func
 
OF
((
voidpf
 
›aque
, voidp‡
°ªam
));

100 
ZCALLBACK
 
f£ek64_fûe_func
 
OF
((
voidpf
 
›aque
, voidp‡
°ªam
, 
ZPOS64_T
 
off£t
, 
‹igö
));

101 
ZCALLBACK
 
f˛o£_fûe_func
 
OF
((
voidpf
 
›aque
, voidp‡
°ªam
));

102 
ZCALLBACK
 
„º‹_fûe_func
 
OF
((
voidpf
 
›aque
, voidp‡
°ªam
));

104 
voidpf
 
ZCALLBACK
 
	$f›í_fûe_func
 (
voidpf
 
›aque
, c⁄° * 
fûíame
, 
mode
)

106 
FILE
* 
fûe
 = 
NULL
;

107 c⁄° * 
mode_f›í
 = 
NULL
;

108 i‡((
mode
 & 
ZLIB_FILEFUNC_MODE_READWRITEFILTER
)==
ZLIB_FILEFUNC_MODE_READ
)

109 
mode_f›í
 = "rb";

111 i‡(
mode
 & 
ZLIB_FILEFUNC_MODE_EXISTING
)

112 
mode_f›í
 = "r+b";

114 i‡(
mode
 & 
ZLIB_FILEFUNC_MODE_CREATE
)

115 
mode_f›í
 = "wb";

117 i‡((
fûíame
!=
NULL
Ë&& (
mode_f›í
 != NULL))

118 
fûe
 = 
	`f›í
(
fûíame
, 
mode_f›í
);

119  
fûe
;

120 
	}
}

122 
voidpf
 
ZCALLBACK
 
	$f›í64_fûe_func
 (
voidpf
 
›aque
, c⁄° * 
fûíame
, 
mode
)

124 
FILE
* 
fûe
 = 
NULL
;

125 c⁄° * 
mode_f›í
 = 
NULL
;

126 i‡((
mode
 & 
ZLIB_FILEFUNC_MODE_READWRITEFILTER
)==
ZLIB_FILEFUNC_MODE_READ
)

127 
mode_f›í
 = "rb";

129 i‡(
mode
 & 
ZLIB_FILEFUNC_MODE_EXISTING
)

130 
mode_f›í
 = "r+b";

132 i‡(
mode
 & 
ZLIB_FILEFUNC_MODE_CREATE
)

133 
mode_f›í
 = "wb";

135 i‡((
fûíame
!=
NULL
Ë&& (
mode_f›í
 != NULL))

136 
fûe
 = 
	`FOPEN_FUNC
((c⁄° *)
fûíame
, 
mode_f›í
);

137  
fûe
;

138 
	}
}

141 
uL⁄g
 
ZCALLBACK
 
	$‰ód_fûe_func
 (
voidpf
 
›aque
, voidp‡
°ªam
, * 
buf
, 
uL⁄g
 
size
)

143 
uL⁄g
 
ªt
;

144 
ªt
 = (
uL⁄g
)
	`‰ód
(
buf
, 1, (
size_t
)
size
, (
FILE
 *)
°ªam
);

145  
ªt
;

146 
	}
}

148 
uL⁄g
 
ZCALLBACK
 
	$fwrôe_fûe_func
 (
voidpf
 
›aque
, voidp‡
°ªam
, c⁄° * 
buf
, 
uL⁄g
 
size
)

150 
uL⁄g
 
ªt
;

151 
ªt
 = (
uL⁄g
)
	`fwrôe
(
buf
, 1, (
size_t
)
size
, (
FILE
 *)
°ªam
);

152  
ªt
;

153 
	}
}

155 
ZCALLBACK
 
	$·ñl_fûe_func
 (
voidpf
 
›aque
, voidp‡
°ªam
)

157 
ªt
;

158 
ªt
 = 
	`·ñl
((
FILE
 *)
°ªam
);

159  
ªt
;

160 
	}
}

163 
ZPOS64_T
 
ZCALLBACK
 
	$·ñl64_fûe_func
 (
voidpf
 
›aque
, voidp‡
°ªam
)

165 
ZPOS64_T
 
ªt
;

166 
ªt
 = 
	`FTELLO_FUNC
((
FILE
 *)
°ªam
);

167  
ªt
;

168 
	}
}

170 
ZCALLBACK
 
	$f£ek_fûe_func
 (
voidpf
 
›aque
, voidp‡
°ªam
, 
uL⁄g
 
off£t
, 
‹igö
)

172 
f£ek_‹igö
=0;

173 
ªt
;

174 
‹igö
)

176 
ZLIB_FILEFUNC_SEEK_CUR
 :

177 
f£ek_‹igö
 = 
SEEK_CUR
;

179 
ZLIB_FILEFUNC_SEEK_END
 :

180 
f£ek_‹igö
 = 
SEEK_END
;

182 
ZLIB_FILEFUNC_SEEK_SET
 :

183 
f£ek_‹igö
 = 
SEEK_SET
;

187 
ªt
 = 0;

188 i‡(
	`f£ek
((
FILE
 *)
°ªam
, 
off£t
, 
f£ek_‹igö
) != 0)

189 
ªt
 = -1;

190  
ªt
;

191 
	}
}

193 
ZCALLBACK
 
	$f£ek64_fûe_func
 (
voidpf
 
›aque
, voidp‡
°ªam
, 
ZPOS64_T
 
off£t
, 
‹igö
)

195 
f£ek_‹igö
=0;

196 
ªt
;

197 
‹igö
)

199 
ZLIB_FILEFUNC_SEEK_CUR
 :

200 
f£ek_‹igö
 = 
SEEK_CUR
;

202 
ZLIB_FILEFUNC_SEEK_END
 :

203 
f£ek_‹igö
 = 
SEEK_END
;

205 
ZLIB_FILEFUNC_SEEK_SET
 :

206 
f£ek_‹igö
 = 
SEEK_SET
;

210 
ªt
 = 0;

212 if(
	`FSEEKO_FUNC
((
FILE
 *)
°ªam
, 
off£t
, 
f£ek_‹igö
) != 0)

213 
ªt
 = -1;

215  
ªt
;

216 
	}
}

219 
ZCALLBACK
 
	$f˛o£_fûe_func
 (
voidpf
 
›aque
, voidp‡
°ªam
)

221 
ªt
;

222 
ªt
 = 
	`f˛o£
((
FILE
 *)
°ªam
);

223  
ªt
;

224 
	}
}

226 
ZCALLBACK
 
	$„º‹_fûe_func
 (
voidpf
 
›aque
, voidp‡
°ªam
)

228 
ªt
;

229 
ªt
 = 
	`„º‹
((
FILE
 *)
°ªam
);

230  
ªt
;

231 
	}
}

233 
	$fûl_f›í_fûefunc
 (
pzlib_fûefunc_def
)

234 
zlib_fûefunc_def
* 
pzlib_fûefunc_def
;

236 
pzlib_fûefunc_def
->
z›í_fûe
 = 
f›í_fûe_func
;

237 
pzlib_fûefunc_def
->
zªad_fûe
 = 
‰ód_fûe_func
;

238 
pzlib_fûefunc_def
->
zwrôe_fûe
 = 
fwrôe_fûe_func
;

239 
pzlib_fûefunc_def
->
zãŒ_fûe
 = 
·ñl_fûe_func
;

240 
pzlib_fûefunc_def
->
z£ek_fûe
 = 
f£ek_fûe_func
;

241 
pzlib_fûefunc_def
->
z˛o£_fûe
 = 
f˛o£_fûe_func
;

242 
pzlib_fûefunc_def
->
zîr‹_fûe
 = 
„º‹_fûe_func
;

243 
pzlib_fûefunc_def
->
›aque
 = 
NULL
;

244 
	}
}

246 
	$fûl_f›í64_fûefunc
 (
zlib_fûefunc64_def
* 
pzlib_fûefunc_def
)

248 
pzlib_fûefunc_def
->
z›í64_fûe
 = 
f›í64_fûe_func
;

249 
pzlib_fûefunc_def
->
zªad_fûe
 = 
‰ód_fûe_func
;

250 
pzlib_fûefunc_def
->
zwrôe_fûe
 = 
fwrôe_fûe_func
;

251 
pzlib_fûefunc_def
->
zãŒ64_fûe
 = 
·ñl64_fûe_func
;

252 
pzlib_fûefunc_def
->
z£ek64_fûe
 = 
f£ek64_fûe_func
;

253 
pzlib_fûefunc_def
->
z˛o£_fûe
 = 
f˛o£_fûe_func
;

254 
pzlib_fûefunc_def
->
zîr‹_fûe
 = 
„º‹_fûe_func
;

255 
pzlib_fûefunc_def
->
›aque
 = 
NULL
;

256 
	}
}

	@ioapi.h

21 #i‚de‡
_ZLIBIOAPI64_H


22 
	#_ZLIBIOAPI64_H


	)

24 #i‡(!
deföed
(
_WIN32
)Ë&& (!deföed(
WIN32
)Ë&& (!deföed(
__APPLE__
))

29 #i‚de‡
__USE_FILE_OFFSET64


30 
	#__USE_FILE_OFFSET64


	)

32 #i‚de‡
__USE_LARGEFILE64


33 
	#__USE_LARGEFILE64


	)

35 #i‚de‡
_LARGEFILE64_SOURCE


36 
	#_LARGEFILE64_SOURCE


	)

38 #i‚de‡
_FILE_OFFSET_BIT


39 
	#_FILE_OFFSET_BIT
 64

	)

44 
	~<°dio.h
>

45 
	~<°dlib.h
>

46 
	~"zlib.h
"

48 #i‡
deföed
(
USE_FILE32API
)

49 
	#f›í64
 
f›í


	)

50 
	#·ñlo64
 
·ñl


	)

51 
	#f£eko64
 
f£ek


	)

53 #ifde‡
__FªeBSD__


54 
	#f›í64
 
f›í


	)

55 
	#·ñlo64
 
·ñlo


	)

56 
	#f£eko64
 
f£eko


	)

58 #ifde‡
_MSC_VER


59 
	#f›í64
 
f›í


	)

60 #i‡(
_MSC_VER
 >1400Ë&& (!(
deföed
(
NO_MSCVER_FILE64_FUNC
)))

61 
	#·ñlo64
 
_·ñli64


	)

62 
	#f£eko64
 
_f£eki64


	)

64 
	#·ñlo64
 
·ñl


	)

65 
	#f£eko64
 
f£ek


	)

81 #ifde‡
HAVE_MINIZIP64_CONF_H


82 
	~"mz64c⁄f.h
"

86 #ifde‡
HAVE_64BIT_INT_CUSTOM


87 64B
IT_INT_CUSTOM_TYPE
 
	tZPOS64_T
;

89 #ifde‡
HAS_STDINT_H


90 
	~"°döt.h
"

91 
uöt64_t
 
	tZPOS64_T
;

95 
	#MAXU32
 0xffffffff

	)

97 #i‡
deföed
(
_MSC_VER
Ë|| deföed(
__BORLANDC__
)

98 
	t__öt64
 
	tZPOS64_T
;

100 
	tZPOS64_T
;

107 #ifde‡
__˝lu•lus


112 
	#ZLIB_FILEFUNC_SEEK_CUR
 (1)

	)

113 
	#ZLIB_FILEFUNC_SEEK_END
 (2)

	)

114 
	#ZLIB_FILEFUNC_SEEK_SET
 (0)

	)

116 
	#ZLIB_FILEFUNC_MODE_READ
 (1)

	)

117 
	#ZLIB_FILEFUNC_MODE_WRITE
 (2)

	)

118 
	#ZLIB_FILEFUNC_MODE_READWRITEFILTER
 (3)

	)

120 
	#ZLIB_FILEFUNC_MODE_EXISTING
 (4)

	)

121 
	#ZLIB_FILEFUNC_MODE_CREATE
 (8)

	)

124 #i‚de‡
ZCALLBACK


125 #i‡(
deföed
(
WIN32
Ë|| deföed(
_WIN32
Ë|| deföed (
WINDOWS
Ë|| deföed (
_WINDOWS
)Ë&& deföed(
CALLBACK
Ë&& deföed (
USEWINDOWS_CALLBACK
)

126 
	#ZCALLBACK
 
CALLBACK


	)

128 
	#ZCALLBACK


	)

135 
voidpf
 (
	tZCALLBACK
 *
	t›í_fûe_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, c⁄° * 
	tfûíame
, 
	tmode
));

136 
uL⁄g
 (
	tZCALLBACK
 *
	tªad_fûe_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, voidp‡
	t°ªam
, * 
	tbuf
, 
	tuL⁄g
 
	tsize
));

137 
uL⁄g
 (
	tZCALLBACK
 *
	twrôe_fûe_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, voidp‡
	t°ªam
, c⁄° * 
	tbuf
, 
	tuL⁄g
 
	tsize
));

138 (
ZCALLBACK
 *
	t˛o£_fûe_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, voidp‡
	t°ªam
));

139 (
ZCALLBACK
 *
	tã°îr‹_fûe_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, voidp‡
	t°ªam
));

141 (
ZCALLBACK
 *
	tãŒ_fûe_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, voidp‡
	t°ªam
));

142 (
ZCALLBACK
 *
	t£ek_fûe_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, voidp‡
	t°ªam
, 
	tuL⁄g
 
	toff£t
, 
	t‹igö
));

146 
	szlib_fûefunc_def_s


148 
›í_fûe_func
 
z›í_fûe
;

149 
ªad_fûe_func
 
zªad_fûe
;

150 
wrôe_fûe_func
 
zwrôe_fûe
;

151 
ãŒ_fûe_func
 
zãŒ_fûe
;

152 
£ek_fûe_func
 
z£ek_fûe
;

153 
˛o£_fûe_func
 
z˛o£_fûe
;

154 
ã°îr‹_fûe_func
 
zîr‹_fûe
;

155 
voidpf
 
›aque
;

156 } 
	tzlib_fûefunc_def
;

158 
ZPOS64_T
 (
	tZCALLBACK
 *
	tãŒ64_fûe_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, voidp‡
	t°ªam
));

159 (
ZCALLBACK
 *
	t£ek64_fûe_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, voidp‡
	t°ªam
, 
	tZPOS64_T
 
	toff£t
, 
	t‹igö
));

160 
voidpf
 (
	tZCALLBACK
 *
	t›í64_fûe_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, c⁄° * 
	tfûíame
, c⁄° 
	tsize_t
 
	tsize
,
	tmode
));

162 
	szlib_fûefunc64_def_s


164 
›í64_fûe_func
 
z›í64_fûe
;

165 
ªad_fûe_func
 
zªad_fûe
;

166 
wrôe_fûe_func
 
zwrôe_fûe
;

167 
ãŒ64_fûe_func
 
zãŒ64_fûe
;

168 
£ek64_fûe_func
 
z£ek64_fûe
;

169 
˛o£_fûe_func
 
z˛o£_fûe
;

170 
ã°îr‹_fûe_func
 
zîr‹_fûe
;

171 
voidpf
 
›aque
;

172 } 
	tzlib_fûefunc64_def
;

174 
fûl_f›í64_fûefunc
 
OF
((
zlib_fûefunc64_def
* 
pzlib_fûefunc_def
));

175 
fûl_f›í_fûefunc
 
OF
((
zlib_fûefunc_def
* 
pzlib_fûefunc_def
));

178 
	szlib_fûefunc64_32_def_s


180 
zlib_fûefunc64_def
 
zfûe_func64
;

181 
›í_fûe_func
 
z›í32_fûe
;

182 
ãŒ_fûe_func
 
zãŒ32_fûe
;

183 
£ek_fûe_func
 
z£ek32_fûe
;

184 } 
	tzlib_fûefunc64_32_def
;

187 
	#ZREAD64
(
fûefunc
,
fûe°ªam
,
buf
,
size
Ë((*((fûefunc).
zfûe_func64
.
zªad_fûe
)Ë((fûefunc).zfûe_func64.
›aque
,fûe°ªam,buf,size))

	)

188 
	#ZWRITE64
(
fûefunc
,
fûe°ªam
,
buf
,
size
Ë((*((fûefunc).
zfûe_func64
.
zwrôe_fûe
)Ë((fûefunc).zfûe_func64.
›aque
,fûe°ªam,buf,size))

	)

191 
	#ZCLOSE64
(
fûefunc
,
fûe°ªam
Ë((*((fûefunc).
zfûe_func64
.
z˛o£_fûe
)Ë((fûefunc).zfûe_func64.
›aque
,fûe°ªam))

	)

192 
	#ZERROR64
(
fûefunc
,
fûe°ªam
Ë((*((fûefunc).
zfûe_func64
.
zîr‹_fûe
)Ë((fûefunc).zfûe_func64.
›aque
,fûe°ªam))

	)

194 
voidpf
 
ˇŒ_z›í64_Œ
 
OF
((c⁄° 
zlib_fûefunc64_32_def
* 
pfûefunc
,c⁄° *
fûíame
,c⁄° 
size_t
 
size
,
mode
));

195 
voidpf
 
ˇŒ_z›í64
 
OF
((c⁄° 
zlib_fûefunc64_32_def
* 
pfûefunc
,c⁄° *
fûíame
,
mode
));

196 
ˇŒ_z£ek64
 
OF
((c⁄° 
zlib_fûefunc64_32_def
* 
pfûefunc
,
voidpf
 
fûe°ªam
, 
ZPOS64_T
 
off£t
, 
‹igö
));

197 
ZPOS64_T
 
ˇŒ_zãŒ64
 
OF
((c⁄° 
zlib_fûefunc64_32_def
* 
pfûefunc
,
voidpf
 
fûe°ªam
));

199 
fûl_zlib_fûefunc64_32_def_‰om_fûefunc32
(
zlib_fûefunc64_32_def
* 
p_fûefunc64_32
,c⁄° 
zlib_fûefunc_def
* 
p_fûefunc32
);

201 
	#ZOPEN64_LL
(
fûefunc
,
fûíame
,
size
,
mode
Ë(
	`ˇŒ_z›í64_Œ
((&(fûefunc)),(fûíame),(size),(mode)))

	)

202 
	#ZOPEN64
(
fûefunc
,
fûíame
,
mode
Ë(
	`ˇŒ_z›í64
((&(fûefunc)),(fûíame),(mode)))

	)

203 
	#ZTELL64
(
fûefunc
,
fûe°ªam
Ë(
	`ˇŒ_zãŒ64
((&(fûefunc)),(fûe°ªam)))

	)

204 
	#ZSEEK64
(
fûefunc
,
fûe°ªam
,
pos
,
mode
Ë(
	`ˇŒ_z£ek64
((&(fûefunc)),(fûe°ªam),’os),(mode)))

	)

206 #ifde‡
__˝lu•lus


	@test.c

1 
	~<zlib.h
>

2 
	~"unzù.h
"

3 
	$maö
()

6 
unzFûe
 
zFûe
=
	`unzO≥n64
("t.zip",100);

7 if(
zFûe
 =
NULL
)

9 
	`¥ötf
("error\n");

13 
	`¥ötf
("success\n");

15 
unz_globÆ_öfo64
 
zGlobÆInfo
;

16 if(
UNZ_OK
!=
	`unzGëGlobÆInfo64
(
zFûe
,&
zGlobÆInfo
))

18 
	`¥ötf
("error\n");

20 
	`¥ötf
("%d\n",()
zGlobÆInfo
.
numbî_íåy
);

21 
unz_fûe_öfo64
 
zFûeInfo
;

22 
fûíame
[512];

23 
i
=0;i<
zGlobÆInfo
.
numbî_íåy
;i++)

25 if(
UNZ_OK
!=
	`unzGëCuºítFûeInfo64
(
zFûe
,&
zFûeInfo
,
fûíame
,512,
NULL
,0,NULL,0))

27 
	`¥ötf
("error\n");

29 
	`¥ötf
("%s\n",
fûíame
);

30 
	`unzGoToNextFûe
(
zFûe
);

32 
	`unzClo£
(
zFûe
);

34 
	}
}

	@unzip.c

67 
	~<°dio.h
>

68 
	~<°dlib.h
>

69 
	~<°rög.h
>

71 #i‚de‡
NOUNCRYPT


72 
	#NOUNCRYPT


	)

75 
	~"zlib.h
"

76 
	~"unzù.h
"

78 #ifde‡
STDC


79 
	~<°ddef.h
>

80 
	~<°rög.h
>

81 
	~<°dlib.h
>

83 #ifde‡
NO_ERRNO_H


84 
î∫o
;

86 
	~<î∫o.h
>

90 #i‚de‡
loˇl


91 
	#loˇl
 

	)

96 #i‚de‡
CASESENSITIVITYDEFAULT_NO


97 #i‡!
deföed
(
unix
Ë&& !deföed(
CASESENSITIVITYDEFAULT_YES
)

98 
	#CASESENSITIVITYDEFAULT_NO


	)

103 #i‚de‡
UNZ_BUFSIZE


104 
	#UNZ_BUFSIZE
 (16384)

	)

107 #i‚de‡
UNZ_MAXFILENAMEINZIP


108 
	#UNZ_MAXFILENAMEINZIP
 (256)

	)

111 #i‚de‡
ALLOC


112 
	#ALLOC
(
size
Ë(
	`mÆloc
(size))

	)

114 #i‚de‡
TRYFREE


115 
	#TRYFREE
(
p
Ë{i‡’Ë
	`‰ì
’);}

	)

118 
	#SIZECENTRALDIRITEM
 (0x2e)

	)

119 
	#SIZEZIPLOCALHEADER
 (0x1e)

	)

122 c⁄° 
	gunz_c›yright
[] =

126 
	sunz_fûe_öfo64_öã∫Æ_s


128 
ZPOS64_T
 
	moff£t_curfûe
;

129 } 
	tunz_fûe_öfo64_öã∫Æ
;

136 *
	mªad_buf„r
;

137 
z_°ªam
 
	m°ªam
;

139 #ifde‡
HAVE_BZIP2


140 
bz_°ªam
 
	mb°ªam
;

143 
ZPOS64_T
 
	mpos_ö_zùfûe
;

144 
uL⁄g
 
	m°ªam_öôüli£d
;

146 
ZPOS64_T
 
	moff£t_loˇl_exåafõld
;

147 
uI¡
 
	msize_loˇl_exåafõld
;

148 
ZPOS64_T
 
	mpos_loˇl_exåafõld
;

149 
ZPOS64_T
 
	mtŸÆ_out_64
;

151 
uL⁄g
 
	m¸c32
;

152 
uL⁄g
 
	m¸c32_waô
;

153 
ZPOS64_T
 
	mª°_ªad_com¥es£d
;

154 
ZPOS64_T
 
	mª°_ªad_uncom¥es£d
;

155 
zlib_fûefunc64_32_def
 
	mz_fûefunc
;

156 
voidpf
 
	mfûe°ªam
;

157 
uL⁄g
 
	mcom¥essi⁄_mëhod
;

158 
ZPOS64_T
 
	mbyã_bef‹e_the_zùfûe
;

159 
	møw
;

160 } 
	tfûe_ö_zù64_ªad_öfo_s
;

167 
zlib_fûefunc64_32_def
 
	mz_fûefunc
;

168 
	mis64bôO≥nFun˘i⁄
;

169 
voidpf
 
	mfûe°ªam
;

170 
unz_globÆ_öfo64
 
	mgi
;

171 
ZPOS64_T
 
	mbyã_bef‹e_the_zùfûe
;

172 
ZPOS64_T
 
	mnum_fûe
;

173 
ZPOS64_T
 
	mpos_ö_˚¡øl_dú
;

174 
ZPOS64_T
 
	mcuºít_fûe_ok
;

175 
ZPOS64_T
 
	m˚¡øl_pos
;

177 
ZPOS64_T
 
	msize_˚¡øl_dú
;

178 
ZPOS64_T
 
	moff£t_˚¡øl_dú
;

181 
unz_fûe_öfo64
 
	mcur_fûe_öfo
;

182 
unz_fûe_öfo64_öã∫Æ
 
	mcur_fûe_öfo_öã∫Æ
;

183 
fûe_ö_zù64_ªad_öfo_s
* 
	mpfûe_ö_zù_ªad
;

185 
	mí¸y±ed
;

187 
	misZù64
;

189 #i‚de‡
NOUNCRYPT


190 
	mkeys
[3];

191 c⁄° 
z_¸c_t
* 
	mp¸c_32_èb
;

193 } 
	tunz64_s
;

196 #i‚de‡
NOUNCRYPT


197 
	~"¸y±.h
"

207 
loˇl
 
unz64loˇl_gëByã
 
OF
((

208 c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
,

209 
voidpf
 
fûe°ªam
,

210 *
pi
));

212 
loˇl
 
	$unz64loˇl_gëByã
(c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
, 
voidpf
 
fûe°ªam
, *
pi
)

214 
c
;

215 
îr
 = ()
	`ZREAD64
(*
pzlib_fûefunc_def
,
fûe°ªam
,&
c
,1);

216 i‡(
îr
==1)

218 *
pi
 = ()
c
;

219  
UNZ_OK
;

223 i‡(
	`ZERROR64
(*
pzlib_fûefunc_def
,
fûe°ªam
))

224  
UNZ_ERRNO
;

226  
UNZ_EOF
;

228 
	}
}

234 
loˇl
 
unz64loˇl_gëSh‹t
 
OF
((

235 c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
,

236 
voidpf
 
fûe°ªam
,

237 
uL⁄g
 *
pX
));

239 
loˇl
 
	$unz64loˇl_gëSh‹t
 (c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
,

240 
voidpf
 
fûe°ªam
,

241 
uL⁄g
 *
pX
)

243 
uL⁄g
 
x
 ;

244 
i
 = 0;

245 
îr
;

247 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

248 
x
 = (
uL⁄g
)
i
;

250 i‡(
îr
==
UNZ_OK
)

251 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

252 
x
 |((
uL⁄g
)
i
)<<8;

254 i‡(
îr
==
UNZ_OK
)

255 *
pX
 = 
x
;

257 *
pX
 = 0;

258  
îr
;

259 
	}
}

261 
loˇl
 
unz64loˇl_gëL⁄g
 
OF
((

262 c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
,

263 
voidpf
 
fûe°ªam
,

264 
uL⁄g
 *
pX
));

266 
loˇl
 
	$unz64loˇl_gëL⁄g
 (c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
,

267 
voidpf
 
fûe°ªam
,

268 
uL⁄g
 *
pX
)

270 
uL⁄g
 
x
 ;

271 
i
 = 0;

272 
îr
;

274 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

275 
x
 = (
uL⁄g
)
i
;

277 i‡(
îr
==
UNZ_OK
)

278 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

279 
x
 |((
uL⁄g
)
i
)<<8;

281 i‡(
îr
==
UNZ_OK
)

282 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

283 
x
 |((
uL⁄g
)
i
)<<16;

285 i‡(
îr
==
UNZ_OK
)

286 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

287 
x
 +((
uL⁄g
)
i
)<<24;

289 i‡(
îr
==
UNZ_OK
)

290 *
pX
 = 
x
;

292 *
pX
 = 0;

293  
îr
;

294 
	}
}

296 
loˇl
 
unz64loˇl_gëL⁄g64
 
OF
((

297 c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
,

298 
voidpf
 
fûe°ªam
,

299 
ZPOS64_T
 *
pX
));

302 
loˇl
 
	$unz64loˇl_gëL⁄g64
 (c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
,

303 
voidpf
 
fûe°ªam
,

304 
ZPOS64_T
 *
pX
)

306 
ZPOS64_T
 
x
 ;

307 
i
 = 0;

308 
îr
;

310 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

311 
x
 = (
ZPOS64_T
)
i
;

313 i‡(
îr
==
UNZ_OK
)

314 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

315 
x
 |((
ZPOS64_T
)
i
)<<8;

317 i‡(
îr
==
UNZ_OK
)

318 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

319 
x
 |((
ZPOS64_T
)
i
)<<16;

321 i‡(
îr
==
UNZ_OK
)

322 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

323 
x
 |((
ZPOS64_T
)
i
)<<24;

325 i‡(
îr
==
UNZ_OK
)

326 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

327 
x
 |((
ZPOS64_T
)
i
)<<32;

329 i‡(
îr
==
UNZ_OK
)

330 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

331 
x
 |((
ZPOS64_T
)
i
)<<40;

333 i‡(
îr
==
UNZ_OK
)

334 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

335 
x
 |((
ZPOS64_T
)
i
)<<48;

337 i‡(
îr
==
UNZ_OK
)

338 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

339 
x
 |((
ZPOS64_T
)
i
)<<56;

341 i‡(
îr
==
UNZ_OK
)

342 *
pX
 = 
x
;

344 *
pX
 = 0;

345  
îr
;

346 
	}
}

349 
loˇl
 
	$°rcmpˇ£no£nsôive_öã∫Æ
 (c⁄° * 
fûeName1
, c⁄° * 
fûeName2
)

353 
c1
=*(
fûeName1
++);

354 
c2
=*(
fûeName2
++);

355 i‡((
c1
>='a') && (c1<='z'))

356 
c1
 -= 0x20;

357 i‡((
c2
>='a') && (c2<='z'))

358 
c2
 -= 0x20;

359 i‡(
c1
=='\0')

360  ((
c2
=='\0') ? 0 : -1);

361 i‡(
c2
=='\0')

363 i‡(
c1
<
c2
)

365 i‡(
c1
>
c2
)

368 
	}
}

371 #ifde‡ 
CASESENSITIVITYDEFAULT_NO


372 
	#CASESENSITIVITYDEFAULTVALUE
 2

	)

374 
	#CASESENSITIVITYDEFAULTVALUE
 1

	)

377 #i‚de‡
STRCMPCASENOSENTIVEFUNCTION


378 
	#STRCMPCASENOSENTIVEFUNCTION
 
°rcmpˇ£no£nsôive_öã∫Æ


	)

390 
ZEXPORT
 
	$unzSåögFûeNameCom∑ª
 (c⁄° * 
fûeName1
,

391 c⁄° * 
fûeName2
,

392 
iCa£Sísôivôy
)

395 i‡(
iCa£Sísôivôy
==0)

396 
iCa£Sísôivôy
=
CASESENSITIVITYDEFAULTVALUE
;

398 i‡(
iCa£Sísôivôy
==1)

399  
	`°rcmp
(
fûeName1
,
fûeName2
);

401  
	`STRCMPCASENOSENTIVEFUNCTION
(
fûeName1
,
fûeName2
);

402 
	}
}

404 #i‚de‡
BUFREADCOMMENT


405 
	#BUFREADCOMMENT
 (0x400)

	)

412 
loˇl
 
ZPOS64_T
 
unz64loˇl_SórchCíåÆDú
 
OF
((c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
, 
voidpf
 
fûe°ªam
));

413 
loˇl
 
ZPOS64_T
 
	$unz64loˇl_SórchCíåÆDú
(c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
, 
voidpf
 
fûe°ªam
)

415 * 
buf
;

416 
ZPOS64_T
 
uSizeFûe
;

417 
ZPOS64_T
 
uBackRód
;

418 
ZPOS64_T
 
uMaxBack
=0xffff;

419 
ZPOS64_T
 
uPosFound
=0;

421 i‡(
	`ZSEEK64
(*
pzlib_fûefunc_def
,
fûe°ªam
,0,
ZLIB_FILEFUNC_SEEK_END
) != 0)

425 
uSizeFûe
 = 
	`ZTELL64
(*
pzlib_fûefunc_def
,
fûe°ªam
);

427 i‡(
uMaxBack
>
uSizeFûe
)

428 
uMaxBack
 = 
uSizeFûe
;

430 
buf
 = (*)
	`ALLOC
(
BUFREADCOMMENT
+4);

431 i‡(
buf
==
NULL
)

434 
uBackRód
 = 4;

435 
uBackRód
<
uMaxBack
)

437 
uL⁄g
 
uRódSize
;

438 
ZPOS64_T
 
uRódPos
 ;

439 
i
;

440 i‡(
uBackRód
+
BUFREADCOMMENT
>
uMaxBack
)

441 
uBackRód
 = 
uMaxBack
;

443 
uBackRód
+=
BUFREADCOMMENT
;

444 
uRódPos
 = 
uSizeFûe
-
uBackRód
 ;

446 
uRódSize
 = ((
BUFREADCOMMENT
+4Ë< (
uSizeFûe
-
uRódPos
)) ?

447 (
BUFREADCOMMENT
+4Ë: (
uL⁄g
)(
uSizeFûe
-
uRódPos
);

448 i‡(
	`ZSEEK64
(*
pzlib_fûefunc_def
,
fûe°ªam
,
uRódPos
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

451 i‡(
	`ZREAD64
(*
pzlib_fûefunc_def
,
fûe°ªam
,
buf
,
uRódSize
)!=uReadSize)

454 
i
=()
uRódSize
-3; (i--)>0;)

455 i‡(((*(
buf
+
i
))==0x50) && ((*(buf+i+1))==0x4b) &&

456 ((*(
buf
+
i
+2))==0x05) && ((*(buf+i+3))==0x06))

458 
uPosFound
 = 
uRódPos
+
i
;

462 i‡(
uPosFound
!=0)

465 
	`TRYFREE
(
buf
);

466  
uPosFound
;

467 
	}
}

474 
loˇl
 
ZPOS64_T
 
unz64loˇl_SórchCíåÆDú64
 
OF
((

475 c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
,

476 
voidpf
 
fûe°ªam
));

478 
loˇl
 
ZPOS64_T
 
	$unz64loˇl_SórchCíåÆDú64
(c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
,

479 
voidpf
 
fûe°ªam
)

481 * 
buf
;

482 
ZPOS64_T
 
uSizeFûe
;

483 
ZPOS64_T
 
uBackRód
;

484 
ZPOS64_T
 
uMaxBack
=0xffff;

485 
ZPOS64_T
 
uPosFound
=0;

486 
uL⁄g
 
uL
;

487 
ZPOS64_T
 
ªœtiveOff£t
;

489 i‡(
	`ZSEEK64
(*
pzlib_fûefunc_def
,
fûe°ªam
,0,
ZLIB_FILEFUNC_SEEK_END
) != 0)

493 
uSizeFûe
 = 
	`ZTELL64
(*
pzlib_fûefunc_def
,
fûe°ªam
);

495 i‡(
uMaxBack
>
uSizeFûe
)

496 
uMaxBack
 = 
uSizeFûe
;

498 
buf
 = (*)
	`ALLOC
(
BUFREADCOMMENT
+4);

499 i‡(
buf
==
NULL
)

502 
uBackRód
 = 4;

503 
uBackRód
<
uMaxBack
)

505 
uL⁄g
 
uRódSize
;

506 
ZPOS64_T
 
uRódPos
;

507 
i
;

508 i‡(
uBackRód
+
BUFREADCOMMENT
>
uMaxBack
)

509 
uBackRód
 = 
uMaxBack
;

511 
uBackRód
+=
BUFREADCOMMENT
;

512 
uRódPos
 = 
uSizeFûe
-
uBackRód
 ;

514 
uRódSize
 = ((
BUFREADCOMMENT
+4Ë< (
uSizeFûe
-
uRódPos
)) ?

515 (
BUFREADCOMMENT
+4Ë: (
uL⁄g
)(
uSizeFûe
-
uRódPos
);

516 i‡(
	`ZSEEK64
(*
pzlib_fûefunc_def
,
fûe°ªam
,
uRódPos
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

519 i‡(
	`ZREAD64
(*
pzlib_fûefunc_def
,
fûe°ªam
,
buf
,
uRódSize
)!=uReadSize)

522 
i
=()
uRódSize
-3; (i--)>0;)

523 i‡(((*(
buf
+
i
))==0x50) && ((*(buf+i+1))==0x4b) &&

524 ((*(
buf
+
i
+2))==0x06) && ((*(buf+i+3))==0x07))

526 
uPosFound
 = 
uRódPos
+
i
;

530 i‡(
uPosFound
!=0)

533 
	`TRYFREE
(
buf
);

534 i‡(
uPosFound
 == 0)

538 i‡(
	`ZSEEK64
(*
pzlib_fûefunc_def
,
fûe°ªam
, 
uPosFound
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

542 i‡(
	`unz64loˇl_gëL⁄g
(
pzlib_fûefunc_def
,
fûe°ªam
,&
uL
)!=
UNZ_OK
)

546 i‡(
	`unz64loˇl_gëL⁄g
(
pzlib_fûefunc_def
,
fûe°ªam
,&
uL
)!=
UNZ_OK
)

548 i‡(
uL
 != 0)

552 i‡(
	`unz64loˇl_gëL⁄g64
(
pzlib_fûefunc_def
,
fûe°ªam
,&
ªœtiveOff£t
)!=
UNZ_OK
)

556 i‡(
	`unz64loˇl_gëL⁄g
(
pzlib_fûefunc_def
,
fûe°ªam
,&
uL
)!=
UNZ_OK
)

558 i‡(
uL
 != 1)

562 i‡(
	`ZSEEK64
(*
pzlib_fûefunc_def
,
fûe°ªam
, 
ªœtiveOff£t
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

566 i‡(
	`unz64loˇl_gëL⁄g
(
pzlib_fûefunc_def
,
fûe°ªam
,&
uL
)!=
UNZ_OK
)

569 i‡(
uL
 != 0x06064b50)

572  
ªœtiveOff£t
;

573 
	}
}

584 
loˇl
 
unzFûe
 
	$unzO≥nI¡î«l
 (c⁄° *
∑th
,

585 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc64_32_def
,

586 
is64bôO≥nFun˘i⁄
)

588 
unz64_s
 
us
;

589 
unz64_s
 *
s
;

590 
ZPOS64_T
 
˚¡øl_pos
;

591 
uL⁄g
 
uL
;

593 
uL⁄g
 
numbî_disk
;

595 
uL⁄g
 
numbî_disk_wôh_CD
;

597 
ZPOS64_T
 
numbî_íåy_CD
;

601 
îr
=
UNZ_OK
;

603 i‡(
unz_c›yright
[0]!=' ')

604  
NULL
;

606 
us
.
z_fûefunc
.
z£ek32_fûe
 = 
NULL
;

607 
us
.
z_fûefunc
.
zãŒ32_fûe
 = 
NULL
;

608 i‡(
pzlib_fûefunc64_32_def
==
NULL
)

609 
	`fûl_f›í64_fûefunc
(&
us
.
z_fûefunc
.
zfûe_func64
);

611 
us
.
z_fûefunc
 = *
pzlib_fûefunc64_32_def
;

612 
us
.
is64bôO≥nFun˘i⁄
 = is64bitOpenFunction;

616 
us
.
fûe°ªam
 = 
	`ZOPEN64
(us.
z_fûefunc
,

617 
∑th
,

618 
ZLIB_FILEFUNC_MODE_READ
 |

619 
ZLIB_FILEFUNC_MODE_EXISTING
);

620 i‡(
us
.
fûe°ªam
==
NULL
)

621  
NULL
;

623 
˚¡øl_pos
 = 
	`unz64loˇl_SórchCíåÆDú64
(&
us
.
z_fûefunc
,us.
fûe°ªam
);

624 i‡(
˚¡øl_pos
)

626 
uL⁄g
 
uS
;

627 
ZPOS64_T
 
uL64
;

629 
us
.
isZù64
 = 1;

631 i‡(
	`ZSEEK64
(
us
.
z_fûefunc
, us.
fûe°ªam
,

632 
˚¡øl_pos
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

633 
îr
=
UNZ_ERRNO
;

636 i‡(
	`unz64loˇl_gëL⁄g
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uL
)!=
UNZ_OK
)

637 
îr
=
UNZ_ERRNO
;

640 i‡(
	`unz64loˇl_gëL⁄g64
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uL64
)!=
UNZ_OK
)

641 
îr
=
UNZ_ERRNO
;

644 i‡(
	`unz64loˇl_gëSh‹t
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uS
)!=
UNZ_OK
)

645 
îr
=
UNZ_ERRNO
;

648 i‡(
	`unz64loˇl_gëSh‹t
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uS
)!=
UNZ_OK
)

649 
îr
=
UNZ_ERRNO
;

652 i‡(
	`unz64loˇl_gëL⁄g
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
numbî_disk
)!=
UNZ_OK
)

653 
îr
=
UNZ_ERRNO
;

656 i‡(
	`unz64loˇl_gëL⁄g
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
numbî_disk_wôh_CD
)!=
UNZ_OK
)

657 
îr
=
UNZ_ERRNO
;

660 i‡(
	`unz64loˇl_gëL⁄g64
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&us.
gi
.
numbî_íåy
)!=
UNZ_OK
)

661 
îr
=
UNZ_ERRNO
;

664 i‡(
	`unz64loˇl_gëL⁄g64
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
numbî_íåy_CD
)!=
UNZ_OK
)

665 
îr
=
UNZ_ERRNO
;

667 i‡((
numbî_íåy_CD
!=
us
.
gi
.
numbî_íåy
) ||

668 (
numbî_disk_wôh_CD
!=0) ||

669 (
numbî_disk
!=0))

670 
îr
=
UNZ_BADZIPFILE
;

673 i‡(
	`unz64loˇl_gëL⁄g64
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&us.
size_˚¡øl_dú
)!=
UNZ_OK
)

674 
îr
=
UNZ_ERRNO
;

678 i‡(
	`unz64loˇl_gëL⁄g64
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&us.
off£t_˚¡øl_dú
)!=
UNZ_OK
)

679 
îr
=
UNZ_ERRNO
;

681 
us
.
gi
.
size_commít
 = 0;

685 
˚¡øl_pos
 = 
	`unz64loˇl_SórchCíåÆDú
(&
us
.
z_fûefunc
,us.
fûe°ªam
);

686 i‡(
˚¡øl_pos
==0)

687 
îr
=
UNZ_ERRNO
;

689 
us
.
isZù64
 = 0;

691 i‡(
	`ZSEEK64
(
us
.
z_fûefunc
, us.
fûe°ªam
,

692 
˚¡øl_pos
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

693 
îr
=
UNZ_ERRNO
;

696 i‡(
	`unz64loˇl_gëL⁄g
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uL
)!=
UNZ_OK
)

697 
îr
=
UNZ_ERRNO
;

700 i‡(
	`unz64loˇl_gëSh‹t
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
numbî_disk
)!=
UNZ_OK
)

701 
îr
=
UNZ_ERRNO
;

704 i‡(
	`unz64loˇl_gëSh‹t
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
numbî_disk_wôh_CD
)!=
UNZ_OK
)

705 
îr
=
UNZ_ERRNO
;

708 i‡(
	`unz64loˇl_gëSh‹t
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uL
)!=
UNZ_OK
)

709 
îr
=
UNZ_ERRNO
;

710 
us
.
gi
.
numbî_íåy
 = 
uL
;

713 i‡(
	`unz64loˇl_gëSh‹t
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uL
)!=
UNZ_OK
)

714 
îr
=
UNZ_ERRNO
;

715 
numbî_íåy_CD
 = 
uL
;

717 i‡((
numbî_íåy_CD
!=
us
.
gi
.
numbî_íåy
) ||

718 (
numbî_disk_wôh_CD
!=0) ||

719 (
numbî_disk
!=0))

720 
îr
=
UNZ_BADZIPFILE
;

723 i‡(
	`unz64loˇl_gëL⁄g
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uL
)!=
UNZ_OK
)

724 
îr
=
UNZ_ERRNO
;

725 
us
.
size_˚¡øl_dú
 = 
uL
;

729 i‡(
	`unz64loˇl_gëL⁄g
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uL
)!=
UNZ_OK
)

730 
îr
=
UNZ_ERRNO
;

731 
us
.
off£t_˚¡øl_dú
 = 
uL
;

734 i‡(
	`unz64loˇl_gëSh‹t
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&us.
gi
.
size_commít
)!=
UNZ_OK
)

735 
îr
=
UNZ_ERRNO
;

738 i‡((
˚¡øl_pos
<
us
.
off£t_˚¡øl_dú
+us.
size_˚¡øl_dú
) &&

739 (
îr
==
UNZ_OK
))

740 
îr
=
UNZ_BADZIPFILE
;

742 i‡(
îr
!=
UNZ_OK
)

744 
	`ZCLOSE64
(
us
.
z_fûefunc
, us.
fûe°ªam
);

745  
NULL
;

748 
us
.
byã_bef‹e_the_zùfûe
 = 
˚¡øl_pos
 -

749 (
us
.
off£t_˚¡øl_dú
+us.
size_˚¡øl_dú
);

750 
us
.
˚¡øl_pos
 = central_pos;

751 
us
.
pfûe_ö_zù_ªad
 = 
NULL
;

752 
us
.
í¸y±ed
 = 0;

755 
s
=(
unz64_s
*)
	`ALLOC
((unz64_s));

756 if–
s
 !
NULL
)

758 *
s
=
us
;

759 
	`unzGoToFú°Fûe
((
unzFûe
)
s
);

761  (
unzFûe
)
s
;

762 
	}
}

764 
loˇl
 
unzFûe
 
	$unzO≥nI¡î«l_Œ
 (c⁄° *
∑th
,
size_t
 
size
,

765 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc64_32_def
,

766 
is64bôO≥nFun˘i⁄
)

768 
unz64_s
 
us
;

769 
unz64_s
 *
s
;

770 
ZPOS64_T
 
˚¡øl_pos
;

771 
uL⁄g
 
uL
;

773 
uL⁄g
 
numbî_disk
;

775 
uL⁄g
 
numbî_disk_wôh_CD
;

777 
ZPOS64_T
 
numbî_íåy_CD
;

781 
îr
=
UNZ_OK
;

783 i‡(
unz_c›yright
[0]!=' ')

784  
NULL
;

786 
us
.
z_fûefunc
.
z£ek32_fûe
 = 
NULL
;

787 
us
.
z_fûefunc
.
zãŒ32_fûe
 = 
NULL
;

788 i‡(
pzlib_fûefunc64_32_def
==
NULL
)

789 
	`fûl_f›í64_fûefunc
(&
us
.
z_fûefunc
.
zfûe_func64
);

791 
us
.
z_fûefunc
 = *
pzlib_fûefunc64_32_def
;

792 
us
.
is64bôO≥nFun˘i⁄
 = is64bitOpenFunction;

796 
us
.
fûe°ªam
 = 
	`ZOPEN64_LL
(us.
z_fûefunc
,

797 
∑th
,

798 
size
,

799 
ZLIB_FILEFUNC_MODE_READ
 |

800 
ZLIB_FILEFUNC_MODE_EXISTING
);

801 i‡(
us
.
fûe°ªam
==
NULL
)

802  
NULL
;

804 
˚¡øl_pos
 = 
	`unz64loˇl_SórchCíåÆDú64
(&
us
.
z_fûefunc
,us.
fûe°ªam
);

805 i‡(
˚¡øl_pos
)

807 
uL⁄g
 
uS
;

808 
ZPOS64_T
 
uL64
;

810 
us
.
isZù64
 = 1;

812 i‡(
	`ZSEEK64
(
us
.
z_fûefunc
, us.
fûe°ªam
,

813 
˚¡øl_pos
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

814 
îr
=
UNZ_ERRNO
;

817 i‡(
	`unz64loˇl_gëL⁄g
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uL
)!=
UNZ_OK
)

818 
îr
=
UNZ_ERRNO
;

821 i‡(
	`unz64loˇl_gëL⁄g64
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uL64
)!=
UNZ_OK
)

822 
îr
=
UNZ_ERRNO
;

825 i‡(
	`unz64loˇl_gëSh‹t
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uS
)!=
UNZ_OK
)

826 
îr
=
UNZ_ERRNO
;

829 i‡(
	`unz64loˇl_gëSh‹t
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uS
)!=
UNZ_OK
)

830 
îr
=
UNZ_ERRNO
;

833 i‡(
	`unz64loˇl_gëL⁄g
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
numbî_disk
)!=
UNZ_OK
)

834 
îr
=
UNZ_ERRNO
;

837 i‡(
	`unz64loˇl_gëL⁄g
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
numbî_disk_wôh_CD
)!=
UNZ_OK
)

838 
îr
=
UNZ_ERRNO
;

841 i‡(
	`unz64loˇl_gëL⁄g64
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&us.
gi
.
numbî_íåy
)!=
UNZ_OK
)

842 
îr
=
UNZ_ERRNO
;

845 i‡(
	`unz64loˇl_gëL⁄g64
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
numbî_íåy_CD
)!=
UNZ_OK
)

846 
îr
=
UNZ_ERRNO
;

848 i‡((
numbî_íåy_CD
!=
us
.
gi
.
numbî_íåy
) ||

849 (
numbî_disk_wôh_CD
!=0) ||

850 (
numbî_disk
!=0))

851 
îr
=
UNZ_BADZIPFILE
;

854 i‡(
	`unz64loˇl_gëL⁄g64
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&us.
size_˚¡øl_dú
)!=
UNZ_OK
)

855 
îr
=
UNZ_ERRNO
;

859 i‡(
	`unz64loˇl_gëL⁄g64
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&us.
off£t_˚¡øl_dú
)!=
UNZ_OK
)

860 
îr
=
UNZ_ERRNO
;

862 
us
.
gi
.
size_commít
 = 0;

866 
˚¡øl_pos
 = 
	`unz64loˇl_SórchCíåÆDú
(&
us
.
z_fûefunc
,us.
fûe°ªam
);

867 i‡(
˚¡øl_pos
==0)

868 
îr
=
UNZ_ERRNO
;

870 
us
.
isZù64
 = 0;

872 i‡(
	`ZSEEK64
(
us
.
z_fûefunc
, us.
fûe°ªam
,

873 
˚¡øl_pos
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

874 
îr
=
UNZ_ERRNO
;

877 i‡(
	`unz64loˇl_gëL⁄g
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uL
)!=
UNZ_OK
)

878 
îr
=
UNZ_ERRNO
;

881 i‡(
	`unz64loˇl_gëSh‹t
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
numbî_disk
)!=
UNZ_OK
)

882 
îr
=
UNZ_ERRNO
;

885 i‡(
	`unz64loˇl_gëSh‹t
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
numbî_disk_wôh_CD
)!=
UNZ_OK
)

886 
îr
=
UNZ_ERRNO
;

889 i‡(
	`unz64loˇl_gëSh‹t
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uL
)!=
UNZ_OK
)

890 
îr
=
UNZ_ERRNO
;

891 
us
.
gi
.
numbî_íåy
 = 
uL
;

894 i‡(
	`unz64loˇl_gëSh‹t
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uL
)!=
UNZ_OK
)

895 
îr
=
UNZ_ERRNO
;

896 
numbî_íåy_CD
 = 
uL
;

898 i‡((
numbî_íåy_CD
!=
us
.
gi
.
numbî_íåy
) ||

899 (
numbî_disk_wôh_CD
!=0) ||

900 (
numbî_disk
!=0))

901 
îr
=
UNZ_BADZIPFILE
;

904 i‡(
	`unz64loˇl_gëL⁄g
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uL
)!=
UNZ_OK
)

905 
îr
=
UNZ_ERRNO
;

906 
us
.
size_˚¡øl_dú
 = 
uL
;

910 i‡(
	`unz64loˇl_gëL⁄g
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uL
)!=
UNZ_OK
)

911 
îr
=
UNZ_ERRNO
;

912 
us
.
off£t_˚¡øl_dú
 = 
uL
;

915 i‡(
	`unz64loˇl_gëSh‹t
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&us.
gi
.
size_commít
)!=
UNZ_OK
)

916 
îr
=
UNZ_ERRNO
;

919 i‡((
˚¡øl_pos
<
us
.
off£t_˚¡øl_dú
+us.
size_˚¡øl_dú
) &&

920 (
îr
==
UNZ_OK
))

921 
îr
=
UNZ_BADZIPFILE
;

923 i‡(
îr
!=
UNZ_OK
)

925 
	`ZCLOSE64
(
us
.
z_fûefunc
, us.
fûe°ªam
);

926  
NULL
;

929 
us
.
byã_bef‹e_the_zùfûe
 = 
˚¡øl_pos
 -

930 (
us
.
off£t_˚¡øl_dú
+us.
size_˚¡øl_dú
);

931 
us
.
˚¡øl_pos
 = central_pos;

932 
us
.
pfûe_ö_zù_ªad
 = 
NULL
;

933 
us
.
í¸y±ed
 = 0;

936 
s
=(
unz64_s
*)
	`ALLOC
((unz64_s));

937 if–
s
 !
NULL
)

939 *
s
=
us
;

940 
	`unzGoToFú°Fûe
((
unzFûe
)
s
);

942  (
unzFûe
)
s
;

943 
	}
}

945 
unzFûe
 
ZEXPORT
 
	$unzO≥n2
 (c⁄° *
∑th
,

946 
zlib_fûefunc_def
* 
pzlib_fûefunc32_def
)

948 i‡(
pzlib_fûefunc32_def
 !
NULL
)

950 
zlib_fûefunc64_32_def
 
zlib_fûefunc64_32_def_fûl
;

951 
	`fûl_zlib_fûefunc64_32_def_‰om_fûefunc32
(&
zlib_fûefunc64_32_def_fûl
,
pzlib_fûefunc32_def
);

952  
	`unzO≥nI¡î«l
(
∑th
, &
zlib_fûefunc64_32_def_fûl
, 0);

955  
	`unzO≥nI¡î«l
(
∑th
, 
NULL
, 0);

956 
	}
}

958 
unzFûe
 
ZEXPORT
 
	$unzO≥n2_64
 (c⁄° *
∑th
,

959 
zlib_fûefunc64_def
* 
pzlib_fûefunc_def
)

961 i‡(
pzlib_fûefunc_def
 !
NULL
)

963 
zlib_fûefunc64_32_def
 
zlib_fûefunc64_32_def_fûl
;

964 
zlib_fûefunc64_32_def_fûl
.
zfûe_func64
 = *
pzlib_fûefunc_def
;

965 
zlib_fûefunc64_32_def_fûl
.
zãŒ32_fûe
 = 
NULL
;

966 
zlib_fûefunc64_32_def_fûl
.
z£ek32_fûe
 = 
NULL
;

967  
	`unzO≥nI¡î«l
(
∑th
, &
zlib_fûefunc64_32_def_fûl
, 1);

970  
	`unzO≥nI¡î«l
(
∑th
, 
NULL
, 1);

971 
	}
}

973 
unzFûe
 
ZEXPORT
 
	$unzO≥n
 (c⁄° *
∑th
)

975  
	`unzO≥nI¡î«l
(
∑th
, 
NULL
, 0);

976 
	}
}

978 
unzFûe
 
ZEXPORT
 
	$unzO≥n64
 (c⁄° *
∑th
,c⁄° 
size_t
 
size
)

980  
	`unzO≥nI¡î«l_Œ
(
∑th
,
size
, 
NULL
, 1);

981 
	}
}

988 
ZEXPORT
 
	$unzClo£
 (
unzFûe
 
fûe
)

990 
unz64_s
* 
s
;

991 i‡(
fûe
==
NULL
)

992  
UNZ_PARAMERROR
;

993 
s
=(
unz64_s
*)
fûe
;

995 i‡(
s
->
pfûe_ö_zù_ªad
!=
NULL
)

996 
	`unzClo£CuºítFûe
(
fûe
);

998 
	`ZCLOSE64
(
s
->
z_fûefunc
, s->
fûe°ªam
);

999 
	`TRYFREE
(
s
);

1000  
UNZ_OK
;

1001 
	}
}

1008 
ZEXPORT
 
	$unzGëGlobÆInfo64
 (
unzFûe
 
fûe
, 
unz_globÆ_öfo64
* 
pglobÆ_öfo
)

1010 
unz64_s
* 
s
;

1011 i‡(
fûe
==
NULL
)

1012  
UNZ_PARAMERROR
;

1013 
s
=(
unz64_s
*)
fûe
;

1014 *
pglobÆ_öfo
=
s
->
gi
;

1015  
UNZ_OK
;

1016 
	}
}

1018 
ZEXPORT
 
	$unzGëGlobÆInfo
 (
unzFûe
 
fûe
, 
unz_globÆ_öfo
* 
pglobÆ_öfo32
)

1020 
unz64_s
* 
s
;

1021 i‡(
fûe
==
NULL
)

1022  
UNZ_PARAMERROR
;

1023 
s
=(
unz64_s
*)
fûe
;

1025 
pglobÆ_öfo32
->
numbî_íåy
 = (
uL⁄g
)
s
->
gi
.number_entry;

1026 
pglobÆ_öfo32
->
size_commít
 = 
s
->
gi
.size_comment;

1027  
UNZ_OK
;

1028 
	}
}

1032 
loˇl
 
	$unz64loˇl_DosD©eToTmuD©e
 (
ZPOS64_T
 
ulDosD©e
, 
tm_unz
* 
±m
)

1034 
ZPOS64_T
 
uD©e
;

1035 
uD©e
 = (
ZPOS64_T
)(
ulDosD©e
>>16);

1036 
±m
->
tm_mday
 = (
uI¡
)(
uD©e
&0x1f) ;

1037 
±m
->
tm_m⁄
 = (
uI¡
)((((
uD©e
)&0x1E0)/0x20)-1) ;

1038 
±m
->
tm_yór
 = (
uI¡
)(((
uD©e
&0x0FE00)/0x0200)+1980) ;

1040 
±m
->
tm_hour
 = (
uI¡
Ë((
ulDosD©e
 &0xF800)/0x800);

1041 
±m
->
tm_mö
 = (
uI¡
Ë((
ulDosD©e
&0x7E0)/0x20) ;

1042 
±m
->
tm_£c
 = (
uI¡
Ë(2*(
ulDosD©e
&0x1f)) ;

1043 
	}
}

1048 
loˇl
 
unz64loˇl_GëCuºítFûeInfoI¡î«l
 
OF
((
unzFûe
 
fûe
,

1049 
unz_fûe_öfo64
 *
pfûe_öfo
,

1050 
unz_fûe_öfo64_öã∫Æ


1051 *
pfûe_öfo_öã∫Æ
,

1052 *
szFûeName
,

1053 
uL⁄g
 
fûeNameBuf„rSize
,

1054 *
exåaFõld
,

1055 
uL⁄g
 
exåaFõldBuf„rSize
,

1056 *
szCommít
,

1057 
uL⁄g
 
commítBuf„rSize
));

1059 
loˇl
 
	$unz64loˇl_GëCuºítFûeInfoI¡î«l
 (
unzFûe
 
fûe
,

1060 
unz_fûe_öfo64
 *
pfûe_öfo
,

1061 
unz_fûe_öfo64_öã∫Æ


1062 *
pfûe_öfo_öã∫Æ
,

1063 *
szFûeName
,

1064 
uL⁄g
 
fûeNameBuf„rSize
,

1065 *
exåaFõld
,

1066 
uL⁄g
 
exåaFõldBuf„rSize
,

1067 *
szCommít
,

1068 
uL⁄g
 
commítBuf„rSize
)

1070 
unz64_s
* 
s
;

1071 
unz_fûe_öfo64
 
fûe_öfo
;

1072 
unz_fûe_öfo64_öã∫Æ
 
fûe_öfo_öã∫Æ
;

1073 
îr
=
UNZ_OK
;

1074 
uL⁄g
 
uMagic
;

1075 
lSìk
=0;

1076 
uL⁄g
 
uL
;

1078 i‡(
fûe
==
NULL
)

1079  
UNZ_PARAMERROR
;

1080 
s
=(
unz64_s
*)
fûe
;

1081 i‡(
	`ZSEEK64
(
s
->
z_fûefunc
, s->
fûe°ªam
,

1082 
s
->
pos_ö_˚¡øl_dú
+s->
byã_bef‹e_the_zùfûe
,

1083 
ZLIB_FILEFUNC_SEEK_SET
)!=0)

1084 
îr
=
UNZ_ERRNO
;

1088 i‡(
îr
==
UNZ_OK
)

1090 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uMagic
Ë!
UNZ_OK
)

1091 
îr
=
UNZ_ERRNO
;

1092 i‡(
uMagic
!=0x02014b50)

1093 
îr
=
UNZ_BADZIPFILE
;

1096 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
vîsi⁄
Ë!
UNZ_OK
)

1097 
îr
=
UNZ_ERRNO
;

1099 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
vîsi⁄_√eded
Ë!
UNZ_OK
)

1100 
îr
=
UNZ_ERRNO
;

1102 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
Êag
Ë!
UNZ_OK
)

1103 
îr
=
UNZ_ERRNO
;

1105 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
com¥essi⁄_mëhod
Ë!
UNZ_OK
)

1106 
îr
=
UNZ_ERRNO
;

1108 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
dosD©e
Ë!
UNZ_OK
)

1109 
îr
=
UNZ_ERRNO
;

1111 
	`unz64loˇl_DosD©eToTmuD©e
(
fûe_öfo
.
dosD©e
,&fûe_öfo.
tmu_d©e
);

1113 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
¸c
Ë!
UNZ_OK
)

1114 
îr
=
UNZ_ERRNO
;

1116 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uL
Ë!
UNZ_OK
)

1117 
îr
=
UNZ_ERRNO
;

1118 
fûe_öfo
.
com¥es£d_size
 = 
uL
;

1120 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uL
Ë!
UNZ_OK
)

1121 
îr
=
UNZ_ERRNO
;

1122 
fûe_öfo
.
uncom¥es£d_size
 = 
uL
;

1124 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
size_fûíame
Ë!
UNZ_OK
)

1125 
îr
=
UNZ_ERRNO
;

1127 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
size_fûe_exåa
Ë!
UNZ_OK
)

1128 
îr
=
UNZ_ERRNO
;

1130 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
size_fûe_commít
Ë!
UNZ_OK
)

1131 
îr
=
UNZ_ERRNO
;

1133 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
disk_num_°¨t
Ë!
UNZ_OK
)

1134 
îr
=
UNZ_ERRNO
;

1136 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
öã∫Æ_Á
Ë!
UNZ_OK
)

1137 
îr
=
UNZ_ERRNO
;

1139 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
exã∫Æ_Á
Ë!
UNZ_OK
)

1140 
îr
=
UNZ_ERRNO
;

1143 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uL
Ë!
UNZ_OK
)

1144 
îr
=
UNZ_ERRNO
;

1145 
fûe_öfo_öã∫Æ
.
off£t_curfûe
 = 
uL
;

1147 
lSìk
+=
fûe_öfo
.
size_fûíame
;

1148 i‡((
îr
==
UNZ_OK
Ë&& (
szFûeName
!=
NULL
))

1150 
uL⁄g
 
uSizeRód
 ;

1151 i‡(
fûe_öfo
.
size_fûíame
<
fûeNameBuf„rSize
)

1153 *(
szFûeName
+
fûe_öfo
.
size_fûíame
)='\0';

1154 
uSizeRód
 = 
fûe_öfo
.
size_fûíame
;

1157 
uSizeRód
 = 
fûeNameBuf„rSize
;

1159 i‡((
fûe_öfo
.
size_fûíame
>0Ë&& (
fûeNameBuf„rSize
>0))

1160 i‡(
	`ZREAD64
(
s
->
z_fûefunc
, s->
fûe°ªam
,
szFûeName
,
uSizeRód
)!=uSizeRead)

1161 
îr
=
UNZ_ERRNO
;

1162 
lSìk
 -
uSizeRód
;

1166 i‡((
îr
==
UNZ_OK
Ë&& (
exåaFõld
!=
NULL
))

1168 
ZPOS64_T
 
uSizeRód
 ;

1169 i‡(
fûe_öfo
.
size_fûe_exåa
<
exåaFõldBuf„rSize
)

1170 
uSizeRód
 = 
fûe_öfo
.
size_fûe_exåa
;

1172 
uSizeRód
 = 
exåaFõldBuf„rSize
;

1174 i‡(
lSìk
!=0)

1176 i‡(
	`ZSEEK64
(
s
->
z_fûefunc
, s->
fûe°ªam
,
lSìk
,
ZLIB_FILEFUNC_SEEK_CUR
)==0)

1177 
lSìk
=0;

1179 
îr
=
UNZ_ERRNO
;

1182 i‡((
fûe_öfo
.
size_fûe_exåa
>0Ë&& (
exåaFõldBuf„rSize
>0))

1183 i‡(
	`ZREAD64
(
s
->
z_fûefunc
, s->
fûe°ªam
,
exåaFõld
,(
uL⁄g
)
uSizeRód
)!=uSizeRead)

1184 
îr
=
UNZ_ERRNO
;

1186 
lSìk
 +
fûe_öfo
.
size_fûe_exåa
 - (
uL⁄g
)
uSizeRód
;

1189 
lSìk
 +
fûe_öfo
.
size_fûe_exåa
;

1192 i‡((
îr
==
UNZ_OK
Ë&& (
fûe_öfo
.
size_fûe_exåa
 != 0))

1194 
uL⁄g
 
acc
 = 0;

1197 
lSìk
 -
fûe_öfo
.
size_fûe_exåa
;

1199 i‡(
lSìk
!=0)

1201 i‡(
	`ZSEEK64
(
s
->
z_fûefunc
, s->
fûe°ªam
,
lSìk
,
ZLIB_FILEFUNC_SEEK_CUR
)==0)

1202 
lSìk
=0;

1204 
îr
=
UNZ_ERRNO
;

1207 
acc
 < 
fûe_öfo
.
size_fûe_exåa
)

1209 
uL⁄g
 
hódîId
;

1210 
uL⁄g
 
d©aSize
;

1212 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
hódîId
Ë!
UNZ_OK
)

1213 
îr
=
UNZ_ERRNO
;

1215 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
d©aSize
Ë!
UNZ_OK
)

1216 
îr
=
UNZ_ERRNO
;

1219 i‡(
hódîId
 == 0x0001)

1221 
uL⁄g
 
uL
;

1223 if(
fûe_öfo
.
uncom¥es£d_size
 =
MAXU32
)

1225 i‡(
	`unz64loˇl_gëL⁄g64
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
uncom¥es£d_size
Ë!
UNZ_OK
)

1226 
îr
=
UNZ_ERRNO
;

1229 if(
fûe_öfo
.
com¥es£d_size
 =
MAXU32
)

1231 i‡(
	`unz64loˇl_gëL⁄g64
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
com¥es£d_size
Ë!
UNZ_OK
)

1232 
îr
=
UNZ_ERRNO
;

1235 if(
fûe_öfo_öã∫Æ
.
off£t_curfûe
 =
MAXU32
)

1238 i‡(
	`unz64loˇl_gëL⁄g64
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo_öã∫Æ
.
off£t_curfûe
Ë!
UNZ_OK
)

1239 
îr
=
UNZ_ERRNO
;

1242 if(
fûe_öfo
.
disk_num_°¨t
 =
MAXU32
)

1245 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uL
Ë!
UNZ_OK
)

1246 
îr
=
UNZ_ERRNO
;

1252 i‡(
	`ZSEEK64
(
s
->
z_fûefunc
, s->
fûe°ªam
,
d©aSize
,
ZLIB_FILEFUNC_SEEK_CUR
)!=0)

1253 
îr
=
UNZ_ERRNO
;

1256 
acc
 +2 + 2 + 
d©aSize
;

1260 i‡((
îr
==
UNZ_OK
Ë&& (
szCommít
!=
NULL
))

1262 
uL⁄g
 
uSizeRód
 ;

1263 i‡(
fûe_öfo
.
size_fûe_commít
<
commítBuf„rSize
)

1265 *(
szCommít
+
fûe_öfo
.
size_fûe_commít
)='\0';

1266 
uSizeRód
 = 
fûe_öfo
.
size_fûe_commít
;

1269 
uSizeRód
 = 
commítBuf„rSize
;

1271 i‡(
lSìk
!=0)

1273 i‡(
	`ZSEEK64
(
s
->
z_fûefunc
, s->
fûe°ªam
,
lSìk
,
ZLIB_FILEFUNC_SEEK_CUR
)==0)

1274 
lSìk
=0;

1276 
îr
=
UNZ_ERRNO
;

1279 i‡((
fûe_öfo
.
size_fûe_commít
>0Ë&& (
commítBuf„rSize
>0))

1280 i‡(
	`ZREAD64
(
s
->
z_fûefunc
, s->
fûe°ªam
,
szCommít
,
uSizeRód
)!=uSizeRead)

1281 
îr
=
UNZ_ERRNO
;

1282 
lSìk
+=
fûe_öfo
.
size_fûe_commít
 - 
uSizeRód
;

1285 
lSìk
+=
fûe_öfo
.
size_fûe_commít
;

1288 i‡((
îr
==
UNZ_OK
Ë&& (
pfûe_öfo
!=
NULL
))

1289 *
pfûe_öfo
=
fûe_öfo
;

1291 i‡((
îr
==
UNZ_OK
Ë&& (
pfûe_öfo_öã∫Æ
!=
NULL
))

1292 *
pfûe_öfo_öã∫Æ
=
fûe_öfo_öã∫Æ
;

1294  
îr
;

1295 
	}
}

1304 
ZEXPORT
 
	$unzGëCuºítFûeInfo64
 (
unzFûe
 
fûe
,

1305 
unz_fûe_öfo64
 * 
pfûe_öfo
,

1306 * 
szFûeName
, 
uL⁄g
 
fûeNameBuf„rSize
,

1307 *
exåaFõld
, 
uL⁄g
 
exåaFõldBuf„rSize
,

1308 * 
szCommít
, 
uL⁄g
 
commítBuf„rSize
)

1310  
	`unz64loˇl_GëCuºítFûeInfoI¡î«l
(
fûe
,
pfûe_öfo
,
NULL
,

1311 
szFûeName
,
fûeNameBuf„rSize
,

1312 
exåaFõld
,
exåaFõldBuf„rSize
,

1313 
szCommít
,
commítBuf„rSize
);

1314 
	}
}

1316 
ZEXPORT
 
	$unzGëCuºítFûeInfo
 (
unzFûe
 
fûe
,

1317 
unz_fûe_öfo
 * 
pfûe_öfo
,

1318 * 
szFûeName
, 
uL⁄g
 
fûeNameBuf„rSize
,

1319 *
exåaFõld
, 
uL⁄g
 
exåaFõldBuf„rSize
,

1320 * 
szCommít
, 
uL⁄g
 
commítBuf„rSize
)

1322 
îr
;

1323 
unz_fûe_öfo64
 
fûe_öfo64
;

1324 
îr
 = 
	`unz64loˇl_GëCuºítFûeInfoI¡î«l
(
fûe
,&
fûe_öfo64
,
NULL
,

1325 
szFûeName
,
fûeNameBuf„rSize
,

1326 
exåaFõld
,
exåaFõldBuf„rSize
,

1327 
szCommít
,
commítBuf„rSize
);

1328 i‡((
îr
==
UNZ_OK
Ë&& (
pfûe_öfo
 !
NULL
))

1330 
pfûe_öfo
->
vîsi⁄
 = 
fûe_öfo64
.version;

1331 
pfûe_öfo
->
vîsi⁄_√eded
 = 
fûe_öfo64
.version_needed;

1332 
pfûe_öfo
->
Êag
 = 
fûe_öfo64
.flag;

1333 
pfûe_öfo
->
com¥essi⁄_mëhod
 = 
fûe_öfo64
.compression_method;

1334 
pfûe_öfo
->
dosD©e
 = 
fûe_öfo64
.dosDate;

1335 
pfûe_öfo
->
¸c
 = 
fûe_öfo64
.crc;

1337 
pfûe_öfo
->
size_fûíame
 = 
fûe_öfo64
.size_filename;

1338 
pfûe_öfo
->
size_fûe_exåa
 = 
fûe_öfo64
.size_file_extra;

1339 
pfûe_öfo
->
size_fûe_commít
 = 
fûe_öfo64
.size_file_comment;

1341 
pfûe_öfo
->
disk_num_°¨t
 = 
fûe_öfo64
.disk_num_start;

1342 
pfûe_öfo
->
öã∫Æ_Á
 = 
fûe_öfo64
.internal_fa;

1343 
pfûe_öfo
->
exã∫Æ_Á
 = 
fûe_öfo64
.external_fa;

1345 
pfûe_öfo
->
tmu_d©e
 = 
fûe_öfo64
.tmu_date,

1348 
pfûe_öfo
->
com¥es£d_size
 = (
uL⁄g
)
fûe_öfo64
.compressed_size;

1349 
pfûe_öfo
->
uncom¥es£d_size
 = (
uL⁄g
)
fûe_öfo64
.uncompressed_size;

1352  
îr
;

1353 
	}
}

1358 
ZEXPORT
 
	$unzGoToFú°Fûe
 (
unzFûe
 
fûe
)

1360 
îr
=
UNZ_OK
;

1361 
unz64_s
* 
s
;

1362 i‡(
fûe
==
NULL
)

1363  
UNZ_PARAMERROR
;

1364 
s
=(
unz64_s
*)
fûe
;

1365 
s
->
pos_ö_˚¡øl_dú
=s->
off£t_˚¡øl_dú
;

1366 
s
->
num_fûe
=0;

1367 
îr
=
	`unz64loˇl_GëCuºítFûeInfoI¡î«l
(
fûe
,&
s
->
cur_fûe_öfo
,

1368 &
s
->
cur_fûe_öfo_öã∫Æ
,

1369 
NULL
,0,NULL,0,NULL,0);

1370 
s
->
cuºít_fûe_ok
 = (
îr
 =
UNZ_OK
);

1371  
îr
;

1372 
	}
}

1379 
ZEXPORT
 
	$unzGoToNextFûe
 (
unzFûe
 
fûe
)

1381 
unz64_s
* 
s
;

1382 
îr
;

1384 i‡(
fûe
==
NULL
)

1385  
UNZ_PARAMERROR
;

1386 
s
=(
unz64_s
*)
fûe
;

1387 i‡(!
s
->
cuºít_fûe_ok
)

1388  
UNZ_END_OF_LIST_OF_FILE
;

1389 i‡(
s
->
gi
.
numbî_íåy
 != 0xffff)

1390 i‡(
s
->
num_fûe
+1==s->
gi
.
numbî_íåy
)

1391  
UNZ_END_OF_LIST_OF_FILE
;

1393 
s
->
pos_ö_˚¡øl_dú
 +
SIZECENTRALDIRITEM
 + s->
cur_fûe_öfo
.
size_fûíame
 +

1394 
s
->
cur_fûe_öfo
.
size_fûe_exåa
 + s->cur_fûe_öfo.
size_fûe_commít
 ;

1395 
s
->
num_fûe
++;

1396 
îr
 = 
	`unz64loˇl_GëCuºítFûeInfoI¡î«l
(
fûe
,&
s
->
cur_fûe_öfo
,

1397 &
s
->
cur_fûe_öfo_öã∫Æ
,

1398 
NULL
,0,NULL,0,NULL,0);

1399 
s
->
cuºít_fûe_ok
 = (
îr
 =
UNZ_OK
);

1400  
îr
;

1401 
	}
}

1412 
ZEXPORT
 
	$unzLoˇãFûe
 (
unzFûe
 
fûe
, c⁄° *
szFûeName
, 
iCa£Sísôivôy
)

1414 
unz64_s
* 
s
;

1415 
îr
;

1420 
unz_fûe_öfo64
 
cur_fûe_öfoSaved
;

1421 
unz_fûe_öfo64_öã∫Æ
 
cur_fûe_öfo_öã∫ÆSaved
;

1422 
ZPOS64_T
 
num_fûeSaved
;

1423 
ZPOS64_T
 
pos_ö_˚¡øl_dúSaved
;

1426 i‡(
fûe
==
NULL
)

1427  
UNZ_PARAMERROR
;

1429 i‡(
	`°æí
(
szFûeName
)>=
UNZ_MAXFILENAMEINZIP
)

1430  
UNZ_PARAMERROR
;

1432 
s
=(
unz64_s
*)
fûe
;

1433 i‡(!
s
->
cuºít_fûe_ok
)

1434  
UNZ_END_OF_LIST_OF_FILE
;

1437 
num_fûeSaved
 = 
s
->
num_fûe
;

1438 
pos_ö_˚¡øl_dúSaved
 = 
s
->
pos_ö_˚¡øl_dú
;

1439 
cur_fûe_öfoSaved
 = 
s
->
cur_fûe_öfo
;

1440 
cur_fûe_öfo_öã∫ÆSaved
 = 
s
->
cur_fûe_öfo_öã∫Æ
;

1442 
îr
 = 
	`unzGoToFú°Fûe
(
fûe
);

1444 
îr
 =
UNZ_OK
)

1446 
szCuºítFûeName
[
UNZ_MAXFILENAMEINZIP
+1];

1447 
îr
 = 
	`unzGëCuºítFûeInfo64
(
fûe
,
NULL
,

1448 
szCuºítFûeName
,(szCurrentFileName)-1,

1449 
NULL
,0,NULL,0);

1450 i‡(
îr
 =
UNZ_OK
)

1452 i‡(
	`unzSåögFûeNameCom∑ª
(
szCuºítFûeName
,

1453 
szFûeName
,
iCa£Sísôivôy
)==0)

1454  
UNZ_OK
;

1455 
îr
 = 
	`unzGoToNextFûe
(
fûe
);

1462 
s
->
num_fûe
 = 
num_fûeSaved
 ;

1463 
s
->
pos_ö_˚¡øl_dú
 = 
pos_ö_˚¡øl_dúSaved
 ;

1464 
s
->
cur_fûe_öfo
 = 
cur_fûe_öfoSaved
;

1465 
s
->
cur_fûe_öfo_öã∫Æ
 = 
cur_fûe_öfo_öã∫ÆSaved
;

1466  
îr
;

1467 
	}
}

1488 
ZEXPORT
 
	$unzGëFûePos64
(
unzFûe
 
fûe
, 
unz64_fûe_pos
* 
fûe_pos
)

1490 
unz64_s
* 
s
;

1492 i‡(
fûe
==
NULL
 || 
fûe_pos
==NULL)

1493  
UNZ_PARAMERROR
;

1494 
s
=(
unz64_s
*)
fûe
;

1495 i‡(!
s
->
cuºít_fûe_ok
)

1496  
UNZ_END_OF_LIST_OF_FILE
;

1498 
fûe_pos
->
pos_ö_zù_dúe˘‹y
 = 
s
->
pos_ö_˚¡øl_dú
;

1499 
fûe_pos
->
num_of_fûe
 = 
s
->
num_fûe
;

1501  
UNZ_OK
;

1502 
	}
}

1504 
ZEXPORT
 
	$unzGëFûePos
(

1505 
unzFûe
 
fûe
,

1506 
unz_fûe_pos
* 
fûe_pos
)

1508 
unz64_fûe_pos
 
fûe_pos64
;

1509 
îr
 = 
	`unzGëFûePos64
(
fûe
,&
fûe_pos64
);

1510 i‡(
îr
==
UNZ_OK
)

1512 
fûe_pos
->
pos_ö_zù_dúe˘‹y
 = (
uL⁄g
)
fûe_pos64
.pos_in_zip_directory;

1513 
fûe_pos
->
num_of_fûe
 = (
uL⁄g
)
fûe_pos64
.num_of_file;

1515  
îr
;

1516 
	}
}

1518 
ZEXPORT
 
	$unzGoToFûePos64
(
unzFûe
 
fûe
, c⁄° 
unz64_fûe_pos
* 
fûe_pos
)

1520 
unz64_s
* 
s
;

1521 
îr
;

1523 i‡(
fûe
==
NULL
 || 
fûe_pos
==NULL)

1524  
UNZ_PARAMERROR
;

1525 
s
=(
unz64_s
*)
fûe
;

1528 
s
->
pos_ö_˚¡øl_dú
 = 
fûe_pos
->
pos_ö_zù_dúe˘‹y
;

1529 
s
->
num_fûe
 = 
fûe_pos
->
num_of_fûe
;

1532 
îr
 = 
	`unz64loˇl_GëCuºítFûeInfoI¡î«l
(
fûe
,&
s
->
cur_fûe_öfo
,

1533 &
s
->
cur_fûe_öfo_öã∫Æ
,

1534 
NULL
,0,NULL,0,NULL,0);

1536 
s
->
cuºít_fûe_ok
 = (
îr
 =
UNZ_OK
);

1537  
îr
;

1538 
	}
}

1540 
ZEXPORT
 
	$unzGoToFûePos
(

1541 
unzFûe
 
fûe
,

1542 
unz_fûe_pos
* 
fûe_pos
)

1544 
unz64_fûe_pos
 
fûe_pos64
;

1545 i‡(
fûe_pos
 =
NULL
)

1546  
UNZ_PARAMERROR
;

1548 
fûe_pos64
.
pos_ö_zù_dúe˘‹y
 = 
fûe_pos
->pos_in_zip_directory;

1549 
fûe_pos64
.
num_of_fûe
 = 
fûe_pos
->num_of_file;

1550  
	`unzGoToFûePos64
(
fûe
,&
fûe_pos64
);

1551 
	}
}

1565 
loˇl
 
	$unz64loˇl_CheckCuºítFûeCohîícyHódî
 (
unz64_s
* 
s
, 
uI¡
* 
piSizeV¨
,

1566 
ZPOS64_T
 * 
poff£t_loˇl_exåafõld
,

1567 
uI¡
 * 
psize_loˇl_exåafõld
)

1569 
uL⁄g
 
uMagic
,
uD©a
,
uFœgs
;

1570 
uL⁄g
 
size_fûíame
;

1571 
uL⁄g
 
size_exåa_fõld
;

1572 
îr
=
UNZ_OK
;

1574 *
piSizeV¨
 = 0;

1575 *
poff£t_loˇl_exåafõld
 = 0;

1576 *
psize_loˇl_exåafõld
 = 0;

1578 i‡(
	`ZSEEK64
(
s
->
z_fûefunc
, s->
fûe°ªam
,s->
cur_fûe_öfo_öã∫Æ
.
off£t_curfûe
 +

1579 
s
->
byã_bef‹e_the_zùfûe
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

1580  
UNZ_ERRNO
;

1583 i‡(
îr
==
UNZ_OK
)

1585 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uMagic
Ë!
UNZ_OK
)

1586 
îr
=
UNZ_ERRNO
;

1587 i‡(
uMagic
!=0x04034b50)

1588 
îr
=
UNZ_BADZIPFILE
;

1591 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uD©a
Ë!
UNZ_OK
)

1592 
îr
=
UNZ_ERRNO
;

1597 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uFœgs
Ë!
UNZ_OK
)

1598 
îr
=
UNZ_ERRNO
;

1600 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uD©a
Ë!
UNZ_OK
)

1601 
îr
=
UNZ_ERRNO
;

1602 i‡((
îr
==
UNZ_OK
Ë&& (
uD©a
!=
s
->
cur_fûe_öfo
.
com¥essi⁄_mëhod
))

1603 
îr
=
UNZ_BADZIPFILE
;

1605 i‡((
îr
==
UNZ_OK
Ë&& (
s
->
cur_fûe_öfo
.
com¥essi⁄_mëhod
!=0) &&

1607 (
s
->
cur_fûe_öfo
.
com¥essi⁄_mëhod
!=
Z_BZIP2ED
) &&

1609 (
s
->
cur_fûe_öfo
.
com¥essi⁄_mëhod
!=
Z_DEFLATED
))

1610 
îr
=
UNZ_BADZIPFILE
;

1612 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uD©a
Ë!
UNZ_OK
)

1613 
îr
=
UNZ_ERRNO
;

1615 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uD©a
Ë!
UNZ_OK
)

1616 
îr
=
UNZ_ERRNO
;

1617 i‡((
îr
==
UNZ_OK
Ë&& (
uD©a
!=
s
->
cur_fûe_öfo
.
¸c
Ë&& ((
uFœgs
 & 8)==0))

1618 
îr
=
UNZ_BADZIPFILE
;

1620 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uD©a
Ë!
UNZ_OK
)

1621 
îr
=
UNZ_ERRNO
;

1622 i‡(
uD©a
 !0xFFFFFFFF && (
îr
==
UNZ_OK
Ë&& (uD©a!=
s
->
cur_fûe_öfo
.
com¥es£d_size
Ë&& ((
uFœgs
 & 8)==0))

1623 
îr
=
UNZ_BADZIPFILE
;

1625 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uD©a
Ë!
UNZ_OK
)

1626 
îr
=
UNZ_ERRNO
;

1627 i‡(
uD©a
 !0xFFFFFFFF && (
îr
==
UNZ_OK
Ë&& (uD©a!=
s
->
cur_fûe_öfo
.
uncom¥es£d_size
Ë&& ((
uFœgs
 & 8)==0))

1628 
îr
=
UNZ_BADZIPFILE
;

1630 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
size_fûíame
Ë!
UNZ_OK
)

1631 
îr
=
UNZ_ERRNO
;

1632 i‡((
îr
==
UNZ_OK
Ë&& (
size_fûíame
!=
s
->
cur_fûe_öfo
.size_filename))

1633 
îr
=
UNZ_BADZIPFILE
;

1635 *
piSizeV¨
 +(
uI¡
)
size_fûíame
;

1637 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
size_exåa_fõld
Ë!
UNZ_OK
)

1638 
îr
=
UNZ_ERRNO
;

1639 *
poff£t_loˇl_exåafõld

s
->
cur_fûe_öfo_öã∫Æ
.
off£t_curfûe
 +

1640 
SIZEZIPLOCALHEADER
 + 
size_fûíame
;

1641 *
psize_loˇl_exåafõld
 = (
uI¡
)
size_exåa_fõld
;

1643 *
piSizeV¨
 +(
uI¡
)
size_exåa_fõld
;

1645  
îr
;

1646 
	}
}

1652 
ZEXPORT
 
	$unzO≥nCuºítFûe3
 (
unzFûe
 
fûe
, * 
mëhod
,

1653 * 
Àvñ
, 
øw
, c⁄° * 
∑ssw‹d
)

1655 
îr
=
UNZ_OK
;

1656 
uI¡
 
iSizeV¨
;

1657 
unz64_s
* 
s
;

1658 
fûe_ö_zù64_ªad_öfo_s
* 
pfûe_ö_zù_ªad_öfo
;

1659 
ZPOS64_T
 
off£t_loˇl_exåafõld
;

1660 
uI¡
 
size_loˇl_exåafõld
;

1661 #i‚de‡
NOUNCRYPT


1662 
sour˚
[12];

1664 i‡(
∑ssw‹d
 !
NULL
)

1665  
UNZ_PARAMERROR
;

1668 i‡(
fûe
==
NULL
)

1669  
UNZ_PARAMERROR
;

1670 
s
=(
unz64_s
*)
fûe
;

1671 i‡(!
s
->
cuºít_fûe_ok
)

1672  
UNZ_PARAMERROR
;

1674 i‡(
s
->
pfûe_ö_zù_ªad
 !
NULL
)

1675 
	`unzClo£CuºítFûe
(
fûe
);

1677 i‡(
	`unz64loˇl_CheckCuºítFûeCohîícyHódî
(
s
,&
iSizeV¨
, &
off£t_loˇl_exåafõld
,&
size_loˇl_exåafõld
)!=
UNZ_OK
)

1678  
UNZ_BADZIPFILE
;

1680 
pfûe_ö_zù_ªad_öfo
 = (
fûe_ö_zù64_ªad_öfo_s
*)
	`ALLOC
((file_in_zip64_read_info_s));

1681 i‡(
pfûe_ö_zù_ªad_öfo
==
NULL
)

1682  
UNZ_INTERNALERROR
;

1684 
pfûe_ö_zù_ªad_öfo
->
ªad_buf„r
=(*)
	`ALLOC
(
UNZ_BUFSIZE
);

1685 
pfûe_ö_zù_ªad_öfo
->
off£t_loˇl_exåafõld
 = offset_local_extrafield;

1686 
pfûe_ö_zù_ªad_öfo
->
size_loˇl_exåafõld
 = size_local_extrafield;

1687 
pfûe_ö_zù_ªad_öfo
->
pos_loˇl_exåafõld
=0;

1688 
pfûe_ö_zù_ªad_öfo
->
øw
=raw;

1690 i‡(
pfûe_ö_zù_ªad_öfo
->
ªad_buf„r
==
NULL
)

1692 
	`TRYFREE
(
pfûe_ö_zù_ªad_öfo
);

1693  
UNZ_INTERNALERROR
;

1696 
pfûe_ö_zù_ªad_öfo
->
°ªam_öôüli£d
=0;

1698 i‡(
mëhod
!=
NULL
)

1699 *
mëhod
 = ()
s
->
cur_fûe_öfo
.
com¥essi⁄_mëhod
;

1701 i‡(
Àvñ
!=
NULL
)

1703 *
Àvñ
 = 6;

1704 
s
->
cur_fûe_öfo
.
Êag
 & 0x06)

1706 6 : *
Àvñ
 = 1; ;

1707 4 : *
Àvñ
 = 2; ;

1708 2 : *
Àvñ
 = 9; ;

1712 i‡((
s
->
cur_fûe_öfo
.
com¥essi⁄_mëhod
!=0) &&

1714 (
s
->
cur_fûe_öfo
.
com¥essi⁄_mëhod
!=
Z_BZIP2ED
) &&

1716 (
s
->
cur_fûe_öfo
.
com¥essi⁄_mëhod
!=
Z_DEFLATED
))

1718 
îr
=
UNZ_BADZIPFILE
;

1720 
pfûe_ö_zù_ªad_öfo
->
¸c32_waô
=
s
->
cur_fûe_öfo
.
¸c
;

1721 
pfûe_ö_zù_ªad_öfo
->
¸c32
=0;

1722 
pfûe_ö_zù_ªad_öfo
->
tŸÆ_out_64
=0;

1723 
pfûe_ö_zù_ªad_öfo
->
com¥essi⁄_mëhod
 = 
s
->
cur_fûe_öfo
.compression_method;

1724 
pfûe_ö_zù_ªad_öfo
->
fûe°ªam
=
s
->filestream;

1725 
pfûe_ö_zù_ªad_öfo
->
z_fûefunc
=
s
->z_filefunc;

1726 
pfûe_ö_zù_ªad_öfo
->
byã_bef‹e_the_zùfûe
=
s
->byte_before_the_zipfile;

1728 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
tŸÆ_out
 = 0;

1730 i‡((
s
->
cur_fûe_öfo
.
com¥essi⁄_mëhod
==
Z_BZIP2ED
Ë&& (!
øw
))

1732 #ifde‡
HAVE_BZIP2


1733 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
bzÆloc
 = (*(*) (*, , ))0;

1734 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
bz‰ì
 = (
‰ì_func
)0;

1735 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
›aque
 = (
voidpf
)0;

1736 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
°©e
 = (
voidpf
)0;

1738 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
zÆloc
 = (
Æloc_func
)0;

1739 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
z‰ì
 = (
‰ì_func
)0;

1740 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
›aque
 = (
voidpf
)0;

1741 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_ö
 = (
voidpf
)0;

1742 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
 = 0;

1744 
îr
=
	`BZ2_bzDecom¥essInô
(&
pfûe_ö_zù_ªad_öfo
->
b°ªam
, 0, 0);

1745 i‡(
îr
 =
Z_OK
)

1746 
pfûe_ö_zù_ªad_öfo
->
°ªam_öôüli£d
=
Z_BZIP2ED
;

1749 
	`TRYFREE
(
pfûe_ö_zù_ªad_öfo
);

1750  
îr
;

1753 
pfûe_ö_zù_ªad_öfo
->
øw
=1;

1756 i‡((
s
->
cur_fûe_öfo
.
com¥essi⁄_mëhod
==
Z_DEFLATED
Ë&& (!
øw
))

1758 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
zÆloc
 = (
Æloc_func
)0;

1759 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
z‰ì
 = (
‰ì_func
)0;

1760 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
›aque
 = (
voidpf
)0;

1761 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_ö
 = 0;

1762 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
 = 0;

1764 
îr
=
	`öÊ©eInô2
(&
pfûe_ö_zù_ªad_öfo
->
°ªam
, -
MAX_WBITS
);

1765 i‡(
îr
 =
Z_OK
)

1766 
pfûe_ö_zù_ªad_öfo
->
°ªam_öôüli£d
=
Z_DEFLATED
;

1769 
	`TRYFREE
(
pfûe_ö_zù_ªad_öfo
);

1770  
îr
;

1780 
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_com¥es£d
 =

1781 
s
->
cur_fûe_öfo
.
com¥es£d_size
 ;

1782 
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_uncom¥es£d
 =

1783 
s
->
cur_fûe_öfo
.
uncom¥es£d_size
 ;

1786 
pfûe_ö_zù_ªad_öfo
->
pos_ö_zùfûe
 =

1787 
s
->
cur_fûe_öfo_öã∫Æ
.
off£t_curfûe
 + 
SIZEZIPLOCALHEADER
 +

1788 
iSizeV¨
;

1790 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
 = (
uI¡
)0;

1792 
s
->
pfûe_ö_zù_ªad
 = 
pfûe_ö_zù_ªad_öfo
;

1793 
s
->
í¸y±ed
 = 0;

1795 #i‚de‡
NOUNCRYPT


1796 i‡(
∑ssw‹d
 !
NULL
)

1798 
i
;

1799 
s
->
p¸c_32_èb
 = 
	`gë_¸c_èbÀ
();

1800 
	`öô_keys
(
∑ssw‹d
,
s
->
keys
,s->
p¸c_32_èb
);

1801 i‡(
	`ZSEEK64
(
s
->
z_fûefunc
, s->
fûe°ªam
,

1802 
s
->
pfûe_ö_zù_ªad
->
pos_ö_zùfûe
 +

1803 
s
->
pfûe_ö_zù_ªad
->
byã_bef‹e_the_zùfûe
,

1804 
SEEK_SET
)!=0)

1805  
UNZ_INTERNALERROR
;

1806 if(
	`ZREAD64
(
s
->
z_fûefunc
, s->
fûe°ªam
,
sour˚
, 12)<12)

1807  
UNZ_INTERNALERROR
;

1809 
i
 = 0; i<12; i++)

1810 
	`zdecode
(
s
->
keys
,s->
p¸c_32_èb
,
sour˚
[
i
]);

1812 
s
->
pfûe_ö_zù_ªad
->
pos_ö_zùfûe
+=12;

1813 
s
->
í¸y±ed
=1;

1818  
UNZ_OK
;

1819 
	}
}

1821 
ZEXPORT
 
	$unzO≥nCuºítFûe
 (
unzFûe
 
fûe
)

1823  
	`unzO≥nCuºítFûe3
(
fûe
, 
NULL
, NULL, 0, NULL);

1824 
	}
}

1826 
ZEXPORT
 
	$unzO≥nCuºítFûePassw‹d
 (
unzFûe
 
fûe
, c⁄° * 
∑ssw‹d
)

1828  
	`unzO≥nCuºítFûe3
(
fûe
, 
NULL
, NULL, 0, 
∑ssw‹d
);

1829 
	}
}

1831 
ZEXPORT
 
	$unzO≥nCuºítFûe2
 (
unzFûe
 
fûe
, * 
mëhod
, * 
Àvñ
, 
øw
)

1833  
	`unzO≥nCuºítFûe3
(
fûe
, 
mëhod
, 
Àvñ
, 
øw
, 
NULL
);

1834 
	}
}

1838 
ZPOS64_T
 
ZEXPORT
 
	$unzGëCuºítFûeZSåómPos64
–
unzFûe
 
fûe
)

1840 
unz64_s
* 
s
;

1841 
fûe_ö_zù64_ªad_öfo_s
* 
pfûe_ö_zù_ªad_öfo
;

1842 
s
=(
unz64_s
*)
fûe
;

1843 i‡(
fûe
==
NULL
)

1845 
pfûe_ö_zù_ªad_öfo
=
s
->
pfûe_ö_zù_ªad
;

1846 i‡(
pfûe_ö_zù_ªad_öfo
==
NULL
)

1848  
pfûe_ö_zù_ªad_öfo
->
pos_ö_zùfûe
 +

1849 
pfûe_ö_zù_ªad_öfo
->
byã_bef‹e_the_zùfûe
;

1850 
	}
}

1864 
ZEXPORT
 
	$unzRódCuºítFûe
 (
unzFûe
 
fûe
, 
voidp
 
buf
, 
Àn
)

1866 
îr
=
UNZ_OK
;

1867 
uI¡
 
iRód
 = 0;

1868 
unz64_s
* 
s
;

1869 
fûe_ö_zù64_ªad_öfo_s
* 
pfûe_ö_zù_ªad_öfo
;

1870 i‡(
fûe
==
NULL
)

1871  
UNZ_PARAMERROR
;

1872 
s
=(
unz64_s
*)
fûe
;

1873 
pfûe_ö_zù_ªad_öfo
=
s
->
pfûe_ö_zù_ªad
;

1875 i‡(
pfûe_ö_zù_ªad_öfo
==
NULL
)

1876  
UNZ_PARAMERROR
;

1879 i‡(
pfûe_ö_zù_ªad_öfo
->
ªad_buf„r
 =
NULL
)

1880  
UNZ_END_OF_LIST_OF_FILE
;

1881 i‡(
Àn
==0)

1884 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_out
 = (
Byãf
*)
buf
;

1886 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_out
 = (
uI¡
)
Àn
;

1888 i‡((
Àn
>
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_uncom¥es£d
) &&

1889 (!(
pfûe_ö_zù_ªad_öfo
->
øw
)))

1890 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_out
 =

1891 (
uI¡
)
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_uncom¥es£d
;

1893 i‡((
Àn
>
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_com¥es£d
+

1894 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
) &&

1895 (
pfûe_ö_zù_ªad_öfo
->
øw
))

1896 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_out
 =

1897 (
uI¡
)
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_com¥es£d
+

1898 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
;

1900 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_out
>0)

1902 i‡((
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
==0) &&

1903 (
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_com¥es£d
>0))

1905 
uI¡
 
uRódThis
 = 
UNZ_BUFSIZE
;

1906 i‡(
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_com¥es£d
<
uRódThis
)

1907 
uRódThis
 = (
uI¡
)
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_com¥es£d
;

1908 i‡(
uRódThis
 == 0)

1909  
UNZ_EOF
;

1910 i‡(
	`ZSEEK64
(
pfûe_ö_zù_ªad_öfo
->
z_fûefunc
,

1911 
pfûe_ö_zù_ªad_öfo
->
fûe°ªam
,

1912 
pfûe_ö_zù_ªad_öfo
->
pos_ö_zùfûe
 +

1913 
pfûe_ö_zù_ªad_öfo
->
byã_bef‹e_the_zùfûe
,

1914 
ZLIB_FILEFUNC_SEEK_SET
)!=0)

1915  
UNZ_ERRNO
;

1916 i‡(
	`ZREAD64
(
pfûe_ö_zù_ªad_öfo
->
z_fûefunc
,

1917 
pfûe_ö_zù_ªad_öfo
->
fûe°ªam
,

1918 
pfûe_ö_zù_ªad_öfo
->
ªad_buf„r
,

1919 
uRódThis
)!=uReadThis)

1920  
UNZ_ERRNO
;

1923 #i‚de‡
NOUNCRYPT


1924 if(
s
->
í¸y±ed
)

1926 
uI¡
 
i
;

1927 
i
=0;i<
uRódThis
;i++)

1928 
pfûe_ö_zù_ªad_öfo
->
ªad_buf„r
[
i
] =

1929 
	`zdecode
(
s
->
keys
,s->
p¸c_32_èb
,

1930 
pfûe_ö_zù_ªad_öfo
->
ªad_buf„r
[
i
]);

1935 
pfûe_ö_zù_ªad_öfo
->
pos_ö_zùfûe
 +
uRódThis
;

1937 
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_com¥es£d
-=
uRódThis
;

1939 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_ö
 =

1940 (
Byãf
*)
pfûe_ö_zù_ªad_öfo
->
ªad_buf„r
;

1941 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
 = (
uI¡
)
uRódThis
;

1944 i‡((
pfûe_ö_zù_ªad_öfo
->
com¥essi⁄_mëhod
==0Ë|| (pfûe_ö_zù_ªad_öfo->
øw
))

1946 
uI¡
 
uDoC›y
,
i
 ;

1948 i‡((
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
 == 0) &&

1949 (
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_com¥es£d
 == 0))

1950  (
iRód
==0Ë? 
UNZ_EOF
 : iRead;

1952 i‡(
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_out
 <

1953 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
)

1954 
uDoC›y
 = 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_out
 ;

1956 
uDoC›y
 = 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
 ;

1958 
i
=0;i<
uDoC›y
;i++)

1959 *(
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_out
+
i
) =

1960 *(
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_ö
+
i
);

1962 
pfûe_ö_zù_ªad_öfo
->
tŸÆ_out_64
 =Öfûe_ö_zù_ªad_öfo->tŸÆ_out_64 + 
uDoC›y
;

1964 
pfûe_ö_zù_ªad_öfo
->
¸c32
 = 
	`¸c32
(pfile_in_zip_read_info->crc32,

1965 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_out
,

1966 
uDoC›y
);

1967 
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_uncom¥es£d
-=
uDoC›y
;

1968 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
 -
uDoC›y
;

1969 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_out
 -
uDoC›y
;

1970 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_out
 +
uDoC›y
;

1971 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_ö
 +
uDoC›y
;

1972 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
tŸÆ_out
 +
uDoC›y
;

1973 
iRód
 +
uDoC›y
;

1975 i‡(
pfûe_ö_zù_ªad_öfo
->
com¥essi⁄_mëhod
==
Z_BZIP2ED
)

1977 #ifde‡
HAVE_BZIP2


1978 
uL⁄g
 
uTŸÆOutBef‹e
,
uTŸÆOutA·î
;

1979 c⁄° 
Byãf
 *
bufBef‹e
;

1980 
uL⁄g
 
uOutThis
;

1982 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
√xt_ö
 = (*Ìfûe_ö_zù_ªad_öfo->
°ªam
.next_in;

1983 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
avaû_ö
 =Öfûe_ö_zù_ªad_öfo->
°ªam
.avail_in;

1984 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
tŸÆ_ö_lo32
 =Öfûe_ö_zù_ªad_öfo->
°ªam
.
tŸÆ_ö
;

1985 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
tŸÆ_ö_hi32
 = 0;

1986 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
√xt_out
 = (*Ìfûe_ö_zù_ªad_öfo->
°ªam
.next_out;

1987 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
avaû_out
 =Öfûe_ö_zù_ªad_öfo->
°ªam
.avail_out;

1988 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
tŸÆ_out_lo32
 =Öfûe_ö_zù_ªad_öfo->
°ªam
.
tŸÆ_out
;

1989 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
tŸÆ_out_hi32
 = 0;

1991 
uTŸÆOutBef‹e
 = 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
tŸÆ_out_lo32
;

1992 
bufBef‹e
 = (c⁄° 
Byãf
 *)
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
√xt_out
;

1994 
îr
=
	`BZ2_bzDecom¥ess
(&
pfûe_ö_zù_ªad_öfo
->
b°ªam
);

1996 
uTŸÆOutA·î
 = 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
tŸÆ_out_lo32
;

1997 
uOutThis
 = 
uTŸÆOutA·î
-
uTŸÆOutBef‹e
;

1999 
pfûe_ö_zù_ªad_öfo
->
tŸÆ_out_64
 =Öfûe_ö_zù_ªad_öfo->tŸÆ_out_64 + 
uOutThis
;

2001 
pfûe_ö_zù_ªad_öfo
->
¸c32
 = 
	`¸c32
’fûe_ö_zù_ªad_öfo->¸c32,
bufBef‹e
, (
uI¡
)(
uOutThis
));

2002 
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_uncom¥es£d
 -
uOutThis
;

2003 
iRód
 +(
uI¡
)(
uTŸÆOutA·î
 - 
uTŸÆOutBef‹e
);

2005 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_ö
 = (
Byãf
*Ìfûe_ö_zù_ªad_öfo->
b°ªam
.next_in;

2006 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
 =Öfûe_ö_zù_ªad_öfo->
b°ªam
.avail_in;

2007 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
tŸÆ_ö
 =Öfûe_ö_zù_ªad_öfo->
b°ªam
.
tŸÆ_ö_lo32
;

2008 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_out
 = (
Byãf
*Ìfûe_ö_zù_ªad_öfo->
b°ªam
.next_out;

2009 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_out
 =Öfûe_ö_zù_ªad_öfo->
b°ªam
.avail_out;

2010 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
tŸÆ_out
 =Öfûe_ö_zù_ªad_öfo->
b°ªam
.
tŸÆ_out_lo32
;

2012 i‡(
îr
==
BZ_STREAM_END
)

2013  (
iRód
==0Ë? 
UNZ_EOF
 : iRead;

2014 i‡(
îr
!=
BZ_OK
)

2020 
ZPOS64_T
 
uTŸÆOutBef‹e
,
uTŸÆOutA·î
;

2021 c⁄° 
Byãf
 *
bufBef‹e
;

2022 
ZPOS64_T
 
uOutThis
;

2023 
Êush
=
Z_SYNC_FLUSH
;

2025 
uTŸÆOutBef‹e
 = 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
tŸÆ_out
;

2026 
bufBef‹e
 = 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_out
;

2034 
îr
=
	`öÊ©e
(&
pfûe_ö_zù_ªad_öfo
->
°ªam
,
Êush
);

2036 i‡((
îr
>=0Ë&& (
pfûe_ö_zù_ªad_öfo
->
°ªam
.
msg
!=
NULL
))

2037 
îr
 = 
Z_DATA_ERROR
;

2039 
uTŸÆOutA·î
 = 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
tŸÆ_out
;

2040 
uOutThis
 = 
uTŸÆOutA·î
-
uTŸÆOutBef‹e
;

2042 
pfûe_ö_zù_ªad_öfo
->
tŸÆ_out_64
 =Öfûe_ö_zù_ªad_öfo->tŸÆ_out_64 + 
uOutThis
;

2044 
pfûe_ö_zù_ªad_öfo
->
¸c32
 =

2045 
	`¸c32
(
pfûe_ö_zù_ªad_öfo
->
¸c32
,
bufBef‹e
,

2046 (
uI¡
)(
uOutThis
));

2048 
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_uncom¥es£d
 -=

2049 
uOutThis
;

2051 
iRód
 +(
uI¡
)(
uTŸÆOutA·î
 - 
uTŸÆOutBef‹e
);

2053 i‡(
îr
==
Z_STREAM_END
)

2054  (
iRód
==0Ë? 
UNZ_EOF
 : iRead;

2055 i‡(
îr
!=
Z_OK
)

2060 i‡(
îr
==
Z_OK
)

2061  
iRód
;

2062  
îr
;

2063 
	}
}

2069 
z_off_t
 
ZEXPORT
 
	$unzãŒ
 (
unzFûe
 
fûe
)

2071 
unz64_s
* 
s
;

2072 
fûe_ö_zù64_ªad_öfo_s
* 
pfûe_ö_zù_ªad_öfo
;

2073 i‡(
fûe
==
NULL
)

2074  
UNZ_PARAMERROR
;

2075 
s
=(
unz64_s
*)
fûe
;

2076 
pfûe_ö_zù_ªad_öfo
=
s
->
pfûe_ö_zù_ªad
;

2078 i‡(
pfûe_ö_zù_ªad_öfo
==
NULL
)

2079  
UNZ_PARAMERROR
;

2081  (
z_off_t
)
pfûe_ö_zù_ªad_öfo
->
°ªam
.
tŸÆ_out
;

2082 
	}
}

2084 
ZPOS64_T
 
ZEXPORT
 
	$unzãŒ64
 (
unzFûe
 
fûe
)

2087 
unz64_s
* 
s
;

2088 
fûe_ö_zù64_ªad_öfo_s
* 
pfûe_ö_zù_ªad_öfo
;

2089 i‡(
fûe
==
NULL
)

2090  (
ZPOS64_T
)-1;

2091 
s
=(
unz64_s
*)
fûe
;

2092 
pfûe_ö_zù_ªad_öfo
=
s
->
pfûe_ö_zù_ªad
;

2094 i‡(
pfûe_ö_zù_ªad_öfo
==
NULL
)

2095  (
ZPOS64_T
)-1;

2097  
pfûe_ö_zù_ªad_öfo
->
tŸÆ_out_64
;

2098 
	}
}

2104 
ZEXPORT
 
	$unzeof
 (
unzFûe
 
fûe
)

2106 
unz64_s
* 
s
;

2107 
fûe_ö_zù64_ªad_öfo_s
* 
pfûe_ö_zù_ªad_öfo
;

2108 i‡(
fûe
==
NULL
)

2109  
UNZ_PARAMERROR
;

2110 
s
=(
unz64_s
*)
fûe
;

2111 
pfûe_ö_zù_ªad_öfo
=
s
->
pfûe_ö_zù_ªad
;

2113 i‡(
pfûe_ö_zù_ªad_öfo
==
NULL
)

2114  
UNZ_PARAMERROR
;

2116 i‡(
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_uncom¥es£d
 == 0)

2120 
	}
}

2136 
ZEXPORT
 
	$unzGëLoˇlExåafõld
 (
unzFûe
 
fûe
, 
voidp
 
buf
, 
Àn
)

2138 
unz64_s
* 
s
;

2139 
fûe_ö_zù64_ªad_öfo_s
* 
pfûe_ö_zù_ªad_öfo
;

2140 
uI¡
 
ªad_now
;

2141 
ZPOS64_T
 
size_to_ªad
;

2143 i‡(
fûe
==
NULL
)

2144  
UNZ_PARAMERROR
;

2145 
s
=(
unz64_s
*)
fûe
;

2146 
pfûe_ö_zù_ªad_öfo
=
s
->
pfûe_ö_zù_ªad
;

2148 i‡(
pfûe_ö_zù_ªad_öfo
==
NULL
)

2149  
UNZ_PARAMERROR
;

2151 
size_to_ªad
 = (
pfûe_ö_zù_ªad_öfo
->
size_loˇl_exåafõld
 -

2152 
pfûe_ö_zù_ªad_öfo
->
pos_loˇl_exåafõld
);

2154 i‡(
buf
==
NULL
)

2155  ()
size_to_ªad
;

2157 i‡(
Àn
>
size_to_ªad
)

2158 
ªad_now
 = (
uI¡
)
size_to_ªad
;

2160 
ªad_now
 = (
uI¡
)
Àn
 ;

2162 i‡(
ªad_now
==0)

2165 i‡(
	`ZSEEK64
(
pfûe_ö_zù_ªad_öfo
->
z_fûefunc
,

2166 
pfûe_ö_zù_ªad_öfo
->
fûe°ªam
,

2167 
pfûe_ö_zù_ªad_öfo
->
off£t_loˇl_exåafõld
 +

2168 
pfûe_ö_zù_ªad_öfo
->
pos_loˇl_exåafõld
,

2169 
ZLIB_FILEFUNC_SEEK_SET
)!=0)

2170  
UNZ_ERRNO
;

2172 i‡(
	`ZREAD64
(
pfûe_ö_zù_ªad_öfo
->
z_fûefunc
,

2173 
pfûe_ö_zù_ªad_öfo
->
fûe°ªam
,

2174 
buf
,
ªad_now
)!=read_now)

2175  
UNZ_ERRNO
;

2177  ()
ªad_now
;

2178 
	}
}

2184 
ZEXPORT
 
	$unzClo£CuºítFûe
 (
unzFûe
 
fûe
)

2186 
îr
=
UNZ_OK
;

2188 
unz64_s
* 
s
;

2189 
fûe_ö_zù64_ªad_öfo_s
* 
pfûe_ö_zù_ªad_öfo
;

2190 i‡(
fûe
==
NULL
)

2191  
UNZ_PARAMERROR
;

2192 
s
=(
unz64_s
*)
fûe
;

2193 
pfûe_ö_zù_ªad_öfo
=
s
->
pfûe_ö_zù_ªad
;

2195 i‡(
pfûe_ö_zù_ªad_öfo
==
NULL
)

2196  
UNZ_PARAMERROR
;

2199 i‡((
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_uncom¥es£d
 == 0) &&

2200 (!
pfûe_ö_zù_ªad_öfo
->
øw
))

2202 i‡(
pfûe_ö_zù_ªad_öfo
->
¸c32
 !pfûe_ö_zù_ªad_öfo->
¸c32_waô
)

2203 
îr
=
UNZ_CRCERROR
;

2207 
	`TRYFREE
(
pfûe_ö_zù_ªad_öfo
->
ªad_buf„r
);

2208 
pfûe_ö_zù_ªad_öfo
->
ªad_buf„r
 = 
NULL
;

2209 i‡(
pfûe_ö_zù_ªad_öfo
->
°ªam_öôüli£d
 =
Z_DEFLATED
)

2210 
	`öÊ©eEnd
(&
pfûe_ö_zù_ªad_öfo
->
°ªam
);

2211 #ifde‡
HAVE_BZIP2


2212 i‡(
pfûe_ö_zù_ªad_öfo
->
°ªam_öôüli£d
 =
Z_BZIP2ED
)

2213 
	`BZ2_bzDecom¥essEnd
(&
pfûe_ö_zù_ªad_öfo
->
b°ªam
);

2217 
pfûe_ö_zù_ªad_öfo
->
°ªam_öôüli£d
 = 0;

2218 
	`TRYFREE
(
pfûe_ö_zù_ªad_öfo
);

2220 
s
->
pfûe_ö_zù_ªad
=
NULL
;

2222  
îr
;

2223 
	}
}

2231 
ZEXPORT
 
	$unzGëGlobÆCommít
 (
unzFûe
 
fûe
, * 
szCommít
, 
uL⁄g
 
uSizeBuf
)

2233 
unz64_s
* 
s
;

2234 
uL⁄g
 
uRódThis
 ;

2235 i‡(
fûe
==
NULL
)

2236  ()
UNZ_PARAMERROR
;

2237 
s
=(
unz64_s
*)
fûe
;

2239 
uRódThis
 = 
uSizeBuf
;

2240 i‡(
uRódThis
>
s
->
gi
.
size_commít
)

2241 
uRódThis
 = 
s
->
gi
.
size_commít
;

2243 i‡(
	`ZSEEK64
(
s
->
z_fûefunc
,s->
fûe°ªam
,s->
˚¡øl_pos
+22,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

2244  
UNZ_ERRNO
;

2246 i‡(
uRódThis
>0)

2248 *
szCommít
='\0';

2249 i‡(
	`ZREAD64
(
s
->
z_fûefunc
,s->
fûe°ªam
,
szCommít
,
uRódThis
)!=uReadThis)

2250  
UNZ_ERRNO
;

2253 i‡((
szCommít
 !
NULL
Ë&& (
uSizeBuf
 > 
s
->
gi
.
size_commít
))

2254 *(
szCommít
+
s
->
gi
.
size_commít
)='\0';

2255  ()
uRódThis
;

2256 
	}
}

2259 
ZPOS64_T
 
ZEXPORT
 
	$unzGëOff£t64
(
unzFûe
 
fûe
)

2261 
unz64_s
* 
s
;

2263 i‡(
fûe
==
NULL
)

2265 
s
=(
unz64_s
*)
fûe
;

2266 i‡(!
s
->
cuºít_fûe_ok
)

2268 i‡(
s
->
gi
.
numbî_íåy
 != 0 && s->gi.number_entry != 0xffff)

2269 i‡(
s
->
num_fûe
==s->
gi
.
numbî_íåy
)

2271  
s
->
pos_ö_˚¡øl_dú
;

2272 
	}
}

2274 
uL⁄g
 
ZEXPORT
 
	$unzGëOff£t
 (
unzFûe
 
fûe
)

2276 
ZPOS64_T
 
off£t64
;

2278 i‡(
fûe
==
NULL
)

2280 
off£t64
 = 
	`unzGëOff£t64
(
fûe
);

2281  (
uL⁄g
)
off£t64
;

2282 
	}
}

2284 
ZEXPORT
 
	$unzSëOff£t64
(
unzFûe
 
fûe
, 
ZPOS64_T
 
pos
)

2286 
unz64_s
* 
s
;

2287 
îr
;

2289 i‡(
fûe
==
NULL
)

2290  
UNZ_PARAMERROR
;

2291 
s
=(
unz64_s
*)
fûe
;

2293 
s
->
pos_ö_˚¡øl_dú
 = 
pos
;

2294 
s
->
num_fûe
 = s->
gi
.
numbî_íåy
;

2295 
îr
 = 
	`unz64loˇl_GëCuºítFûeInfoI¡î«l
(
fûe
,&
s
->
cur_fûe_öfo
,

2296 &
s
->
cur_fûe_öfo_öã∫Æ
,

2297 
NULL
,0,NULL,0,NULL,0);

2298 
s
->
cuºít_fûe_ok
 = (
îr
 =
UNZ_OK
);

2299  
îr
;

2300 
	}
}

2302 
ZEXPORT
 
	$unzSëOff£t
 (
unzFûe
 
fûe
, 
uL⁄g
 
pos
)

2304  
	`unzSëOff£t64
(
fûe
,
pos
);

2305 
	}
}

	@unzip.h

43 #i‚de‡
_unz64_H


44 
	#_unz64_H


	)

46 #ifde‡
__˝lu•lus


50 #i‚de‡
_ZLIB_H


51 
	~"zlib.h
"

54 #i‚de‡ 
_ZLIBIOAPI_H


55 
	~"iﬂpi.h
"

58 #ifde‡
HAVE_BZIP2


59 
	~"bzlib.h
"

62 
	#Z_BZIP2ED
 12

	)

64 #i‡
deföed
(
STRICTUNZIP
Ë|| deföed(
STRICTZIPUNZIP
)

67 
	sTagunzFûe__
 { 
unu£d
; } 
	tunzFûe__
;

68 
unzFûe__
 *
	tunzFûe
;

70 
voidp
 
	tunzFûe
;

74 
	#UNZ_OK
 (0)

	)

75 
	#UNZ_END_OF_LIST_OF_FILE
 (-100)

	)

76 
	#UNZ_ERRNO
 (
Z_ERRNO
)

	)

77 
	#UNZ_EOF
 (0)

	)

78 
	#UNZ_PARAMERROR
 (-102)

	)

79 
	#UNZ_BADZIPFILE
 (-103)

	)

80 
	#UNZ_INTERNALERROR
 (-104)

	)

81 
	#UNZ_CRCERROR
 (-105)

	)

84 
	stm_unz_s


86 
uI¡
 
tm_£c
;

87 
uI¡
 
tm_mö
;

88 
uI¡
 
tm_hour
;

89 
uI¡
 
tm_mday
;

90 
uI¡
 
tm_m⁄
;

91 
uI¡
 
tm_yór
;

92 } 
	ttm_unz
;

96 
	sunz_globÆ_öfo64_s


98 
ZPOS64_T
 
numbî_íåy
;

100 
uL⁄g
 
size_commít
;

101 } 
	tunz_globÆ_öfo64
;

103 
	sunz_globÆ_öfo_s


105 
uL⁄g
 
numbî_íåy
;

107 
uL⁄g
 
size_commít
;

108 } 
	tunz_globÆ_öfo
;

111 
	sunz_fûe_öfo64_s


113 
uL⁄g
 
vîsi⁄
;

114 
uL⁄g
 
vîsi⁄_√eded
;

115 
uL⁄g
 
Êag
;

116 
uL⁄g
 
com¥essi⁄_mëhod
;

117 
uL⁄g
 
dosD©e
;

118 
uL⁄g
 
¸c
;

119 
ZPOS64_T
 
com¥es£d_size
;

120 
ZPOS64_T
 
uncom¥es£d_size
;

121 
uL⁄g
 
size_fûíame
;

122 
uL⁄g
 
size_fûe_exåa
;

123 
uL⁄g
 
size_fûe_commít
;

125 
uL⁄g
 
disk_num_°¨t
;

126 
uL⁄g
 
öã∫Æ_Á
;

127 
uL⁄g
 
exã∫Æ_Á
;

129 
tm_unz
 
tmu_d©e
;

130 } 
	tunz_fûe_öfo64
;

132 
	sunz_fûe_öfo_s


134 
uL⁄g
 
vîsi⁄
;

135 
uL⁄g
 
vîsi⁄_√eded
;

136 
uL⁄g
 
Êag
;

137 
uL⁄g
 
com¥essi⁄_mëhod
;

138 
uL⁄g
 
dosD©e
;

139 
uL⁄g
 
¸c
;

140 
uL⁄g
 
com¥es£d_size
;

141 
uL⁄g
 
uncom¥es£d_size
;

142 
uL⁄g
 
size_fûíame
;

143 
uL⁄g
 
size_fûe_exåa
;

144 
uL⁄g
 
size_fûe_commít
;

146 
uL⁄g
 
disk_num_°¨t
;

147 
uL⁄g
 
öã∫Æ_Á
;

148 
uL⁄g
 
exã∫Æ_Á
;

150 
tm_unz
 
tmu_d©e
;

151 } 
	tunz_fûe_öfo
;

153 
ZEXPORT
 
unzSåögFûeNameCom∑ª
 
OF
 ((c⁄° * 
fûeName1
,

154 c⁄° * 
fûeName2
,

155 
iCa£Sísôivôy
));

166 
unzFûe
 
ZEXPORT
 
unzO≥n
 
OF
((c⁄° *
∑th
));

167 
unzFûe
 
ZEXPORT
 
unzO≥n64
 
OF
((c⁄° *
∑th
,c⁄° 
size_t
 
size
));

184 
unzFûe
 
ZEXPORT
 
unzO≥n2
 
OF
((c⁄° *
∑th
,

185 
zlib_fûefunc_def
* 
pzlib_fûefunc_def
));

191 
unzFûe
 
ZEXPORT
 
unzO≥n2_64
 
OF
((c⁄° *
∑th
,

192 
zlib_fûefunc64_def
* 
pzlib_fûefunc_def
));

198 
ZEXPORT
 
unzClo£
 
OF
((
unzFûe
 
fûe
));

205 
ZEXPORT
 
unzGëGlobÆInfo
 
OF
((
unzFûe
 
fûe
,

206 
unz_globÆ_öfo
 *
pglobÆ_öfo
));

208 
ZEXPORT
 
unzGëGlobÆInfo64
 
OF
((
unzFûe
 
fûe
,

209 
unz_globÆ_öfo64
 *
pglobÆ_öfo
));

216 
ZEXPORT
 
unzGëGlobÆCommít
 
OF
((
unzFûe
 
fûe
,

217 *
szCommít
,

218 
uL⁄g
 
uSizeBuf
));

229 
ZEXPORT
 
unzGoToFú°Fûe
 
OF
((
unzFûe
 
fûe
));

235 
ZEXPORT
 
unzGoToNextFûe
 
OF
((
unzFûe
 
fûe
));

242 
ZEXPORT
 
unzLoˇãFûe
 
OF
((
unzFûe
 
fûe
,

243 c⁄° *
szFûeName
,

244 
iCa£Sísôivôy
));

258 
	sunz_fûe_pos_s


260 
uL⁄g
 
	gpos_ö_zù_dúe˘‹y
;

261 
uL⁄g
 
	gnum_of_fûe
;

262 } 
	tunz_fûe_pos
;

264 
ZEXPORT
 
unzGëFûePos
(

265 
unzFûe
 
fûe
,

266 
unz_fûe_pos
* 
fûe_pos
);

268 
ZEXPORT
 
unzGoToFûePos
(

269 
unzFûe
 
fûe
,

270 
unz_fûe_pos
* 
fûe_pos
);

272 
	sunz64_fûe_pos_s


274 
ZPOS64_T
 
	gpos_ö_zù_dúe˘‹y
;

275 
ZPOS64_T
 
	gnum_of_fûe
;

276 } 
	tunz64_fûe_pos
;

278 
ZEXPORT
 
unzGëFûePos64
(

279 
unzFûe
 
fûe
,

280 
unz64_fûe_pos
* 
fûe_pos
);

282 
ZEXPORT
 
unzGoToFûePos64
(

283 
unzFûe
 
fûe
,

284 c⁄° 
unz64_fûe_pos
* 
fûe_pos
);

288 
ZEXPORT
 
unzGëCuºítFûeInfo64
 
OF
((
unzFûe
 
fûe
,

289 
unz_fûe_öfo64
 *
pfûe_öfo
,

290 *
szFûeName
,

291 
uL⁄g
 
fûeNameBuf„rSize
,

292 *
exåaFõld
,

293 
uL⁄g
 
exåaFõldBuf„rSize
,

294 *
szCommít
,

295 
uL⁄g
 
commítBuf„rSize
));

297 
ZEXPORT
 
unzGëCuºítFûeInfo
 
OF
((
unzFûe
 
fûe
,

298 
unz_fûe_öfo
 *
pfûe_öfo
,

299 *
szFûeName
,

300 
uL⁄g
 
fûeNameBuf„rSize
,

301 *
exåaFõld
,

302 
uL⁄g
 
exåaFõldBuf„rSize
,

303 *
szCommít
,

304 
uL⁄g
 
commítBuf„rSize
));

321 
ZPOS64_T
 
ZEXPORT
 
unzGëCuºítFûeZSåómPos64
 
OF
((
unzFûe
 
fûe
));

331 
ZEXPORT
 
unzO≥nCuºítFûe
 
OF
((
unzFûe
 
fûe
));

337 
ZEXPORT
 
unzO≥nCuºítFûePassw‹d
 
OF
((
unzFûe
 
fûe
,

338 c⁄° * 
∑ssw‹d
));

345 
ZEXPORT
 
unzO≥nCuºítFûe2
 
OF
((
unzFûe
 
fûe
,

346 * 
mëhod
,

347 * 
Àvñ
,

348 
øw
));

358 
ZEXPORT
 
unzO≥nCuºítFûe3
 
OF
((
unzFûe
 
fûe
,

359 * 
mëhod
,

360 * 
Àvñ
,

361 
øw
,

362 c⁄° * 
∑ssw‹d
));

373 
ZEXPORT
 
unzClo£CuºítFûe
 
OF
((
unzFûe
 
fûe
));

379 
ZEXPORT
 
unzRódCuºítFûe
 
OF
((
unzFûe
 
fûe
,

380 
voidp
 
buf
,

381 
Àn
));

393 
z_off_t
 
ZEXPORT
 
unzãŒ
 
OF
((
unzFûe
 
fûe
));

395 
ZPOS64_T
 
ZEXPORT
 
unzãŒ64
 
OF
((
unzFûe
 
fûe
));

400 
ZEXPORT
 
unzeof
 
OF
((
unzFûe
 
fûe
));

405 
ZEXPORT
 
unzGëLoˇlExåafõld
 
OF
((
unzFûe
 
fûe
,

406 
voidp
 
buf
,

407 
Àn
));

424 
ZPOS64_T
 
ZEXPORT
 
unzGëOff£t64
 (
unzFûe
 
fûe
);

425 
uL⁄g
 
ZEXPORT
 
unzGëOff£t
 (
unzFûe
 
fûe
);

428 
ZEXPORT
 
unzSëOff£t64
 (
unzFûe
 
fûe
, 
ZPOS64_T
 
pos
);

429 
ZEXPORT
 
unzSëOff£t
 (
unzFûe
 
fûe
, 
uL⁄g
 
pos
);

433 #ifde‡
__˝lu•lus


	@zlib-1.2.8/adler32.c

8 
	~"zutû.h
"

10 
	#loˇl
 

	)

12 
loˇl
 
uL⁄g
 
adÀr32_comböe_
 
OF
((uL⁄g 
adÀr1
, uL⁄g 
adÀr2
, 
z_off64_t
 
Àn2
));

14 
	#BASE
 65521

	)

15 
	#NMAX
 5552

	)

18 
	#DO1
(
buf
,
i
Ë{
adÀr
 +(buf)[i]; 
sum2
 +adÀr;}

	)

19 
	#DO2
(
buf
,
i
Ë
	`DO1
(buf,i); DO1(buf,i+1);

	)

20 
	#DO4
(
buf
,
i
Ë
	`DO2
(buf,i); DO2(buf,i+2);

	)

21 
	#DO8
(
buf
,
i
Ë
	`DO4
(buf,i); DO4(buf,i+4);

	)

22 
	#DO16
(
buf
Ë
	`DO8
(buf,0); DO8(buf,8);

	)

26 #ifde‡
NO_DIVIDE


29 
	#CHOP
(
a
) \

31 
tmp
 = 
a
 >> 16; \

32 
a
 &= 0xffffUL; \

33 
a
 +(
tmp
 << 4) -Åmp; \

34 } 0)

	)

35 
	#MOD28
(
a
) \

37 
	`CHOP
(
a
); \

38 i‡(
a
 >
BASE
)á -= BASE; \

39 } 0)

	)

40 
	#MOD
(
a
) \

42 
	`CHOP
(
a
); \

43 
	`MOD28
(
a
); \

44 } 0)

	)

45 
	#MOD63
(
a
) \

47 
z_off64_t
 
tmp
 = 
a
 >> 32; \

48 
a
 &= 0xffffffffL; \

49 
a
 +(
tmp
 << 8) - (tmp << 5) +Åmp; \

50 
tmp
 = 
a
 >> 16; \

51 
a
 &= 0xffffL; \

52 
a
 +(
tmp
 << 4) -Åmp; \

53 
tmp
 = 
a
 >> 16; \

54 
a
 &= 0xffffL; \

55 
a
 +(
tmp
 << 4) -Åmp; \

56 i‡(
a
 >
BASE
)á -= BASE; \

57 } 0)

	)

59 
	#MOD
(
a
Ë®%
BASE


	)

60 
	#MOD28
(
a
Ë®%
BASE


	)

61 
	#MOD63
(
a
Ë®%
BASE


	)

65 
uL⁄g
 
ZEXPORT
 
	$adÀr32
(
adÀr
, 
buf
, 
Àn
)

66 
uL⁄g
 
adÀr
;

67 c⁄° 
Byãf
 *
buf
;

68 
uI¡
 
Àn
;

70 
sum2
;

71 
n
;

74 
sum2
 = (
adÀr
 >> 16) & 0xffff;

75 
adÀr
 &= 0xffff;

78 i‡(
Àn
 == 1) {

79 
adÀr
 +
buf
[0];

80 i‡(
adÀr
 >
BASE
)

81 
adÀr
 -
BASE
;

82 
sum2
 +
adÀr
;

83 i‡(
sum2
 >
BASE
)

84 
sum2
 -
BASE
;

85  
adÀr
 | (
sum2
 << 16);

89 i‡(
buf
 =
Z_NULL
)

93 i‡(
Àn
 < 16) {

94 
Àn
--) {

95 
adÀr
 +*
buf
++;

96 
sum2
 +
adÀr
;

98 i‡(
adÀr
 >
BASE
)

99 
adÀr
 -
BASE
;

100 
	`MOD28
(
sum2
);

101  
adÀr
 | (
sum2
 << 16);

105 
Àn
 >
NMAX
) {

106 
Àn
 -
NMAX
;

107 
n
 = 
NMAX
 / 16;

109 
	`DO16
(
buf
);

110 
buf
 += 16;

111 } --
n
);

112 
	`MOD
(
adÀr
);

113 
	`MOD
(
sum2
);

117 i‡(
Àn
) {

118 
Àn
 >= 16) {

119 
Àn
 -= 16;

120 
	`DO16
(
buf
);

121 
buf
 += 16;

123 
Àn
--) {

124 
adÀr
 +*
buf
++;

125 
sum2
 +
adÀr
;

127 
	`MOD
(
adÀr
);

128 
	`MOD
(
sum2
);

132  
adÀr
 | (
sum2
 << 16);

133 
	}
}

136 
loˇl
 
uL⁄g
 
	$adÀr32_comböe_
(
adÀr1
, 
adÀr2
, 
Àn2
)

137 
uL⁄g
 
adÀr1
;

138 
uL⁄g
 
adÀr2
;

139 
z_off64_t
 
Àn2
;

141 
sum1
;

142 
sum2
;

143 
ªm
;

146 i‡(
Àn2
 < 0)

150 
	`MOD63
(
Àn2
);

151 
ªm
 = ()
Àn2
;

152 
sum1
 = 
adÀr1
 & 0xffff;

153 
sum2
 = 
ªm
 * 
sum1
;

154 
	`MOD
(
sum2
);

155 
sum1
 +(
adÀr2
 & 0xffffË+ 
BASE
 - 1;

156 
sum2
 +((
adÀr1
 >> 16Ë& 0xffffË+ ((
adÀr2
 >> 16Ë& 0xffffË+ 
BASE
 - 
ªm
;

157 i‡(
sum1
 >
BASE
) sum1 -= BASE;

158 i‡(
sum1
 >
BASE
) sum1 -= BASE;

159 i‡(
sum2
 >(
BASE
 << 1)) sum2 -= (BASE << 1);

160 i‡(
sum2
 >
BASE
) sum2 -= BASE;

161  
sum1
 | (
sum2
 << 16);

162 
	}
}

165 
uL⁄g
 
ZEXPORT
 
	$adÀr32_comböe
(
adÀr1
, 
adÀr2
, 
Àn2
)

166 
uL⁄g
 
adÀr1
;

167 
uL⁄g
 
adÀr2
;

168 
z_off_t
 
Àn2
;

170  
	`adÀr32_comböe_
(
adÀr1
, 
adÀr2
, 
Àn2
);

171 
	}
}

173 
uL⁄g
 
ZEXPORT
 
	$adÀr32_comböe64
(
adÀr1
, 
adÀr2
, 
Àn2
)

174 
uL⁄g
 
adÀr1
;

175 
uL⁄g
 
adÀr2
;

176 
z_off64_t
 
Àn2
;

178  
	`adÀr32_comböe_
(
adÀr1
, 
adÀr2
, 
Àn2
);

179 
	}
}

	@zlib-1.2.8/compress.c

8 
	#ZLIB_INTERNAL


	)

9 
	~"zlib.h
"

22 
ZEXPORT
 
	$com¥ess2
 (
de°
, 
de°Lí
, 
sour˚
, 
sour˚Lí
, 
Àvñ
)

23 
Byãf
 *
de°
;

24 
uL⁄gf
 *
de°Lí
;

25 c⁄° 
Byãf
 *
sour˚
;

26 
uL⁄g
 
sour˚Lí
;

27 
Àvñ
;

29 
z_°ªam
 
°ªam
;

30 
îr
;

32 
°ªam
.
√xt_ö
 = (
z_c⁄°
 
Byãf
 *)
sour˚
;

33 
°ªam
.
avaû_ö
 = (
uI¡
)
sour˚Lí
;

34 #ifde‡
MAXSEG_64K


36 i‡((
uL⁄g
)
°ªam
.
avaû_ö
 !
sour˚Lí
Ë 
Z_BUF_ERROR
;

38 
°ªam
.
√xt_out
 = 
de°
;

39 
°ªam
.
avaû_out
 = (
uI¡
)*
de°Lí
;

40 i‡((
uL⁄g
)
°ªam
.
avaû_out
 !*
de°Lí
Ë 
Z_BUF_ERROR
;

42 
°ªam
.
zÆloc
 = (
Æloc_func
)0;

43 
°ªam
.
z‰ì
 = (
‰ì_func
)0;

44 
°ªam
.
›aque
 = (
voidpf
)0;

46 
îr
 = 
	`deÊ©eInô
(&
°ªam
, 
Àvñ
);

47 i‡(
îr
 !
Z_OK
) Érr;

49 
îr
 = 
	`deÊ©e
(&
°ªam
, 
Z_FINISH
);

50 i‡(
îr
 !
Z_STREAM_END
) {

51 
	`deÊ©eEnd
(&
°ªam
);

52  
îr
 =
Z_OK
 ? 
Z_BUF_ERROR
 :Érr;

54 *
de°Lí
 = 
°ªam
.
tŸÆ_out
;

56 
îr
 = 
	`deÊ©eEnd
(&
°ªam
);

57  
îr
;

58 
	}
}

62 
ZEXPORT
 
	$com¥ess
 (
de°
, 
de°Lí
, 
sour˚
, 
sour˚Lí
)

63 
Byãf
 *
de°
;

64 
uL⁄gf
 *
de°Lí
;

65 c⁄° 
Byãf
 *
sour˚
;

66 
uL⁄g
 
sour˚Lí
;

68  
	`com¥ess2
(
de°
, 
de°Lí
, 
sour˚
, 
sour˚Lí
, 
Z_DEFAULT_COMPRESSION
);

69 
	}
}

75 
uL⁄g
 
ZEXPORT
 
	$com¥essBound
 (
sour˚Lí
)

76 
uL⁄g
 
sour˚Lí
;

78  
sour˚Lí
 + (sourceLen >> 12) + (sourceLen >> 14) +

79 (
sour˚Lí
 >> 25) + 13;

80 
	}
}

	@zlib-1.2.8/contrib/blast/blast.c

29 
	~<£tjmp.h
>

30 
	~"bœ°.h
"

32 
	#loˇl
 

	)

33 
	#MAXBITS
 13

	)

34 
	#MAXWIN
 4096

	)

37 
	s°©e
 {

39 
bœ°_ö
 
	möfun
;

40 *
	möhow
;

41 *
	mö
;

42 
	mÀ·
;

43 
	mbôbuf
;

44 
	mbô˙t
;

47 
jmp_buf
 
	mív
;

50 
bœ°_out
 
	moutfun
;

51 *
	mouthow
;

52 
	m√xt
;

53 
	mfú°
;

54 
	mout
[
MAXWIN
];

68 
loˇl
 
	$bôs
(
°©e
 *
s
, 
√ed
)

70 
vÆ
;

73 
vÆ
 = 
s
->
bôbuf
;

74 
s
->
bô˙t
 < 
√ed
) {

75 i‡(
s
->
À·
 == 0) {

76 
s
->
À·
 = s->
	`öfun
(s->
öhow
, &(s->
ö
));

77 i‡(
s
->
À·
 =0Ë
	`l⁄gjmp
(s->
ív
, 1);

79 
vÆ
 |()(*(
s
->
ö
)++Ë<< s->
bô˙t
;

80 
s
->
À·
--;

81 
s
->
bô˙t
 += 8;

85 
s
->
bôbuf
 = 
vÆ
 >> 
√ed
;

86 
s
->
bô˙t
 -
√ed
;

89  
vÆ
 & ((1 << 
√ed
) - 1);

90 
	}
}

99 
	shuffm™
 {

100 *
	mcou¡
;

101 *
	msymbﬁ
;

125 
loˇl
 
	$decode
(
°©e
 *
s
, 
huffm™
 *
h
)

127 
Àn
;

128 
code
;

129 
fú°
;

130 
cou¡
;

131 
ödex
;

132 
bôbuf
;

133 
À·
;

134 *
√xt
;

136 
bôbuf
 = 
s
->bitbuf;

137 
À·
 = 
s
->
bô˙t
;

138 
code
 = 
fú°
 = 
ödex
 = 0;

139 
Àn
 = 1;

140 
√xt
 = 
h
->
cou¡
 + 1;

142 
À·
--) {

143 
code
 |(
bôbuf
 & 1) ^ 1;

144 
bôbuf
 >>= 1;

145 
cou¡
 = *
√xt
++;

146 i‡(
code
 < 
fú°
 + 
cou¡
) {

147 
s
->
bôbuf
 = bitbuf;

148 
s
->
bô˙t
 = (s->bô˙à- 
Àn
) & 7;

149  
h
->
symbﬁ
[
ödex
 + (
code
 - 
fú°
)];

151 
ödex
 +
cou¡
;

152 
fú°
 +
cou¡
;

153 
fú°
 <<= 1;

154 
code
 <<= 1;

155 
Àn
++;

157 
À·
 = (
MAXBITS
+1Ë- 
Àn
;

158 i‡(
À·
 == 0) ;

159 i‡(
s
->
À·
 == 0) {

160 
s
->
À·
 = s->
	`öfun
(s->
öhow
, &(s->
ö
));

161 i‡(
s
->
À·
 =0Ë
	`l⁄gjmp
(s->
ív
, 1);

163 
bôbuf
 = *(
s
->
ö
)++;

164 
s
->
À·
--;

165 i‡(
À·
 > 8)Üeft = 8;

168 
	}
}

187 
loˇl
 
	$c⁄°ru˘
(
huffm™
 *
h
, c⁄° *
ªp
, 
n
)

189 
symbﬁ
;

190 
Àn
;

191 
À·
;

192 
offs
[
MAXBITS
+1];

193 
Àngth
[256];

196 
symbﬁ
 = 0;

198 
Àn
 = *
ªp
++;

199 
À·
 = (
Àn
 >> 4) + 1;

200 
Àn
 &= 15;

202 
Àngth
[
symbﬁ
++] = 
Àn
;

203 } --
À·
);

204 } --
n
);

205 
n
 = 
symbﬁ
;

208 
Àn
 = 0;Üí <
MAXBITS
;Üen++)

209 
h
->
cou¡
[
Àn
] = 0;

210 
symbﬁ
 = 0; symbﬁ < 
n
; symbol++)

211 (
h
->
cou¡
[
Àngth
[
symbﬁ
]])++;

212 i‡(
h
->
cou¡
[0] =
n
)

216 
À·
 = 1;

217 
Àn
 = 1;Üí <
MAXBITS
;Üen++) {

218 
À·
 <<= 1;

219 
À·
 -
h
->
cou¡
[
Àn
];

220 i‡(
À·
 < 0) Üeft;

224 
offs
[1] = 0;

225 
Àn
 = 1;Üí < 
MAXBITS
;Üen++)

226 
offs
[
Àn
 + 1] = offs[Àn] + 
h
->
cou¡
[len];

232 
symbﬁ
 = 0; symbﬁ < 
n
; symbol++)

233 i‡(
Àngth
[
symbﬁ
] != 0)

234 
h
->
symbﬁ
[
offs
[
Àngth
[symbol]]++] = symbol;

237  
À·
;

238 
	}
}

278 
loˇl
 
	$decomp
(
°©e
 *
s
)

280 
lô
;

281 
di˘
;

282 
symbﬁ
;

283 
Àn
;

284 
di°
;

285 
c›y
;

286 *
‰om
, *
to
;

287 
vúgö
 = 1;

288 
lô˙t
[
MAXBITS
+1], 
lôsym
[256];

289 
Àn˙t
[
MAXBITS
+1], 
Ànsym
[16];

290 
di°˙t
[
MAXBITS
+1], 
di°sym
[64];

291 
huffm™
 
lôcode
 = {
lô˙t
, 
lôsym
};

292 
huffm™
 
Àncode
 = {
Àn˙t
, 
Ànsym
};

293 
huffm™
 
di°code
 = {
di°˙t
, 
di°sym
};

295 c⁄° 
lôÀn
[] = {

303 c⁄° 
À∆í
[] = {2, 35, 36, 53, 38, 23};

305 c⁄° 
di°Àn
[] = {2, 20, 53, 230, 247, 151, 248};

306 c⁄° 
ba£
[16] = {

308 c⁄° 
exåa
[16] = {

312 i‡(
vúgö
) {

313 
	`c⁄°ru˘
(&
lôcode
, 
lôÀn
, (litlen));

314 
	`c⁄°ru˘
(&
Àncode
, 
À∆í
, (lenlen));

315 
	`c⁄°ru˘
(&
di°code
, 
di°Àn
, (distlen));

316 
vúgö
 = 0;

320 
lô
 = 
	`bôs
(
s
, 8);

321 i‡(
lô
 > 1)  -1;

322 
di˘
 = 
	`bôs
(
s
, 8);

323 i‡(
di˘
 < 4 || dict > 6)  -2;

327 i‡(
	`bôs
(
s
, 1)) {

329 
symbﬁ
 = 
	`decode
(
s
, &
Àncode
);

330 
Àn
 = 
ba£
[
symbﬁ
] + 
	`bôs
(
s
, 
exåa
[symbol]);

331 i‡(
Àn
 == 519) ;

334 
symbﬁ
 = 
Àn
 =2 ? 2 : 
di˘
;

335 
di°
 = 
	`decode
(
s
, &
di°code
Ë<< 
symbﬁ
;

336 
di°
 +
	`bôs
(
s
, 
symbﬁ
);

337 
di°
++;

338 i‡(
s
->
fú°
 && 
di°
 > s->
√xt
)

343 
to
 = 
s
->
out
 + s->
√xt
;

344 
‰om
 = 
to
 - 
di°
;

345 
c›y
 = 
MAXWIN
;

346 i‡(
s
->
√xt
 < 
di°
) {

347 
‰om
 +
c›y
;

348 
c›y
 = 
di°
;

350 
c›y
 -
s
->
√xt
;

351 i‡(
c›y
 > 
Àn
) copy =Üen;

352 
Àn
 -
c›y
;

353 
s
->
√xt
 +
c›y
;

355 *
to
++ = *
‰om
++;

356 } --
c›y
);

357 i‡(
s
->
√xt
 =
MAXWIN
) {

358 i‡(
s
->
	`outfun
(s->
outhow
, s->
out
, s->
√xt
))  1;

359 
s
->
√xt
 = 0;

360 
s
->
fú°
 = 0;

362 } 
Àn
 != 0);

366 
symbﬁ
 = 
lô
 ? 
	`decode
(
s
, &
lôcode
Ë: 
	`bôs
(s, 8);

367 
s
->
out
[s->
√xt
++] = 
symbﬁ
;

368 i‡(
s
->
√xt
 =
MAXWIN
) {

369 i‡(
s
->
	`outfun
(s->
outhow
, s->
out
, s->
√xt
))  1;

370 
s
->
√xt
 = 0;

371 
s
->
fú°
 = 0;

376 
	}
}

379 
	$bœ°
(
bœ°_ö
 
öfun
, *
öhow
, 
bœ°_out
 
outfun
, *
outhow
)

381 
°©e
 
s
;

382 
îr
;

385 
s
.
öfun
 = infun;

386 
s
.
öhow
 = inhow;

387 
s
.
À·
 = 0;

388 
s
.
bôbuf
 = 0;

389 
s
.
bô˙t
 = 0;

392 
s
.
outfun
 = outfun;

393 
s
.
outhow
 = outhow;

394 
s
.
√xt
 = 0;

395 
s
.
fú°
 = 1;

398 i‡(
	`£tjmp
(
s
.
ív
) != 0)

399 
îr
 = 2;

401 
îr
 = 
	`decomp
(&
s
);

404 i‡(
îr
 !1 && 
s
.
√xt
 && s.
	`outfun
(s.
outhow
, s.
out
, s.next) &&Érr == 0)

405 
îr
 = 1;

406  
îr
;

407 
	}
}

409 #ifde‡
TEST


411 
	~<°dio.h
>

412 
	~<°dlib.h
>

414 
	#CHUNK
 16384

	)

416 
loˇl
 
	$öf
(*
how
, **
buf
)

418 
hﬁd
[
CHUNK
];

420 *
buf
 = 
hﬁd
;

421  
	`‰ód
(
hﬁd
, 1, 
CHUNK
, (
FILE
 *)
how
);

422 
	}
}

424 
loˇl
 
	$outf
(*
how
, *
buf
, 
Àn
)

426  
	`fwrôe
(
buf
, 1, 
Àn
, (
FILE
 *)
how
) !=Üen;

427 
	}
}

430 
	$maö
()

432 
ªt
, 
n
;

435 
ªt
 = 
	`bœ°
(
öf
, 
°dö
, 
outf
, 
°dout
);

436 i‡(
ªt
 !0Ë
	`Ârötf
(
°dîr
, "blastÉrror: %d\n",Ñet);

439 
n
 = 0;

440 
	`gëch¨
(Ë!
EOF
Ë
n
++;

441 i‡(
n
Ë
	`Ârötf
(
°dîr
, "blast warning: %d unused bytes of input\n",Ç);

444  
ªt
;

445 
	}
}

	@zlib-1.2.8/contrib/blast/blast.h

38 (*
	tbœ°_ö
)(*
	thow
, **
	tbuf
);

39 (*
	tbœ°_out
)(*
	thow
, *
	tbuf
, 
	tÀn
);

45 
	`bœ°
(
bœ°_ö
 
öfun
, *
öhow
, 
bœ°_out
 
outfun
, *
outhow
);

	@zlib-1.2.8/contrib/infback9/infback9.c

6 
	~"zutû.h
"

7 
	~"öfback9.h
"

8 
	~"ö·ªe9.h
"

9 
	~"öÊ©e9.h
"

11 
	#WSIZE
 65536UL

	)

19 
ZEXPORT
 
	$öÊ©eBack9Inô_
(
°rm
, 
wödow
, 
vîsi⁄
, 
°ªam_size
)

20 
z_°ªam
 
FAR
 *
°rm
;

21 
FAR
 *
wödow
;

22 c⁄° *
vîsi⁄
;

23 
°ªam_size
;

25 
öÊ©e_°©e
 
FAR
 *
°©e
;

27 i‡(
vîsi⁄
 =
Z_NULL
 || vîsi⁄[0] !
ZLIB_VERSION
[0] ||

28 
°ªam_size
 !()((
z_°ªam
)))

29  
Z_VERSION_ERROR
;

30 i‡(
°rm
 =
Z_NULL
 || 
wödow
 == Z_NULL)

31  
Z_STREAM_ERROR
;

32 
°rm
->
msg
 = 
Z_NULL
;

33 i‡(
°rm
->
zÆloc
 =(
Æloc_func
)0) {

34 
°rm
->
zÆloc
 = 
zˇŒoc
;

35 
°rm
->
›aque
 = (
voidpf
)0;

37 i‡(
°rm
->
z‰ì
 =(
‰ì_func
)0Ë°rm->z‰ì = 
zc‰ì
;

38 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
	`ZALLOC
(
°rm
, 1,

39 (
öÊ©e_°©e
));

40 i‡(
°©e
 =
Z_NULL
Ë 
Z_MEM_ERROR
;

41 
	`Tø˚v
((
°dîr
, "inflate:állocated\n"));

42 
°rm
->
°©e
 = (
voidpf
)state;

43 
°©e
->
wödow
 = window;

44  
Z_OK
;

45 
	}
}

51 #ifde‡
MAKEFIXED


52 
	~<°dio.h
>

54 
	$makefixed9
()

56 
sym
, 
bôs
, 
low
, 
size
;

57 
code
 *
√xt
, *
Ànfix
, *
di°fix
;

58 
öÊ©e_°©e
 
°©e
;

59 
code
 
fixed
[544];

62 
sym
 = 0;

63 
sym
 < 144Ë
°©e
.
Àns
[sym++] = 8;

64 
sym
 < 256Ë
°©e
.
Àns
[sym++] = 9;

65 
sym
 < 280Ë
°©e
.
Àns
[sym++] = 7;

66 
sym
 < 288Ë
°©e
.
Àns
[sym++] = 8;

67 
√xt
 = 
fixed
;

68 
Ànfix
 = 
√xt
;

69 
bôs
 = 9;

70 
	`öÊ©e_èbÀ9
(
LENS
, 
°©e
.
Àns
, 288, &(
√xt
), &(
bôs
), sèã.
w‹k
);

73 
sym
 = 0;

74 
sym
 < 32Ë
°©e
.
Àns
[sym++] = 5;

75 
di°fix
 = 
√xt
;

76 
bôs
 = 5;

77 
	`öÊ©e_èbÀ9
(
DISTS
, 
°©e
.
Àns
, 32, &(
√xt
), &(
bôs
), sèã.
w‹k
);

80 
	`puts
(" /* inffix9.h --Åable for decoding deflate64 fixed codes");

81 
	`puts
(" * Generatedáutomatically by makefixed9().");

82 
	`puts
(" */");

83 
	`puts
("");

84 
	`puts
(" /* WARNING:Åhis file should *not* be used byápplications.");

85 
	`puts
(" It isÖart ofÅhe implementation ofÅhisÜibraryánd is");

86 
	`puts
(" subjectÅo change. Applications should only use zlib.h.");

87 
	`puts
(" */");

88 
	`puts
("");

89 
size
 = 1U << 9;

90 
	`¥ötf
(" sèti¯c⁄° codêÀnfix[%u] = {", 
size
);

91 
low
 = 0;

93 i‡((
low
 % 6Ë=0Ë
	`¥ötf
("\n ");

94 
	`¥ötf
("{%u,%u,%d}", 
Ànfix
[
low
].
›
,Üífix[low].
bôs
,

95 
Ànfix
[
low
].
vÆ
);

96 i‡(++
low
 =
size
) ;

97 
	`putch¨
(',');

99 
	`puts
("\n };");

100 
size
 = 1U << 5;

101 
	`¥ötf
("\¿ sèti¯c⁄° codêdi°fix[%u] = {", 
size
);

102 
low
 = 0;

104 i‡((
low
 % 5Ë=0Ë
	`¥ötf
("\n ");

105 
	`¥ötf
("{%u,%u,%d}", 
di°fix
[
low
].
›
, di°fix[low].
bôs
,

106 
di°fix
[
low
].
vÆ
);

107 i‡(++
low
 =
size
) ;

108 
	`putch¨
(',');

110 
	`puts
("\n };");

111 
	}
}

117 
	#INITBITS
() \

119 
hﬁd
 = 0; \

120 
bôs
 = 0; \

121 } 0)

	)

125 
	#PULL
() \

127 i‡(
have
 == 0) { \

128 
have
 = 
	`ö
(
ö_desc
, &
√xt
); \

129 i‡(
have
 == 0) { \

130 
√xt
 = 
Z_NULL
; \

131 
ªt
 = 
Z_BUF_ERROR
; \

132 
öf_Àave
; \

135 } 0)

	)

139 
	#PULLBYTE
() \

141 
	`PULL
(); \

142 
have
--; \

143 
hﬁd
 +()(*
√xt
++Ë<< 
bôs
; \

144 
bôs
 += 8; \

145 } 0)

	)

150 
	#NEEDBITS
(
n
) \

152 
bôs
 < ()(
n
)) \

153 
	`PULLBYTE
(); \

154 } 0)

	)

157 
	#BITS
(
n
) \

158 (()
hﬁd
 & ((1U << (
n
)Ë- 1))

	)

161 
	#DROPBITS
(
n
) \

163 
hﬁd
 >>(
n
); \

164 
bôs
 -()(
n
); \

165 } 0)

	)

168 
	#BYTEBITS
() \

170 
hﬁd
 >>
bôs
 & 7; \

171 
bôs
 -= bits & 7; \

172 } 0)

	)

177 
	#ROOM
() \

179 i‡(
À·
 == 0) { \

180 
put
 = 
wödow
; \

181 
À·
 = 
WSIZE
; \

182 
wøp
 = 1; \

183 i‡(
	`out
(
out_desc
, 
put
, ()
À·
)) { \

184 
ªt
 = 
Z_BUF_ERROR
; \

185 
öf_Àave
; \

188 } 0)

	)

217 
ZEXPORT
 
	$öÊ©eBack9
(
°rm
, 
ö
, 
ö_desc
, 
out
, 
out_desc
)

218 
z_°ªam
 
FAR
 *
°rm
;

219 
ö_func
 
ö
;

220 
FAR
 *
ö_desc
;

221 
out_func
 
out
;

222 
FAR
 *
out_desc
;

224 
öÊ©e_°©e
 
FAR
 *
°©e
;

225 
z_c⁄°
 
FAR
 *
√xt
;

226 
FAR
 *
put
;

227 
have
;

228 
À·
;

229 
öÊ©e_mode
 
mode
;

230 
œ°block
;

231 
wøp
;

232 
FAR
 *
wödow
;

233 
hﬁd
;

234 
bôs
;

235 
exåa
;

236 
Àngth
;

237 
off£t
;

238 
c›y
;

239 
FAR
 *
‰om
;

240 
code
 c⁄° 
FAR
 *
Àncode
;

241 
code
 c⁄° 
FAR
 *
di°code
;

242 
Ànbôs
;

243 
di°bôs
;

244 
code
 
hîe
;

245 
code
 
œ°
;

246 
Àn
;

247 
ªt
;

248 c⁄° 
‹dî
[19] =

250 
	~"öffix9.h
"

253 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 == Z_NULL)

254  
Z_STREAM_ERROR
;

255 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
°rm
->state;

258 
°rm
->
msg
 = 
Z_NULL
;

259 
mode
 = 
TYPE
;

260 
œ°block
 = 0;

261 
wøp
 = 0;

262 
wödow
 = 
°©e
->window;

263 
√xt
 = 
°rm
->
√xt_ö
;

264 
have
 = 
√xt
 !
Z_NULL
 ? 
°rm
->
avaû_ö
 : 0;

265 
hﬁd
 = 0;

266 
bôs
 = 0;

267 
put
 = 
wödow
;

268 
À·
 = 
WSIZE
;

269 
Àncode
 = 
Z_NULL
;

270 
di°code
 = 
Z_NULL
;

274 
mode
) {

275 
TYPE
:

277 i‡(
œ°block
) {

278 
	`BYTEBITS
();

279 
mode
 = 
DONE
;

282 
	`NEEDBITS
(3);

283 
œ°block
 = 
	`BITS
(1);

284 
	`DROPBITS
(1);

285 
	`BITS
(2)) {

287 
	`Tø˚v
((
°dîr
, "inflate: stored block%s\n",

288 
œ°block
 ? " (last)" : ""));

289 
mode
 = 
STORED
;

292 
Àncode
 = 
Ànfix
;

293 
Ànbôs
 = 9;

294 
di°code
 = 
di°fix
;

295 
di°bôs
 = 5;

296 
	`Tø˚v
((
°dîr
, "inflate: fixed codes block%s\n",

297 
œ°block
 ? " (last)" : ""));

298 
mode
 = 
LEN
;

301 
	`Tø˚v
((
°dîr
, "inflate: dynamic codes block%s\n",

302 
œ°block
 ? " (last)" : ""));

303 
mode
 = 
TABLE
;

306 
°rm
->
msg
 = (*)"invalid blockÅype";

307 
mode
 = 
BAD
;

309 
	`DROPBITS
(2);

312 
STORED
:

314 
	`BYTEBITS
();

315 
	`NEEDBITS
(32);

316 i‡((
hﬁd
 & 0xffff) != ((hold >> 16) ^ 0xffff)) {

317 
°rm
->
msg
 = (*)"invalid stored blockÜengths";

318 
mode
 = 
BAD
;

321 
Àngth
 = ()
hﬁd
 & 0xffff;

322 
	`Tø˚v
((
°dîr
, "inflate: storedÜength %lu\n",

323 
Àngth
));

324 
	`INITBITS
();

327 
Àngth
 != 0) {

328 
c›y
 = 
Àngth
;

329 
	`PULL
();

330 
	`ROOM
();

331 i‡(
c›y
 > 
have
) copy = have;

332 i‡(
c›y
 > 
À·
) copy =Üeft;

333 
	`zmem˝y
(
put
, 
√xt
, 
c›y
);

334 
have
 -
c›y
;

335 
√xt
 +
c›y
;

336 
À·
 -
c›y
;

337 
put
 +
c›y
;

338 
Àngth
 -
c›y
;

340 
	`Tø˚v
((
°dîr
, "inflate: storedÉnd\n"));

341 
mode
 = 
TYPE
;

344 
TABLE
:

346 
	`NEEDBITS
(14);

347 
°©e
->
∆í
 = 
	`BITS
(5) + 257;

348 
	`DROPBITS
(5);

349 
°©e
->
ndi°
 = 
	`BITS
(5) + 1;

350 
	`DROPBITS
(5);

351 
°©e
->
ncode
 = 
	`BITS
(4) + 4;

352 
	`DROPBITS
(4);

353 i‡(
°©e
->
∆í
 > 286) {

354 
°rm
->
msg
 = (*)"too manyÜength symbols";

355 
mode
 = 
BAD
;

358 
	`Tø˚v
((
°dîr
, "inflate:Åable sizes ok\n"));

361 
°©e
->
have
 = 0;

362 
°©e
->
have
 < sèã->
ncode
) {

363 
	`NEEDBITS
(3);

364 
°©e
->
Àns
[
‹dî
[°©e->
have
++]] = ()
	`BITS
(3);

365 
	`DROPBITS
(3);

367 
°©e
->
have
 < 19)

368 
°©e
->
Àns
[
‹dî
[°©e->
have
++]] = 0;

369 
°©e
->
√xt
 = sèã->
codes
;

370 
Àncode
 = (
code
 c⁄° 
FAR
 *)(
°©e
->
√xt
);

371 
Ànbôs
 = 7;

372 
ªt
 = 
	`öÊ©e_èbÀ9
(
CODES
, 
°©e
->
Àns
, 19, &(°©e->
√xt
),

373 &(
Ànbôs
), 
°©e
->
w‹k
);

374 i‡(
ªt
) {

375 
°rm
->
msg
 = (*)"invalid codeÜengths set";

376 
mode
 = 
BAD
;

379 
	`Tø˚v
((
°dîr
, "inflate: codeÜengths ok\n"));

382 
°©e
->
have
 = 0;

383 
°©e
->
have
 < sèã->
∆í
 + sèã->
ndi°
) {

385 
hîe
 = 
Àncode
[
	`BITS
(
Ànbôs
)];

386 i‡(()(
hîe
.
bôs
) <= bits) ;

387 
	`PULLBYTE
();

389 i‡(
hîe
.
vÆ
 < 16) {

390 
	`NEEDBITS
(
hîe
.
bôs
);

391 
	`DROPBITS
(
hîe
.
bôs
);

392 
°©e
->
Àns
[°©e->
have
++] = 
hîe
.
vÆ
;

395 i‡(
hîe
.
vÆ
 == 16) {

396 
	`NEEDBITS
(
hîe
.
bôs
 + 2);

397 
	`DROPBITS
(
hîe
.
bôs
);

398 i‡(
°©e
->
have
 == 0) {

399 
°rm
->
msg
 = (*)"invalid bitÜengthÑepeat";

400 
mode
 = 
BAD
;

403 
Àn
 = ()(
°©e
->
Àns
[°©e->
have
 - 1]);

404 
c›y
 = 3 + 
	`BITS
(2);

405 
	`DROPBITS
(2);

407 i‡(
hîe
.
vÆ
 == 17) {

408 
	`NEEDBITS
(
hîe
.
bôs
 + 3);

409 
	`DROPBITS
(
hîe
.
bôs
);

410 
Àn
 = 0;

411 
c›y
 = 3 + 
	`BITS
(3);

412 
	`DROPBITS
(3);

415 
	`NEEDBITS
(
hîe
.
bôs
 + 7);

416 
	`DROPBITS
(
hîe
.
bôs
);

417 
Àn
 = 0;

418 
c›y
 = 11 + 
	`BITS
(7);

419 
	`DROPBITS
(7);

421 i‡(
°©e
->
have
 + 
c›y
 > sèã->
∆í
 + sèã->
ndi°
) {

422 
°rm
->
msg
 = (*)"invalid bitÜengthÑepeat";

423 
mode
 = 
BAD
;

426 
c›y
--)

427 
°©e
->
Àns
[°©e->
have
++] = ()
Àn
;

432 i‡(
mode
 =
BAD
) ;

435 i‡(
°©e
->
Àns
[256] == 0) {

436 
°rm
->
msg
 = (*)"invalid code -- missingÉnd-of-block";

437 
mode
 = 
BAD
;

444 
°©e
->
√xt
 = sèã->
codes
;

445 
Àncode
 = (
code
 c⁄° 
FAR
 *)(
°©e
->
√xt
);

446 
Ànbôs
 = 9;

447 
ªt
 = 
	`öÊ©e_èbÀ9
(
LENS
, 
°©e
->
Àns
, sèã->
∆í
,

448 &(
°©e
->
√xt
), &(
Ànbôs
), sèã->
w‹k
);

449 i‡(
ªt
) {

450 
°rm
->
msg
 = (*)"invalidÜiteral/lengths set";

451 
mode
 = 
BAD
;

454 
di°code
 = (
code
 c⁄° 
FAR
 *)(
°©e
->
√xt
);

455 
di°bôs
 = 6;

456 
ªt
 = 
	`öÊ©e_èbÀ9
(
DISTS
, 
°©e
->
Àns
 + sèã->
∆í
,

457 
°©e
->
ndi°
, &(°©e->
√xt
), &(
di°bôs
),

458 
°©e
->
w‹k
);

459 i‡(
ªt
) {

460 
°rm
->
msg
 = (*)"invalid distances set";

461 
mode
 = 
BAD
;

464 
	`Tø˚v
((
°dîr
, "inflate: codes ok\n"));

465 
mode
 = 
LEN
;

467 
LEN
:

470 
hîe
 = 
Àncode
[
	`BITS
(
Ànbôs
)];

471 i‡(()(
hîe
.
bôs
) <= bits) ;

472 
	`PULLBYTE
();

474 i‡(
hîe
.
›
 && (here.op & 0xf0) == 0) {

475 
œ°
 = 
hîe
;

477 
hîe
 = 
Àncode
[
œ°
.
vÆ
 +

478 (
	`BITS
(
œ°
.
bôs
 +Üa°.
›
) >>Üast.bits)];

479 i‡(()(
œ°
.
bôs
 + 
hîe
.bits) <= bits) ;

480 
	`PULLBYTE
();

482 
	`DROPBITS
(
œ°
.
bôs
);

484 
	`DROPBITS
(
hîe
.
bôs
);

485 
Àngth
 = ()
hîe
.
vÆ
;

488 i‡(
hîe
.
›
 == 0) {

489 
	`Tø˚vv
((
°dîr
, 
hîe
.
vÆ
 >= 0x20 && here.val < 0x7f ?

491 "öÊ©e:ÜôîÆ 0x%02x\n", 
hîe
.
vÆ
));

492 
	`ROOM
();

493 *
put
++ = ()(
Àngth
);

494 
À·
--;

495 
mode
 = 
LEN
;

500 i‡(
hîe
.
›
 & 32) {

501 
	`Tø˚vv
((
°dîr
, "inflate:Énd of block\n"));

502 
mode
 = 
TYPE
;

507 i‡(
hîe
.
›
 & 64) {

508 
°rm
->
msg
 = (*)"invalidÜiteral/length code";

509 
mode
 = 
BAD
;

514 
exåa
 = ()(
hîe
.
›
) & 31;

515 i‡(
exåa
 != 0) {

516 
	`NEEDBITS
(
exåa
);

517 
Àngth
 +
	`BITS
(
exåa
);

518 
	`DROPBITS
(
exåa
);

520 
	`Tø˚vv
((
°dîr
, "öÊ©e:Üígth %lu\n", 
Àngth
));

524 
hîe
 = 
di°code
[
	`BITS
(
di°bôs
)];

525 i‡(()(
hîe
.
bôs
) <= bits) ;

526 
	`PULLBYTE
();

528 i‡((
hîe
.
›
 & 0xf0) == 0) {

529 
œ°
 = 
hîe
;

531 
hîe
 = 
di°code
[
œ°
.
vÆ
 +

532 (
	`BITS
(
œ°
.
bôs
 +Üa°.
›
) >>Üast.bits)];

533 i‡(()(
œ°
.
bôs
 + 
hîe
.bits) <= bits) ;

534 
	`PULLBYTE
();

536 
	`DROPBITS
(
œ°
.
bôs
);

538 
	`DROPBITS
(
hîe
.
bôs
);

539 i‡(
hîe
.
›
 & 64) {

540 
°rm
->
msg
 = (*)"invalid distance code";

541 
mode
 = 
BAD
;

544 
off£t
 = ()
hîe
.
vÆ
;

547 
exåa
 = ()(
hîe
.
›
) & 15;

548 i‡(
exåa
 != 0) {

549 
	`NEEDBITS
(
exåa
);

550 
off£t
 +
	`BITS
(
exåa
);

551 
	`DROPBITS
(
exåa
);

553 i‡(
off£t
 > 
WSIZE
 - (
wøp
 ? 0: 
À·
)) {

554 
°rm
->
msg
 = (*)"invalid distanceÅoo far back";

555 
mode
 = 
BAD
;

558 
	`Tø˚vv
((
°dîr
, "öÊ©e: di°™˚ %lu\n", 
off£t
));

562 
	`ROOM
();

563 
c›y
 = 
WSIZE
 - 
off£t
;

564 i‡(
c›y
 < 
À·
) {

565 
‰om
 = 
put
 + 
c›y
;

566 
c›y
 = 
À·
 - copy;

569 
‰om
 = 
put
 - 
off£t
;

570 
c›y
 = 
À·
;

572 i‡(
c›y
 > 
Àngth
) copy =Üength;

573 
Àngth
 -
c›y
;

574 
À·
 -
c›y
;

576 *
put
++ = *
‰om
++;

577 } --
c›y
);

578 } 
Àngth
 != 0);

581 
DONE
:

583 
ªt
 = 
Z_STREAM_END
;

584 i‡(
À·
 < 
WSIZE
) {

585 i‡(
	`out
(
out_desc
, 
wödow
, ()(
WSIZE
 - 
À·
)))

586 
ªt
 = 
Z_BUF_ERROR
;

588 
öf_Àave
;

590 
BAD
:

591 
ªt
 = 
Z_DATA_ERROR
;

592 
öf_Àave
;

595 
ªt
 = 
Z_STREAM_ERROR
;

596 
öf_Àave
;

600 
öf_Àave
:

601 
°rm
->
√xt_ö
 = 
√xt
;

602 
°rm
->
avaû_ö
 = 
have
;

603  
ªt
;

604 
	}
}

606 
ZEXPORT
 
	$öÊ©eBack9End
(
°rm
)

607 
z_°ªam
 
FAR
 *
°rm
;

609 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 =Z_NULL || såm->
z‰ì
 =(
‰ì_func
)0)

610  
Z_STREAM_ERROR
;

611 
	`ZFREE
(
°rm
, såm->
°©e
);

612 
°rm
->
°©e
 = 
Z_NULL
;

613 
	`Tø˚v
((
°dîr
, "inflate:Énd\n"));

614  
Z_OK
;

615 
	}
}

	@zlib-1.2.8/contrib/infback9/infback9.h

19 #ifde‡
__˝lu•lus


23 
ZEXTERN
 
ZEXPORT
 
öÊ©eBack9
 
OF
((
z_°ªam
 
FAR
 *
°rm
,

24 
ö_func
 
ö
, 
FAR
 *
ö_desc
,

25 
out_func
 
out
, 
FAR
 *
out_desc
));

26 
ZEXTERN
 
ZEXPORT
 
öÊ©eBack9End
 
OF
((
z_°ªam
 
FAR
 *
°rm
));

27 
ZEXTERN
 
ZEXPORT
 
öÊ©eBack9Inô_
 
OF
((
z_°ªam
 
FAR
 *
°rm
,

28 
FAR
 *
wödow
,

29 c⁄° *
vîsi⁄
,

30 
°ªam_size
));

31 
	#öÊ©eBack9Inô
(
°rm
, 
wödow
) \

32 
	`öÊ©eBack9Inô_
((
°rm
), (
wödow
), \

33 
ZLIB_VERSION
, (
z_°ªam
))

	)

35 #ifde‡
__˝lu•lus


	@zlib-1.2.8/contrib/infback9/inffix9.h

10 c⁄° 
code
 
	gÀnfix
[512] = {

99 c⁄° 
code
 
	gdi°fix
[32] = {

	@zlib-1.2.8/contrib/infback9/inflate9.h

13 
	mTYPE
,

14 
	mSTORED
,

15 
	mTABLE
,

16 
	mLEN
,

17 
	mDONE
,

18 
	mBAD


19 } 
	töÊ©e_mode
;

35 
	söÊ©e_°©e
 {

37 
FAR
 *
	mwödow
;

39 
	mncode
;

40 
	m∆í
;

41 
	mndi°
;

42 
	mhave
;

43 
code
 
FAR
 *
	m√xt
;

44 
	mÀns
[320];

45 
	mw‹k
[288];

46 
code
 
	mcodes
[
ENOUGH
];

	@zlib-1.2.8/contrib/infback9/inftree9.c

6 
	~"zutû.h
"

7 
	~"ö·ªe9.h
"

9 
	#MAXBITS
 15

	)

11 c⁄° 
	göÊ©e9_c›yright
[] =

32 
	$öÊ©e_èbÀ9
(
ty≥
, 
Àns
, 
codes
, 
èbÀ
, 
bôs
, 
w‹k
)

33 
codëy≥
 
ty≥
;

34 
FAR
 *
Àns
;

35 
codes
;

36 
code
 
FAR
 * FAR *
èbÀ
;

37 
FAR
 *
bôs
;

38 
FAR
 *
w‹k
;

40 
Àn
;

41 
sym
;

42 
mö
, 
max
;

43 
roŸ
;

44 
cuº
;

45 
dr›
;

46 
À·
;

47 
u£d
;

48 
huff
;

49 
ö¸
;

50 
fûl
;

51 
low
;

52 
mask
;

53 
code
 
this
;

54 
code
 
FAR
 *
√xt
;

55 c⁄° 
FAR
 *
ba£
;

56 c⁄° 
FAR
 *
exåa
;

57 
íd
;

58 
cou¡
[
MAXBITS
+1];

59 
offs
[
MAXBITS
+1];

60 c⁄° 
lba£
[31] = {

64 c⁄° 
Àxt
[31] = {

68 c⁄° 
dba£
[32] = {

72 c⁄° 
dext
[32] = {

109 
Àn
 = 0;Üí <
MAXBITS
;Üen++)

110 
cou¡
[
Àn
] = 0;

111 
sym
 = 0; sym < 
codes
; sym++)

112 
cou¡
[
Àns
[
sym
]]++;

115 
roŸ
 = *
bôs
;

116 
max
 = 
MAXBITS
; max >= 1; max--)

117 i‡(
cou¡
[
max
] != 0) ;

118 i‡(
roŸ
 > 
max
)Ñoot = max;

119 i‡(
max
 == 0)  -1;

120 
mö
 = 1; mö <
MAXBITS
; min++)

121 i‡(
cou¡
[
mö
] != 0) ;

122 i‡(
roŸ
 < 
mö
)Ñoot = min;

125 
À·
 = 1;

126 
Àn
 = 1;Üí <
MAXBITS
;Üen++) {

127 
À·
 <<= 1;

128 
À·
 -
cou¡
[
Àn
];

129 i‡(
À·
 < 0)  -1;

131 i‡(
À·
 > 0 && (
ty≥
 =
CODES
 || 
max
 != 1))

135 
offs
[1] = 0;

136 
Àn
 = 1;Üí < 
MAXBITS
;Üen++)

137 
offs
[
Àn
 + 1] = offs[Àn] + 
cou¡
[len];

140 
sym
 = 0; sym < 
codes
; sym++)

141 i‡(
Àns
[
sym
] !0Ë
w‹k
[
offs
[lens[sym]]++] = ()sym;

175 
ty≥
) {

176 
CODES
:

177 
ba£
 = 
exåa
 = 
w‹k
;

178 
íd
 = 19;

180 
LENS
:

181 
ba£
 = 
lba£
;

182 
ba£
 -= 257;

183 
exåa
 = 
Àxt
;

184 
exåa
 -= 257;

185 
íd
 = 256;

188 
ba£
 = 
dba£
;

189 
exåa
 = 
dext
;

190 
íd
 = -1;

194 
huff
 = 0;

195 
sym
 = 0;

196 
Àn
 = 
mö
;

197 
√xt
 = *
èbÀ
;

198 
cuº
 = 
roŸ
;

199 
dr›
 = 0;

200 
low
 = ()(-1);

201 
u£d
 = 1U << 
roŸ
;

202 
mask
 = 
u£d
 - 1;

205 i‡((
ty≥
 =
LENS
 && 
u£d
 >
ENOUGH_LENS
) ||

206 (
ty≥
 =
DISTS
 && 
u£d
 >
ENOUGH_DISTS
))

212 
this
.
bôs
 = ()(
Àn
 - 
dr›
);

213 i‡(()(
w‹k
[
sym
]Ë< 
íd
) {

214 
this
.
›
 = ()0;

215 
this
.
vÆ
 = 
w‹k
[
sym
];

217 i‡(()(
w‹k
[
sym
]Ë> 
íd
) {

218 
this
.
›
 = ()(
exåa
[
w‹k
[
sym
]]);

219 
this
.
vÆ
 = 
ba£
[
w‹k
[
sym
]];

222 
this
.
›
 = ()(32 + 64);

223 
this
.
vÆ
 = 0;

227 
ö¸
 = 1U << (
Àn
 - 
dr›
);

228 
fûl
 = 1U << 
cuº
;

230 
fûl
 -
ö¸
;

231 
√xt
[(
huff
 >> 
dr›
Ë+ 
fûl
] = 
this
;

232 } 
fûl
 != 0);

235 
ö¸
 = 1U << (
Àn
 - 1);

236 
huff
 & 
ö¸
)

237 
ö¸
 >>= 1;

238 i‡(
ö¸
 != 0) {

239 
huff
 &
ö¸
 - 1;

240 
huff
 +
ö¸
;

243 
huff
 = 0;

246 
sym
++;

247 i‡(--(
cou¡
[
Àn
]) == 0) {

248 i‡(
Àn
 =
max
) ;

249 
Àn
 = 
Àns
[
w‹k
[
sym
]];

253 i‡(
Àn
 > 
roŸ
 && (
huff
 & 
mask
Ë!
low
) {

255 i‡(
dr›
 == 0)

256 
dr›
 = 
roŸ
;

259 
√xt
 +1U << 
cuº
;

262 
cuº
 = 
Àn
 - 
dr›
;

263 
À·
 = ()(1 << 
cuº
);

264 
cuº
 + 
dr›
 < 
max
) {

265 
À·
 -
cou¡
[
cuº
 + 
dr›
];

266 i‡(
À·
 <= 0) ;

267 
cuº
++;

268 
À·
 <<= 1;

272 
u£d
 +1U << 
cuº
;

273 i‡((
ty≥
 =
LENS
 && 
u£d
 >
ENOUGH_LENS
) ||

274 (
ty≥
 =
DISTS
 && 
u£d
 >
ENOUGH_DISTS
))

278 
low
 = 
huff
 & 
mask
;

279 (*
èbÀ
)[
low
].
›
 = ()
cuº
;

280 (*
èbÀ
)[
low
].
bôs
 = ()
roŸ
;

281 (*
èbÀ
)[
low
].
vÆ
 = ()(
√xt
 - *table);

292 
this
.
›
 = ()64;

293 
this
.
bôs
 = ()(
Àn
 - 
dr›
);

294 
this
.
vÆ
 = ()0;

295 
huff
 != 0) {

297 i‡(
dr›
 !0 && (
huff
 & 
mask
Ë!
low
) {

298 
dr›
 = 0;

299 
Àn
 = 
roŸ
;

300 
√xt
 = *
èbÀ
;

301 
cuº
 = 
roŸ
;

302 
this
.
bôs
 = ()
Àn
;

306 
√xt
[
huff
 >> 
dr›
] = 
this
;

309 
ö¸
 = 1U << (
Àn
 - 1);

310 
huff
 & 
ö¸
)

311 
ö¸
 >>= 1;

312 i‡(
ö¸
 != 0) {

313 
huff
 &
ö¸
 - 1;

314 
huff
 +
ö¸
;

317 
huff
 = 0;

321 *
èbÀ
 +
u£d
;

322 *
bôs
 = 
roŸ
;

324 
	}
}

	@zlib-1.2.8/contrib/infback9/inftree9.h

25 
	m›
;

26 
	mbôs
;

27 
	mvÆ
;

28 } 
	tcode
;

48 
	#ENOUGH_LENS
 852

	)

49 
	#ENOUGH_DISTS
 594

	)

50 
	#ENOUGH
 (
ENOUGH_LENS
+
ENOUGH_DISTS
)

	)

54 
	mCODES
,

55 
	mLENS
,

56 
	mDISTS


57 } 
	tcodëy≥
;

59 
öÊ©e_èbÀ9
 
OF
((
codëy≥
 
ty≥
, 
FAR
 *
Àns
,

60 
codes
, 
code
 
FAR
 * FAR *
èbÀ
,

61 
FAR
 *
bôs
, FAR *
w‹k
));

	@zlib-1.2.8/contrib/inflate86/inffas86.c

29 
	~"zutû.h
"

30 
	~"ö·ªes.h
"

31 
	~"öÊ©e.h
"

32 
	~"öfÁ°.h
"

71 
	$öÊ©e_Á°
(
°rm
, 
°¨t
)

72 
z_°ªamp
 
°rm
;

73 
°¨t
;

75 
öÊ©e_°©e
 
FAR
 *
°©e
;

76 
	söfÁ°_¨
 {

79  *
e•
;

80  *
ebp
;

81  
FAR
 *
ö
;

82  
FAR
 *
œ°
;

83  
FAR
 *
out
;

84  
FAR
 *
beg
;

85  
FAR
 *
íd
;

86  
FAR
 *
wödow
;

87  
code
 c⁄° 
FAR
 *
lcode
;

88  
code
 c⁄° 
FAR
 *
dcode
;

89  
hﬁd
;

90  
bôs
;

91  
wsize
;

92  
wrôe
;

93  
lmask
;

94  
dmask
;

95  
Àn
;

96  
di°
;

97  
°©us
;

98 } 
¨
;

100 #i‡
	`deföed
–
__GNUC__
 ) && deföed–
__amd64__
 ) && ! deföed–
__i386
 )

101 
	#PAD_AVAIL_IN
 6

	)

102 
	#PAD_AVAIL_OUT
 258

	)

104 
	#PAD_AVAIL_IN
 5

	)

105 
	#PAD_AVAIL_OUT
 257

	)

109 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
°rm
->state;

110 
¨
.
ö
 = 
°rm
->
√xt_ö
;

111 
¨
.
œ°
 =ár.
ö
 + (
°rm
->
avaû_ö
 - 
PAD_AVAIL_IN
);

112 
¨
.
out
 = 
°rm
->
√xt_out
;

113 
¨
.
beg
 =ár.
out
 - (
°¨t
 - 
°rm
->
avaû_out
);

114 
¨
.
íd
 =ár.
out
 + (
°rm
->
avaû_out
 - 
PAD_AVAIL_OUT
);

115 
¨
.
wsize
 = 
°©e
->wsize;

116 
¨
.
wrôe
 = 
°©e
->
w√xt
;

117 
¨
.
wödow
 = 
°©e
->window;

118 
¨
.
hﬁd
 = 
°©e
->hold;

119 
¨
.
bôs
 = 
°©e
->bits;

120 
¨
.
lcode
 = 
°©e
->
Àncode
;

121 
¨
.
dcode
 = 
°©e
->
di°code
;

122 
¨
.
lmask
 = (1U << 
°©e
->
Ànbôs
) - 1;

123 
¨
.
dmask
 = (1U << 
°©e
->
di°bôs
) - 1;

129 (()(*)
¨
.
ö
 & (◊r.
hﬁd
) / 2 - 1)) != 0) {

130 
¨
.
hﬁd
 +()*¨.
ö
++ <<ár.
bôs
;

131 
¨
.
bôs
 += 8;

134 #i‡
	`deföed
–
__GNUC__
 ) && deföed–
__amd64__
 ) && ! deföed–
__i386
 )

135 
__asm__
 
	`__vﬁ©ûe__
 (

466 : "m" (
¨
)

470 #ñi‡–
	`deföed
–
__GNUC__
 ) || deföed–
__ICC
 ) ) && deföed–
__i386
 )

471 
__asm__
 
	`__vﬁ©ûe__
 (

794 : "m" (
¨
)

797 #ñi‡
	`deföed
–
_MSC_VER
 ) && ! deföed–
_M_AMD64
 )

798 
__asm
 {

799 
Àa
 
óx
, 
¨


800 
mov
 [
óx
], 
e•


801 
mov
 [
óx
+4], 
ebp


802 
mov
 
e•
, 
óx


803 
mov
 
esi
, [
e•
+8]

804 
mov
 
edi
, [
e•
+16]

805 
mov
 
edx
, [
e•
+40]

806 
mov
 
ebx
, [
e•
+44]

807 
mov
 
ebp
, [
e•
+32]

809 
˛d


810 
jmp
 
L_do_lo›


812 
ALIGN
 4

813 
L_whûe_ã°
:

814 
cmp
 [
e•
+24], 
edi


815 
jbe
 
L_bªak_lo›


816 
cmp
 [
e•
+12], 
esi


817 
jbe
 
L_bªak_lo›


819 
L_do_lo›
:

820 
cmp
 
bl
, 15

821 
ja
 
L_gë_Àngth_code


823 
x‹
 
óx
,Éax

824 
lodsw


825 
mov
 
˛
, 
bl


826 
add
 
bl
, 16

827 
shl
 
óx
, 
˛


828 
‹
 
edx
, 
óx


830 
L_gë_Àngth_code
:

831 
mov
 
óx
, [
e•
+56]

832 
™d
 
óx
, 
edx


833 
mov
 
óx
, [
ebp
+eax*4]

835 
L_dﬁí
:

836 
mov
 
˛
, 
ah


837 
sub
 
bl
, 
ah


838 
shr
 
edx
, 
˛


840 
ã°
 
Æ
,ál

841 
jnz
 
L_ã°_f‹_Àngth_ba£


843 
shr
 
óx
, 16

844 
°osb


845 
jmp
 
L_whûe_ã°


847 
ALIGN
 4

848 
L_ã°_f‹_Àngth_ba£
:

849 
mov
 
ecx
, 
óx


850 
shr
 
ecx
, 16

851 
mov
 [
e•
+64], 
ecx


852 
mov
 
˛
, 
Æ


854 
ã°
 
Æ
, 16

855 
jz
 
L_ã°_f‹_£c⁄d_Àvñ_Àngth


856 
™d
 
˛
, 15

857 
jz
 
L_decode_di°™˚


858 
cmp
 
bl
, 
˛


859 
j´
 
L_add_bôs_to_Àn


861 
mov
 
ch
, 
˛


862 
x‹
 
óx
,Éax

863 
lodsw


864 
mov
 
˛
, 
bl


865 
add
 
bl
, 16

866 
shl
 
óx
, 
˛


867 
‹
 
edx
, 
óx


868 
mov
 
˛
, 
ch


870 
L_add_bôs_to_Àn
:

871 
sub
 
bl
, 
˛


872 
x‹
 
óx
,Éax

873 
öc
 
óx


874 
shl
 
óx
, 
˛


875 
dec
 
óx


876 
™d
 
óx
, 
edx


877 
shr
 
edx
, 
˛


878 
add
 [
e•
+64], 
óx


880 
L_decode_di°™˚
:

881 
cmp
 
bl
, 15

882 
ja
 
L_gë_di°™˚_code


884 
x‹
 
óx
,Éax

885 
lodsw


886 
mov
 
˛
, 
bl


887 
add
 
bl
, 16

888 
shl
 
óx
, 
˛


889 
‹
 
edx
, 
óx


891 
L_gë_di°™˚_code
:

892 
mov
 
óx
, [
e•
+60]

893 
mov
 
ecx
, [
e•
+36]

894 
™d
 
óx
, 
edx


895 
mov
 
óx
, [
ecx
+eax*4]

897 
L_dodi°
:

898 
mov
 
ebp
, 
óx


899 
shr
 
ebp
, 16

900 
mov
 
˛
, 
ah


901 
sub
 
bl
, 
ah


902 
shr
 
edx
, 
˛


903 
mov
 
˛
, 
Æ


905 
ã°
 
Æ
, 16

906 
jz
 
L_ã°_f‹_£c⁄d_Àvñ_di°


907 
™d
 
˛
, 15

908 
jz
 
L_check_di°_⁄e


909 
cmp
 
bl
, 
˛


910 
j´
 
L_add_bôs_to_di°


912 
mov
 
ch
, 
˛


913 
x‹
 
óx
,Éax

914 
lodsw


915 
mov
 
˛
, 
bl


916 
add
 
bl
, 16

917 
shl
 
óx
, 
˛


918 
‹
 
edx
, 
óx


919 
mov
 
˛
, 
ch


921 
L_add_bôs_to_di°
:

922 
sub
 
bl
, 
˛


923 
x‹
 
óx
,Éax

924 
öc
 
óx


925 
shl
 
óx
, 
˛


926 
dec
 
óx


927 
™d
 
óx
, 
edx


928 
shr
 
edx
, 
˛


929 
add
 
ebp
, 
óx


931 
L_check_wödow
:

932 
mov
 [
e•
+8], 
esi


933 
mov
 
óx
, 
edi


934 
sub
 
óx
, [
e•
+20]

936 
cmp
 
óx
, 
ebp


937 
jb
 
L_˛ù_wödow


939 
mov
 
ecx
, [
e•
+64]

940 
mov
 
esi
, 
edi


941 
sub
 
esi
, 
ebp


943 
ßr
 
ecx
, 1

944 
jnc
 
L_c›y_two


946 
ªp
 
movsw


947 
mov
 
Æ
, [
esi
]

948 
mov
 [
edi
], 
Æ


949 
öc
 
edi


951 
mov
 
esi
, [
e•
+8]

952 
mov
 
ebp
, [
e•
+32]

953 
jmp
 
L_whûe_ã°


955 
L_c›y_two
:

956 
ªp
 
movsw


957 
mov
 
esi
, [
e•
+8]

958 
mov
 
ebp
, [
e•
+32]

959 
jmp
 
L_whûe_ã°


961 
ALIGN
 4

962 
L_check_di°_⁄e
:

963 
cmp
 
ebp
, 1

964 
j√
 
L_check_wödow


965 
cmp
 [
e•
+20], 
edi


966 
je
 
L_check_wödow


968 
mov
 
ecx
, [
e•
+64]

969 
mov
 
Æ
, [
edi
-1]

970 
mov
 
ah
, 
Æ


972 
ßr
 
ecx
, 1

973 
jnc
 
L_£t_two


974 
mov
 [
edi
], 
Æ


975 
öc
 
edi


977 
L_£t_two
:

978 
ªp
 
°osw


979 
mov
 
ebp
, [
e•
+32]

980 
jmp
 
L_whûe_ã°


982 
ALIGN
 4

983 
L_ã°_f‹_£c⁄d_Àvñ_Àngth
:

984 
ã°
 
Æ
, 64

985 
jnz
 
L_ã°_f‹_íd_of_block


987 
x‹
 
óx
,Éax

988 
öc
 
óx


989 
shl
 
óx
, 
˛


990 
dec
 
óx


991 
™d
 
óx
, 
edx


992 
add
 
óx
, [
e•
+64]

993 
mov
 
óx
, [
ebp
+eax*4]

994 
jmp
 
L_dﬁí


996 
ALIGN
 4

997 
L_ã°_f‹_£c⁄d_Àvñ_di°
:

998 
ã°
 
Æ
, 64

999 
jnz
 
L_övÆid_di°™˚_code


1001 
x‹
 
óx
,Éax

1002 
öc
 
óx


1003 
shl
 
óx
, 
˛


1004 
dec
 
óx


1005 
™d
 
óx
, 
edx


1006 
add
 
óx
, 
ebp


1007 
mov
 
ecx
, [
e•
+36]

1008 
mov
 
óx
, [
ecx
+eax*4]

1009 
jmp
 
L_dodi°


1011 
ALIGN
 4

1012 
L_˛ù_wödow
:

1013 
mov
 
ecx
, 
óx


1014 
mov
 
óx
, [
e•
+48]

1015 
√g
 
ecx


1016 
mov
 
esi
, [
e•
+28]

1018 
cmp
 
óx
, 
ebp


1019 
jb
 
L_övÆid_di°™˚_too_Ár


1021 
add
 
ecx
, 
ebp


1022 
cmp
 
dw‹d
 
±r
 [
e•
+52], 0

1023 
j√
 
L_wøp_¨ound_wödow


1025 
sub
 
óx
, 
ecx


1026 
add
 
esi
, 
óx


1028 
mov
 
óx
, [
e•
+64]

1029 
cmp
 
óx
, 
ecx


1030 
jbe
 
L_do_c›y


1032 
sub
 
óx
, 
ecx


1033 
ªp
 
movsb


1034 
mov
 
esi
, 
edi


1035 
sub
 
esi
, 
ebp


1036 
jmp
 
L_do_c›y


1038 
ALIGN
 4

1039 
L_wøp_¨ound_wödow
:

1040 
mov
 
óx
, [
e•
+52]

1041 
cmp
 
ecx
, 
óx


1042 
jbe
 
L_c⁄tiguous_ö_wödow


1044 
add
 
esi
, [
e•
+48]

1045 
add
 
esi
, 
óx


1046 
sub
 
esi
, 
ecx


1047 
sub
 
ecx
, 
óx


1049 
mov
 
óx
, [
e•
+64]

1050 
cmp
 
óx
, 
ecx


1051 
jbe
 
L_do_c›y


1053 
sub
 
óx
, 
ecx


1054 
ªp
 
movsb


1055 
mov
 
esi
, [
e•
+28]

1056 
mov
 
ecx
, [
e•
+52]

1057 
cmp
 
óx
, 
ecx


1058 
jbe
 
L_do_c›y


1060 
sub
 
óx
, 
ecx


1061 
ªp
 
movsb


1062 
mov
 
esi
, 
edi


1063 
sub
 
esi
, 
ebp


1064 
jmp
 
L_do_c›y


1066 
ALIGN
 4

1067 
L_c⁄tiguous_ö_wödow
:

1068 
add
 
esi
, 
óx


1069 
sub
 
esi
, 
ecx


1071 
mov
 
óx
, [
e•
+64]

1072 
cmp
 
óx
, 
ecx


1073 
jbe
 
L_do_c›y


1075 
sub
 
óx
, 
ecx


1076 
ªp
 
movsb


1077 
mov
 
esi
, 
edi


1078 
sub
 
esi
, 
ebp


1079 
jmp
 
L_do_c›y


1081 
ALIGN
 4

1082 
L_do_c›y
:

1083 
mov
 
ecx
, 
óx


1084 
ªp
 
movsb


1086 
mov
 
esi
, [
e•
+8]

1087 
mov
 
ebp
, [
e•
+32]

1088 
jmp
 
L_whûe_ã°


1090 
L_ã°_f‹_íd_of_block
:

1091 
ã°
 
Æ
, 32

1092 
jz
 
L_övÆid_lôîÆ_Àngth_code


1093 
mov
 
dw‹d
 
±r
 [
e•
+72], 1

1094 
jmp
 
L_bªak_lo›_wôh_°©us


1096 
L_övÆid_lôîÆ_Àngth_code
:

1097 
mov
 
dw‹d
 
±r
 [
e•
+72], 2

1098 
jmp
 
L_bªak_lo›_wôh_°©us


1100 
L_övÆid_di°™˚_code
:

1101 
mov
 
dw‹d
 
±r
 [
e•
+72], 3

1102 
jmp
 
L_bªak_lo›_wôh_°©us


1104 
L_övÆid_di°™˚_too_Ár
:

1105 
mov
 
esi
, [
e•
+4]

1106 
mov
 
dw‹d
 
±r
 [
e•
+72], 4

1107 
jmp
 
L_bªak_lo›_wôh_°©us


1109 
L_bªak_lo›
:

1110 
mov
 
dw‹d
 
±r
 [
e•
+72], 0

1112 
L_bªak_lo›_wôh_°©us
:

1114 
mov
 [
e•
+8], 
esi


1115 
mov
 [
e•
+16], 
edi


1116 
mov
 [
e•
+44], 
ebx


1117 
mov
 [
e•
+40], 
edx


1118 
mov
 
ebp
, [
e•
+4]

1119 
mov
 
e•
, [esp]

1125 i‡(
¨
.
°©us
 > 1) {

1126 i‡(
¨
.
°©us
 == 2)

1127 
°rm
->
msg
 = "invalidÜiteral/length code";

1128 i‡(
¨
.
°©us
 == 3)

1129 
°rm
->
msg
 = "invalid distance code";

1131 
°rm
->
msg
 = "invalid distanceÅoo far back";

1132 
°©e
->
mode
 = 
BAD
;

1134 i‡–
¨
.
°©us
 == 1 ) {

1135 
°©e
->
mode
 = 
TYPE
;

1139 
¨
.
Àn
 =ár.
bôs
 >> 3;

1140 
¨
.
ö
 -¨.
Àn
;

1141 
¨
.
bôs
 -¨.
Àn
 << 3;

1142 
¨
.
hﬁd
 &(1U <<ár.
bôs
) - 1;

1145 
°rm
->
√xt_ö
 = 
¨
.
ö
;

1146 
°rm
->
√xt_out
 = 
¨
.
out
;

1147 
°rm
->
avaû_ö
 = ()(
¨
.
ö
 <ár.
œ°
 ?

1148 
PAD_AVAIL_IN
 + (
¨
.
œ°
 -ár.
ö
) :

1149 
PAD_AVAIL_IN
 - (
¨
.
ö
 -ár.
œ°
));

1150 
°rm
->
avaû_out
 = ()(
¨
.
out
 <ár.
íd
 ?

1151 
PAD_AVAIL_OUT
 + (
¨
.
íd
 -ár.
out
) :

1152 
PAD_AVAIL_OUT
 - (
¨
.
out
 -ár.
íd
));

1153 
°©e
->
hﬁd
 = 
¨
.hold;

1154 
°©e
->
bôs
 = 
¨
.bits;

1156 
	}
}

	@zlib-1.2.8/contrib/iostream/test.cpp

2 
	~"zf°ªam.h
"

4 
	$maö
() {

8 
gzof°ªam
 
	`os
–1, 
ios
::
out
 );

12 
os
 << "Hñlo, Mommy" << 
ídl
;

14 
os
 << 
	`£tcom¥essi⁄Àvñ
–
Z_NO_COMPRESSION
 );

15 
os
 << "hñlo, hñlo, hi, ho!" << 
ídl
;

17 
	`£tcom¥essi⁄Àvñ
–
os
, 
Z_DEFAULT_COMPRESSION
 )

18 << "I'm com¥essögágaö" << 
ídl
;

20 
os
.
	`˛o£
();

24 
	}
}

	@zlib-1.2.8/contrib/iostream/zfstream.cpp

2 
	~"zf°ªam.h
"

4 
	ggzfûebuf
::
	$gzfûebuf
() :

5 
	`fûe
(
NULL
),

6 
	`mode
(0),

7 
	$own_fûe_des¸ùt‹
(0)

8 { 
	}
}

10 
	ggzfûebuf
::~
	$gzfûebuf
() {

12 
	`sync
();

13 i‡–
own_fûe_des¸ùt‹
 )

14 
	`˛o£
();

16 
	}
}

18 
gzfûebuf
 *
	ggzfûebuf
::
	$›í
–c⁄° *
«me
,

19 
io_mode
 ) {

21 i‡–
	`is_›í
() )

22  
NULL
;

24 
ch¨_mode
[10];

25 *
p
 = 
ch¨_mode
;

27 i‡–
io_mode
 & 
ios
::
ö
 ) {

28 
mode
 = 
ios
::
ö
;

29 *
p
++ = 'r';

30 } i‡–
io_mode
 & 
ios
::
≠p
 ) {

31 
mode
 = 
ios
::
≠p
;

32 *
p
++ = 'a';

34 
mode
 = 
ios
::
out
;

35 *
p
++ = 'w';

38 i‡–
io_mode
 & 
ios
::
bö¨y
 ) {

39 
mode
 |
ios
::
bö¨y
;

40 *
p
++ = 'b';

44 i‡–
io_mode
 & (
ios
::
out
|ios::
≠p
 )) {

45 *
p
++ = '9';

49 *
p
 = '\0';

51 i‡–(
fûe
 = 
	`gz›í
(
«me
, 
ch¨_mode
)Ë=
NULL
 )

52  
NULL
;

54 
own_fûe_des¸ùt‹
 = 1;

56  
this
;

58 
	}
}

60 
gzfûebuf
 *
	ggzfûebuf
::
	$©èch
–
fûe_des¸ùt‹
,

61 
io_mode
 ) {

63 i‡–
	`is_›í
() )

64  
NULL
;

66 
ch¨_mode
[10];

67 *
p
 = 
ch¨_mode
;

69 i‡–
io_mode
 & 
ios
::
ö
 ) {

70 
mode
 = 
ios
::
ö
;

71 *
p
++ = 'r';

72 } i‡–
io_mode
 & 
ios
::
≠p
 ) {

73 
mode
 = 
ios
::
≠p
;

74 *
p
++ = 'a';

76 
mode
 = 
ios
::
out
;

77 *
p
++ = 'w';

80 i‡–
io_mode
 & 
ios
::
bö¨y
 ) {

81 
mode
 |
ios
::
bö¨y
;

82 *
p
++ = 'b';

86 i‡–
io_mode
 & (
ios
::
out
|ios::
≠p
 )) {

87 *
p
++ = '9';

91 *
p
 = '\0';

93 i‡–(
fûe
 = 
	`gzd›í
(
fûe_des¸ùt‹
, 
ch¨_mode
)Ë=
NULL
 )

94  
NULL
;

96 
own_fûe_des¸ùt‹
 = 0;

98  
this
;

100 
	}
}

102 
gzfûebuf
 *
	ggzfûebuf
::
	$˛o£
() {

104 i‡–
	`is_›í
() ) {

106 
	`sync
();

107 
	`gz˛o£
–
fûe
 );

108 
fûe
 = 
NULL
;

112  
this
;

114 
	}
}

116 
	ggzfûebuf
::
	$£tcom¥essi⁄Àvñ
–
comp_Àvñ
 ) {

118  
	`gz£ç¨ams
(
fûe
, 
comp_Àvñ
, -2);

120 
	}
}

122 
	ggzfûebuf
::
	$£tcom¥essi⁄°øãgy
–
comp_°øãgy
 ) {

124  
	`gz£ç¨ams
(
fûe
, -2, 
comp_°øãgy
);

126 
	}
}

129 
°ªampos
 
	ggzfûebuf
::
£ekoff
–
°ªamoff
 
off
, 
ios
::
£ek_dú
 
dú
, 
which
 ) {

131  
°ªampos
(
EOF
);

135 
	ggzfûebuf
::
	$undîÊow
() {

138 i‡–!
	`is_›í
(Ë|| !(
mode
 & 
ios
::
ö
) )

139  
EOF
;

142 i‡–!
	`ba£
() ) {

144 i‡–(
	`Æloˇã
()Ë=
EOF
 )

145  
EOF
;

146 
	`£ç
(0,0);

150 i‡–
	`ö_avaû
() )

151  (Ë*
	`g±r
();

153 i‡–
	`out_waôög
() ) {

154 i‡–
	`Êushbuf
(Ë=
EOF
 )

155  
EOF
;

162 
ªsu…
 = 
	`fûlbuf
();

163 i‡–
ªsu…
 =
EOF
 ) {

165 
	`£tg
(0,0,0);

166  
EOF
;

169  (Ë*
	`g±r
();

171 
	}
}

173 
	ggzfûebuf
::
	$ovîÊow
–
c
 ) {

175 i‡–!
	`is_›í
(Ë|| !(
mode
 & 
ios
::
out
) )

176  
EOF
;

178 i‡–!
	`ba£
() ) {

179 i‡–
	`Æloˇã
(Ë=
EOF
 )

180  
EOF
;

181 
	`£tg
(0,0,0);

183 i‡(
	`ö_avaû
()) {

184  
EOF
;

186 i‡(
	`out_waôög
()) {

187 i‡(
	`Êushbuf
(Ë=
EOF
)

188  
EOF
;

192 
bl
 = 
	`bÀn
();

193 
	`£ç
–
	`ba£
(), ba£(Ë+ 
bl
);

195 i‡–
c
 !
EOF
 ) {

197 *
	`µå
(Ë
c
;

198 
	`pbump
(1);

204 
	}
}

206 
	ggzfûebuf
::
	$sync
() {

208 i‡–!
	`is_›í
() )

209  
EOF
;

211 i‡–
	`out_waôög
() )

212  
	`Êushbuf
();

216 
	}
}

218 
	ggzfûebuf
::
	$Êushbuf
() {

220 
n
;

221 *
q
;

223 
q
 = 
	`pba£
();

224 
n
 = 
	`µå
(Ë- 
q
;

226 i‡–
	`gzwrôe
–
fûe
, 
q
, 
n
) <Ç )

227  
EOF
;

229 
	`£ç
(0,0);

233 
	}
}

235 
	ggzfûebuf
::
	$fûlbuf
() {

237 
ªquúed
;

238 *
p
;

240 
p
 = 
	`ba£
();

242 
ªquúed
 = 
	`bÀn
();

244 
t
 = 
	`gzªad
–
fûe
, 
p
, 
ªquúed
 );

246 i‡–
t
 <0Ë 
EOF
;

248 
	`£tg
–
	`ba£
(), ba£(), ba£()+
t
);

250  
t
;

252 
	}
}

254 
	ggzfûe°ªam_comm⁄
::
	$gzfûe°ªam_comm⁄
() :

255 
	`ios
–
gzfûe°ªam_comm⁄
::
	$rdbuf
() )

256 { 
	}
}

258 
gzfûe°ªam_comm⁄
::~
	$gzfûe°ªam_comm⁄
()

259 { 
	}
}

261 
gzfûe°ªam_comm⁄
::
	$©èch
–
fd
, 
io_mode
 ) {

263 i‡–!
buf„r
.
	`©èch
–
fd
, 
io_mode
) )

264 
	`˛ór
–
ios
::
Áûbô
 | ios::
badbô
 );

266 
	`˛ór
();

268 
	}
}

270 
	ggzfûe°ªam_comm⁄
::
	$›í
–c⁄° *
«me
, 
io_mode
 ) {

272 i‡–!
buf„r
.
	`›í
–
«me
, 
io_mode
 ) )

273 
	`˛ór
–
ios
::
Áûbô
 | ios::
badbô
 );

275 
	`˛ór
();

277 
	}
}

279 
	ggzfûe°ªam_comm⁄
::
	$˛o£
() {

281 i‡–!
buf„r
.
	`˛o£
() )

282 
	`˛ór
–
ios
::
Áûbô
 | ios::
badbô
 );

284 
	}
}

286 
gzfûebuf
 *
	ggzfûe°ªam_comm⁄
::
	$rdbuf
()

288  &
buf„r
;

289 
	}
}

291 
	ggzif°ªam
::
	$gzif°ªam
() :

292 
	`ios
–
gzfûe°ªam_comm⁄
::
	$rdbuf
() )

294 
	`˛ór
–
ios
::
badbô
 );

295 
	}
}

297 
	ggzif°ªam
::
	$gzif°ªam
–c⁄° *
«me
, 
io_mode
 ) :

298 
	`ios
–
gzfûe°ªam_comm⁄
::
	$rdbuf
() )

300 
gzfûe°ªam_comm⁄
::
	`›í
–
«me
, 
io_mode
 );

301 
	}
}

303 
	ggzif°ªam
::
	$gzif°ªam
–
fd
, 
io_mode
 ) :

304 
	`ios
–
gzfûe°ªam_comm⁄
::
	$rdbuf
() )

306 
gzfûe°ªam_comm⁄
::
	`©èch
–
fd
, 
io_mode
 );

307 
	}
}

309 
	ggzif°ªam
::~
	$gzif°ªam
(Ë{ 
	}
}

311 
gzof°ªam
::
	$gzof°ªam
() :

312 
	`ios
–
gzfûe°ªam_comm⁄
::
	$rdbuf
() )

314 
	`˛ór
–
ios
::
badbô
 );

315 
	}
}

317 
	ggzof°ªam
::
	$gzof°ªam
–c⁄° *
«me
, 
io_mode
 ) :

318 
	`ios
–
gzfûe°ªam_comm⁄
::
	$rdbuf
() )

320 
gzfûe°ªam_comm⁄
::
	`›í
–
«me
, 
io_mode
 );

321 
	}
}

323 
	ggzof°ªam
::
	$gzof°ªam
–
fd
, 
io_mode
 ) :

324 
	`ios
–
gzfûe°ªam_comm⁄
::
	$rdbuf
() )

326 
gzfûe°ªam_comm⁄
::
	`©èch
–
fd
, 
io_mode
 );

327 
	}
}

329 
	ggzof°ªam
::~
	$gzof°ªam
(Ë{ 
	}
}

	@zlib-1.2.8/contrib/iostream/zfstream.h

2 #i‚de‡
zf°ªam_h


3 
	#zf°ªam_h


	)

5 
	~<f°ªam.h
>

6 
	~"zlib.h
"

8 ˛as†
	cgzfûebuf
 : 
public
 
°ªambuf
 {

10 
public
:

12 
gzfûebuf
( );

13 
	mvútuÆ
 ~
gzfûebuf
();

15 
gzfûebuf
 *
›í
–c⁄° *
«me
, 
io_mode
 );

16 
gzfûebuf
 *
©èch
–
fûe_des¸ùt‹
, 
io_mode
 );

17 
gzfûebuf
 *
˛o£
();

19 
£tcom¥essi⁄Àvñ
–
comp_Àvñ
 );

20 
£tcom¥essi⁄°øãgy
–
comp_°øãgy
 );

22 
ölöe
 
	$is_›í
(Ëc⁄° {  (
fûe
 !=
NULL
); }

24 
vútuÆ
 
°ªampos
 
	`£ekoff
–
°ªamoff
, 
ios
::
£ek_dú
, );

26 
vútuÆ
 
	`sync
();

28 
¥Ÿe˘ed
:

30 
vútuÆ
 
	`undîÊow
();

31 
vútuÆ
 
	`ovîÊow
–
EOF
 );

33 
¥iv©e
:

35 
gzFûe
 
fûe
;

36 
mode
;

37 
own_fûe_des¸ùt‹
;

39 
	`Êushbuf
();

40 
	`fûlbuf
();

42 
	}
};

44 ˛as†
	cgzfûe°ªam_comm⁄
 : 
vútuÆ
 
public
 
ios
 {

46 
‰õnd
 
˛ass
 
gzif°ªam
;

47 
‰õnd
 
˛ass
 
	mgzof°ªam
;

48 
‰õnd
 
	mgzof°ªam
 &
£tcom¥essi⁄Àvñ
–
gzof°ªam
 &, );

49 
‰õnd
 
	mgzof°ªam
 &
£tcom¥essi⁄°øãgy
–
gzof°ªam
 &, );

51 
	mpublic
:

52 
vútuÆ
 ~
gzfûe°ªam_comm⁄
();

54 
©èch
–
fd
, 
io_mode
 );

55 
›í
–c⁄° *
«me
, 
io_mode
 );

56 
˛o£
();

58 
	m¥Ÿe˘ed
:

59 
gzfûe°ªam_comm⁄
();

61 
	m¥iv©e
:

62 
gzfûebuf
 *
rdbuf
();

64 
gzfûebuf
 
	mbuf„r
;

68 
˛ass
 
	ggzif°ªam
 : 
public
 
gzfûe°ªam_comm⁄
,Öubli¯
	gi°ªam
 {

70 
	gpublic
:

72 
gzif°ªam
();

73 
gzif°ªam
–c⁄° *
«me
, 
io_mode
 = 
ios
::
ö
 );

74 
gzif°ªam
–
fd
, 
io_mode
 = 
ios
::
ö
 );

76 
	gvútuÆ
 ~
gzif°ªam
();

80 
˛ass
 
	ggzof°ªam
 : 
public
 
gzfûe°ªam_comm⁄
,Öubli¯
	go°ªam
 {

82 
	gpublic
:

84 
gzof°ªam
();

85 
gzof°ªam
–c⁄° *
«me
, 
io_mode
 = 
ios
::
out
 );

86 
gzof°ªam
–
fd
, 
io_mode
 = 
ios
::
out
 );

88 
	gvútuÆ
 ~
gzof°ªam
();

92 
	gãm∂©e
<
˛ass
 
	gT
> cœs†
	cgzom™ù
 {

93 
‰õnd
 
	mgzof°ªam
 &
	m›î©‹
<<(gzof°ªam &, c⁄° 
	mgzom™ù
<
	mT
> &);

94 
	mpublic
:

95 
gzom™ù
(
gzof°ªam
 &(*
f
)(gzof°ªam &, 
T
), T 
v
Ë: 
func
(f), 
	$vÆ
(
v
) { }

96 
¥iv©e
:

97 
gzof°ªam
 &(*
func
)(gzof°ªam &, 
T
);

98 
T
 
vÆ
;

99 
	}
};

101 
	gãm∂©e
<
˛ass
 
	gT
> 
	ggzof°ªam
 &
	g›î©‹
<<(gzof°ªam &
	gs
, c⁄° 
	ggzom™ù
<T> &
	gm
)

103  (*
	gm
.
	gfunc
)(
	gs
, m.
	gvÆ
);

106 
ölöe
 
	ggzof°ªam
 &
	$£tcom¥essi⁄Àvñ
–
gzof°ªam
 &
s
, 
l
 )

108 (
s
.
	`rdbuf
())->
	`£tcom¥essi⁄Àvñ
(
l
);

109  
s
;

110 
	}
}

112 
ölöe
 
	ggzof°ªam
 &
	$£tcom¥essi⁄°øãgy
–
gzof°ªam
 &
s
, 
l
 )

114 (
s
.
	`rdbuf
())->
	`£tcom¥essi⁄°øãgy
(
l
);

115  
s
;

116 
	}
}

118 
ölöe
 
	ggzom™ù
<> 
	$£tcom¥essi⁄Àvñ
(
l
)

120  
gzom™ù
<>(&
£tcom¥essi⁄Àvñ
,
l
);

121 
	}
}

123 
ölöe
 
	ggzom™ù
<> 
	$£tcom¥essi⁄°øãgy
(
l
)

125  
gzom™ù
<>(&
£tcom¥essi⁄°øãgy
,
l
);

126 
	}
}

	@zlib-1.2.8/contrib/iostream2/zstream.h

19 #i‚de‡
ZSTREAM__H


20 
	#ZSTREAM__H


	)

27 
	~<°r°ªam.h
>

28 
	~<°rög.h
>

29 
	~<°dio.h
>

30 
	~"zlib.h
"

32 #i‡
deföed
(
_WIN32
)

33 
	~<f˙é.h
>

34 
	~<io.h
>

35 
	#SET_BINARY_MODE
(
fûe
Ë
	`£tmode
(
	`fûío
(fûe), 
O_BINARY
)

	)

37 
	#SET_BINARY_MODE
(
fûe
)

	)

40 ˛as†
	cz°rögÀn
 {

41 
	mpublic
:

42 
z°rögÀn
(
˛ass
 
iz°ªam
&);

43 
z°rögÀn
(
˛ass
 
oz°ªam
&, const *);

44 
size_t
 
	$vÆue
(Ëc⁄° {  
vÆ
.
w‹d
; }

45 
¥iv©e
:

46 
	sVÆ
 { 
byã
; 
size_t
 
w‹d
; 
	}
} 
	gvÆ
;

51 ˛as†
	ciz°ªam


53 
	mpublic
:

54 
	$iz°ªam
(Ë: 
	$m_Â
(0) {}

55 
	$iz°ªam
(
FILE
* 
Â
Ë: 
	$m_Â
(0Ë{ 
	`›í
(
Â
); 
	}
}

56 
	$iz°ªam
(c⁄° * 
«me
Ë: 
	$m_Â
(0Ë{ 
	`›í
(
«me
); 
	}
}

57 ~
	$iz°ªam
(Ë{ 
	`˛o£
(); 
	}
}

65 
	$›í
(c⁄° * 
«me
) {

66 i‡(
m_Â
Ë
	`˛o£
();

67 
m_Â
 = ::
	`gz›í
(
«me
, "rb");

68 
	}
}

70 
	$›í
(
FILE
* 
Â
) {

71 
	`SET_BINARY_MODE
(
Â
);

72 i‡(
m_Â
Ë
	`˛o£
();

73 
m_Â
 = ::
	`gzd›í
(
	`fûío
(
Â
), "rb");

74 
	}
}

80 
	$˛o£
() {

81 
r
 = ::
	`gz˛o£
(
m_Â
);

82 
m_Â
 = 0;  
r
;

83 
	}
}

87 
	$ªad
(* 
buf
, 
size_t
 
Àn
) {

88  ::
	`gzªad
(
m_Â
, 
buf
, 
Àn
);

89 
	}
}

97 c⁄° * 
	$îr‹
(* 
î∫um
) {

98  ::
	`gzîr‹
(
m_Â
, 
î∫um
);

99 
	}
}

101 
gzFûe
 
	$Â
(Ë{  
m_Â
; 
	}
}

103 
	g¥iv©e
:

104 
gzFûe
 
m_Â
;

114 
	gãm∂©e
 <
˛ass
 
	gT
, cœs†
	gIãms
>

115 
ölöe
 
	$ªad
(
iz°ªam
& 
zs
, 
T
* 
x
, 
Iãms
 
ôems
) {

116  ::
	`gzªad
(
zs
.
	`Â
(), 
x
, 
ôems
*(
T
));

117 
	}
}

122 
	gãm∂©e
 <
˛ass
 
	gT
>

123 
ölöe
 
	giz°ªam
& 
	g›î©‹
>(iz°ªam& 
	gzs
, 
	gT
& 
	gx
) {

124 ::
gzªad
(
zs
.
Â
(), &
x
, (
T
));

125  
	gzs
;

129 
ölöe
 
	gz°rögÀn
::
	$z°rögÀn
(
iz°ªam
& 
zs
) {

130 
zs
 > 
vÆ
.
byã
;

131 i‡(
vÆ
.
byã
 =255Ë
zs
 > vÆ.
w‹d
;

132 
vÆ
.
w‹d
 = vÆ.
byã
;

133 
	}
}

138 
ölöe
 
	giz°ªam
& 
	g›î©‹
>(iz°ªam& 
	gzs
, * 
	gx
) {

139 
z°rögÀn
 
Àn
(
zs
);

140 ::
gzªad
(
zs
.
Â
(), 
x
, 
Àn
.
vÆue
());

141 
	gx
[
Àn
.
vÆue
()] = '\0';

142  
	gzs
;

145 
ölöe
 * 
	$ªad_°rög
(
iz°ªam
& 
zs
) {

146 
z°rögÀn
 
	`Àn
(
zs
);

147 * 
x
 = 
√w
 [
Àn
.
	`vÆue
()+1];

148 ::
	`gzªad
(
zs
.
	`Â
(), 
x
, 
Àn
.
	`vÆue
());

149 
x
[
Àn
.
	`vÆue
()] = '\0';

150  
x
;

151 
	}
}

155 ˛as†
	coz°ªam


157 
	mpublic
:

158 
	$oz°ªam
(Ë: 
	`m_Â
(0), 
	$m_os
(0) {

160 
	$oz°ªam
(
FILE
* 
Â
, 
Àvñ
 = 
Z_DEFAULT_COMPRESSION
)

161 : 
	`m_Â
(0), 
	$m_os
(0) {

162 
	`›í
(
Â
, 
Àvñ
);

163 
	}
}

164 
	$oz°ªam
(c⁄° * 
«me
, 
Àvñ
 = 
Z_DEFAULT_COMPRESSION
)

165 : 
	`m_Â
(0), 
	$m_os
(0) {

166 
	`›í
(
«me
, 
Àvñ
);

167 
	}
}

168 ~
	$oz°ªam
() {

169 
	`˛o£
();

170 
	}
}

177 
	$›í
(c⁄° * 
«me
, 
Àvñ
 = 
Z_DEFAULT_COMPRESSION
) {

178 
mode
[4] = "wb\0";

179 i‡(
Àvñ
 !
Z_DEFAULT_COMPRESSION
Ë
mode
[2] = '0'+level;

180 i‡(
m_Â
Ë
	`˛o£
();

181 
m_Â
 = ::
	`gz›í
(
«me
, 
mode
);

182 
	}
}

186 
	$›í
(
FILE
* 
Â
, 
Àvñ
 = 
Z_DEFAULT_COMPRESSION
) {

187 
	`SET_BINARY_MODE
(
Â
);

188 
mode
[4] = "wb\0";

189 i‡(
Àvñ
 !
Z_DEFAULT_COMPRESSION
Ë
mode
[2] = '0'+level;

190 i‡(
m_Â
Ë
	`˛o£
();

191 
m_Â
 = ::
	`gzd›í
(
	`fûío
(
Â
), 
mode
);

192 
	}
}

198 
	$˛o£
() {

199 i‡(
m_os
) {

200 ::
	`gzwrôe
(
m_Â
, 
m_os
->
	`°r
(), m_os->
	`pcou¡
());

201 
dñëe
[] 
m_os
->
	`°r
(); delete m_os; m_os = 0;

203 
r
 = ::
	`gz˛o£
(
m_Â
); m_fp = 0; Ñ;

204 
	}
}

208 
	$wrôe
(c⁄° * 
buf
, 
size_t
 
Àn
) {

209  ::
	`gzwrôe
(
m_Â
, (
voidp
Ë
buf
, 
Àn
);

210 
	}
}

219 
	$Êush
(
_Êush
) {

220 
	`os_Êush
();

221  ::
	`gzÊush
(
m_Â
, 
_Êush
);

222 
	}
}

230 c⁄° * 
	$îr‹
(* 
î∫um
) {

231  ::
	`gzîr‹
(
m_Â
, 
î∫um
);

232 
	}
}

234 
gzFûe
 
	$Â
(Ë{  
m_Â
; 
	}
}

236 
	go°ªam
& 
	$os
() {

237 i‡(
m_os
 =0Ëm_o†
√w
 
o°r°ªam
;

238  *
m_os
;

239 
	}
}

241 
	$os_Êush
() {

242 i‡(
m_os
 && m_os->
	`pcou¡
()>0) {

243 
o°r°ªam
* 
oss
 = 
√w
 ostrstream;

244 
oss
->
	`fûl
(
m_os
->fill());

245 
oss
->
	`Êags
(
m_os
->flags());

246 
oss
->
	`¥ecisi⁄
(
m_os
->precision());

247 
oss
->
	`width
(
m_os
->width());

248 ::
	`gzwrôe
(
m_Â
, 
m_os
->
	`°r
(), m_os->
	`pcou¡
());

249 
dñëe
[] 
m_os
->
	`°r
(); dñëêm_os; m_o†
oss
;

251 
	}
}

253 
	g¥iv©e
:

254 
gzFûe
 
m_Â
;

255 
o°r°ªam
* 
	gm_os
;

263 
	gãm∂©e
 <
˛ass
 
	gT
, cœs†
	gIãms
>

264 
ölöe
 
	$wrôe
(
oz°ªam
& 
zs
, c⁄° 
T
* 
x
, 
Iãms
 
ôems
) {

265  ::
	`gzwrôe
(
zs
.
	`Â
(), (
voidp
Ë
x
, 
ôems
*(
T
));

266 
	}
}

271 
	gãm∂©e
 <
˛ass
 
	gT
>

272 
ölöe
 
	goz°ªam
& 
	g›î©‹
<(oz°ªam& 
	gzs
, c⁄° 
	gT
& 
	gx
) {

273 ::
gzwrôe
(
zs
.
Â
(), (
voidp
Ë&
x
, (
T
));

274  
	gzs
;

277 
ölöe
 
	gz°rögÀn
::
	$z°rögÀn
(
oz°ªam
& 
zs
, c⁄° * 
x
) {

278 
vÆ
.
byã
 = 255; vÆ.
w‹d
 = ::
	`°æí
(
x
);

279 i‡(
vÆ
.
w‹d
 < 255Ë
zs
 < (vÆ.
byã
 = val.word);

280 
zs
 < 
vÆ
;

281 
	}
}

286 
ölöe
 
	goz°ªam
& 
	g›î©‹
<(oz°ªam& 
	gzs
, c⁄° * 
	gx
) {

287 
z°rögÀn
 
Àn
(
zs
, 
x
);

288 ::
gzwrôe
(
zs
.
Â
(), (
voidp
Ë
x
, 
Àn
.
vÆue
());

289  
	gzs
;

292 #ifde‡
_MSC_VER


293 
ölöe
 
	goz°ªam
& 
	g›î©‹
<(oz°ªam& 
	gzs
, * c⁄°& 
	gx
) {

294  
	gzs
 < (c⁄° *Ë
	gx
;

301 
	gãm∂©e
 <
˛ass
 
	gT
>

302 
ölöe
 
	go°ªam
& 
	g›î©‹
<<(
	goz°ªam
& 
	gzs
, c⁄° 
	gT
& 
	gx
) {

303 
	gzs
.
os_Êush
();

304  
	gzs
.
os
(Ë<< 
	gx
;

	@zlib-1.2.8/contrib/iostream2/zstream_test.cpp

1 
	~"z°ªam.h
"

2 
	~<m©h.h
>

3 
	~<°dlib.h
>

4 
	~<iom™ù.h
>

6 
	$maö
() {

7 
h
[256] = "Hello";

8 * 
g
 = "Goodbye";

9 
oz°ªam
 
	`out
("temp.gz");

10 
out
 < "Thi†w‹k†wñl" < 
h
 < 
g
;

11 
out
.
	`˛o£
();

13 
iz°ªam
 
	`ö
("temp.gz");

14 *
x
 = 
	`ªad_°rög
(
ö
), *
y
 = 
√w
 [256], 
z
[256];

15 
ö
 > 
y
 > 
z
;

16 
ö
.
	`˛o£
();

17 
cout
 << 
x
 << 
ídl
 << 
y
 <<Énd»<< 
z
 <<Éndl;

19 
out
.
	`›í
("temp.gz");

20 
out
 << 
	`£tw
(50Ë<< 
	`£tfûl
('#'Ë<< 
	`£çªcisi⁄
(20Ë<< 
x
 << 
ídl
 << 
y
 <<Énd»<< 
z
 <<Éndl;

21 
out
 << 
z
 << 
ídl
 << 
y
 <<Énd»<< 
x
 <<Éndl;

22 
out
 << 1.1234567890123456789 << 
ídl
;

24 
dñëe
[] 
x
; dñëe[] 
y
;

25 
	}
}

	@zlib-1.2.8/contrib/iostream3/test.cc

8 
	~"zf°ªam.h
"

9 
	~<io°ªam
>

11 
	$maö
() {

13 
gzof°ªam
 
outf
;

14 
gzif°ªam
 
öf
;

15 
buf
[80];

17 
outf
.
	`›í
("test1.txt.gz");

18 
outf
 << "The quick brown fox sidesteppedÅheÜazy canine\n"

19 << 1.3 << "\nPœ¿" << 9 << 
°d
::
ídl
;

20 
outf
.
	`˛o£
();

21 
°d
::
cout
 << "WroteÅhe following messageÅo 'test1.txt.gz' (check with zcat or zless):\n"

23 << 1.3 << "\nPœ¿" << 9 << 
°d
::
ídl
;

25 
°d
::
cout
 << "\nReading 'test1.txt.gz' (buffered)Öroduces:\n";

26 
öf
.
	`›í
("test1.txt.gz");

27 
öf
.
	`gëlöe
(
buf
,80,'\n')) {

28 
°d
::
cout
 << 
buf
 << "\t(" << 
öf
.
	`rdbuf
()->
	`ö_avaû
() << " charsÜeft in buffer)\n";

30 
öf
.
	`˛o£
();

32 
outf
.
	`rdbuf
()->
	`pub£tbuf
(0,0);

33 
outf
.
	`›í
("test2.txt.gz");

34 
outf
 << 
	`£tcom¥essi⁄
(
Z_NO_COMPRESSION
)

36 << 1.3 << "\nPœ¿" << 9 << 
°d
::
ídl
;

37 
outf
.
	`˛o£
();

38 
°d
::
cout
 << "\nWroteÅhe same messageÅo 'test2.txt.gz' in uncompressed form";

40 
°d
::
cout
 << "\nReading 'test2.txt.gz' (unbuffered)Öroduces:\n";

41 
öf
.
	`rdbuf
()->
	`pub£tbuf
(0,0);

42 
öf
.
	`›í
("test2.txt.gz");

43 
öf
.
	`gëlöe
(
buf
,80,'\n')) {

44 
°d
::
cout
 << 
buf
 << "\t(" << 
öf
.
	`rdbuf
()->
	`ö_avaû
() << " charsÜeft in buffer)\n";

46 
öf
.
	`˛o£
();

50 
	}
}

	@zlib-1.2.8/contrib/iostream3/zfstream.cc

10 
	~"zf°ªam.h
"

11 
	~<c°rög
>

12 
	~<c°dio
>

15 
	#BIGBUFSIZE
 
BUFSIZ


	)

16 
	#SMALLBUFSIZE
 1

	)

21 
	ggzfûebuf
::
	$gzfûebuf
()

22 : 
	`fûe
(
NULL
), 
	`io_mode
(
°d
::
ios_ba£
::
	`›ímode
(0)), 
	`own_fd
(
Ál£
),

23 
	`buf„r
(
NULL
), 
	`buf„r_size
(
BIGBUFSIZE
), 
	$own_buf„r
(
åue
)

26 
this
->
	`dißbÀ_buf„r
();

27 
	}
}

30 
	ggzfûebuf
::~
	$gzfûebuf
()

34 
this
->
	`sync
();

35 i‡(
own_fd
)

36 
this
->
	`˛o£
();

38 
this
->
	`dißbÀ_buf„r
();

39 
	}
}

43 
	ggzfûebuf
::
	$£tcom¥essi⁄
(
comp_Àvñ
,

44 
comp_°øãgy
)

46  
	`gz£ç¨ams
(
fûe
, 
comp_Àvñ
, 
comp_°øãgy
);

47 
	}
}

50 
gzfûebuf
*

51 
	ggzfûebuf
::
›í
(c⁄° *
«me
,

52 
°d
::
ios_ba£
::
›ímode
 
mode
)

55 i‡(
this
->
is_›í
())

56  
NULL
;

58 i‡((
	gmode
 & 
	g°d
::
ios_ba£
::
ö
Ë&& (
mode
 & 
°d
::ios_ba£::
out
))

59  
NULL
;

62 
	gch¨_mode
[6] = "\0\0\0\0\0";

63 i‡(!
	gthis
->
›í_mode
(
mode
, 
ch¨_mode
))

64  
	gNULL
;

67 i‡((
	gfûe
 = 
gz›í
(
«me
, 
ch¨_mode
)Ë=
NULL
)

68  
NULL
;

71 
	gthis
->
íabÀ_buf„r
();

72 
	gio_mode
 = 
mode
;

73 
	gown_fd
 = 
åue
;

74  
	gthis
;

78 
gzfûebuf
*

79 
	ggzfûebuf
::
©èch
(
fd
,

80 
°d
::
ios_ba£
::
›ímode
 
mode
)

83 i‡(
this
->
is_›í
())

84  
NULL
;

86 i‡((
	gmode
 & 
	g°d
::
ios_ba£
::
ö
Ë&& (
mode
 & 
°d
::ios_ba£::
out
))

87  
NULL
;

90 
	gch¨_mode
[6] = "\0\0\0\0\0";

91 i‡(!
	gthis
->
›í_mode
(
mode
, 
ch¨_mode
))

92  
	gNULL
;

95 i‡((
	gfûe
 = 
gzd›í
(
fd
, 
ch¨_mode
)Ë=
NULL
)

96  
NULL
;

99 
	gthis
->
íabÀ_buf„r
();

100 
	gio_mode
 = 
mode
;

101 
	gown_fd
 = 
Ál£
;

102  
	gthis
;

106 
gzfûebuf
*

107 
	ggzfûebuf
::
	$˛o£
()

110 i‡(!
this
->
	`is_›í
())

111  
NULL
;

113 
gzfûebuf
* 
ªtvÆ
 = 
this
;

115 i‡(
this
->
	`sync
() == -1)

116 
ªtvÆ
 = 
NULL
;

117 i‡(
	`gz˛o£
(
fûe
) < 0)

118 
ªtvÆ
 = 
NULL
;

120 
fûe
 = 
NULL
;

121 
own_fd
 = 
Ál£
;

123 
this
->
	`dißbÀ_buf„r
();

124  
ªtvÆ
;

125 
	}
}

130 
boﬁ


131 
	ggzfûebuf
::
›í_mode
(
°d
::
ios_ba£
::
›ímode
 
mode
,

132 * 
c_mode
) const

134 
boﬁ
 
	gã°b
 = 
mode
 & 
°d
::
ios_ba£
::
bö¨y
;

135 
boﬁ
 
	gã°i
 = 
mode
 & 
°d
::
ios_ba£
::
ö
;

136 
boﬁ
 
	gã°o
 = 
mode
 & 
°d
::
ios_ba£
::
out
;

137 
boﬁ
 
	gã°t
 = 
mode
 & 
°d
::
ios_ba£
::
åunc
;

138 
boﬁ
 
	gã°a
 = 
mode
 & 
°d
::
ios_ba£
::
≠p
;

145 i‡(!
	gã°i
 && 
	gã°o
 && !
	gã°t
 && !
	gã°a
)

146 
°r˝y
(
c_mode
, "w");

147 i‡(!
	gã°i
 && 
	gã°o
 && !
	gã°t
 && 
	gã°a
)

148 
°r˝y
(
c_mode
, "a");

149 i‡(!
	gã°i
 && 
	gã°o
 && 
	gã°t
 && !
	gã°a
)

150 
°r˝y
(
c_mode
, "w");

151 i‡(
	gã°i
 && !
	gã°o
 && !
	gã°t
 && !
	gã°a
)

152 
°r˝y
(
c_mode
, "r");

160 i‡(
°æí
(
c_mode
) == 0)

161  
Ál£
;

162 i‡(
	gã°b
)

163 
°rˇt
(
c_mode
, "b");

164  
	gåue
;

168 
	g°d
::
°ªamsize


169 
gzfûebuf
::
	$showm™yc
()

172 i‡(!
this
->
	`is_›í
(Ë|| !(
io_mode
 & 
°d
::
ios_ba£
::
ö
))

175 i‡(
this
->
	`g±r
(Ë&& (this->g±r(Ë<Åhis->
	`eg±r
()))

176  
°d
::
	`°ªamsize
(
this
->
	`eg±r
(Ë-Åhis->
	`g±r
());

179 
	}
}

182 
	ggzfûebuf
::
öt_ty≥


183 
gzfûebuf
::
	$undîÊow
()

188 i‡(
this
->
	`g±r
(Ë&& (this->g±r(Ë<Åhis->
	`eg±r
()))

189  
åaôs_ty≥
::
	`to_öt_ty≥
(*(
this
->
	`g±r
()));

192 i‡(!
this
->
	`is_›í
(Ë|| !(
io_mode
 & 
°d
::
ios_ba£
::
ö
))

193  
åaôs_ty≥
::
	`eof
();

197 
byãs_ªad
 = 
	`gzªad
(
fûe
, 
buf„r
, 
buf„r_size
);

199 i‡(
byãs_ªad
 <= 0)

202 
this
->
	`£tg
(
buf„r
, buffer, buffer);

203  
åaôs_ty≥
::
	`eof
();

206 
this
->
	`£tg
(
buf„r
, buf„r, buf„∏+ 
byãs_ªad
);

209  
åaôs_ty≥
::
	`to_öt_ty≥
(*(
this
->
	`g±r
()));

210 
	}
}

213 
	ggzfûebuf
::
öt_ty≥


214 
gzfûebuf
::
	$ovîÊow
(
öt_ty≥
 
c
)

217 i‡(
this
->
	`pba£
())

220 i‡(
this
->
	`µå
(Ë>Åhis->
	`ï±r
(Ë||Åhis->µå(Ë<Åhis->
	`pba£
())

221  
åaôs_ty≥
::
	`eof
();

223 i‡(!
åaôs_ty≥
::
	`eq_öt_ty≥
(
c
,Åøôs_ty≥::
	`eof
()))

225 *(
this
->
	`µå
()Ë
åaôs_ty≥
::
	`to_ch¨_ty≥
(
c
);

226 
this
->
	`pbump
(1);

229 
byãs_to_wrôe
 = 
this
->
	`µå
(Ë-Åhis->
	`pba£
();

231 i‡(
byãs_to_wrôe
 > 0)

234 i‡(!
this
->
	`is_›í
(Ë|| !(
io_mode
 & 
°d
::
ios_ba£
::
out
))

235  
åaôs_ty≥
::
	`eof
();

237 i‡(
	`gzwrôe
(
fûe
, 
this
->
	`pba£
(), 
byãs_to_wrôe
) != bytes_to_write)

238  
åaôs_ty≥
::
	`eof
();

240 
this
->
	`pbump
(-
byãs_to_wrôe
);

244 i‡(!
åaôs_ty≥
::
	`eq_öt_ty≥
(
c
,Åøôs_ty≥::
	`eof
()))

247 i‡(!
this
->
	`is_›í
(Ë|| !(
io_mode
 & 
°d
::
ios_ba£
::
out
))

248  
åaôs_ty≥
::
	`eof
();

250 
ch¨_ty≥
 
œ°_ch¨
 = 
åaôs_ty≥
::
	`to_ch¨_ty≥
(
c
);

252 i‡(
	`gzwrôe
(
fûe
, &
œ°_ch¨
, 1) != 1)

253  
åaôs_ty≥
::
	`eof
();

258 i‡(
åaôs_ty≥
::
	`eq_öt_ty≥
(
c
,Åøôs_ty≥::
	`eof
()))

259  
åaôs_ty≥
::
	`nŸ_eof
(
c
);

261  
c
;

262 
	}
}

265 
	g°d
::
°ªambuf
*

266 
gzfûebuf
::
£tbuf
(
ch¨_ty≥
* 
p
,

267 
°d
::
°ªamsize
 
n
)

270 i‡(
this
->
sync
() == -1)

271  
NULL
;

276 i‡(!
	gp
 || !
	gn
)

279 
	gthis
->
dißbÀ_buf„r
();

280 
	gbuf„r
 = 
NULL
;

281 
	gbuf„r_size
 = 0;

282 
	gown_buf„r
 = 
åue
;

283 
	gthis
->
íabÀ_buf„r
();

288 
	gthis
->
dißbÀ_buf„r
();

289 
	gbuf„r
 = 
p
;

290 
	gbuf„r_size
 = 
n
;

291 
	gown_buf„r
 = 
Ál£
;

292 
	gthis
->
íabÀ_buf„r
();

294  
	gthis
;

299 
	ggzfûebuf
::
	$sync
()

301  
åaôs_ty≥
::
	`eq_öt_ty≥
(
this
->
	`ovîÊow
(),Åøôs_ty≥::
	`eof
()) ? -1 : 0;

302 
	}
}

308 
	ggzfûebuf
::
	$íabÀ_buf„r
()

311 i‡(
own_buf„r
 && !
buf„r
)

314 i‡(
buf„r_size
 > 0)

317 
buf„r
 = 
√w
 
ch¨_ty≥
[
buf„r_size
];

319 
this
->
	`£tg
(
buf„r
, buffer, buffer);

324 
this
->
	`£ç
(
buf„r
, buf„∏+ 
buf„r_size
 - 1);

329 
buf„r_size
 = 
SMALLBUFSIZE
;

330 
buf„r
 = 
√w
 
ch¨_ty≥
[
buf„r_size
];

331 
this
->
	`£tg
(
buf„r
, buffer, buffer);

333 
this
->
	`£ç
(0, 0);

340 
this
->
	`£tg
(
buf„r
, buffer, buffer);

341 
this
->
	`£ç
(
buf„r
, buf„∏+ 
buf„r_size
 - 1);

343 
	}
}

347 
	ggzfûebuf
::
	$dißbÀ_buf„r
()

350 i‡(
own_buf„r
 && 
buf„r
)

353 i‡(!
this
->
	`pba£
())

354 
buf„r_size
 = 0;

355 
dñëe
[] 
buf„r
;

356 
buf„r
 = 
NULL
;

357 
this
->
	`£tg
(0, 0, 0);

358 
this
->
	`£ç
(0, 0);

363 
this
->
	`£tg
(
buf„r
, buffer, buffer);

364 i‡(
buf„r
)

365 
this
->
	`£ç
(
buf„r
, buf„∏+ 
buf„r_size
 - 1);

367 
this
->
	`£ç
(0, 0);

369 
	}
}

374 
	ggzif°ªam
::
	$gzif°ªam
()

375 : 
°d
::
	`i°ªam
(
NULL
), 
	$sb
()

376 { 
this
->
	`öô
(&
sb
); 
	}
}

379 
	ggzif°ªam
::
gzif°ªam
(c⁄° * 
«me
,

380 
°d
::
ios_ba£
::
›ímode
 
mode
)

381 : 
°d
::
i°ªam
(
NULL
), 
	$sb
()

383 
this
->
	`öô
(&
sb
);

384 
this
->
	`›í
(
«me
, 
mode
);

385 
	}
}

388 
	ggzif°ªam
::
gzif°ªam
(
fd
,

389 
°d
::
ios_ba£
::
›ímode
 
mode
)

390 : 
°d
::
i°ªam
(
NULL
), 
	$sb
()

392 
this
->
	`öô
(&
sb
);

393 
this
->
	`©èch
(
fd
, 
mode
);

394 
	}
}

398 
	ggzif°ªam
::
›í
(c⁄° * 
«me
,

399 
°d
::
ios_ba£
::
›ímode
 
mode
)

401 i‡(!
sb
.
›í
(
«me
, 
mode
 | 
°d
::
ios_ba£
::
ö
))

402 
this
->
£t°©e
(
°d
::
ios_ba£
::
Áûbô
);

404 
	gthis
->
˛ór
();

409 
	ggzif°ªam
::
©èch
(
fd
,

410 
°d
::
ios_ba£
::
›ímode
 
mode
)

412 i‡(!
sb
.
©èch
(
fd
, 
mode
 | 
°d
::
ios_ba£
::
ö
))

413 
this
->
£t°©e
(
°d
::
ios_ba£
::
Áûbô
);

415 
	gthis
->
˛ór
();

420 
	ggzif°ªam
::
	$˛o£
()

422 i‡(!
sb
.
	`˛o£
())

423 
this
->
	`£t°©e
(
°d
::
ios_ba£
::
Áûbô
);

424 
	}
}

429 
	ggzof°ªam
::
	$gzof°ªam
()

430 : 
°d
::
	`o°ªam
(
NULL
), 
	$sb
()

431 { 
this
->
	`öô
(&
sb
); 
	}
}

434 
	ggzof°ªam
::
gzof°ªam
(c⁄° * 
«me
,

435 
°d
::
ios_ba£
::
›ímode
 
mode
)

436 : 
°d
::
o°ªam
(
NULL
), 
	$sb
()

438 
this
->
	`öô
(&
sb
);

439 
this
->
	`›í
(
«me
, 
mode
);

440 
	}
}

443 
	ggzof°ªam
::
gzof°ªam
(
fd
,

444 
°d
::
ios_ba£
::
›ímode
 
mode
)

445 : 
°d
::
o°ªam
(
NULL
), 
	$sb
()

447 
this
->
	`öô
(&
sb
);

448 
this
->
	`©èch
(
fd
, 
mode
);

449 
	}
}

453 
	ggzof°ªam
::
›í
(c⁄° * 
«me
,

454 
°d
::
ios_ba£
::
›ímode
 
mode
)

456 i‡(!
sb
.
›í
(
«me
, 
mode
 | 
°d
::
ios_ba£
::
out
))

457 
this
->
£t°©e
(
°d
::
ios_ba£
::
Áûbô
);

459 
	gthis
->
˛ór
();

464 
	ggzof°ªam
::
©èch
(
fd
,

465 
°d
::
ios_ba£
::
›ímode
 
mode
)

467 i‡(!
sb
.
©èch
(
fd
, 
mode
 | 
°d
::
ios_ba£
::
out
))

468 
this
->
£t°©e
(
°d
::
ios_ba£
::
Áûbô
);

470 
	gthis
->
˛ór
();

475 
	ggzof°ªam
::
	$˛o£
()

477 i‡(!
sb
.
	`˛o£
())

478 
this
->
	`£t°©e
(
°d
::
ios_ba£
::
Áûbô
);

479 
	}
}

	@zlib-1.2.8/contrib/iostream3/zfstream.h

10 #i‚de‡
ZFSTREAM_H


11 
	#ZFSTREAM_H


	)

13 
	~<i°ªam
>

14 
	~<o°ªam
>

15 
	~"zlib.h
"

27 ˛as†
	cgzfûebuf
 : 
public
 
°d
::
°ªambuf


29 
public
:

31 
gzfûebuf
();

34 
	mvútuÆ


35 ~
gzfûebuf
();

49 
£tcom¥essi⁄
(
comp_Àvñ
,

50 
comp_°øãgy
 = 
Z_DEFAULT_STRATEGY
);

56 
boﬁ


57 
	$is_›í
(Ëc⁄° {  (
fûe
 !
NULL
); }

65 
gzfûebuf
*

66 
	`›í
(c⁄° * 
«me
,

67 
°d
::
ios_ba£
::
›ímode
 
mode
);

75 
gzfûebuf
*

76 
	`©èch
(
fd
,

77 
°d
::
ios_ba£
::
›ímode
 
mode
);

83 
gzfûebuf
*

84 
	`˛o£
();

86 
¥Ÿe˘ed
:

91 
boﬁ


92 
	`›í_mode
(
°d
::
ios_ba£
::
›ímode
 
mode
,

93 * 
c_mode
) const;

102 
vútuÆ
 
°d
::
°ªamsize


103 
	`showm™yc
();

112 
vútuÆ
 
öt_ty≥


113 
	`undîÊow
();

124 
vútuÆ
 
öt_ty≥


125 
	`ovîÊow
(
öt_ty≥
 
c
 = 
åaôs_ty≥
::
	`eof
());

135 
vútuÆ
 
°d
::
°ªambuf
*

136 
	`£tbuf
(
ch¨_ty≥
* 
p
,

137 
°d
::
°ªamsize
 
n
);

145 
vútuÆ
 

146 
	`sync
();

161 
¥iv©e
:

171 
	`íabÀ_buf„r
();

181 
	`dißbÀ_buf„r
();

186 
gzFûe
 
fûe
;

191 
°d
::
ios_ba£
::
›ímode
 
io_mode
;

199 
boﬁ
 
own_fd
;

207 
ch¨_ty≥
* 
buf„r
;

215 
°d
::
°ªamsize
 
buf„r_size
;

223 
boﬁ
 
own_buf„r
;

224 
	}
};

234 ˛as†
	cgzif°ªam
 : 
public
 
°d
::
i°ªam


236 
public
:

238 
gzif°ªam
();

245 
ex∂icô


246 
gzif°ªam
(c⁄° * 
«me
,

247 
°d
::
ios_ba£
::
›ímode
 
mode
 = std::ios_ba£::
ö
);

254 
ex∂icô


255 
gzif°ªam
(
fd
,

256 
°d
::
ios_ba£
::
›ímode
 
mode
 = std::ios_ba£::
ö
);

261 
gzfûebuf
*

262 
	$rdbuf
() const

263 {  
c⁄°_ˇ°
<
gzfûebuf
*>(&
sb
); }

269 
boﬁ


270 
	$is_›í
(Ë{  
sb
.
	`is_›í
(); 
	}
}

285 
›í
(c⁄° * 
«me
,

286 
°d
::
ios_ba£
::
›ímode
 
mode
 = std::ios_ba£::
ö
);

297 
©èch
(
fd
,

298 
°d
::
ios_ba£
::
›ímode
 
mode
 = std::ios_ba£::
ö
);

306 
˛o£
();

308 
	g¥iv©e
:

312 
gzfûebuf
 
sb
;

323 ˛as†
	cgzof°ªam
 : 
public
 
°d
::
o°ªam


325 
public
:

327 
gzof°ªam
();

334 
ex∂icô


335 
gzof°ªam
(c⁄° * 
«me
,

336 
°d
::
ios_ba£
::
›ímode
 
mode
 = std::ios_ba£::
out
);

343 
ex∂icô


344 
gzof°ªam
(
fd
,

345 
°d
::
ios_ba£
::
›ímode
 
mode
 = std::ios_ba£::
out
);

350 
gzfûebuf
*

351 
	$rdbuf
() const

352 {  
c⁄°_ˇ°
<
gzfûebuf
*>(&
sb
); }

358 
boﬁ


359 
	$is_›í
(Ë{  
sb
.
	`is_›í
(); 
	}
}

374 
›í
(c⁄° * 
«me
,

375 
°d
::
ios_ba£
::
›ímode
 
mode
 = std::ios_ba£::
out
);

386 
©èch
(
fd
,

387 
°d
::
ios_ba£
::
›ímode
 
mode
 = std::ios_ba£::
out
);

395 
˛o£
();

397 
	g¥iv©e
:

401 
gzfûebuf
 
sb
;

412 
	gãm∂©e
<
ty≥«me
 
	gT1
,Åy≥«mê
	gT2
>

413 ˛as†
	cgzom™ù2


415 
	mpublic
:

417 
ãm∂©e
 <
ty≥«me
 
Ta
,Åy≥«mê
	mTb
>

418 
‰õnd
 
	mgzof°ªam
&

419 
	m›î©‹
<<(
	mgzof°ªam
&,

420 c⁄° 
	mgzom™ù2
<
	mTa
,
	mTb
>&);

423 
gzom™ù2
(
gzof°ªam
& (*
f
)(gzof°ªam&, 
T1
, 
T2
),

424 
T1
 
v1
,

425 
T2
 
v2
);

426 
	m¥iv©e
:

428 
gzof°ªam
&

429 (*
func
)(
gzof°ªam
&, 
	mT1
, 
	mT2
);

432 
T1
 
	mvÆ1
;

433 
T2
 
	mvÆ2
;

439 
ölöe
 
	ggzof°ªam
&

440 
	$£tcom¥essi⁄
(
gzof°ªam
 &
gzs
, 
l
, 
s
 = 
Z_DEFAULT_STRATEGY
)

442 (
gzs
.
	`rdbuf
())->
	`£tcom¥essi⁄
(
l
, 
s
);

443  
gzs
;

444 
	}
}

447 
	gãm∂©e
<
ty≥«me
 
	gT1
,Åy≥«mê
	gT2
>

448 
ölöe


449 
	ggzom™ù2
<
	gT1
,
	gT2
>::
gzom™ù2
(
gzof°ªam
 &(*
f
)(gzof°ªam &, 
T1
, 
T2
),

450 
T1
 
v1
,

451 
T2
 
v2
)

452 : 
func
(
f
), 
vÆ1
(
v1
), 
	$vÆ2
(
v2
)

453 { 
	}
}

456 
	gãm∂©e
<
ty≥«me
 
	gT1
,Åy≥«mê
	gT2
>

457 
ölöe
 
	ggzof°ªam
&

458 
	g›î©‹
<<(
	ggzof°ªam
& 
	gs
, c⁄° 
	ggzom™ù2
<
	gT1
,
	gT2
>& 
	gm
)

459 {  (*
	gm
.
	gfunc
)(
	gs
, m.
	gvÆ1
, m.
	gvÆ2
); }

462 
ölöe
 
	ggzom™ù2
<,>

463 
	$£tcom¥essi⁄
(
l
, 
s
 = 
Z_DEFAULT_STRATEGY
)

464 {  
gzom™ù2
<,>(&
£tcom¥essi⁄
, 
l
, 
s
); 
	}
}

	@zlib-1.2.8/contrib/masmx64/inffas8664.c

35 
	~<°dio.h
>

36 
	~"zutû.h
"

37 
	~"ö·ªes.h
"

38 
	~"öÊ©e.h
"

39 
	~"öfÁ°.h
"

81 
	söfÁ°_¨
 {

84  *
	me•
;

85  *
	mebp
;

86  
FAR
 *
	mö
;

87  
FAR
 *
	mœ°
;

88  
FAR
 *
	mout
;

89  
FAR
 *
	mbeg
;

90  
FAR
 *
	míd
;

91  
FAR
 *
	mwödow
;

92  
code
 c⁄° 
FAR
 *
	mlcode
;

93  
code
 c⁄° 
FAR
 *
	mdcode
;

94  
size_t
 
	mhﬁd
;

95  
	mbôs
;

96  
	mwsize
;

97  
	mwrôe
;

98  
	mlmask
;

99  
	mdmask
;

100  
	mÀn
;

101  
	mdi°
;

102  
	m°©us
;

103 } 
	tty≥_¨
;

104 #ifde‡
ASMINF


106 
	$öÊ©e_Á°
(
°rm
, 
°¨t
)

107 
z_°ªamp
 
°rm
;

108 
°¨t
;

110 
öÊ©e_°©e
 
FAR
 *
°©e
;

111 
ty≥_¨
 
¨
;

112 
	`öfÁs8664‚c
(
öfÁ°_¨
 * 
∑r
);

116 #i‡(
	`deföed
–
__GNUC__
 ) && deföed–
__amd64__
 ) && ! deföed–
__i386
 )Ë|| (deföed(
_MSC_VER
Ë&& deföed(
_M_AMD64
))

117 
	#PAD_AVAIL_IN
 6

	)

118 
	#PAD_AVAIL_OUT
 258

	)

120 
	#PAD_AVAIL_IN
 5

	)

121 
	#PAD_AVAIL_OUT
 257

	)

125 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
°rm
->state;

127 
¨
.
ö
 = 
°rm
->
√xt_ö
;

128 
¨
.
œ°
 =ár.
ö
 + (
°rm
->
avaû_ö
 - 
PAD_AVAIL_IN
);

129 
¨
.
out
 = 
°rm
->
√xt_out
;

130 
¨
.
beg
 =ár.
out
 - (
°¨t
 - 
°rm
->
avaû_out
);

131 
¨
.
íd
 =ár.
out
 + (
°rm
->
avaû_out
 - 
PAD_AVAIL_OUT
);

132 
¨
.
wsize
 = 
°©e
->wsize;

133 
¨
.
wrôe
 = 
°©e
->
w√xt
;

134 
¨
.
wödow
 = 
°©e
->window;

135 
¨
.
hﬁd
 = 
°©e
->hold;

136 
¨
.
bôs
 = 
°©e
->bits;

137 
¨
.
lcode
 = 
°©e
->
Àncode
;

138 
¨
.
dcode
 = 
°©e
->
di°code
;

139 
¨
.
lmask
 = (1U << 
°©e
->
Ànbôs
) - 1;

140 
¨
.
dmask
 = (1U << 
°©e
->
di°bôs
) - 1;

146 ((
size_t
)(*)
¨
.
ö
 & (◊r.
hﬁd
) / 2 - 1)) != 0) {

147 
¨
.
hﬁd
 +()*¨.
ö
++ <<ár.
bôs
;

148 
¨
.
bôs
 += 8;

151 
	`öfÁs8664‚c
(&
¨
);

153 i‡(
¨
.
°©us
 > 1) {

154 i‡(
¨
.
°©us
 == 2)

155 
°rm
->
msg
 = "invalidÜiteral/length code";

156 i‡(
¨
.
°©us
 == 3)

157 
°rm
->
msg
 = "invalid distance code";

159 
°rm
->
msg
 = "invalid distanceÅoo far back";

160 
°©e
->
mode
 = 
BAD
;

162 i‡–
¨
.
°©us
 == 1 ) {

163 
°©e
->
mode
 = 
TYPE
;

167 
¨
.
Àn
 =ár.
bôs
 >> 3;

168 
¨
.
ö
 -¨.
Àn
;

169 
¨
.
bôs
 -¨.
Àn
 << 3;

170 
¨
.
hﬁd
 &(1U <<ár.
bôs
) - 1;

173 
°rm
->
√xt_ö
 = 
¨
.
ö
;

174 
°rm
->
√xt_out
 = 
¨
.
out
;

175 
°rm
->
avaû_ö
 = ()(
¨
.
ö
 <ár.
œ°
 ?

176 
PAD_AVAIL_IN
 + (
¨
.
œ°
 -ár.
ö
) :

177 
PAD_AVAIL_IN
 - (
¨
.
ö
 -ár.
œ°
));

178 
°rm
->
avaû_out
 = ()(
¨
.
out
 <ár.
íd
 ?

179 
PAD_AVAIL_OUT
 + (
¨
.
íd
 -ár.
out
) :

180 
PAD_AVAIL_OUT
 - (
¨
.
out
 -ár.
íd
));

181 
°©e
->
hﬁd
 = ()
¨
.hold;

182 
°©e
->
bôs
 = 
¨
.bits;

184 
	}
}

	@zlib-1.2.8/contrib/minizip/crypt.h

30 
	#CRC32
(
c
, 
b
Ë((*(
p¸c_32_èb
+((()(cË^ (b)Ë& 0xff))Ë^ ((cË>> 8))

	)

35 
	$de¸y±_byã
(* 
pkeys
, c⁄° 
z_¸c_t
* 
p¸c_32_èb
)

37 
ãmp
;

41 
ãmp
 = (()(*(
pkeys
+2)) & 0xffff) | 2;

42  ()(((
ãmp
 * (temp ^ 1)) >> 8) & 0xff);

43 
	}
}

48 
	$upd©e_keys
(* 
pkeys
,c⁄° 
z_¸c_t
* 
p¸c_32_èb
,
c
)

50 (*(
pkeys
+0)Ë
	`CRC32
((*’keys+0)), 
c
);

51 (*(
pkeys
+1)) += (*(pkeys+0)) & 0xff;

52 (*(
pkeys
+1)) = (*(pkeys+1)) * 134775813L + 1;

54 
keyshi·
 = ()((*(
pkeys
+1)) >> 24);

55 (*(
pkeys
+2)Ë
	`CRC32
((*’keys+2)), 
keyshi·
);

57  
c
;

58 
	}
}

65 
	$öô_keys
(c⁄° * 
∑sswd
,* 
pkeys
,c⁄° 
z_¸c_t
* 
p¸c_32_èb
)

67 *(
pkeys
+0) = 305419896L;

68 *(
pkeys
+1) = 591751049L;

69 *(
pkeys
+2) = 878082192L;

70 *
∑sswd
 != '\0') {

71 
	`upd©e_keys
(
pkeys
,
p¸c_32_èb
,()*
∑sswd
);

72 
∑sswd
++;

74 
	}
}

76 
	#zdecode
(
pkeys
,
p¸c_32_èb
,
c
) \

77 (
	`upd©e_keys
(
pkeys
,
p¸c_32_èb
,
c
 ^
	`de¸y±_byã
’keys,p¸c_32_èb)))

	)

79 
	#zícode
(
pkeys
,
p¸c_32_èb
,
c
,
t
) \

80 (
t
=
	`de¸y±_byã
(
pkeys
,
p¸c_32_èb
), 
	`upd©e_keys
’keys,p¸c_32_èb,
c
),Å^(c))

	)

82 #ifde‡
INCLUDECRYPTINGCODE_IFCRYPTALLOWED


84 
	#RAND_HEAD_LEN
 12

	)

86 #i‚de‡
ZCR_SEED2


87 
	#ZCR_SEED2
 3141592654UL

	)

90 
	$¸y±hód
(c⁄° * 
∑sswd
,

91 * 
buf
,

92 
bufSize
,

93 * 
pkeys
,

94 c⁄° 
z_¸c_t
* 
p¸c_32_èb
,

95 
¸cF‹Cry±ög
)

97 
n
;

98 
t
;

99 
c
;

100 
hódî
[
RAND_HEAD_LEN
-2];

101 
ˇŒs
 = 0;

103 i‡(
bufSize
<
RAND_HEAD_LEN
)

110 i‡(++
ˇŒs
 == 1)

112 
	`§™d
(()(
	`time
(
NULL
Ë^ 
ZCR_SEED2
));

114 
	`öô_keys
(
∑sswd
, 
pkeys
, 
p¸c_32_èb
);

115 
n
 = 0;Ç < 
RAND_HEAD_LEN
-2;Ç++)

117 
c
 = (
	`ønd
() >> 7) & 0xff;

118 
hódî
[
n
] = ()
	`zícode
(
pkeys
, 
p¸c_32_èb
, 
c
, 
t
);

121 
	`öô_keys
(
∑sswd
, 
pkeys
, 
p¸c_32_èb
);

122 
n
 = 0;Ç < 
RAND_HEAD_LEN
-2;Ç++)

124 
buf
[
n
] = ()
	`zícode
(
pkeys
, 
p¸c_32_èb
, 
hódî
[n], 
t
);

126 
buf
[
n
++] = ()
	`zícode
(
pkeys
, 
p¸c_32_èb
, ()(
¸cF‹Cry±ög
 >> 16Ë& 0xff, 
t
);

127 
buf
[
n
++] = ()
	`zícode
(
pkeys
, 
p¸c_32_èb
, ()(
¸cF‹Cry±ög
 >> 24Ë& 0xff, 
t
);

128  
n
;

129 
	}
}

	@zlib-1.2.8/contrib/minizip/ioapi.c

13 #i‡
deföed
(
_WIN32
Ë&& (!(deföed(
_CRT_SECURE_NO_WARNINGS
)))

14 
	#_CRT_SECURE_NO_WARNINGS


	)

17 #i‡
deföed
(
__APPLE__
Ë|| deföed(
IOAPI_NO_64
)

19 
	#FOPEN_FUNC
(
fûíame
, 
mode
Ë
	`f›í
(fûíame, mode)

	)

20 
	#FTELLO_FUNC
(
°ªam
Ë
	`·ñlo
(°ªam)

	)

21 
	#FSEEKO_FUNC
(
°ªam
, 
off£t
, 
‹igö
Ë
	`f£eko
(°ªam, off£t, origö)

	)

23 
	#FOPEN_FUNC
(
fûíame
, 
mode
Ë
	`f›í64
(fûíame, mode)

	)

24 
	#FTELLO_FUNC
(
°ªam
Ë
	`·ñlo64
(°ªam)

	)

25 
	#FSEEKO_FUNC
(
°ªam
, 
off£t
, 
‹igö
Ë
	`f£eko64
(°ªam, off£t, origö)

	)

29 
	~"iﬂpi.h
"

31 
voidpf
 
	$ˇŒ_z›í64
 (c⁄° 
zlib_fûefunc64_32_def
* 
pfûefunc
,c⁄° *
fûíame
,
mode
)

33 i‡(
pfûefunc
->
zfûe_func64
.
z›í64_fûe
 !
NULL
)

34  (*(
pfûefunc
->
zfûe_func64
.
z›í64_fûe
)Ë’fûefunc->zfûe_func64.
›aque
,
fûíame
,
mode
);

37  (*(
pfûefunc
->
z›í32_fûe
))’fûefunc->
zfûe_func64
.
›aque
,(c⁄° *)
fûíame
,
mode
);

39 
	}
}

41 
	$ˇŒ_z£ek64
 (c⁄° 
zlib_fûefunc64_32_def
* 
pfûefunc
,
voidpf
 
fûe°ªam
, 
ZPOS64_T
 
off£t
, 
‹igö
)

43 i‡(
pfûefunc
->
zfûe_func64
.
z£ek64_fûe
 !
NULL
)

44  (*(
pfûefunc
->
zfûe_func64
.
z£ek64_fûe
)Ë’fûefunc->zfûe_func64.
›aque
,
fûe°ªam
,
off£t
,
‹igö
);

47 
uL⁄g
 
off£tTrunˇãd
 = (uL⁄g)
off£t
;

48 i‡(
off£tTrunˇãd
 !
off£t
)

51  (*(
pfûefunc
->
z£ek32_fûe
))’fûefunc->
zfûe_func64
.
›aque
,
fûe°ªam
,
off£tTrunˇãd
,
‹igö
);

53 
	}
}

55 
ZPOS64_T
 
	$ˇŒ_zãŒ64
 (c⁄° 
zlib_fûefunc64_32_def
* 
pfûefunc
,
voidpf
 
fûe°ªam
)

57 i‡(
pfûefunc
->
zfûe_func64
.
z£ek64_fûe
 !
NULL
)

58  (*(
pfûefunc
->
zfûe_func64
.
zãŒ64_fûe
)Ë’fûefunc->zfûe_func64.
›aque
,
fûe°ªam
);

61 
uL⁄g
 
ãŒ_uL⁄g
 = (*(
pfûefunc
->
zãŒ32_fûe
))’fûefunc->
zfûe_func64
.
›aque
,
fûe°ªam
);

62 i‡((
ãŒ_uL⁄g
Ë=
MAXU32
)

63  (
ZPOS64_T
)-1;

65  
ãŒ_uL⁄g
;

67 
	}
}

69 
	$fûl_zlib_fûefunc64_32_def_‰om_fûefunc32
(
zlib_fûefunc64_32_def
* 
p_fûefunc64_32
,c⁄° 
zlib_fûefunc_def
* 
p_fûefunc32
)

71 
p_fûefunc64_32
->
zfûe_func64
.
z›í64_fûe
 = 
NULL
;

72 
p_fûefunc64_32
->
z›í32_fûe
 = 
p_fûefunc32
->
z›í_fûe
;

73 
p_fûefunc64_32
->
zfûe_func64
.
zîr‹_fûe
 = 
p_fûefunc32
->zerror_file;

74 
p_fûefunc64_32
->
zfûe_func64
.
zªad_fûe
 = 
p_fûefunc32
->zread_file;

75 
p_fûefunc64_32
->
zfûe_func64
.
zwrôe_fûe
 = 
p_fûefunc32
->zwrite_file;

76 
p_fûefunc64_32
->
zfûe_func64
.
zãŒ64_fûe
 = 
NULL
;

77 
p_fûefunc64_32
->
zfûe_func64
.
z£ek64_fûe
 = 
NULL
;

78 
p_fûefunc64_32
->
zfûe_func64
.
z˛o£_fûe
 = 
p_fûefunc32
->zclose_file;

79 
p_fûefunc64_32
->
zfûe_func64
.
zîr‹_fûe
 = 
p_fûefunc32
->zerror_file;

80 
p_fûefunc64_32
->
zfûe_func64
.
›aque
 = 
p_fûefunc32
->opaque;

81 
p_fûefunc64_32
->
z£ek32_fûe
 = 
p_fûefunc32
->
z£ek_fûe
;

82 
p_fûefunc64_32
->
zãŒ32_fûe
 = 
p_fûefunc32
->
zãŒ_fûe
;

83 
	}
}

87 
voidpf
 
ZCALLBACK
 
f›í_fûe_func
 
OF
((voidp‡
›aque
, c⁄° * 
fûíame
, 
mode
));

88 
uL⁄g
 
ZCALLBACK
 
‰ód_fûe_func
 
OF
((
voidpf
 
›aque
, voidp‡
°ªam
, * 
buf
, uL⁄g 
size
));

89 
uL⁄g
 
ZCALLBACK
 
fwrôe_fûe_func
 
OF
((
voidpf
 
›aque
, voidp‡
°ªam
, c⁄° * 
buf
,uL⁄g 
size
));

90 
ZPOS64_T
 
ZCALLBACK
 
·ñl64_fûe_func
 
OF
((
voidpf
 
›aque
, voidp‡
°ªam
));

91 
ZCALLBACK
 
f£ek64_fûe_func
 
OF
((
voidpf
 
›aque
, voidp‡
°ªam
, 
ZPOS64_T
 
off£t
, 
‹igö
));

92 
ZCALLBACK
 
f˛o£_fûe_func
 
OF
((
voidpf
 
›aque
, voidp‡
°ªam
));

93 
ZCALLBACK
 
„º‹_fûe_func
 
OF
((
voidpf
 
›aque
, voidp‡
°ªam
));

95 
voidpf
 
ZCALLBACK
 
	$f›í_fûe_func
 (
voidpf
 
›aque
, c⁄° * 
fûíame
, 
mode
)

97 
FILE
* 
fûe
 = 
NULL
;

98 c⁄° * 
mode_f›í
 = 
NULL
;

99 i‡((
mode
 & 
ZLIB_FILEFUNC_MODE_READWRITEFILTER
)==
ZLIB_FILEFUNC_MODE_READ
)

100 
mode_f›í
 = "rb";

102 i‡(
mode
 & 
ZLIB_FILEFUNC_MODE_EXISTING
)

103 
mode_f›í
 = "r+b";

105 i‡(
mode
 & 
ZLIB_FILEFUNC_MODE_CREATE
)

106 
mode_f›í
 = "wb";

108 i‡((
fûíame
!=
NULL
Ë&& (
mode_f›í
 != NULL))

109 
fûe
 = 
	`f›í
(
fûíame
, 
mode_f›í
);

110  
fûe
;

111 
	}
}

113 
voidpf
 
ZCALLBACK
 
	$f›í64_fûe_func
 (
voidpf
 
›aque
, c⁄° * 
fûíame
, 
mode
)

115 
FILE
* 
fûe
 = 
NULL
;

116 c⁄° * 
mode_f›í
 = 
NULL
;

117 i‡((
mode
 & 
ZLIB_FILEFUNC_MODE_READWRITEFILTER
)==
ZLIB_FILEFUNC_MODE_READ
)

118 
mode_f›í
 = "rb";

120 i‡(
mode
 & 
ZLIB_FILEFUNC_MODE_EXISTING
)

121 
mode_f›í
 = "r+b";

123 i‡(
mode
 & 
ZLIB_FILEFUNC_MODE_CREATE
)

124 
mode_f›í
 = "wb";

126 i‡((
fûíame
!=
NULL
Ë&& (
mode_f›í
 != NULL))

127 
fûe
 = 
	`FOPEN_FUNC
((c⁄° *)
fûíame
, 
mode_f›í
);

128  
fûe
;

129 
	}
}

132 
uL⁄g
 
ZCALLBACK
 
	$‰ód_fûe_func
 (
voidpf
 
›aque
, voidp‡
°ªam
, * 
buf
, 
uL⁄g
 
size
)

134 
uL⁄g
 
ªt
;

135 
ªt
 = (
uL⁄g
)
	`‰ód
(
buf
, 1, (
size_t
)
size
, (
FILE
 *)
°ªam
);

136  
ªt
;

137 
	}
}

139 
uL⁄g
 
ZCALLBACK
 
	$fwrôe_fûe_func
 (
voidpf
 
›aque
, voidp‡
°ªam
, c⁄° * 
buf
, 
uL⁄g
 
size
)

141 
uL⁄g
 
ªt
;

142 
ªt
 = (
uL⁄g
)
	`fwrôe
(
buf
, 1, (
size_t
)
size
, (
FILE
 *)
°ªam
);

143  
ªt
;

144 
	}
}

146 
ZCALLBACK
 
	$·ñl_fûe_func
 (
voidpf
 
›aque
, voidp‡
°ªam
)

148 
ªt
;

149 
ªt
 = 
	`·ñl
((
FILE
 *)
°ªam
);

150  
ªt
;

151 
	}
}

154 
ZPOS64_T
 
ZCALLBACK
 
	$·ñl64_fûe_func
 (
voidpf
 
›aque
, voidp‡
°ªam
)

156 
ZPOS64_T
 
ªt
;

157 
ªt
 = 
	`FTELLO_FUNC
((
FILE
 *)
°ªam
);

158  
ªt
;

159 
	}
}

161 
ZCALLBACK
 
	$f£ek_fûe_func
 (
voidpf
 
›aque
, voidp‡
°ªam
, 
uL⁄g
 
off£t
, 
‹igö
)

163 
f£ek_‹igö
=0;

164 
ªt
;

165 
‹igö
)

167 
ZLIB_FILEFUNC_SEEK_CUR
 :

168 
f£ek_‹igö
 = 
SEEK_CUR
;

170 
ZLIB_FILEFUNC_SEEK_END
 :

171 
f£ek_‹igö
 = 
SEEK_END
;

173 
ZLIB_FILEFUNC_SEEK_SET
 :

174 
f£ek_‹igö
 = 
SEEK_SET
;

178 
ªt
 = 0;

179 i‡(
	`f£ek
((
FILE
 *)
°ªam
, 
off£t
, 
f£ek_‹igö
) != 0)

180 
ªt
 = -1;

181  
ªt
;

182 
	}
}

184 
ZCALLBACK
 
	$f£ek64_fûe_func
 (
voidpf
 
›aque
, voidp‡
°ªam
, 
ZPOS64_T
 
off£t
, 
‹igö
)

186 
f£ek_‹igö
=0;

187 
ªt
;

188 
‹igö
)

190 
ZLIB_FILEFUNC_SEEK_CUR
 :

191 
f£ek_‹igö
 = 
SEEK_CUR
;

193 
ZLIB_FILEFUNC_SEEK_END
 :

194 
f£ek_‹igö
 = 
SEEK_END
;

196 
ZLIB_FILEFUNC_SEEK_SET
 :

197 
f£ek_‹igö
 = 
SEEK_SET
;

201 
ªt
 = 0;

203 if(
	`FSEEKO_FUNC
((
FILE
 *)
°ªam
, 
off£t
, 
f£ek_‹igö
) != 0)

204 
ªt
 = -1;

206  
ªt
;

207 
	}
}

210 
ZCALLBACK
 
	$f˛o£_fûe_func
 (
voidpf
 
›aque
, voidp‡
°ªam
)

212 
ªt
;

213 
ªt
 = 
	`f˛o£
((
FILE
 *)
°ªam
);

214  
ªt
;

215 
	}
}

217 
ZCALLBACK
 
	$„º‹_fûe_func
 (
voidpf
 
›aque
, voidp‡
°ªam
)

219 
ªt
;

220 
ªt
 = 
	`„º‹
((
FILE
 *)
°ªam
);

221  
ªt
;

222 
	}
}

224 
	$fûl_f›í_fûefunc
 (
pzlib_fûefunc_def
)

225 
zlib_fûefunc_def
* 
pzlib_fûefunc_def
;

227 
pzlib_fûefunc_def
->
z›í_fûe
 = 
f›í_fûe_func
;

228 
pzlib_fûefunc_def
->
zªad_fûe
 = 
‰ód_fûe_func
;

229 
pzlib_fûefunc_def
->
zwrôe_fûe
 = 
fwrôe_fûe_func
;

230 
pzlib_fûefunc_def
->
zãŒ_fûe
 = 
·ñl_fûe_func
;

231 
pzlib_fûefunc_def
->
z£ek_fûe
 = 
f£ek_fûe_func
;

232 
pzlib_fûefunc_def
->
z˛o£_fûe
 = 
f˛o£_fûe_func
;

233 
pzlib_fûefunc_def
->
zîr‹_fûe
 = 
„º‹_fûe_func
;

234 
pzlib_fûefunc_def
->
›aque
 = 
NULL
;

235 
	}
}

237 
	$fûl_f›í64_fûefunc
 (
zlib_fûefunc64_def
* 
pzlib_fûefunc_def
)

239 
pzlib_fûefunc_def
->
z›í64_fûe
 = 
f›í64_fûe_func
;

240 
pzlib_fûefunc_def
->
zªad_fûe
 = 
‰ód_fûe_func
;

241 
pzlib_fûefunc_def
->
zwrôe_fûe
 = 
fwrôe_fûe_func
;

242 
pzlib_fûefunc_def
->
zãŒ64_fûe
 = 
·ñl64_fûe_func
;

243 
pzlib_fûefunc_def
->
z£ek64_fûe
 = 
f£ek64_fûe_func
;

244 
pzlib_fûefunc_def
->
z˛o£_fûe
 = 
f˛o£_fûe_func
;

245 
pzlib_fûefunc_def
->
zîr‹_fûe
 = 
„º‹_fûe_func
;

246 
pzlib_fûefunc_def
->
›aque
 = 
NULL
;

247 
	}
}

	@zlib-1.2.8/contrib/minizip/ioapi.h

21 #i‚de‡
_ZLIBIOAPI64_H


22 
	#_ZLIBIOAPI64_H


	)

24 #i‡(!
deföed
(
_WIN32
)Ë&& (!deföed(
WIN32
)Ë&& (!deföed(
__APPLE__
))

29 #i‚de‡
__USE_FILE_OFFSET64


30 
	#__USE_FILE_OFFSET64


	)

32 #i‚de‡
__USE_LARGEFILE64


33 
	#__USE_LARGEFILE64


	)

35 #i‚de‡
_LARGEFILE64_SOURCE


36 
	#_LARGEFILE64_SOURCE


	)

38 #i‚de‡
_FILE_OFFSET_BIT


39 
	#_FILE_OFFSET_BIT
 64

	)

44 
	~<°dio.h
>

45 
	~<°dlib.h
>

46 
	~"zlib.h
"

48 #i‡
deföed
(
USE_FILE32API
)

49 
	#f›í64
 
f›í


	)

50 
	#·ñlo64
 
·ñl


	)

51 
	#f£eko64
 
f£ek


	)

53 #ifde‡
__FªeBSD__


54 
	#f›í64
 
f›í


	)

55 
	#·ñlo64
 
·ñlo


	)

56 
	#f£eko64
 
f£eko


	)

58 #ifde‡
_MSC_VER


59 
	#f›í64
 
f›í


	)

60 #i‡(
_MSC_VER
 >1400Ë&& (!(
deföed
(
NO_MSCVER_FILE64_FUNC
)))

61 
	#·ñlo64
 
_·ñli64


	)

62 
	#f£eko64
 
_f£eki64


	)

64 
	#·ñlo64
 
·ñl


	)

65 
	#f£eko64
 
f£ek


	)

81 #ifde‡
HAVE_MINIZIP64_CONF_H


82 
	~"mz64c⁄f.h
"

86 #ifde‡
HAVE_64BIT_INT_CUSTOM


87 64B
IT_INT_CUSTOM_TYPE
 
	tZPOS64_T
;

89 #ifde‡
HAS_STDINT_H


90 
	~"°döt.h
"

91 
uöt64_t
 
	tZPOS64_T
;

95 
	#MAXU32
 0xffffffff

	)

97 #i‡
deföed
(
_MSC_VER
Ë|| deföed(
__BORLANDC__
)

98 
	t__öt64
 
	tZPOS64_T
;

100 
	tZPOS64_T
;

107 #ifde‡
__˝lu•lus


112 
	#ZLIB_FILEFUNC_SEEK_CUR
 (1)

	)

113 
	#ZLIB_FILEFUNC_SEEK_END
 (2)

	)

114 
	#ZLIB_FILEFUNC_SEEK_SET
 (0)

	)

116 
	#ZLIB_FILEFUNC_MODE_READ
 (1)

	)

117 
	#ZLIB_FILEFUNC_MODE_WRITE
 (2)

	)

118 
	#ZLIB_FILEFUNC_MODE_READWRITEFILTER
 (3)

	)

120 
	#ZLIB_FILEFUNC_MODE_EXISTING
 (4)

	)

121 
	#ZLIB_FILEFUNC_MODE_CREATE
 (8)

	)

124 #i‚de‡
ZCALLBACK


125 #i‡(
deföed
(
WIN32
Ë|| deföed(
_WIN32
Ë|| deföed (
WINDOWS
Ë|| deföed (
_WINDOWS
)Ë&& deföed(
CALLBACK
Ë&& deföed (
USEWINDOWS_CALLBACK
)

126 
	#ZCALLBACK
 
CALLBACK


	)

128 
	#ZCALLBACK


	)

135 
voidpf
 (
	tZCALLBACK
 *
	t›í_fûe_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, c⁄° * 
	tfûíame
, 
	tmode
));

136 
uL⁄g
 (
	tZCALLBACK
 *
	tªad_fûe_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, voidp‡
	t°ªam
, * 
	tbuf
, 
	tuL⁄g
 
	tsize
));

137 
uL⁄g
 (
	tZCALLBACK
 *
	twrôe_fûe_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, voidp‡
	t°ªam
, c⁄° * 
	tbuf
, 
	tuL⁄g
 
	tsize
));

138 (
ZCALLBACK
 *
	t˛o£_fûe_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, voidp‡
	t°ªam
));

139 (
ZCALLBACK
 *
	tã°îr‹_fûe_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, voidp‡
	t°ªam
));

141 (
ZCALLBACK
 *
	tãŒ_fûe_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, voidp‡
	t°ªam
));

142 (
ZCALLBACK
 *
	t£ek_fûe_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, voidp‡
	t°ªam
, 
	tuL⁄g
 
	toff£t
, 
	t‹igö
));

146 
	szlib_fûefunc_def_s


148 
›í_fûe_func
 
z›í_fûe
;

149 
ªad_fûe_func
 
zªad_fûe
;

150 
wrôe_fûe_func
 
zwrôe_fûe
;

151 
ãŒ_fûe_func
 
zãŒ_fûe
;

152 
£ek_fûe_func
 
z£ek_fûe
;

153 
˛o£_fûe_func
 
z˛o£_fûe
;

154 
ã°îr‹_fûe_func
 
zîr‹_fûe
;

155 
voidpf
 
›aque
;

156 } 
	tzlib_fûefunc_def
;

158 
ZPOS64_T
 (
	tZCALLBACK
 *
	tãŒ64_fûe_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, voidp‡
	t°ªam
));

159 (
ZCALLBACK
 *
	t£ek64_fûe_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, voidp‡
	t°ªam
, 
	tZPOS64_T
 
	toff£t
, 
	t‹igö
));

160 
voidpf
 (
	tZCALLBACK
 *
	t›í64_fûe_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, c⁄° * 
	tfûíame
, 
	tmode
));

162 
	szlib_fûefunc64_def_s


164 
›í64_fûe_func
 
z›í64_fûe
;

165 
ªad_fûe_func
 
zªad_fûe
;

166 
wrôe_fûe_func
 
zwrôe_fûe
;

167 
ãŒ64_fûe_func
 
zãŒ64_fûe
;

168 
£ek64_fûe_func
 
z£ek64_fûe
;

169 
˛o£_fûe_func
 
z˛o£_fûe
;

170 
ã°îr‹_fûe_func
 
zîr‹_fûe
;

171 
voidpf
 
›aque
;

172 } 
	tzlib_fûefunc64_def
;

174 
fûl_f›í64_fûefunc
 
OF
((
zlib_fûefunc64_def
* 
pzlib_fûefunc_def
));

175 
fûl_f›í_fûefunc
 
OF
((
zlib_fûefunc_def
* 
pzlib_fûefunc_def
));

178 
	szlib_fûefunc64_32_def_s


180 
zlib_fûefunc64_def
 
zfûe_func64
;

181 
›í_fûe_func
 
z›í32_fûe
;

182 
ãŒ_fûe_func
 
zãŒ32_fûe
;

183 
£ek_fûe_func
 
z£ek32_fûe
;

184 } 
	tzlib_fûefunc64_32_def
;

187 
	#ZREAD64
(
fûefunc
,
fûe°ªam
,
buf
,
size
Ë((*((fûefunc).
zfûe_func64
.
zªad_fûe
)Ë((fûefunc).zfûe_func64.
›aque
,fûe°ªam,buf,size))

	)

188 
	#ZWRITE64
(
fûefunc
,
fûe°ªam
,
buf
,
size
Ë((*((fûefunc).
zfûe_func64
.
zwrôe_fûe
)Ë((fûefunc).zfûe_func64.
›aque
,fûe°ªam,buf,size))

	)

191 
	#ZCLOSE64
(
fûefunc
,
fûe°ªam
Ë((*((fûefunc).
zfûe_func64
.
z˛o£_fûe
)Ë((fûefunc).zfûe_func64.
›aque
,fûe°ªam))

	)

192 
	#ZERROR64
(
fûefunc
,
fûe°ªam
Ë((*((fûefunc).
zfûe_func64
.
zîr‹_fûe
)Ë((fûefunc).zfûe_func64.
›aque
,fûe°ªam))

	)

194 
voidpf
 
ˇŒ_z›í64
 
OF
((c⁄° 
zlib_fûefunc64_32_def
* 
pfûefunc
,c⁄° *
fûíame
,
mode
));

195 
ˇŒ_z£ek64
 
OF
((c⁄° 
zlib_fûefunc64_32_def
* 
pfûefunc
,
voidpf
 
fûe°ªam
, 
ZPOS64_T
 
off£t
, 
‹igö
));

196 
ZPOS64_T
 
ˇŒ_zãŒ64
 
OF
((c⁄° 
zlib_fûefunc64_32_def
* 
pfûefunc
,
voidpf
 
fûe°ªam
));

198 
fûl_zlib_fûefunc64_32_def_‰om_fûefunc32
(
zlib_fûefunc64_32_def
* 
p_fûefunc64_32
,c⁄° 
zlib_fûefunc_def
* 
p_fûefunc32
);

200 
	#ZOPEN64
(
fûefunc
,
fûíame
,
mode
Ë(
	`ˇŒ_z›í64
((&(fûefunc)),(fûíame),(mode)))

	)

201 
	#ZTELL64
(
fûefunc
,
fûe°ªam
Ë(
	`ˇŒ_zãŒ64
((&(fûefunc)),(fûe°ªam)))

	)

202 
	#ZSEEK64
(
fûefunc
,
fûe°ªam
,
pos
,
mode
Ë(
	`ˇŒ_z£ek64
((&(fûefunc)),(fûe°ªam),’os),(mode)))

	)

204 #ifde‡
__˝lu•lus


	@zlib-1.2.8/contrib/minizip/iowin32.c

14 
	~<°dlib.h
>

16 
	~"zlib.h
"

17 
	~"iﬂpi.h
"

18 
	~"iowö32.h
"

20 #i‚de‡
INVALID_HANDLE_VALUE


21 
	#INVALID_HANDLE_VALUE
 (0xFFFFFFFF)

	)

24 #i‚de‡
INVALID_SET_FILE_POINTER


25 
	#INVALID_SET_FILE_POINTER
 ((
DWORD
)-1)

	)

29 #i‡
deföed
(
WINAPI_FAMILY_PARTITION
Ë&& (!(deföed(
IOWIN32_USING_WINRT_API
)))

30 #i‡
WINAPI_FAMILY_PARTITION
(
WINAPI_PARTITION_APP
)

31 
	#IOWIN32_USING_WINRT_API
 1

	)

35 
voidpf
 
ZCALLBACK
 
wö32_›í_fûe_func
 
OF
((voidp‡
›aque
, c⁄° * 
fûíame
, 
mode
));

36 
uL⁄g
 
ZCALLBACK
 
wö32_ªad_fûe_func
 
OF
((
voidpf
 
›aque
, voidp‡
°ªam
, * 
buf
, uL⁄g 
size
));

37 
uL⁄g
 
ZCALLBACK
 
wö32_wrôe_fûe_func
 
OF
((
voidpf
 
›aque
, voidp‡
°ªam
, c⁄° * 
buf
, uL⁄g 
size
));

38 
ZPOS64_T
 
ZCALLBACK
 
wö32_ãŒ64_fûe_func
 
OF
((
voidpf
 
›aque
, voidp‡
°ªam
));

39 
ZCALLBACK
 
wö32_£ek64_fûe_func
 
OF
((
voidpf
 
›aque
, voidp‡
°ªam
, 
ZPOS64_T
 
off£t
, 
‹igö
));

40 
ZCALLBACK
 
wö32_˛o£_fûe_func
 
OF
((
voidpf
 
›aque
, voidp‡
°ªam
));

41 
ZCALLBACK
 
wö32_îr‹_fûe_func
 
OF
((
voidpf
 
›aque
, voidp‡
°ªam
));

45 
HANDLE
 
	mhf
;

46 
	mîr‹
;

47 } 
	tWIN32FILE_IOWIN
;

50 
	$wö32_å™¶©e_›í_mode
(
mode
,

51 
DWORD
* 
ÕdwDesúedAc˚ss
,

52 
DWORD
* 
ÕdwCª©i⁄Di•osôi⁄
,

53 
DWORD
* 
ÕdwSh¨eMode
,

54 
DWORD
* 
ÕdwFœgsAndAâribuãs
)

56 *
ÕdwDesúedAc˚ss
 = *
ÕdwSh¨eMode
 = *
ÕdwFœgsAndAâribuãs
 = *
ÕdwCª©i⁄Di•osôi⁄
 = 0;

58 i‡((
mode
 & 
ZLIB_FILEFUNC_MODE_READWRITEFILTER
)==
ZLIB_FILEFUNC_MODE_READ
)

60 *
ÕdwDesúedAc˚ss
 = 
GENERIC_READ
;

61 *
ÕdwCª©i⁄Di•osôi⁄
 = 
OPEN_EXISTING
;

62 *
ÕdwSh¨eMode
 = 
FILE_SHARE_READ
;

64 i‡(
mode
 & 
ZLIB_FILEFUNC_MODE_EXISTING
)

66 *
ÕdwDesúedAc˚ss
 = 
GENERIC_WRITE
 | 
GENERIC_READ
;

67 *
ÕdwCª©i⁄Di•osôi⁄
 = 
OPEN_EXISTING
;

69 i‡(
mode
 & 
ZLIB_FILEFUNC_MODE_CREATE
)

71 *
ÕdwDesúedAc˚ss
 = 
GENERIC_WRITE
 | 
GENERIC_READ
;

72 *
ÕdwCª©i⁄Di•osôi⁄
 = 
CREATE_ALWAYS
;

74 
	}
}

76 
voidpf
 
	$wö32_buûd_iowö
(
HANDLE
 
hFûe
)

78 
voidpf
 
ªt
=
NULL
;

80 i‡((
hFûe
 !
NULL
Ë&& (hFûê!
INVALID_HANDLE_VALUE
))

82 
WIN32FILE_IOWIN
 
w32fiow
;

83 
w32fiow
.
hf
 = 
hFûe
;

84 
w32fiow
.
îr‹
 = 0;

85 
ªt
 = 
	`mÆloc
((
WIN32FILE_IOWIN
));

87 i‡(
ªt
==
NULL
)

88 
	`Clo£H™dÀ
(
hFûe
);

90 *((
WIN32FILE_IOWIN
*)
ªt
Ë
w32fiow
;

92  
ªt
;

93 
	}
}

95 
voidpf
 
ZCALLBACK
 
	$wö32_›í64_fûe_func
 (
voidpf
 
›aque
,c⁄° * 
fûíame
,
mode
)

97 c⁄° * 
mode_f›í
 = 
NULL
;

98 
DWORD
 
dwDesúedAc˚ss
,
dwCª©i⁄Di•osôi⁄
,
dwSh¨eMode
,
dwFœgsAndAâribuãs
 ;

99 
HANDLE
 
hFûe
 = 
NULL
;

101 
	`wö32_å™¶©e_›í_mode
(
mode
,&
dwDesúedAc˚ss
,&
dwCª©i⁄Di•osôi⁄
,&
dwSh¨eMode
,&
dwFœgsAndAâribuãs
);

103 #ifde‡
IOWIN32_USING_WINRT_API


104 #ifde‡
UNICODE


105 i‡((
fûíame
!=
NULL
Ë&& (
dwDesúedAc˚ss
 != 0))

106 
hFûe
 = 
	`Cª©eFûe2
((
LPCTSTR
)
fûíame
, 
dwDesúedAc˚ss
, 
dwSh¨eMode
, 
dwCª©i⁄Di•osôi⁄
, 
NULL
);

108 i‡((
fûíame
!=
NULL
Ë&& (
dwDesúedAc˚ss
 != 0))

110 
WCHAR
 
fûíameW
[
FILENAME_MAX
 + 0x200 + 1];

111 
	`Mu…iByãToWideCh¨
(
CP_ACP
,0,(c⁄° *)
fûíame
,-1,
fûíameW
,
FILENAME_MAX
 + 0x200);

112 
hFûe
 = 
	`Cª©eFûe2
(
fûíameW
, 
dwDesúedAc˚ss
, 
dwSh¨eMode
, 
dwCª©i⁄Di•osôi⁄
, 
NULL
);

116 i‡((
fûíame
!=
NULL
Ë&& (
dwDesúedAc˚ss
 != 0))

117 
hFûe
 = 
	`Cª©eFûe
((
LPCTSTR
)
fûíame
, 
dwDesúedAc˚ss
, 
dwSh¨eMode
, 
NULL
, 
dwCª©i⁄Di•osôi⁄
, 
dwFœgsAndAâribuãs
, NULL);

120  
	`wö32_buûd_iowö
(
hFûe
);

121 
	}
}

124 
voidpf
 
ZCALLBACK
 
	$wö32_›í64_fûe_funcA
 (
voidpf
 
›aque
,c⁄° * 
fûíame
,
mode
)

126 c⁄° * 
mode_f›í
 = 
NULL
;

127 
DWORD
 
dwDesúedAc˚ss
,
dwCª©i⁄Di•osôi⁄
,
dwSh¨eMode
,
dwFœgsAndAâribuãs
 ;

128 
HANDLE
 
hFûe
 = 
NULL
;

130 
	`wö32_å™¶©e_›í_mode
(
mode
,&
dwDesúedAc˚ss
,&
dwCª©i⁄Di•osôi⁄
,&
dwSh¨eMode
,&
dwFœgsAndAâribuãs
);

132 #ifde‡
IOWIN32_USING_WINRT_API


133 i‡((
fûíame
!=
NULL
Ë&& (
dwDesúedAc˚ss
 != 0))

135 
WCHAR
 
fûíameW
[
FILENAME_MAX
 + 0x200 + 1];

136 
	`Mu…iByãToWideCh¨
(
CP_ACP
,0,(c⁄° *)
fûíame
,-1,
fûíameW
,
FILENAME_MAX
 + 0x200);

137 
hFûe
 = 
	`Cª©eFûe2
(
fûíameW
, 
dwDesúedAc˚ss
, 
dwSh¨eMode
, 
dwCª©i⁄Di•osôi⁄
, 
NULL
);

140 i‡((
fûíame
!=
NULL
Ë&& (
dwDesúedAc˚ss
 != 0))

141 
hFûe
 = 
	`Cª©eFûeA
((
LPCSTR
)
fûíame
, 
dwDesúedAc˚ss
, 
dwSh¨eMode
, 
NULL
, 
dwCª©i⁄Di•osôi⁄
, 
dwFœgsAndAâribuãs
, NULL);

144  
	`wö32_buûd_iowö
(
hFûe
);

145 
	}
}

148 
voidpf
 
ZCALLBACK
 
	$wö32_›í64_fûe_funcW
 (
voidpf
 
›aque
,c⁄° * 
fûíame
,
mode
)

150 c⁄° * 
mode_f›í
 = 
NULL
;

151 
DWORD
 
dwDesúedAc˚ss
,
dwCª©i⁄Di•osôi⁄
,
dwSh¨eMode
,
dwFœgsAndAâribuãs
 ;

152 
HANDLE
 
hFûe
 = 
NULL
;

154 
	`wö32_å™¶©e_›í_mode
(
mode
,&
dwDesúedAc˚ss
,&
dwCª©i⁄Di•osôi⁄
,&
dwSh¨eMode
,&
dwFœgsAndAâribuãs
);

156 #ifde‡
IOWIN32_USING_WINRT_API


157 i‡((
fûíame
!=
NULL
Ë&& (
dwDesúedAc˚ss
 != 0))

158 
hFûe
 = 
	`Cª©eFûe2
((
LPCWSTR
)
fûíame
, 
dwDesúedAc˚ss
, 
dwSh¨eMode
, 
dwCª©i⁄Di•osôi⁄
,
NULL
);

160 i‡((
fûíame
!=
NULL
Ë&& (
dwDesúedAc˚ss
 != 0))

161 
hFûe
 = 
	`Cª©eFûeW
((
LPCWSTR
)
fûíame
, 
dwDesúedAc˚ss
, 
dwSh¨eMode
, 
NULL
, 
dwCª©i⁄Di•osôi⁄
, 
dwFœgsAndAâribuãs
, NULL);

164  
	`wö32_buûd_iowö
(
hFûe
);

165 
	}
}

168 
voidpf
 
ZCALLBACK
 
	$wö32_›í_fûe_func
 (
voidpf
 
›aque
,c⁄° * 
fûíame
,
mode
)

170 c⁄° * 
mode_f›í
 = 
NULL
;

171 
DWORD
 
dwDesúedAc˚ss
,
dwCª©i⁄Di•osôi⁄
,
dwSh¨eMode
,
dwFœgsAndAâribuãs
 ;

172 
HANDLE
 
hFûe
 = 
NULL
;

174 
	`wö32_å™¶©e_›í_mode
(
mode
,&
dwDesúedAc˚ss
,&
dwCª©i⁄Di•osôi⁄
,&
dwSh¨eMode
,&
dwFœgsAndAâribuãs
);

176 #ifde‡
IOWIN32_USING_WINRT_API


177 #ifde‡
UNICODE


178 i‡((
fûíame
!=
NULL
Ë&& (
dwDesúedAc˚ss
 != 0))

179 
hFûe
 = 
	`Cª©eFûe2
((
LPCTSTR
)
fûíame
, 
dwDesúedAc˚ss
, 
dwSh¨eMode
, 
dwCª©i⁄Di•osôi⁄
, 
NULL
);

181 i‡((
fûíame
!=
NULL
Ë&& (
dwDesúedAc˚ss
 != 0))

183 
WCHAR
 
fûíameW
[
FILENAME_MAX
 + 0x200 + 1];

184 
	`Mu…iByãToWideCh¨
(
CP_ACP
,0,(c⁄° *)
fûíame
,-1,
fûíameW
,
FILENAME_MAX
 + 0x200);

185 
hFûe
 = 
	`Cª©eFûe2
(
fûíameW
, 
dwDesúedAc˚ss
, 
dwSh¨eMode
, 
dwCª©i⁄Di•osôi⁄
, 
NULL
);

189 i‡((
fûíame
!=
NULL
Ë&& (
dwDesúedAc˚ss
 != 0))

190 
hFûe
 = 
	`Cª©eFûe
((
LPCTSTR
)
fûíame
, 
dwDesúedAc˚ss
, 
dwSh¨eMode
, 
NULL
, 
dwCª©i⁄Di•osôi⁄
, 
dwFœgsAndAâribuãs
, NULL);

193  
	`wö32_buûd_iowö
(
hFûe
);

194 
	}
}

197 
uL⁄g
 
ZCALLBACK
 
	$wö32_ªad_fûe_func
 (
voidpf
 
›aque
, voidp‡
°ªam
, * 
buf
,
uL⁄g
 
size
)

199 
uL⁄g
 
ªt
=0;

200 
HANDLE
 
hFûe
 = 
NULL
;

201 i‡(
°ªam
!=
NULL
)

202 
hFûe
 = ((
WIN32FILE_IOWIN
*)
°ªam
Ë-> 
hf
;

204 i‡(
hFûe
 !
NULL
)

206 i‡(!
	`RódFûe
(
hFûe
, 
buf
, 
size
, &
ªt
, 
NULL
))

208 
DWORD
 
dwEº
 = 
	`GëLa°Eº‹
();

209 i‡(
dwEº
 =
ERROR_HANDLE_EOF
)

210 
dwEº
 = 0;

211 ((
WIN32FILE_IOWIN
*)
°ªam
Ë-> 
îr‹
=()
dwEº
;

215  
ªt
;

216 
	}
}

219 
uL⁄g
 
ZCALLBACK
 
	$wö32_wrôe_fûe_func
 (
voidpf
 
›aque
,voidp‡
°ªam
,c⁄° * 
buf
,
uL⁄g
 
size
)

221 
uL⁄g
 
ªt
=0;

222 
HANDLE
 
hFûe
 = 
NULL
;

223 i‡(
°ªam
!=
NULL
)

224 
hFûe
 = ((
WIN32FILE_IOWIN
*)
°ªam
Ë-> 
hf
;

226 i‡(
hFûe
 !
NULL
)

228 i‡(!
	`WrôeFûe
(
hFûe
, 
buf
, 
size
, &
ªt
, 
NULL
))

230 
DWORD
 
dwEº
 = 
	`GëLa°Eº‹
();

231 i‡(
dwEº
 =
ERROR_HANDLE_EOF
)

232 
dwEº
 = 0;

233 ((
WIN32FILE_IOWIN
*)
°ªam
Ë-> 
îr‹
=()
dwEº
;

237  
ªt
;

238 
	}
}

240 
BOOL
 
	$MySëFûePoöãrEx
(
HANDLE
 
hFûe
, 
LARGE_INTEGER
 
pos
, LARGE_INTEGER *
√wPos
, 
DWORD
 
dwMoveMëhod
)

242 #ifde‡
IOWIN32_USING_WINRT_API


243  
	`SëFûePoöãrEx
(
hFûe
, 
pos
, 
√wPos
, 
dwMoveMëhod
);

245 
LONG
 
lHigh
 = 
pos
.
HighP¨t
;

246 
DWORD
 
dwNewPos
 = 
	`SëFûePoöãr
(
hFûe
, 
pos
.
LowP¨t
, &
lHigh
, 
FILE_CURRENT
);

247 
BOOL
 
fOk
 = 
TRUE
;

248 i‡(
dwNewPos
 == 0xFFFFFFFF)

249 i‡(
	`GëLa°Eº‹
(Ë!
NO_ERROR
)

250 
fOk
 = 
FALSE
;

251 i‡((
√wPos
 !
NULL
Ë&& (
fOk
))

253 
√wPos
->
LowP¨t
 = 
dwNewPos
;

254 
√wPos
->
HighP¨t
 = 
lHigh
;

256  
fOk
;

258 
	}
}

260 
ZCALLBACK
 
	$wö32_ãŒ_fûe_func
 (
voidpf
 
›aque
,voidp‡
°ªam
)

262 
ªt
=-1;

263 
HANDLE
 
hFûe
 = 
NULL
;

264 i‡(
°ªam
!=
NULL
)

265 
hFûe
 = ((
WIN32FILE_IOWIN
*)
°ªam
Ë-> 
hf
;

266 i‡(
hFûe
 !
NULL
)

268 
LARGE_INTEGER
 
pos
;

269 
pos
.
QuadP¨t
 = 0;

271 i‡(!
	`MySëFûePoöãrEx
(
hFûe
, 
pos
, &pos, 
FILE_CURRENT
))

273 
DWORD
 
dwEº
 = 
	`GëLa°Eº‹
();

274 ((
WIN32FILE_IOWIN
*)
°ªam
Ë-> 
îr‹
=()
dwEº
;

275 
ªt
 = -1;

278 
ªt
=()
pos
.
LowP¨t
;

280  
ªt
;

281 
	}
}

283 
ZPOS64_T
 
ZCALLBACK
 
	$wö32_ãŒ64_fûe_func
 (
voidpf
 
›aque
, voidp‡
°ªam
)

285 
ZPOS64_T
 
ªt
= (ZPOS64_T)-1;

286 
HANDLE
 
hFûe
 = 
NULL
;

287 i‡(
°ªam
!=
NULL
)

288 
hFûe
 = ((
WIN32FILE_IOWIN
*)
°ªam
)->
hf
;

290 i‡(
hFûe
)

292 
LARGE_INTEGER
 
pos
;

293 
pos
.
QuadP¨t
 = 0;

295 i‡(!
	`MySëFûePoöãrEx
(
hFûe
, 
pos
, &pos, 
FILE_CURRENT
))

297 
DWORD
 
dwEº
 = 
	`GëLa°Eº‹
();

298 ((
WIN32FILE_IOWIN
*)
°ªam
Ë-> 
îr‹
=()
dwEº
;

299 
ªt
 = (
ZPOS64_T
)-1;

302 
ªt
=
pos
.
QuadP¨t
;

304  
ªt
;

305 
	}
}

308 
ZCALLBACK
 
	$wö32_£ek_fûe_func
 (
voidpf
 
›aque
,voidp‡
°ªam
,
uL⁄g
 
off£t
,
‹igö
)

310 
DWORD
 
dwMoveMëhod
=0xFFFFFFFF;

311 
HANDLE
 
hFûe
 = 
NULL
;

313 
ªt
=-1;

314 i‡(
°ªam
!=
NULL
)

315 
hFûe
 = ((
WIN32FILE_IOWIN
*)
°ªam
Ë-> 
hf
;

316 
‹igö
)

318 
ZLIB_FILEFUNC_SEEK_CUR
 :

319 
dwMoveMëhod
 = 
FILE_CURRENT
;

321 
ZLIB_FILEFUNC_SEEK_END
 :

322 
dwMoveMëhod
 = 
FILE_END
;

324 
ZLIB_FILEFUNC_SEEK_SET
 :

325 
dwMoveMëhod
 = 
FILE_BEGIN
;

330 i‡(
hFûe
 !
NULL
)

332 
LARGE_INTEGER
 
pos
;

333 
pos
.
QuadP¨t
 = 
off£t
;

334 i‡(!
	`MySëFûePoöãrEx
(
hFûe
, 
pos
, 
NULL
, 
dwMoveMëhod
))

336 
DWORD
 
dwEº
 = 
	`GëLa°Eº‹
();

337 ((
WIN32FILE_IOWIN
*)
°ªam
Ë-> 
îr‹
=()
dwEº
;

338 
ªt
 = -1;

341 
ªt
=0;

343  
ªt
;

344 
	}
}

346 
ZCALLBACK
 
	$wö32_£ek64_fûe_func
 (
voidpf
 
›aque
, voidp‡
°ªam
,
ZPOS64_T
 
off£t
,
‹igö
)

348 
DWORD
 
dwMoveMëhod
=0xFFFFFFFF;

349 
HANDLE
 
hFûe
 = 
NULL
;

350 
ªt
=-1;

352 i‡(
°ªam
!=
NULL
)

353 
hFûe
 = ((
WIN32FILE_IOWIN
*)
°ªam
)->
hf
;

355 
‹igö
)

357 
ZLIB_FILEFUNC_SEEK_CUR
 :

358 
dwMoveMëhod
 = 
FILE_CURRENT
;

360 
ZLIB_FILEFUNC_SEEK_END
 :

361 
dwMoveMëhod
 = 
FILE_END
;

363 
ZLIB_FILEFUNC_SEEK_SET
 :

364 
dwMoveMëhod
 = 
FILE_BEGIN
;

369 i‡(
hFûe
)

371 
LARGE_INTEGER
 
pos
;

372 
pos
.
QuadP¨t
 = 
off£t
;

373 i‡(!
	`MySëFûePoöãrEx
(
hFûe
, 
pos
, 
NULL
, 
FILE_CURRENT
))

375 
DWORD
 
dwEº
 = 
	`GëLa°Eº‹
();

376 ((
WIN32FILE_IOWIN
*)
°ªam
Ë-> 
îr‹
=()
dwEº
;

377 
ªt
 = -1;

380 
ªt
=0;

382  
ªt
;

383 
	}
}

385 
ZCALLBACK
 
	$wö32_˛o£_fûe_func
 (
voidpf
 
›aque
, voidp‡
°ªam
)

387 
ªt
=-1;

389 i‡(
°ªam
!=
NULL
)

391 
HANDLE
 
hFûe
;

392 
hFûe
 = ((
WIN32FILE_IOWIN
*)
°ªam
Ë-> 
hf
;

393 i‡(
hFûe
 !
NULL
)

395 
	`Clo£H™dÀ
(
hFûe
);

396 
ªt
=0;

398 
	`‰ì
(
°ªam
);

400  
ªt
;

401 
	}
}

403 
ZCALLBACK
 
	$wö32_îr‹_fûe_func
 (
voidpf
 
›aque
,voidp‡
°ªam
)

405 
ªt
=-1;

406 i‡(
°ªam
!=
NULL
)

408 
ªt
 = ((
WIN32FILE_IOWIN
*)
°ªam
Ë-> 
îr‹
;

410  
ªt
;

411 
	}
}

413 
	$fûl_wö32_fûefunc
 (
zlib_fûefunc_def
* 
pzlib_fûefunc_def
)

415 
pzlib_fûefunc_def
->
z›í_fûe
 = 
wö32_›í_fûe_func
;

416 
pzlib_fûefunc_def
->
zªad_fûe
 = 
wö32_ªad_fûe_func
;

417 
pzlib_fûefunc_def
->
zwrôe_fûe
 = 
wö32_wrôe_fûe_func
;

418 
pzlib_fûefunc_def
->
zãŒ_fûe
 = 
wö32_ãŒ_fûe_func
;

419 
pzlib_fûefunc_def
->
z£ek_fûe
 = 
wö32_£ek_fûe_func
;

420 
pzlib_fûefunc_def
->
z˛o£_fûe
 = 
wö32_˛o£_fûe_func
;

421 
pzlib_fûefunc_def
->
zîr‹_fûe
 = 
wö32_îr‹_fûe_func
;

422 
pzlib_fûefunc_def
->
›aque
 = 
NULL
;

423 
	}
}

425 
	$fûl_wö32_fûefunc64
(
zlib_fûefunc64_def
* 
pzlib_fûefunc_def
)

427 
pzlib_fûefunc_def
->
z›í64_fûe
 = 
wö32_›í64_fûe_func
;

428 
pzlib_fûefunc_def
->
zªad_fûe
 = 
wö32_ªad_fûe_func
;

429 
pzlib_fûefunc_def
->
zwrôe_fûe
 = 
wö32_wrôe_fûe_func
;

430 
pzlib_fûefunc_def
->
zãŒ64_fûe
 = 
wö32_ãŒ64_fûe_func
;

431 
pzlib_fûefunc_def
->
z£ek64_fûe
 = 
wö32_£ek64_fûe_func
;

432 
pzlib_fûefunc_def
->
z˛o£_fûe
 = 
wö32_˛o£_fûe_func
;

433 
pzlib_fûefunc_def
->
zîr‹_fûe
 = 
wö32_îr‹_fûe_func
;

434 
pzlib_fûefunc_def
->
›aque
 = 
NULL
;

435 
	}
}

438 
	$fûl_wö32_fûefunc64A
(
zlib_fûefunc64_def
* 
pzlib_fûefunc_def
)

440 
pzlib_fûefunc_def
->
z›í64_fûe
 = 
wö32_›í64_fûe_funcA
;

441 
pzlib_fûefunc_def
->
zªad_fûe
 = 
wö32_ªad_fûe_func
;

442 
pzlib_fûefunc_def
->
zwrôe_fûe
 = 
wö32_wrôe_fûe_func
;

443 
pzlib_fûefunc_def
->
zãŒ64_fûe
 = 
wö32_ãŒ64_fûe_func
;

444 
pzlib_fûefunc_def
->
z£ek64_fûe
 = 
wö32_£ek64_fûe_func
;

445 
pzlib_fûefunc_def
->
z˛o£_fûe
 = 
wö32_˛o£_fûe_func
;

446 
pzlib_fûefunc_def
->
zîr‹_fûe
 = 
wö32_îr‹_fûe_func
;

447 
pzlib_fûefunc_def
->
›aque
 = 
NULL
;

448 
	}
}

451 
	$fûl_wö32_fûefunc64W
(
zlib_fûefunc64_def
* 
pzlib_fûefunc_def
)

453 
pzlib_fûefunc_def
->
z›í64_fûe
 = 
wö32_›í64_fûe_funcW
;

454 
pzlib_fûefunc_def
->
zªad_fûe
 = 
wö32_ªad_fûe_func
;

455 
pzlib_fûefunc_def
->
zwrôe_fûe
 = 
wö32_wrôe_fûe_func
;

456 
pzlib_fûefunc_def
->
zãŒ64_fûe
 = 
wö32_ãŒ64_fûe_func
;

457 
pzlib_fûefunc_def
->
z£ek64_fûe
 = 
wö32_£ek64_fûe_func
;

458 
pzlib_fûefunc_def
->
z˛o£_fûe
 = 
wö32_˛o£_fûe_func
;

459 
pzlib_fûefunc_def
->
zîr‹_fûe
 = 
wö32_îr‹_fûe_func
;

460 
pzlib_fûefunc_def
->
›aque
 = 
NULL
;

461 
	}
}

	@zlib-1.2.8/contrib/minizip/iowin32.h

14 
	~<wödows.h
>

17 #ifde‡
__˝lu•lus


21 
fûl_wö32_fûefunc
 
OF
((
zlib_fûefunc_def
* 
pzlib_fûefunc_def
));

22 
fûl_wö32_fûefunc64
 
OF
((
zlib_fûefunc64_def
* 
pzlib_fûefunc_def
));

23 
fûl_wö32_fûefunc64A
 
OF
((
zlib_fûefunc64_def
* 
pzlib_fûefunc_def
));

24 
fûl_wö32_fûefunc64W
 
OF
((
zlib_fûefunc64_def
* 
pzlib_fûefunc_def
));

26 #ifde‡
__˝lu•lus


	@zlib-1.2.8/contrib/minizip/miniunz.c

15 #i‡(!
deföed
(
_WIN32
)Ë&& (!deföed(
WIN32
)Ë&& (!deföed(
__APPLE__
))

16 #i‚de‡
__USE_FILE_OFFSET64


17 
	#__USE_FILE_OFFSET64


	)

19 #i‚de‡
__USE_LARGEFILE64


20 
	#__USE_LARGEFILE64


	)

22 #i‚de‡
_LARGEFILE64_SOURCE


23 
	#_LARGEFILE64_SOURCE


	)

25 #i‚de‡
_FILE_OFFSET_BIT


26 
	#_FILE_OFFSET_BIT
 64

	)

30 #ifde‡
__APPLE__


32 
	#FOPEN_FUNC
(
fûíame
, 
mode
Ë
	`f›í
(fûíame, mode)

	)

33 
	#FTELLO_FUNC
(
°ªam
Ë
	`·ñlo
(°ªam)

	)

34 
	#FSEEKO_FUNC
(
°ªam
, 
off£t
, 
‹igö
Ë
	`f£eko
(°ªam, off£t, origö)

	)

36 
	#FOPEN_FUNC
(
fûíame
, 
mode
Ë
	`f›í64
(fûíame, mode)

	)

37 
	#FTELLO_FUNC
(
°ªam
Ë
	`·ñlo64
(°ªam)

	)

38 
	#FSEEKO_FUNC
(
°ªam
, 
off£t
, 
‹igö
Ë
	`f£eko64
(°ªam, off£t, origö)

	)

42 
	~<°dio.h
>

43 
	~<°dlib.h
>

44 
	~<°rög.h
>

45 
	~<time.h
>

46 
	~<î∫o.h
>

47 
	~<f˙é.h
>

49 #ifde‡
_WIN32


50 
	~<dúe˘.h
>

51 
	~<io.h
>

53 
	~<uni°d.h
>

54 
	~<utime.h
>

58 
	~"unzù.h
"

60 
	#CASESENSITIVITY
 (0)

	)

61 
	#WRITEBUFFERSIZE
 (8192)

	)

62 
	#MAXFILENAME
 (256)

	)

64 #ifde‡
_WIN32


65 
	#USEWIN32IOAPI


	)

66 
	~"iowö32.h
"

83 
	$ch™ge_fûe_d©e
(
fûíame
,
dosd©e
,
tmu_d©e
)

84 c⁄° *
fûíame
;

85 
uL⁄g
 
dosd©e
;

86 
tm_unz
 
tmu_d©e
;

88 #ifde‡
_WIN32


89 
HANDLE
 
hFûe
;

90 
FILETIME
 
·m
,
·Loˇl
,
·Cª©e
,
·La°Acc
,
·La°Wrôe
;

92 
hFûe
 = 
	`Cª©eFûeA
(
fûíame
,
GENERIC_READ
 | 
GENERIC_WRITE
,

93 0,
NULL
,
OPEN_EXISTING
,0,NULL);

94 
	`GëFûeTime
(
hFûe
,&
·Cª©e
,&
·La°Acc
,&
·La°Wrôe
);

95 
	`DosD©eTimeToFûeTime
((
WORD
)(
dosd©e
>>16),(WORD)dosd©e,&
·Loˇl
);

96 
	`LoˇlFûeTimeToFûeTime
(&
·Loˇl
,&
·m
);

97 
	`SëFûeTime
(
hFûe
,&
·m
,&
·La°Acc
,&ftm);

98 
	`Clo£H™dÀ
(
hFûe
);

100 #ifde‡
unix
 || 
__APPLE__


101 
utimbuf
 
ut
;

102 
tm
 
√wd©e
;

103 
√wd©e
.
tm_£c
 = 
tmu_d©e
.tm_sec;

104 
√wd©e
.
tm_mö
=
tmu_d©e
.tm_min;

105 
√wd©e
.
tm_hour
=
tmu_d©e
.tm_hour;

106 
√wd©e
.
tm_mday
=
tmu_d©e
.tm_mday;

107 
√wd©e
.
tm_m⁄
=
tmu_d©e
.tm_mon;

108 i‡(
tmu_d©e
.
tm_yór
 > 1900)

109 
√wd©e
.
tm_yór
=
tmu_d©e
.tm_year - 1900;

111 
√wd©e
.
tm_yór
=
tmu_d©e
.tm_year ;

112 
√wd©e
.
tm_isd°
=-1;

114 
ut
.
a˘ime
=ut.
modtime
=
	`mktime
(&
√wd©e
);

115 
	`utime
(
fûíame
,&
ut
);

118 
	}
}

124 
	$mymkdú
(
dú«me
)

125 c⁄° * 
dú«me
;

127 
ªt
=0;

128 #ifde‡
_WIN32


129 
ªt
 = 
	`_mkdú
(
dú«me
);

130 #ñi‡
unix


131 
ªt
 = 
	`mkdú
 (
dú«me
,0775);

132 #ñi‡
__APPLE__


133 
ªt
 = 
	`mkdú
 (
dú«me
,0775);

135  
ªt
;

136 
	}
}

138 
	$makedú
 (
√wdú
)

139 *
√wdú
;

141 *
buf„r
 ;

142 *
p
;

143 
Àn
 = ()
	`°æí
(
√wdú
);

145 i‡(
Àn
 <= 0)

148 
buf„r
 = (*)
	`mÆloc
(
Àn
+1);

149 i‡(
buf„r
==
NULL
)

151 
	`¥ötf
("Errorállocating memory\n");

152  
UNZ_INTERNALERROR
;

154 
	`°r˝y
(
buf„r
,
√wdú
);

156 i‡(
buf„r
[
Àn
-1] == '/') {

157 
buf„r
[
Àn
-1] = '\0';

159 i‡(
	`mymkdú
(
buf„r
) == 0)

161 
	`‰ì
(
buf„r
);

165 
p
 = 
buf„r
+1;

168 
hﬁd
;

170 *
p
 && *p != '\\' && *p != '/')

171 
p
++;

172 
hﬁd
 = *
p
;

173 *
p
 = 0;

174 i‡((
	`mymkdú
(
buf„r
Ë=-1Ë&& (
î∫o
 =
ENOENT
))

176 
	`¥ötf
("couldn'à¸óã dúe˘‹y %s\n",
buf„r
);

177 
	`‰ì
(
buf„r
);

180 i‡(
hﬁd
 == 0)

182 *
p
++ = 
hﬁd
;

184 
	`‰ì
(
buf„r
);

186 
	}
}

188 
	$do_b™√r
()

190 
	`¥ötf
("MiniUnz 1.01b, demo of zLib + UnzÖackage written by Gilles Vollant\n");

191 
	`¥ötf
("more infoát http://www.winimage.com/zLibDll/unzip.html\n\n");

192 
	}
}

194 
	$do_hñp
()

196 
	`¥ötf
("Usage : miniunz [-e] [-x] [-v] [-l] [-o] [-pÖassword] file.zip [file_to_extr.] [-dÉxtractdir]\n\n" \

204 
	}
}

206 
	$Di•œy64BôsSize
(
ZPOS64_T
 
n
, 
size_ch¨
)

209 
numbî
[21];

210 
off£t
=19;

211 
pos_°rög
 = 19;

212 
numbî
[20]=0;

214 
numbî
[
off£t
]=()((
n
%10)+'0');

215 i‡(
numbî
[
off£t
] != '0')

216 
pos_°rög
=
off£t
;

217 
n
/=10;

218 i‡(
off£t
==0)

220 
off£t
--;

223 
size_di•œy_°rög
 = 19-
pos_°rög
;

224 
size_ch¨
 > 
size_di•œy_°rög
)

226 
size_ch¨
--;

227 
	`¥ötf
(" ");

231 
	`¥ötf
("%s",&
numbî
[
pos_°rög
]);

232 
	}
}

234 
	$do_li°
(
uf
)

235 
unzFûe
 
uf
;

237 
uL⁄g
 
i
;

238 
unz_globÆ_öfo64
 
gi
;

239 
îr
;

241 
îr
 = 
	`unzGëGlobÆInfo64
(
uf
,&
gi
);

242 i‡(
îr
!=
UNZ_OK
)

243 
	`¥ötf
("îr‹ %d wôh zùfûêö unzGëGlobÆInfÿ\n",
îr
);

244 
	`¥ötf
(" Length Method Size Ratio Date Time CRC-32 Name\n");

245 
	`¥ötf
(" ------ ------ ---- ----- ---- ---- ------ ----\n");

246 
i
=0;i<
gi
.
numbî_íåy
;i++)

248 
fûíame_özù
[256];

249 
unz_fûe_öfo64
 
fûe_öfo
;

250 
uL⁄g
 
øtio
=0;

251 c⁄° *
°rög_mëhod
;

252 
ch¨Cry±
=' ';

253 
îr
 = 
	`unzGëCuºítFûeInfo64
(
uf
,&
fûe_öfo
,
fûíame_özù
,(fûíame_özù),
NULL
,0,NULL,0);

254 i‡(
îr
!=
UNZ_OK
)

256 
	`¥ötf
("îr‹ %d wôh zùfûêö unzGëCuºítFûeInfo\n",
îr
);

259 i‡(
fûe_öfo
.
uncom¥es£d_size
>0)

260 
øtio
 = (
uL⁄g
)((
fûe_öfo
.
com¥es£d_size
*100)/fûe_öfo.
uncom¥es£d_size
);

263 i‡((
fûe_öfo
.
Êag
 & 1) != 0)

264 
ch¨Cry±
='*';

266 i‡(
fûe_öfo
.
com¥essi⁄_mëhod
==0)

267 
°rög_mëhod
="Stored";

269 i‡(
fûe_öfo
.
com¥essi⁄_mëhod
==
Z_DEFLATED
)

271 
uI¡
 
iLevñ
=(uI¡)((
fûe_öfo
.
Êag
 & 0x6)/2);

272 i‡(
iLevñ
==0)

273 
°rög_mëhod
="Defl:N";

274 i‡(
iLevñ
==1)

275 
°rög_mëhod
="Defl:X";

276 i‡((
iLevñ
==2) || (iLevel==3))

277 
°rög_mëhod
="Defl:F";

280 i‡(
fûe_öfo
.
com¥essi⁄_mëhod
==
Z_BZIP2ED
)

282 
°rög_mëhod
="BZip2 ";

285 
°rög_mëhod
="Unkn. ";

287 
	`Di•œy64BôsSize
(
fûe_öfo
.
uncom¥es£d_size
,7);

288 
	`¥ötf
(" %6s%c",
°rög_mëhod
,
ch¨Cry±
);

289 
	`Di•œy64BôsSize
(
fûe_öfo
.
com¥es£d_size
,7);

290 
	`¥ötf
(" %3lu%% %2.2lu-%2.2lu-%2.2lu %2.2lu:%2.2lu %8.8lx %s\n",

291 
øtio
,

292 (
uL⁄g
)
fûe_öfo
.
tmu_d©e
.
tm_m⁄
 + 1,

293 (
uL⁄g
)
fûe_öfo
.
tmu_d©e
.
tm_mday
,

294 (
uL⁄g
)
fûe_öfo
.
tmu_d©e
.
tm_yór
 % 100,

295 (
uL⁄g
)
fûe_öfo
.
tmu_d©e
.
tm_hour
,(uL⁄g)fûe_öfo.tmu_d©e.
tm_mö
,

296 (
uL⁄g
)
fûe_öfo
.
¸c
,
fûíame_özù
);

297 i‡((
i
+1)<
gi
.
numbî_íåy
)

299 
îr
 = 
	`unzGoToNextFûe
(
uf
);

300 i‡(
îr
!=
UNZ_OK
)

302 
	`¥ötf
("îr‹ %d wôh zùfûêö unzGoToNextFûe\n",
îr
);

309 
	}
}

312 
	$do_exåa˘_cuºítfûe
(
uf
,
p›t_exåa˘_wôhout_∑th
,
p›t_ovîwrôe
,
∑ssw‹d
)

313 
unzFûe
 
uf
;

314 c⁄° * 
p›t_exåa˘_wôhout_∑th
;

315 * 
p›t_ovîwrôe
;

316 c⁄° * 
∑ssw‹d
;

318 
fûíame_özù
[256];

319 * 
fûíame_wôhouç©h
;

320 * 
p
;

321 
îr
=
UNZ_OK
;

322 
FILE
 *
fout
=
NULL
;

323 * 
buf
;

324 
uI¡
 
size_buf
;

326 
unz_fûe_öfo64
 
fûe_öfo
;

327 
uL⁄g
 
øtio
=0;

328 
îr
 = 
	`unzGëCuºítFûeInfo64
(
uf
,&
fûe_öfo
,
fûíame_özù
,(fûíame_özù),
NULL
,0,NULL,0);

330 i‡(
îr
!=
UNZ_OK
)

332 
	`¥ötf
("îr‹ %d wôh zùfûêö unzGëCuºítFûeInfo\n",
îr
);

333  
îr
;

336 
size_buf
 = 
WRITEBUFFERSIZE
;

337 
buf
 = (*)
	`mÆloc
(
size_buf
);

338 i‡(
buf
==
NULL
)

340 
	`¥ötf
("Errorállocating memory\n");

341  
UNZ_INTERNALERROR
;

344 
p
 = 
fûíame_wôhouç©h
 = 
fûíame_özù
;

345 (*
p
) != '\0')

347 i‡(((*
p
)=='/') || ((*p)=='\\'))

348 
fûíame_wôhouç©h
 = 
p
+1;

349 
p
++;

352 i‡((*
fûíame_wôhouç©h
)=='\0')

354 i‡((*
p›t_exåa˘_wôhout_∑th
)==0)

356 
	`¥ötf
("¸ótög dúe˘‹y: %s\n",
fûíame_özù
);

357 
	`mymkdú
(
fûíame_özù
);

362 c⁄° * 
wrôe_fûíame
;

363 
skù
=0;

365 i‡((*
p›t_exåa˘_wôhout_∑th
)==0)

366 
wrôe_fûíame
 = 
fûíame_özù
;

368 
wrôe_fûíame
 = 
fûíame_wôhouç©h
;

370 
îr
 = 
	`unzO≥nCuºítFûePassw‹d
(
uf
,
∑ssw‹d
);

371 i‡(
îr
!=
UNZ_OK
)

373 
	`¥ötf
("îr‹ %d wôh zùfûêö unzO≥nCuºítFûePassw‹d\n",
îr
);

376 i‡(((*
p›t_ovîwrôe
)==0Ë&& (
îr
==
UNZ_OK
))

378 
ªp
=0;

379 
FILE
* 
·e°exi°
;

380 
·e°exi°
 = 
	`FOPEN_FUNC
(
wrôe_fûíame
,"rb");

381 i‡(
·e°exi°
!=
NULL
)

383 
	`f˛o£
(
·e°exi°
);

386 
™swî
[128];

387 
ªt
;

389 
	`¥ötf
("Thêfûê%†exi°s. Ovîwrôê? [y]es, [n]o, [A]Œ: ",
wrôe_fûíame
);

390 
ªt
 = 
	`sˇnf
("%1s",
™swî
);

391 i‡(
ªt
 != 1)

393 
	`exô
(
EXIT_FAILURE
);

395 
ªp
 = 
™swî
[0] ;

396 i‡((
ªp
>='a') && (rep<='z'))

397 
ªp
 -= 0x20;

399 (
ªp
!='Y') && (rep!='N') && (rep!='A'));

402 i‡(
ªp
 == 'N')

403 
skù
 = 1;

405 i‡(
ªp
 == 'A')

406 *
p›t_ovîwrôe
=1;

409 i‡((
skù
==0Ë&& (
îr
==
UNZ_OK
))

411 
fout
=
	`FOPEN_FUNC
(
wrôe_fûíame
,"wb");

413 i‡((
fout
==
NULL
Ë&& ((*
p›t_exåa˘_wôhout_∑th
)==0) &&

414 (
fûíame_wôhouç©h
!=(*)
fûíame_özù
))

416 
c
=*(
fûíame_wôhouç©h
-1);

417 *(
fûíame_wôhouç©h
-1)='\0';

418 
	`makedú
(
wrôe_fûíame
);

419 *(
fûíame_wôhouç©h
-1)=
c
;

420 
fout
=
	`FOPEN_FUNC
(
wrôe_fûíame
,"wb");

423 i‡(
fout
==
NULL
)

425 
	`¥ötf
("îr‹ o≥nög %s\n",
wrôe_fûíame
);

429 i‡(
fout
!=
NULL
)

431 
	`¥ötf
("Éxåa˘ög: %s\n",
wrôe_fûíame
);

435 
îr
 = 
	`unzRódCuºítFûe
(
uf
,
buf
,
size_buf
);

436 i‡(
îr
<0)

438 
	`¥ötf
("îr‹ %d wôh zùfûêö unzRódCuºítFûe\n",
îr
);

441 i‡(
îr
>0)

442 i‡(
	`fwrôe
(
buf
,
îr
,1,
fout
)!=1)

444 
	`¥ötf
("error in writingÉxtracted file\n");

445 
îr
=
UNZ_ERRNO
;

449 
îr
>0);

450 i‡(
fout
)

451 
	`f˛o£
(
fout
);

453 i‡(
îr
==0)

454 
	`ch™ge_fûe_d©e
(
wrôe_fûíame
,
fûe_öfo
.
dosD©e
,

455 
fûe_öfo
.
tmu_d©e
);

458 i‡(
îr
==
UNZ_OK
)

460 
îr
 = 
	`unzClo£CuºítFûe
 (
uf
);

461 i‡(
îr
!=
UNZ_OK
)

463 
	`¥ötf
("îr‹ %d wôh zùfûêö unzClo£CuºítFûe\n",
îr
);

467 
	`unzClo£CuºítFûe
(
uf
);

470 
	`‰ì
(
buf
);

471  
îr
;

472 
	}
}

475 
	$do_exåa˘
(
uf
,
›t_exåa˘_wôhout_∑th
,
›t_ovîwrôe
,
∑ssw‹d
)

476 
unzFûe
 
uf
;

477 
›t_exåa˘_wôhout_∑th
;

478 
›t_ovîwrôe
;

479 c⁄° * 
∑ssw‹d
;

481 
uL⁄g
 
i
;

482 
unz_globÆ_öfo64
 
gi
;

483 
îr
;

484 
FILE
* 
fout
=
NULL
;

486 
îr
 = 
	`unzGëGlobÆInfo64
(
uf
,&
gi
);

487 i‡(
îr
!=
UNZ_OK
)

488 
	`¥ötf
("îr‹ %d wôh zùfûêö unzGëGlobÆInfÿ\n",
îr
);

490 
i
=0;i<
gi
.
numbî_íåy
;i++)

492 i‡(
	`do_exåa˘_cuºítfûe
(
uf
,&
›t_exåa˘_wôhout_∑th
,

493 &
›t_ovîwrôe
,

494 
∑ssw‹d
Ë!
UNZ_OK
)

497 i‡((
i
+1)<
gi
.
numbî_íåy
)

499 
îr
 = 
	`unzGoToNextFûe
(
uf
);

500 i‡(
îr
!=
UNZ_OK
)

502 
	`¥ötf
("îr‹ %d wôh zùfûêö unzGoToNextFûe\n",
îr
);

509 
	}
}

511 
	$do_exåa˘_⁄efûe
(
uf
,
fûíame
,
›t_exåa˘_wôhout_∑th
,
›t_ovîwrôe
,
∑ssw‹d
)

512 
unzFûe
 
uf
;

513 c⁄° * 
fûíame
;

514 
›t_exåa˘_wôhout_∑th
;

515 
›t_ovîwrôe
;

516 c⁄° * 
∑ssw‹d
;

518 
îr
 = 
UNZ_OK
;

519 i‡(
	`unzLoˇãFûe
(
uf
,
fûíame
,
CASESENSITIVITY
)!=
UNZ_OK
)

521 
	`¥ötf
("fûê%†nŸ found i¿thêzùfûe\n",
fûíame
);

525 i‡(
	`do_exåa˘_cuºítfûe
(
uf
,&
›t_exåa˘_wôhout_∑th
,

526 &
›t_ovîwrôe
,

527 
∑ssw‹d
Ë=
UNZ_OK
)

531 
	}
}

534 
	$maö
(
¨gc
,
¨gv
)

535 
¨gc
;

536 *
¨gv
[];

538 c⁄° *
zùfûíame
=
NULL
;

539 c⁄° *
fûíame_to_exåa˘
=
NULL
;

540 c⁄° *
∑ssw‹d
=
NULL
;

541 
fûíame_åy
[
MAXFILENAME
+16] = "";

542 
i
;

543 
ªt_vÆue
=0;

544 
›t_do_li°
=0;

545 
›t_do_exåa˘
=1;

546 
›t_do_exåa˘_wôhouç©h
=0;

547 
›t_ovîwrôe
=0;

548 
›t_exåa˘dú
=0;

549 c⁄° *
dú«me
=
NULL
;

550 
unzFûe
 
uf
=
NULL
;

552 
	`do_b™√r
();

553 i‡(
¨gc
==1)

555 
	`do_hñp
();

560 
i
=1;i<
¨gc
;i++)

562 i‡((*
¨gv
[
i
])=='-')

564 c⁄° *
p
=
¨gv
[
i
]+1;

566 (*
p
)!='\0')

568 
c
=*(
p
++);;

569 i‡((
c
=='l') || (c=='L'))

570 
›t_do_li°
 = 1;

571 i‡((
c
=='v') || (c=='V'))

572 
›t_do_li°
 = 1;

573 i‡((
c
=='x') || (c=='X'))

574 
›t_do_exåa˘
 = 1;

575 i‡((
c
=='e') || (c=='E'))

576 
›t_do_exåa˘
 = 
›t_do_exåa˘_wôhouç©h
 = 1;

577 i‡((
c
=='o') || (c=='O'))

578 
›t_ovîwrôe
=1;

579 i‡((
c
=='d') || (c=='D'))

581 
›t_exåa˘dú
=1;

582 
dú«me
=
¨gv
[
i
+1];

585 i‡(((
c
=='p'Ë|| (c=='P')Ë&& (
i
+1<
¨gc
))

587 
∑ssw‹d
=
¨gv
[
i
+1];

588 
i
++;

594 i‡(
zùfûíame
 =
NULL
)

595 
zùfûíame
 = 
¨gv
[
i
];

596 i‡((
fûíame_to_exåa˘
==
NULL
Ë&& (!
›t_exåa˘dú
))

597 
fûíame_to_exåa˘
 = 
¨gv
[
i
] ;

602 i‡(
zùfûíame
!=
NULL
)

605 #ifde‡
USEWIN32IOAPI


606 
zlib_fûefunc64_def
 
ffunc
;

609 
	`°∫˝y
(
fûíame_åy
, 
zùfûíame
,
MAXFILENAME
-1);

611 
fûíame_åy
[ 
MAXFILENAME
 ] = '\0';

613 #ifde‡
USEWIN32IOAPI


614 
	`fûl_wö32_fûefunc64A
(&
ffunc
);

615 
uf
 = 
	`unzO≥n2_64
(
zùfûíame
,&
ffunc
);

617 
uf
 = 
	`unzO≥n64
(
zùfûíame
);

619 i‡(
uf
==
NULL
)

621 
	`°rˇt
(
fûíame_åy
,".zip");

622 #ifde‡
USEWIN32IOAPI


623 
uf
 = 
	`unzO≥n2_64
(
fûíame_åy
,&
ffunc
);

625 
uf
 = 
	`unzO≥n64
(
fûíame_åy
);

630 i‡(
uf
==
NULL
)

632 
	`¥ötf
("C™nŸ o≥¿%†‹ %s.zù\n",
zùfûíame
,zipfilename);

635 
	`¥ötf
("%†›íed\n",
fûíame_åy
);

637 i‡(
›t_do_li°
==1)

638 
ªt_vÆue
 = 
	`do_li°
(
uf
);

639 i‡(
›t_do_exåa˘
==1)

641 #ifde‡
_WIN32


642 i‡(
›t_exåa˘dú
 && 
	`_chdú
(
dú«me
))

644 i‡(
›t_exåa˘dú
 && 
	`chdú
(
dú«me
))

647 
	`¥ötf
("Eº‹ ch™gög i¡ÿ%s,áb‹tög\n", 
dú«me
);

648 
	`exô
(-1);

651 i‡(
fûíame_to_exåa˘
 =
NULL
)

652 
ªt_vÆue
 = 
	`do_exåa˘
(
uf
, 
›t_do_exåa˘_wôhouç©h
, 
›t_ovîwrôe
, 
∑ssw‹d
);

654 
ªt_vÆue
 = 
	`do_exåa˘_⁄efûe
(
uf
, 
fûíame_to_exåa˘
, 
›t_do_exåa˘_wôhouç©h
, 
›t_ovîwrôe
, 
∑ssw‹d
);

657 
	`unzClo£
(
uf
);

659  
ªt_vÆue
;

660 
	}
}

	@zlib-1.2.8/contrib/minizip/minizip.c

16 #i‡(!
deföed
(
_WIN32
)Ë&& (!deföed(
WIN32
)Ë&& (!deföed(
__APPLE__
))

17 #i‚de‡
__USE_FILE_OFFSET64


18 
	#__USE_FILE_OFFSET64


	)

20 #i‚de‡
__USE_LARGEFILE64


21 
	#__USE_LARGEFILE64


	)

23 #i‚de‡
_LARGEFILE64_SOURCE


24 
	#_LARGEFILE64_SOURCE


	)

26 #i‚de‡
_FILE_OFFSET_BIT


27 
	#_FILE_OFFSET_BIT
 64

	)

31 #ifde‡
__APPLE__


33 
	#FOPEN_FUNC
(
fûíame
, 
mode
Ë
	`f›í
(fûíame, mode)

	)

34 
	#FTELLO_FUNC
(
°ªam
Ë
	`·ñlo
(°ªam)

	)

35 
	#FSEEKO_FUNC
(
°ªam
, 
off£t
, 
‹igö
Ë
	`f£eko
(°ªam, off£t, origö)

	)

37 
	#FOPEN_FUNC
(
fûíame
, 
mode
Ë
	`f›í64
(fûíame, mode)

	)

38 
	#FTELLO_FUNC
(
°ªam
Ë
	`·ñlo64
(°ªam)

	)

39 
	#FSEEKO_FUNC
(
°ªam
, 
off£t
, 
‹igö
Ë
	`f£eko64
(°ªam, off£t, origö)

	)

44 
	~<°dio.h
>

45 
	~<°dlib.h
>

46 
	~<°rög.h
>

47 
	~<time.h
>

48 
	~<î∫o.h
>

49 
	~<f˙é.h
>

51 #ifde‡
_WIN32


52 
	~<dúe˘.h
>

53 
	~<io.h
>

55 
	~<uni°d.h
>

56 
	~<utime.h
>

57 
	~<sys/ty≥s.h
>

58 
	~<sys/°©.h
>

61 
	~"zù.h
"

63 #ifde‡
_WIN32


64 
	#USEWIN32IOAPI


	)

65 
	~"iowö32.h
"

70 
	#WRITEBUFFERSIZE
 (16384)

	)

71 
	#MAXFILENAME
 (256)

	)

73 #ifde‡
_WIN32


74 
uL⁄g
 
	$fûëime
(
f
, 
tmzù
, 
dt
)

75 *
f
;

76 
tm_zù
 *
tmzù
;

77 
uL⁄g
 *
dt
;

79 
ªt
 = 0;

81 
FILETIME
 
·Loˇl
;

82 
HANDLE
 
hFöd
;

83 
WIN32_FIND_DATAA
 
ff32
;

85 
hFöd
 = 
	`FödFú°FûeA
(
f
,&
ff32
);

86 i‡(
hFöd
 !
INVALID_HANDLE_VALUE
)

88 
	`FûeTimeToLoˇlFûeTime
(&(
ff32
.
·La°WrôeTime
),&
·Loˇl
);

89 
	`FûeTimeToDosD©eTime
(&
·Loˇl
,((
LPWORD
)
dt
)+1,((LPWORD)dt)+0);

90 
	`FödClo£
(
hFöd
);

91 
ªt
 = 1;

94  
ªt
;

95 
	}
}

97 #ifde‡
unix
 || 
__APPLE__


98 
uL⁄g
 
	$fûëime
(
f
, 
tmzù
, 
dt
)

99 *
f
;

100 
tm_zù
 *
tmzù
;

101 
uL⁄g
 *
dt
;

103 
ªt
=0;

104 
°©
 
s
;

105 
tm
* 
fûed©e
;

106 
time_t
 
tm_t
=0;

108 i‡(
	`°rcmp
(
f
,"-")!=0)

110 
«me
[
MAXFILENAME
+1];

111 
Àn
 = 
	`°æí
(
f
);

112 i‡(
Àn
 > 
MAXFILENAME
)

113 
Àn
 = 
MAXFILENAME
;

115 
	`°∫˝y
(
«me
, 
f
,
MAXFILENAME
-1);

117 
«me
[ 
MAXFILENAME
 ] = '\0';

119 i‡(
«me
[
Àn
 - 1] == '/')

120 
«me
[
Àn
 - 1] = '\0';

122 i‡(
	`°©
(
«me
,&
s
)==0)

124 
tm_t
 = 
s
.
°_mtime
;

125 
ªt
 = 1;

128 
fûed©e
 = 
	`loˇ…ime
(&
tm_t
);

130 
tmzù
->
tm_£c
 = 
fûed©e
->tm_sec;

131 
tmzù
->
tm_mö
 = 
fûed©e
->tm_min;

132 
tmzù
->
tm_hour
 = 
fûed©e
->tm_hour;

133 
tmzù
->
tm_mday
 = 
fûed©e
->tm_mday;

134 
tmzù
->
tm_m⁄
 = 
fûed©e
->tm_mon ;

135 
tmzù
->
tm_yór
 = 
fûed©e
->tm_year;

137  
ªt
;

138 
	}
}

140 
uL⁄g
 
	$fûëime
(
f
, 
tmzù
, 
dt
)

141 *
f
;

142 
tm_zù
 *
tmzù
;

143 
uL⁄g
 *
dt
;

146 
	}
}

153 
	$check_exi°_fûe
(
fûíame
)

154 c⁄° * 
fûíame
;

156 
FILE
* 
·e°exi°
;

157 
ªt
 = 1;

158 
·e°exi°
 = 
	`FOPEN_FUNC
(
fûíame
,"rb");

159 i‡(
·e°exi°
==
NULL
)

160 
ªt
 = 0;

162 
	`f˛o£
(
·e°exi°
);

163  
ªt
;

164 
	}
}

166 
	$do_b™√r
()

168 
	`¥ötf
("MiniZip 1.1, demo of zLib + MiniZip64Öackage, written by Gilles Vollant\n");

169 
	`¥ötf
("more info on MiniZipát http://www.winimage.com/zLibDll/minizip.html\n\n");

170 
	}
}

172 
	$do_hñp
()

174 
	`¥ötf
("Usage : minizip [-o] [-a] [-0Åo -9] [-pÖassword] [-j] file.zip [files_to_add]\n\n" \

181 
	}
}

185 
	$gëFûeCrc
(c⁄° * 
fûíameözù
,*
buf
,
size_buf
,* 
ªsu…_¸c
)

187 
ˇlcuœã_¸c
=0;

188 
îr
=
ZIP_OK
;

189 
FILE
 * 
fö
 = 
	`FOPEN_FUNC
(
fûíameözù
,"rb");

191 
size_ªad
 = 0;

192 
tŸÆ_ªad
 = 0;

193 i‡(
fö
==
NULL
)

195 
îr
 = 
ZIP_ERRNO
;

198 i‡(
îr
 =
ZIP_OK
)

201 
îr
 = 
ZIP_OK
;

202 
size_ªad
 = ()
	`‰ód
(
buf
,1,
size_buf
,
fö
);

203 i‡(
size_ªad
 < 
size_buf
)

204 i‡(
	`„of
(
fö
)==0)

206 
	`¥ötf
("îr‹ i¿ªadög %s\n",
fûíameözù
);

207 
îr
 = 
ZIP_ERRNO
;

210 i‡(
size_ªad
>0)

211 
ˇlcuœã_¸c
 = 
	`¸c32
(ˇlcuœã_¸c,
buf
,
size_ªad
);

212 
tŸÆ_ªad
 +
size_ªad
;

214 } (
îr
 =
ZIP_OK
Ë&& (
size_ªad
>0));

216 i‡(
fö
)

217 
	`f˛o£
(
fö
);

219 *
ªsu…_¸c
=
ˇlcuœã_¸c
;

220 
	`¥ötf
("fûê%†¸¯%lx\n", 
fûíameözù
, 
ˇlcuœã_¸c
);

221  
îr
;

222 
	}
}

224 
	$isL¨geFûe
(c⁄° * 
fûíame
)

226 
œrgeFûe
 = 0;

227 
ZPOS64_T
 
pos
 = 0;

228 
FILE
* 
pFûe
 = 
	`FOPEN_FUNC
(
fûíame
, "rb");

230 if(
pFûe
 !
NULL
)

232 
n
 = 
	`FSEEKO_FUNC
(
pFûe
, 0, 
SEEK_END
);

233 
pos
 = 
	`FTELLO_FUNC
(
pFûe
);

235 
	`¥ötf
("Fûê: %†i†%Œd byãs\n", 
fûíame
, 
pos
);

237 if(
pos
 >= 0xffffffff)

238 
œrgeFûe
 = 1;

240 
	`f˛o£
(
pFûe
);

243  
œrgeFûe
;

244 
	}
}

246 
	$maö
(
¨gc
,
¨gv
)

247 
¨gc
;

248 *
¨gv
[];

250 
i
;

251 
›t_ovîwrôe
=0;

252 
›t_com¥ess_Àvñ
=
Z_DEFAULT_COMPRESSION
;

253 
›t_ex˛ude_∑th
=0;

254 
zùfûíamórg
 = 0;

255 
fûíame_åy
[
MAXFILENAME
+16];

256 
zùok
;

257 
îr
=0;

258 
size_buf
=0;

259 * 
buf
=
NULL
;

260 c⁄° * 
∑ssw‹d
=
NULL
;

263 
	`do_b™√r
();

264 i‡(
¨gc
==1)

266 
	`do_hñp
();

271 
i
=1;i<
¨gc
;i++)

273 i‡((*
¨gv
[
i
])=='-')

275 c⁄° *
p
=
¨gv
[
i
]+1;

277 (*
p
)!='\0')

279 
c
=*(
p
++);;

280 i‡((
c
=='o') || (c=='O'))

281 
›t_ovîwrôe
 = 1;

282 i‡((
c
=='a') || (c=='A'))

283 
›t_ovîwrôe
 = 2;

284 i‡((
c
>='0') && (c<='9'))

285 
›t_com¥ess_Àvñ
 = 
c
-'0';

286 i‡((
c
=='j') || (c=='J'))

287 
›t_ex˛ude_∑th
 = 1;

289 i‡(((
c
=='p'Ë|| (c=='P')Ë&& (
i
+1<
¨gc
))

291 
∑ssw‹d
=
¨gv
[
i
+1];

292 
i
++;

298 i‡(
zùfûíamórg
 == 0)

300 
zùfûíamórg
 = 
i
 ;

306 
size_buf
 = 
WRITEBUFFERSIZE
;

307 
buf
 = (*)
	`mÆloc
(
size_buf
);

308 i‡(
buf
==
NULL
)

310 
	`¥ötf
("Errorállocating memory\n");

311  
ZIP_INTERNALERROR
;

314 i‡(
zùfûíamórg
==0)

316 
zùok
=0;

320 
i
,
Àn
;

321 
dŸ_found
=0;

323 
zùok
 = 1 ;

324 
	`°∫˝y
(
fûíame_åy
, 
¨gv
[
zùfûíamórg
],
MAXFILENAME
-1);

326 
fûíame_åy
[ 
MAXFILENAME
 ] = '\0';

328 
Àn
=()
	`°æí
(
fûíame_åy
);

329 
i
=0;i<
Àn
;i++)

330 i‡(
fûíame_åy
[
i
]=='.')

331 
dŸ_found
=1;

333 i‡(
dŸ_found
==0)

334 
	`°rˇt
(
fûíame_åy
,".zip");

336 i‡(
›t_ovîwrôe
==2)

339 i‡(
	`check_exi°_fûe
(
fûíame_åy
)==0)

340 
›t_ovîwrôe
=1;

343 i‡(
›t_ovîwrôe
==0)

344 i‡(
	`check_exi°_fûe
(
fûíame_åy
)!=0)

346 
ªp
=0;

349 
™swî
[128];

350 
ªt
;

351 
	`¥ötf
("Thêfûê%†exi°s. Ovîwrôê? [y]es, [n]o, [a]µíd : ",
fûíame_åy
);

352 
ªt
 = 
	`sˇnf
("%1s",
™swî
);

353 i‡(
ªt
 != 1)

355 
	`exô
(
EXIT_FAILURE
);

357 
ªp
 = 
™swî
[0] ;

358 i‡((
ªp
>='a') && (rep<='z'))

359 
ªp
 -= 0x20;

361 (
ªp
!='Y') && (rep!='N') && (rep!='A'));

362 i‡(
ªp
=='N')

363 
zùok
 = 0;

364 i‡(
ªp
=='A')

365 
›t_ovîwrôe
 = 2;

369 i‡(
zùok
==1)

371 
zùFûe
 
zf
;

372 
îr˛o£
;

373 #ifde‡
USEWIN32IOAPI


374 
zlib_fûefunc64_def
 
ffunc
;

375 
	`fûl_wö32_fûefunc64A
(&
ffunc
);

376 
zf
 = 
	`zùO≥n2_64
(
fûíame_åy
,(
›t_ovîwrôe
==2Ë? 2 : 0,
NULL
,&
ffunc
);

378 
zf
 = 
	`zùO≥n64
(
fûíame_åy
,(
›t_ovîwrôe
==2) ? 2 : 0);

381 i‡(
zf
 =
NULL
)

383 
	`¥ötf
("îr‹ o≥nög %s\n",
fûíame_åy
);

384 
îr

ZIP_ERRNO
;

387 
	`¥ötf
("¸ótög %s\n",
fûíame_åy
);

389 
i
=
zùfûíamórg
+1;(i<
¨gc
Ë&& (
îr
==
ZIP_OK
);i++)

391 i‡(!((((*(
¨gv
[
i
]))=='-') || ((*(argv[i]))=='/')) &&

392 ((
¨gv
[
i
][1]=='o') || (argv[i][1]=='O') ||

393 (
¨gv
[
i
][1]=='a') || (argv[i][1]=='A') ||

394 (
¨gv
[
i
][1]=='p') || (argv[i][1]=='P') ||

395 ((
¨gv
[
i
][1]>='0') || (argv[i][1]<='9'))) &&

396 (
	`°æí
(
¨gv
[
i
]) == 2)))

398 
FILE
 * 
fö
;

399 
size_ªad
;

400 c⁄° * 
fûíameözù
 = 
¨gv
[
i
];

401 c⁄° *
ßvefûíameözù
;

402 
zù_fûeöfo
 
zi
;

403 
¸cFûe
=0;

404 
zù64
 = 0;

406 
zi
.
tmz_d©e
.
tm_£c
 = zi.tmz_d©e.
tm_mö
 = zi.tmz_d©e.
tm_hour
 =

407 
zi
.
tmz_d©e
.
tm_mday
 = zi.tmz_d©e.
tm_m⁄
 = zi.tmz_d©e.
tm_yór
 = 0;

408 
zi
.
dosD©e
 = 0;

409 
zi
.
öã∫Æ_Á
 = 0;

410 
zi
.
exã∫Æ_Á
 = 0;

411 
	`fûëime
(
fûíameözù
,&
zi
.
tmz_d©e
,&zi.
dosD©e
);

419 i‡((
∑ssw‹d
 !
NULL
Ë&& (
îr
==
ZIP_OK
))

420 
îr
 = 
	`gëFûeCrc
(
fûíameözù
,
buf
,
size_buf
,&
¸cFûe
);

422 
zù64
 = 
	`isL¨geFûe
(
fûíameözù
);

426 
ßvefûíameözù
 = 
fûíameözù
;

427  
ßvefûíameözù
[0] == '\\' || savefilenameinzip[0] == '/' )

429 
ßvefûíameözù
++;

433 if–
›t_ex˛ude_∑th
 )

435 c⁄° *
tmµå
;

436 c⁄° *
œ°¶ash
 = 0;

437  
tmµå
 = 
ßvefûíameözù
; *tmpptr;Åmpptr++)

439 if–*
tmµå
 == '\\' || *tmpptr == '/')

441 
œ°¶ash
 = 
tmµå
;

444 if–
œ°¶ash
 !
NULL
 )

446 
ßvefûíameözù
 = 
œ°¶ash
+1;

451 
îr
 = 
	`zùO≥nNewFûeInZù3_64
(
zf
,
ßvefûíameözù
,&
zi
,

452 
NULL
,0,NULL,0,NULL ,

453 (
›t_com¥ess_Àvñ
 !0Ë? 
Z_DEFLATED
 : 0,

454 
›t_com¥ess_Àvñ
,0,

456 -
MAX_WBITS
, 
DEF_MEM_LEVEL
, 
Z_DEFAULT_STRATEGY
,

457 
∑ssw‹d
,
¸cFûe
, 
zù64
);

459 i‡(
îr
 !
ZIP_OK
)

460 
	`¥ötf
("îr‹ i¿›íög %†ö zùfûe\n",
fûíameözù
);

463 
fö
 = 
	`FOPEN_FUNC
(
fûíameözù
,"rb");

464 i‡(
fö
==
NULL
)

466 
îr
=
ZIP_ERRNO
;

467 
	`¥ötf
("îr‹ i¿›íög %†f‹Ñódög\n",
fûíameözù
);

471 i‡(
îr
 =
ZIP_OK
)

474 
îr
 = 
ZIP_OK
;

475 
size_ªad
 = ()
	`‰ód
(
buf
,1,
size_buf
,
fö
);

476 i‡(
size_ªad
 < 
size_buf
)

477 i‡(
	`„of
(
fö
)==0)

479 
	`¥ötf
("îr‹ i¿ªadög %s\n",
fûíameözù
);

480 
îr
 = 
ZIP_ERRNO
;

483 i‡(
size_ªad
>0)

485 
îr
 = 
	`zùWrôeInFûeInZù
 (
zf
,
buf
,
size_ªad
);

486 i‡(
îr
<0)

488 
	`¥ötf
("error in writing %s inÅhe zipfile\n",

489 
fûíameözù
);

493 } (
îr
 =
ZIP_OK
Ë&& (
size_ªad
>0));

495 i‡(
fö
)

496 
	`f˛o£
(
fö
);

498 i‡(
îr
<0)

499 
îr
=
ZIP_ERRNO
;

502 
îr
 = 
	`zùClo£FûeInZù
(
zf
);

503 i‡(
îr
!=
ZIP_OK
)

504 
	`¥ötf
("error in closing %s inÅhe zipfile\n",

505 
fûíameözù
);

509 
îr˛o£
 = 
	`zùClo£
(
zf
,
NULL
);

510 i‡(
îr˛o£
 !
ZIP_OK
)

511 
	`¥ötf
("îr‹ i¿˛osög %s\n",
fûíame_åy
);

515 
	`do_hñp
();

518 
	`‰ì
(
buf
);

520 
	}
}

	@zlib-1.2.8/contrib/minizip/mztools.c

8 
	~<°dio.h
>

9 
	~<°dlib.h
>

10 
	~<°rög.h
>

11 
	~"zlib.h
"

12 
	~"unzù.h
"

14 
	#READ_8
(
adr
Ë(()*◊dr))

	)

15 
	#READ_16
(
adr
Ë–
	`READ_8
◊drË| (READ_8◊dr+1Ë<< 8Ë)

	)

16 
	#READ_32
(
adr
Ë–
	`READ_16
◊drË| (READ_16(◊dr)+2Ë<< 16Ë)

	)

18 
	#WRITE_8
(
buff
, 
n
) do { \

19 *((*)(
buff
)Ë(Ë((
n
) & 0xff); \

20 } 0)

	)

21 
	#WRITE_16
(
buff
, 
n
) do { \

22 
	`WRITE_8
((*)(
buff
), 
n
); \

23 
	`WRITE_8
(((*)(
buff
)Ë+ 1, (
n
) >> 8); \

24 } 0)

	)

25 
	#WRITE_32
(
buff
, 
n
) do { \

26 
	`WRITE_16
((*)(
buff
), (
n
) & 0xffff); \

27 
	`WRITE_16
((*)(
buff
Ë+ 2, (
n
) >> 16); \

28 } 0)

	)

30 
ZEXPORT
 
	$unzRïaú
(
fûe
, 
fûeOut
, 
fûeOutTmp
, 
nRecovîed
, 
byãsRecovîed
)

31 c⁄° * 
fûe
;

32 c⁄° * 
fûeOut
;

33 c⁄° * 
fûeOutTmp
;

34 
uL⁄g
* 
nRecovîed
;

35 
uL⁄g
* 
byãsRecovîed
;

37 
îr
 = 
Z_OK
;

38 
FILE
* 
ÂZù
 = 
	`f›í
(
fûe
, "rb");

39 
FILE
* 
ÂOut
 = 
	`f›í
(
fûeOut
, "wb");

40 
FILE
* 
ÂOutCD
 = 
	`f›í
(
fûeOutTmp
, "wb");

41 i‡(
ÂZù
 !
NULL
 && 
ÂOut
 != NULL) {

42 
íåõs
 = 0;

43 
uL⁄g
 
tŸÆByãs
 = 0;

44 
hódî
[30];

45 
fûíame
[1024];

46 
exåa
[1024];

47 
off£t
 = 0;

48 
off£tCD
 = 0;

49  
	`‰ód
(
hódî
, 1, 30, 
ÂZù
) == 30 ) {

50 
cuºítOff£t
 = 
off£t
;

53 i‡(
	`READ_32
(
hódî
) == 0x04034b50) {

54 
vîsi⁄
 = 
	`READ_16
(
hódî
 + 4);

55 
gpÊag
 = 
	`READ_16
(
hódî
 + 6);

56 
mëhod
 = 
	`READ_16
(
hódî
 + 8);

57 
fûëime
 = 
	`READ_16
(
hódî
 + 10);

58 
fûed©e
 = 
	`READ_16
(
hódî
 + 12);

59 
¸c
 = 
	`READ_32
(
hódî
 + 14);

60 
˝size
 = 
	`READ_32
(
hódî
 + 18);

61 
un˝size
 = 
	`READ_32
(
hódî
 + 22);

62 
‚size
 = 
	`READ_16
(
hódî
 + 26);

63 
extsize
 = 
	`READ_16
(
hódî
 + 28);

64 
fûíame
[0] = 
exåa
[0] = '\0';

67 i‡(
	`fwrôe
(
hódî
, 1, 30, 
ÂOut
) == 30) {

68 
off£t
 += 30;

70 
îr
 = 
Z_ERRNO
;

75 i‡(
‚size
 > 0) {

76 i‡(
‚size
 < (
fûíame
)) {

77 i‡(
	`‰ód
(
fûíame
, 1, 
‚size
, 
ÂZù
) == fnsize) {

78 i‡(
	`fwrôe
(
fûíame
, 1, 
‚size
, 
ÂOut
) == fnsize) {

79 
off£t
 +
‚size
;

81 
îr
 = 
Z_ERRNO
;

85 
îr
 = 
Z_ERRNO
;

89 
îr
 = 
Z_ERRNO
;

93 
îr
 = 
Z_STREAM_ERROR
;

98 i‡(
extsize
 > 0) {

99 i‡(
extsize
 < (
exåa
)) {

100 i‡(
	`‰ód
(
exåa
, 1, 
extsize
, 
ÂZù
) ==Éxtsize) {

101 i‡(
	`fwrôe
(
exåa
, 1, 
extsize
, 
ÂOut
) ==Éxtsize) {

102 
off£t
 +
extsize
;

104 
îr
 = 
Z_ERRNO
;

108 
îr
 = 
Z_ERRNO
;

112 
îr
 = 
Z_ERRNO
;

119 
d©aSize
 = 
˝size
;

120 i‡(
d©aSize
 == 0) {

121 
d©aSize
 = 
un˝size
;

123 i‡(
d©aSize
 > 0) {

124 * 
d©a
 = 
	`mÆloc
(
d©aSize
);

125 i‡(
d©a
 !
NULL
) {

126 i‡(()
	`‰ód
(
d©a
, 1, 
d©aSize
, 
ÂZù
) == dataSize) {

127 i‡(()
	`fwrôe
(
d©a
, 1, 
d©aSize
, 
ÂOut
) == dataSize) {

128 
off£t
 +
d©aSize
;

129 
tŸÆByãs
 +
d©aSize
;

131 
îr
 = 
Z_ERRNO
;

134 
îr
 = 
Z_ERRNO
;

136 
	`‰ì
(
d©a
);

137 i‡(
îr
 !
Z_OK
) {

141 
îr
 = 
Z_MEM_ERROR
;

149 
hódî
[46];

150 * 
commít
 = "";

151 
comsize
 = (Ë
	`°æí
(
commít
);

152 
	`WRITE_32
(
hódî
, 0x02014b50);

153 
	`WRITE_16
(
hódî
 + 4, 
vîsi⁄
);

154 
	`WRITE_16
(
hódî
 + 6, 
vîsi⁄
);

155 
	`WRITE_16
(
hódî
 + 8, 
gpÊag
);

156 
	`WRITE_16
(
hódî
 + 10, 
mëhod
);

157 
	`WRITE_16
(
hódî
 + 12, 
fûëime
);

158 
	`WRITE_16
(
hódî
 + 14, 
fûed©e
);

159 
	`WRITE_32
(
hódî
 + 16, 
¸c
);

160 
	`WRITE_32
(
hódî
 + 20, 
˝size
);

161 
	`WRITE_32
(
hódî
 + 24, 
un˝size
);

162 
	`WRITE_16
(
hódî
 + 28, 
‚size
);

163 
	`WRITE_16
(
hódî
 + 30, 
extsize
);

164 
	`WRITE_16
(
hódî
 + 32, 
comsize
);

165 
	`WRITE_16
(
hódî
 + 34, 0);

166 
	`WRITE_16
(
hódî
 + 36, 0);

167 
	`WRITE_32
(
hódî
 + 38, 0);

168 
	`WRITE_32
(
hódî
 + 42, 
cuºítOff£t
);

170 i‡(
	`fwrôe
(
hódî
, 1, 46, 
ÂOutCD
) == 46) {

171 
off£tCD
 += 46;

174 i‡(
‚size
 > 0) {

175 i‡(
	`fwrôe
(
fûíame
, 1, 
‚size
, 
ÂOutCD
) == fnsize) {

176 
off£tCD
 +
‚size
;

178 
îr
 = 
Z_ERRNO
;

182 
îr
 = 
Z_STREAM_ERROR
;

187 i‡(
extsize
 > 0) {

188 i‡(
	`fwrôe
(
exåa
, 1, 
extsize
, 
ÂOutCD
) ==Éxtsize) {

189 
off£tCD
 +
extsize
;

191 
îr
 = 
Z_ERRNO
;

197 i‡(
comsize
 > 0) {

198 i‡(()
	`fwrôe
(
commít
, 1, 
comsize
, 
ÂOutCD
) == comsize) {

199 
off£tCD
 +
comsize
;

201 
îr
 = 
Z_ERRNO
;

208 
îr
 = 
Z_ERRNO
;

214 
íåõs
++;

223 
íåõsZù
 = 
íåõs
;

224 
hódî
[22];

225 * 
commít
 = "";

226 
comsize
 = (Ë
	`°æí
(
commít
);

227 i‡(
íåõsZù
 > 0xffff) {

228 
íåõsZù
 = 0xffff;

230 
	`WRITE_32
(
hódî
, 0x06054b50);

231 
	`WRITE_16
(
hódî
 + 4, 0);

232 
	`WRITE_16
(
hódî
 + 6, 0);

233 
	`WRITE_16
(
hódî
 + 8, 
íåõsZù
);

234 
	`WRITE_16
(
hódî
 + 10, 
íåõsZù
);

235 
	`WRITE_32
(
hódî
 + 12, 
off£tCD
);

236 
	`WRITE_32
(
hódî
 + 16, 
off£t
);

237 
	`WRITE_16
(
hódî
 + 20, 
comsize
);

240 i‡(
	`fwrôe
(
hódî
, 1, 22, 
ÂOutCD
) == 22) {

243 i‡(
comsize
 > 0) {

244 i‡(()
	`fwrôe
(
commít
, 1, 
comsize
, 
ÂOutCD
) != comsize) {

245 
îr
 = 
Z_ERRNO
;

250 
îr
 = 
Z_ERRNO
;

255 
	`f˛o£
(
ÂOutCD
);

256 i‡(
îr
 =
Z_OK
) {

257 
ÂOutCD
 = 
	`f›í
(
fûeOutTmp
, "rb");

258 i‡(
ÂOutCD
 !
NULL
) {

259 
nRód
;

260 
buf„r
[8192];

261  (
nRód
 = ()
	`‰ód
(
buf„r
, 1, (buf„r), 
ÂOutCD
)) > 0) {

262 i‡(()
	`fwrôe
(
buf„r
, 1, 
nRód
, 
ÂOut
) !=ÇRead) {

263 
îr
 = 
Z_ERRNO
;

267 
	`f˛o£
(
ÂOutCD
);

272 
	`f˛o£
(
ÂZù
);

273 
	`f˛o£
(
ÂOut
);

276 ()
	`ªmove
(
fûeOutTmp
);

279 i‡(
îr
 =
Z_OK
) {

280 i‡(
nRecovîed
 !
NULL
) {

281 *
nRecovîed
 = 
íåõs
;

283 i‡(
byãsRecovîed
 !
NULL
) {

284 *
byãsRecovîed
 = 
tŸÆByãs
;

288 
îr
 = 
Z_STREAM_ERROR
;

290  
îr
;

291 
	}
}

	@zlib-1.2.8/contrib/minizip/mztools.h

7 #i‚de‡
_zù_toﬁs_H


8 
	#_zù_toﬁs_H


	)

10 #ifde‡
__˝lu•lus


14 #i‚de‡
_ZLIB_H


15 
	~"zlib.h
"

18 
	~"unzù.h
"

25 
ZEXPORT
 
unzRïaú
(c⁄° * 
fûe
,

26 c⁄° * 
fûeOut
,

27 c⁄° * 
fûeOutTmp
,

28 
uL⁄g
* 
nRecovîed
,

29 
uL⁄g
* 
byãsRecovîed
);

32 #ifde‡
__˝lu•lus


	@zlib-1.2.8/contrib/minizip/unzip.c

67 
	~<°dio.h
>

68 
	~<°dlib.h
>

69 
	~<°rög.h
>

71 #i‚de‡
NOUNCRYPT


72 
	#NOUNCRYPT


	)

75 
	~"zlib.h
"

76 
	~"unzù.h
"

78 #ifde‡
STDC


79 
	~<°ddef.h
>

80 
	~<°rög.h
>

81 
	~<°dlib.h
>

83 #ifde‡
NO_ERRNO_H


84 
î∫o
;

86 
	~<î∫o.h
>

90 #i‚de‡
loˇl


91 
	#loˇl
 

	)

96 #i‚de‡
CASESENSITIVITYDEFAULT_NO


97 #i‡!
deföed
(
unix
Ë&& !deföed(
CASESENSITIVITYDEFAULT_YES
)

98 
	#CASESENSITIVITYDEFAULT_NO


	)

103 #i‚de‡
UNZ_BUFSIZE


104 
	#UNZ_BUFSIZE
 (16384)

	)

107 #i‚de‡
UNZ_MAXFILENAMEINZIP


108 
	#UNZ_MAXFILENAMEINZIP
 (256)

	)

111 #i‚de‡
ALLOC


112 
	#ALLOC
(
size
Ë(
	`mÆloc
(size))

	)

114 #i‚de‡
TRYFREE


115 
	#TRYFREE
(
p
Ë{i‡’Ë
	`‰ì
’);}

	)

118 
	#SIZECENTRALDIRITEM
 (0x2e)

	)

119 
	#SIZEZIPLOCALHEADER
 (0x1e)

	)

122 c⁄° 
	gunz_c›yright
[] =

126 
	sunz_fûe_öfo64_öã∫Æ_s


128 
ZPOS64_T
 
	moff£t_curfûe
;

129 } 
	tunz_fûe_öfo64_öã∫Æ
;

136 *
	mªad_buf„r
;

137 
z_°ªam
 
	m°ªam
;

139 #ifde‡
HAVE_BZIP2


140 
bz_°ªam
 
	mb°ªam
;

143 
ZPOS64_T
 
	mpos_ö_zùfûe
;

144 
uL⁄g
 
	m°ªam_öôüli£d
;

146 
ZPOS64_T
 
	moff£t_loˇl_exåafõld
;

147 
uI¡
 
	msize_loˇl_exåafõld
;

148 
ZPOS64_T
 
	mpos_loˇl_exåafõld
;

149 
ZPOS64_T
 
	mtŸÆ_out_64
;

151 
uL⁄g
 
	m¸c32
;

152 
uL⁄g
 
	m¸c32_waô
;

153 
ZPOS64_T
 
	mª°_ªad_com¥es£d
;

154 
ZPOS64_T
 
	mª°_ªad_uncom¥es£d
;

155 
zlib_fûefunc64_32_def
 
	mz_fûefunc
;

156 
voidpf
 
	mfûe°ªam
;

157 
uL⁄g
 
	mcom¥essi⁄_mëhod
;

158 
ZPOS64_T
 
	mbyã_bef‹e_the_zùfûe
;

159 
	møw
;

160 } 
	tfûe_ö_zù64_ªad_öfo_s
;

167 
zlib_fûefunc64_32_def
 
	mz_fûefunc
;

168 
	mis64bôO≥nFun˘i⁄
;

169 
voidpf
 
	mfûe°ªam
;

170 
unz_globÆ_öfo64
 
	mgi
;

171 
ZPOS64_T
 
	mbyã_bef‹e_the_zùfûe
;

172 
ZPOS64_T
 
	mnum_fûe
;

173 
ZPOS64_T
 
	mpos_ö_˚¡øl_dú
;

174 
ZPOS64_T
 
	mcuºít_fûe_ok
;

175 
ZPOS64_T
 
	m˚¡øl_pos
;

177 
ZPOS64_T
 
	msize_˚¡øl_dú
;

178 
ZPOS64_T
 
	moff£t_˚¡øl_dú
;

181 
unz_fûe_öfo64
 
	mcur_fûe_öfo
;

182 
unz_fûe_öfo64_öã∫Æ
 
	mcur_fûe_öfo_öã∫Æ
;

183 
fûe_ö_zù64_ªad_öfo_s
* 
	mpfûe_ö_zù_ªad
;

185 
	mí¸y±ed
;

187 
	misZù64
;

189 #i‚de‡
NOUNCRYPT


190 
	mkeys
[3];

191 c⁄° 
z_¸c_t
* 
	mp¸c_32_èb
;

193 } 
	tunz64_s
;

196 #i‚de‡
NOUNCRYPT


197 
	~"¸y±.h
"

207 
loˇl
 
unz64loˇl_gëByã
 
OF
((

208 c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
,

209 
voidpf
 
fûe°ªam
,

210 *
pi
));

212 
loˇl
 
	$unz64loˇl_gëByã
(c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
, 
voidpf
 
fûe°ªam
, *
pi
)

214 
c
;

215 
îr
 = ()
	`ZREAD64
(*
pzlib_fûefunc_def
,
fûe°ªam
,&
c
,1);

216 i‡(
îr
==1)

218 *
pi
 = ()
c
;

219  
UNZ_OK
;

223 i‡(
	`ZERROR64
(*
pzlib_fûefunc_def
,
fûe°ªam
))

224  
UNZ_ERRNO
;

226  
UNZ_EOF
;

228 
	}
}

234 
loˇl
 
unz64loˇl_gëSh‹t
 
OF
((

235 c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
,

236 
voidpf
 
fûe°ªam
,

237 
uL⁄g
 *
pX
));

239 
loˇl
 
	$unz64loˇl_gëSh‹t
 (c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
,

240 
voidpf
 
fûe°ªam
,

241 
uL⁄g
 *
pX
)

243 
uL⁄g
 
x
 ;

244 
i
 = 0;

245 
îr
;

247 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

248 
x
 = (
uL⁄g
)
i
;

250 i‡(
îr
==
UNZ_OK
)

251 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

252 
x
 |((
uL⁄g
)
i
)<<8;

254 i‡(
îr
==
UNZ_OK
)

255 *
pX
 = 
x
;

257 *
pX
 = 0;

258  
îr
;

259 
	}
}

261 
loˇl
 
unz64loˇl_gëL⁄g
 
OF
((

262 c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
,

263 
voidpf
 
fûe°ªam
,

264 
uL⁄g
 *
pX
));

266 
loˇl
 
	$unz64loˇl_gëL⁄g
 (c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
,

267 
voidpf
 
fûe°ªam
,

268 
uL⁄g
 *
pX
)

270 
uL⁄g
 
x
 ;

271 
i
 = 0;

272 
îr
;

274 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

275 
x
 = (
uL⁄g
)
i
;

277 i‡(
îr
==
UNZ_OK
)

278 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

279 
x
 |((
uL⁄g
)
i
)<<8;

281 i‡(
îr
==
UNZ_OK
)

282 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

283 
x
 |((
uL⁄g
)
i
)<<16;

285 i‡(
îr
==
UNZ_OK
)

286 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

287 
x
 +((
uL⁄g
)
i
)<<24;

289 i‡(
îr
==
UNZ_OK
)

290 *
pX
 = 
x
;

292 *
pX
 = 0;

293  
îr
;

294 
	}
}

296 
loˇl
 
unz64loˇl_gëL⁄g64
 
OF
((

297 c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
,

298 
voidpf
 
fûe°ªam
,

299 
ZPOS64_T
 *
pX
));

302 
loˇl
 
	$unz64loˇl_gëL⁄g64
 (c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
,

303 
voidpf
 
fûe°ªam
,

304 
ZPOS64_T
 *
pX
)

306 
ZPOS64_T
 
x
 ;

307 
i
 = 0;

308 
îr
;

310 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

311 
x
 = (
ZPOS64_T
)
i
;

313 i‡(
îr
==
UNZ_OK
)

314 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

315 
x
 |((
ZPOS64_T
)
i
)<<8;

317 i‡(
îr
==
UNZ_OK
)

318 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

319 
x
 |((
ZPOS64_T
)
i
)<<16;

321 i‡(
îr
==
UNZ_OK
)

322 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

323 
x
 |((
ZPOS64_T
)
i
)<<24;

325 i‡(
îr
==
UNZ_OK
)

326 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

327 
x
 |((
ZPOS64_T
)
i
)<<32;

329 i‡(
îr
==
UNZ_OK
)

330 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

331 
x
 |((
ZPOS64_T
)
i
)<<40;

333 i‡(
îr
==
UNZ_OK
)

334 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

335 
x
 |((
ZPOS64_T
)
i
)<<48;

337 i‡(
îr
==
UNZ_OK
)

338 
îr
 = 
	`unz64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

339 
x
 |((
ZPOS64_T
)
i
)<<56;

341 i‡(
îr
==
UNZ_OK
)

342 *
pX
 = 
x
;

344 *
pX
 = 0;

345  
îr
;

346 
	}
}

349 
loˇl
 
	$°rcmpˇ£no£nsôive_öã∫Æ
 (c⁄° * 
fûeName1
, c⁄° * 
fûeName2
)

353 
c1
=*(
fûeName1
++);

354 
c2
=*(
fûeName2
++);

355 i‡((
c1
>='a') && (c1<='z'))

356 
c1
 -= 0x20;

357 i‡((
c2
>='a') && (c2<='z'))

358 
c2
 -= 0x20;

359 i‡(
c1
=='\0')

360  ((
c2
=='\0') ? 0 : -1);

361 i‡(
c2
=='\0')

363 i‡(
c1
<
c2
)

365 i‡(
c1
>
c2
)

368 
	}
}

371 #ifde‡ 
CASESENSITIVITYDEFAULT_NO


372 
	#CASESENSITIVITYDEFAULTVALUE
 2

	)

374 
	#CASESENSITIVITYDEFAULTVALUE
 1

	)

377 #i‚de‡
STRCMPCASENOSENTIVEFUNCTION


378 
	#STRCMPCASENOSENTIVEFUNCTION
 
°rcmpˇ£no£nsôive_öã∫Æ


	)

390 
ZEXPORT
 
	$unzSåögFûeNameCom∑ª
 (c⁄° * 
fûeName1
,

391 c⁄° * 
fûeName2
,

392 
iCa£Sísôivôy
)

395 i‡(
iCa£Sísôivôy
==0)

396 
iCa£Sísôivôy
=
CASESENSITIVITYDEFAULTVALUE
;

398 i‡(
iCa£Sísôivôy
==1)

399  
	`°rcmp
(
fûeName1
,
fûeName2
);

401  
	`STRCMPCASENOSENTIVEFUNCTION
(
fûeName1
,
fûeName2
);

402 
	}
}

404 #i‚de‡
BUFREADCOMMENT


405 
	#BUFREADCOMMENT
 (0x400)

	)

412 
loˇl
 
ZPOS64_T
 
unz64loˇl_SórchCíåÆDú
 
OF
((c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
, 
voidpf
 
fûe°ªam
));

413 
loˇl
 
ZPOS64_T
 
	$unz64loˇl_SórchCíåÆDú
(c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
, 
voidpf
 
fûe°ªam
)

415 * 
buf
;

416 
ZPOS64_T
 
uSizeFûe
;

417 
ZPOS64_T
 
uBackRód
;

418 
ZPOS64_T
 
uMaxBack
=0xffff;

419 
ZPOS64_T
 
uPosFound
=0;

421 i‡(
	`ZSEEK64
(*
pzlib_fûefunc_def
,
fûe°ªam
,0,
ZLIB_FILEFUNC_SEEK_END
) != 0)

425 
uSizeFûe
 = 
	`ZTELL64
(*
pzlib_fûefunc_def
,
fûe°ªam
);

427 i‡(
uMaxBack
>
uSizeFûe
)

428 
uMaxBack
 = 
uSizeFûe
;

430 
buf
 = (*)
	`ALLOC
(
BUFREADCOMMENT
+4);

431 i‡(
buf
==
NULL
)

434 
uBackRód
 = 4;

435 
uBackRód
<
uMaxBack
)

437 
uL⁄g
 
uRódSize
;

438 
ZPOS64_T
 
uRódPos
 ;

439 
i
;

440 i‡(
uBackRód
+
BUFREADCOMMENT
>
uMaxBack
)

441 
uBackRód
 = 
uMaxBack
;

443 
uBackRód
+=
BUFREADCOMMENT
;

444 
uRódPos
 = 
uSizeFûe
-
uBackRód
 ;

446 
uRódSize
 = ((
BUFREADCOMMENT
+4Ë< (
uSizeFûe
-
uRódPos
)) ?

447 (
BUFREADCOMMENT
+4Ë: (
uL⁄g
)(
uSizeFûe
-
uRódPos
);

448 i‡(
	`ZSEEK64
(*
pzlib_fûefunc_def
,
fûe°ªam
,
uRódPos
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

451 i‡(
	`ZREAD64
(*
pzlib_fûefunc_def
,
fûe°ªam
,
buf
,
uRódSize
)!=uReadSize)

454 
i
=()
uRódSize
-3; (i--)>0;)

455 i‡(((*(
buf
+
i
))==0x50) && ((*(buf+i+1))==0x4b) &&

456 ((*(
buf
+
i
+2))==0x05) && ((*(buf+i+3))==0x06))

458 
uPosFound
 = 
uRódPos
+
i
;

462 i‡(
uPosFound
!=0)

465 
	`TRYFREE
(
buf
);

466  
uPosFound
;

467 
	}
}

474 
loˇl
 
ZPOS64_T
 
unz64loˇl_SórchCíåÆDú64
 
OF
((

475 c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
,

476 
voidpf
 
fûe°ªam
));

478 
loˇl
 
ZPOS64_T
 
	$unz64loˇl_SórchCíåÆDú64
(c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
,

479 
voidpf
 
fûe°ªam
)

481 * 
buf
;

482 
ZPOS64_T
 
uSizeFûe
;

483 
ZPOS64_T
 
uBackRód
;

484 
ZPOS64_T
 
uMaxBack
=0xffff;

485 
ZPOS64_T
 
uPosFound
=0;

486 
uL⁄g
 
uL
;

487 
ZPOS64_T
 
ªœtiveOff£t
;

489 i‡(
	`ZSEEK64
(*
pzlib_fûefunc_def
,
fûe°ªam
,0,
ZLIB_FILEFUNC_SEEK_END
) != 0)

493 
uSizeFûe
 = 
	`ZTELL64
(*
pzlib_fûefunc_def
,
fûe°ªam
);

495 i‡(
uMaxBack
>
uSizeFûe
)

496 
uMaxBack
 = 
uSizeFûe
;

498 
buf
 = (*)
	`ALLOC
(
BUFREADCOMMENT
+4);

499 i‡(
buf
==
NULL
)

502 
uBackRód
 = 4;

503 
uBackRód
<
uMaxBack
)

505 
uL⁄g
 
uRódSize
;

506 
ZPOS64_T
 
uRódPos
;

507 
i
;

508 i‡(
uBackRód
+
BUFREADCOMMENT
>
uMaxBack
)

509 
uBackRód
 = 
uMaxBack
;

511 
uBackRód
+=
BUFREADCOMMENT
;

512 
uRódPos
 = 
uSizeFûe
-
uBackRód
 ;

514 
uRódSize
 = ((
BUFREADCOMMENT
+4Ë< (
uSizeFûe
-
uRódPos
)) ?

515 (
BUFREADCOMMENT
+4Ë: (
uL⁄g
)(
uSizeFûe
-
uRódPos
);

516 i‡(
	`ZSEEK64
(*
pzlib_fûefunc_def
,
fûe°ªam
,
uRódPos
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

519 i‡(
	`ZREAD64
(*
pzlib_fûefunc_def
,
fûe°ªam
,
buf
,
uRódSize
)!=uReadSize)

522 
i
=()
uRódSize
-3; (i--)>0;)

523 i‡(((*(
buf
+
i
))==0x50) && ((*(buf+i+1))==0x4b) &&

524 ((*(
buf
+
i
+2))==0x06) && ((*(buf+i+3))==0x07))

526 
uPosFound
 = 
uRódPos
+
i
;

530 i‡(
uPosFound
!=0)

533 
	`TRYFREE
(
buf
);

534 i‡(
uPosFound
 == 0)

538 i‡(
	`ZSEEK64
(*
pzlib_fûefunc_def
,
fûe°ªam
, 
uPosFound
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

542 i‡(
	`unz64loˇl_gëL⁄g
(
pzlib_fûefunc_def
,
fûe°ªam
,&
uL
)!=
UNZ_OK
)

546 i‡(
	`unz64loˇl_gëL⁄g
(
pzlib_fûefunc_def
,
fûe°ªam
,&
uL
)!=
UNZ_OK
)

548 i‡(
uL
 != 0)

552 i‡(
	`unz64loˇl_gëL⁄g64
(
pzlib_fûefunc_def
,
fûe°ªam
,&
ªœtiveOff£t
)!=
UNZ_OK
)

556 i‡(
	`unz64loˇl_gëL⁄g
(
pzlib_fûefunc_def
,
fûe°ªam
,&
uL
)!=
UNZ_OK
)

558 i‡(
uL
 != 1)

562 i‡(
	`ZSEEK64
(*
pzlib_fûefunc_def
,
fûe°ªam
, 
ªœtiveOff£t
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

566 i‡(
	`unz64loˇl_gëL⁄g
(
pzlib_fûefunc_def
,
fûe°ªam
,&
uL
)!=
UNZ_OK
)

569 i‡(
uL
 != 0x06064b50)

572  
ªœtiveOff£t
;

573 
	}
}

584 
loˇl
 
unzFûe
 
	$unzO≥nI¡î«l
 (c⁄° *
∑th
,

585 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc64_32_def
,

586 
is64bôO≥nFun˘i⁄
)

588 
unz64_s
 
us
;

589 
unz64_s
 *
s
;

590 
ZPOS64_T
 
˚¡øl_pos
;

591 
uL⁄g
 
uL
;

593 
uL⁄g
 
numbî_disk
;

595 
uL⁄g
 
numbî_disk_wôh_CD
;

597 
ZPOS64_T
 
numbî_íåy_CD
;

601 
îr
=
UNZ_OK
;

603 i‡(
unz_c›yright
[0]!=' ')

604  
NULL
;

606 
us
.
z_fûefunc
.
z£ek32_fûe
 = 
NULL
;

607 
us
.
z_fûefunc
.
zãŒ32_fûe
 = 
NULL
;

608 i‡(
pzlib_fûefunc64_32_def
==
NULL
)

609 
	`fûl_f›í64_fûefunc
(&
us
.
z_fûefunc
.
zfûe_func64
);

611 
us
.
z_fûefunc
 = *
pzlib_fûefunc64_32_def
;

612 
us
.
is64bôO≥nFun˘i⁄
 = is64bitOpenFunction;

616 
us
.
fûe°ªam
 = 
	`ZOPEN64
(us.
z_fûefunc
,

617 
∑th
,

618 
ZLIB_FILEFUNC_MODE_READ
 |

619 
ZLIB_FILEFUNC_MODE_EXISTING
);

620 i‡(
us
.
fûe°ªam
==
NULL
)

621  
NULL
;

623 
˚¡øl_pos
 = 
	`unz64loˇl_SórchCíåÆDú64
(&
us
.
z_fûefunc
,us.
fûe°ªam
);

624 i‡(
˚¡øl_pos
)

626 
uL⁄g
 
uS
;

627 
ZPOS64_T
 
uL64
;

629 
us
.
isZù64
 = 1;

631 i‡(
	`ZSEEK64
(
us
.
z_fûefunc
, us.
fûe°ªam
,

632 
˚¡øl_pos
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

633 
îr
=
UNZ_ERRNO
;

636 i‡(
	`unz64loˇl_gëL⁄g
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uL
)!=
UNZ_OK
)

637 
îr
=
UNZ_ERRNO
;

640 i‡(
	`unz64loˇl_gëL⁄g64
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uL64
)!=
UNZ_OK
)

641 
îr
=
UNZ_ERRNO
;

644 i‡(
	`unz64loˇl_gëSh‹t
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uS
)!=
UNZ_OK
)

645 
îr
=
UNZ_ERRNO
;

648 i‡(
	`unz64loˇl_gëSh‹t
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uS
)!=
UNZ_OK
)

649 
îr
=
UNZ_ERRNO
;

652 i‡(
	`unz64loˇl_gëL⁄g
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
numbî_disk
)!=
UNZ_OK
)

653 
îr
=
UNZ_ERRNO
;

656 i‡(
	`unz64loˇl_gëL⁄g
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
numbî_disk_wôh_CD
)!=
UNZ_OK
)

657 
îr
=
UNZ_ERRNO
;

660 i‡(
	`unz64loˇl_gëL⁄g64
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&us.
gi
.
numbî_íåy
)!=
UNZ_OK
)

661 
îr
=
UNZ_ERRNO
;

664 i‡(
	`unz64loˇl_gëL⁄g64
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
numbî_íåy_CD
)!=
UNZ_OK
)

665 
îr
=
UNZ_ERRNO
;

667 i‡((
numbî_íåy_CD
!=
us
.
gi
.
numbî_íåy
) ||

668 (
numbî_disk_wôh_CD
!=0) ||

669 (
numbî_disk
!=0))

670 
îr
=
UNZ_BADZIPFILE
;

673 i‡(
	`unz64loˇl_gëL⁄g64
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&us.
size_˚¡øl_dú
)!=
UNZ_OK
)

674 
îr
=
UNZ_ERRNO
;

678 i‡(
	`unz64loˇl_gëL⁄g64
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&us.
off£t_˚¡øl_dú
)!=
UNZ_OK
)

679 
îr
=
UNZ_ERRNO
;

681 
us
.
gi
.
size_commít
 = 0;

685 
˚¡øl_pos
 = 
	`unz64loˇl_SórchCíåÆDú
(&
us
.
z_fûefunc
,us.
fûe°ªam
);

686 i‡(
˚¡øl_pos
==0)

687 
îr
=
UNZ_ERRNO
;

689 
us
.
isZù64
 = 0;

691 i‡(
	`ZSEEK64
(
us
.
z_fûefunc
, us.
fûe°ªam
,

692 
˚¡øl_pos
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

693 
îr
=
UNZ_ERRNO
;

696 i‡(
	`unz64loˇl_gëL⁄g
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uL
)!=
UNZ_OK
)

697 
îr
=
UNZ_ERRNO
;

700 i‡(
	`unz64loˇl_gëSh‹t
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
numbî_disk
)!=
UNZ_OK
)

701 
îr
=
UNZ_ERRNO
;

704 i‡(
	`unz64loˇl_gëSh‹t
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
numbî_disk_wôh_CD
)!=
UNZ_OK
)

705 
îr
=
UNZ_ERRNO
;

708 i‡(
	`unz64loˇl_gëSh‹t
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uL
)!=
UNZ_OK
)

709 
îr
=
UNZ_ERRNO
;

710 
us
.
gi
.
numbî_íåy
 = 
uL
;

713 i‡(
	`unz64loˇl_gëSh‹t
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uL
)!=
UNZ_OK
)

714 
îr
=
UNZ_ERRNO
;

715 
numbî_íåy_CD
 = 
uL
;

717 i‡((
numbî_íåy_CD
!=
us
.
gi
.
numbî_íåy
) ||

718 (
numbî_disk_wôh_CD
!=0) ||

719 (
numbî_disk
!=0))

720 
îr
=
UNZ_BADZIPFILE
;

723 i‡(
	`unz64loˇl_gëL⁄g
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uL
)!=
UNZ_OK
)

724 
îr
=
UNZ_ERRNO
;

725 
us
.
size_˚¡øl_dú
 = 
uL
;

729 i‡(
	`unz64loˇl_gëL⁄g
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&
uL
)!=
UNZ_OK
)

730 
îr
=
UNZ_ERRNO
;

731 
us
.
off£t_˚¡øl_dú
 = 
uL
;

734 i‡(
	`unz64loˇl_gëSh‹t
(&
us
.
z_fûefunc
, us.
fûe°ªam
,&us.
gi
.
size_commít
)!=
UNZ_OK
)

735 
îr
=
UNZ_ERRNO
;

738 i‡((
˚¡øl_pos
<
us
.
off£t_˚¡øl_dú
+us.
size_˚¡øl_dú
) &&

739 (
îr
==
UNZ_OK
))

740 
îr
=
UNZ_BADZIPFILE
;

742 i‡(
îr
!=
UNZ_OK
)

744 
	`ZCLOSE64
(
us
.
z_fûefunc
, us.
fûe°ªam
);

745  
NULL
;

748 
us
.
byã_bef‹e_the_zùfûe
 = 
˚¡øl_pos
 -

749 (
us
.
off£t_˚¡øl_dú
+us.
size_˚¡øl_dú
);

750 
us
.
˚¡øl_pos
 = central_pos;

751 
us
.
pfûe_ö_zù_ªad
 = 
NULL
;

752 
us
.
í¸y±ed
 = 0;

755 
s
=(
unz64_s
*)
	`ALLOC
((unz64_s));

756 if–
s
 !
NULL
)

758 *
s
=
us
;

759 
	`unzGoToFú°Fûe
((
unzFûe
)
s
);

761  (
unzFûe
)
s
;

762 
	}
}

765 
unzFûe
 
ZEXPORT
 
	$unzO≥n2
 (c⁄° *
∑th
,

766 
zlib_fûefunc_def
* 
pzlib_fûefunc32_def
)

768 i‡(
pzlib_fûefunc32_def
 !
NULL
)

770 
zlib_fûefunc64_32_def
 
zlib_fûefunc64_32_def_fûl
;

771 
	`fûl_zlib_fûefunc64_32_def_‰om_fûefunc32
(&
zlib_fûefunc64_32_def_fûl
,
pzlib_fûefunc32_def
);

772  
	`unzO≥nI¡î«l
(
∑th
, &
zlib_fûefunc64_32_def_fûl
, 0);

775  
	`unzO≥nI¡î«l
(
∑th
, 
NULL
, 0);

776 
	}
}

778 
unzFûe
 
ZEXPORT
 
	$unzO≥n2_64
 (c⁄° *
∑th
,

779 
zlib_fûefunc64_def
* 
pzlib_fûefunc_def
)

781 i‡(
pzlib_fûefunc_def
 !
NULL
)

783 
zlib_fûefunc64_32_def
 
zlib_fûefunc64_32_def_fûl
;

784 
zlib_fûefunc64_32_def_fûl
.
zfûe_func64
 = *
pzlib_fûefunc_def
;

785 
zlib_fûefunc64_32_def_fûl
.
zãŒ32_fûe
 = 
NULL
;

786 
zlib_fûefunc64_32_def_fûl
.
z£ek32_fûe
 = 
NULL
;

787  
	`unzO≥nI¡î«l
(
∑th
, &
zlib_fûefunc64_32_def_fûl
, 1);

790  
	`unzO≥nI¡î«l
(
∑th
, 
NULL
, 1);

791 
	}
}

793 
unzFûe
 
ZEXPORT
 
	$unzO≥n
 (c⁄° *
∑th
)

795  
	`unzO≥nI¡î«l
(
∑th
, 
NULL
, 0);

796 
	}
}

798 
unzFûe
 
ZEXPORT
 
	$unzO≥n64
 (c⁄° *
∑th
)

800  
	`unzO≥nI¡î«l
(
∑th
, 
NULL
, 1);

801 
	}
}

808 
ZEXPORT
 
	$unzClo£
 (
unzFûe
 
fûe
)

810 
unz64_s
* 
s
;

811 i‡(
fûe
==
NULL
)

812  
UNZ_PARAMERROR
;

813 
s
=(
unz64_s
*)
fûe
;

815 i‡(
s
->
pfûe_ö_zù_ªad
!=
NULL
)

816 
	`unzClo£CuºítFûe
(
fûe
);

818 
	`ZCLOSE64
(
s
->
z_fûefunc
, s->
fûe°ªam
);

819 
	`TRYFREE
(
s
);

820  
UNZ_OK
;

821 
	}
}

828 
ZEXPORT
 
	$unzGëGlobÆInfo64
 (
unzFûe
 
fûe
, 
unz_globÆ_öfo64
* 
pglobÆ_öfo
)

830 
unz64_s
* 
s
;

831 i‡(
fûe
==
NULL
)

832  
UNZ_PARAMERROR
;

833 
s
=(
unz64_s
*)
fûe
;

834 *
pglobÆ_öfo
=
s
->
gi
;

835  
UNZ_OK
;

836 
	}
}

838 
ZEXPORT
 
	$unzGëGlobÆInfo
 (
unzFûe
 
fûe
, 
unz_globÆ_öfo
* 
pglobÆ_öfo32
)

840 
unz64_s
* 
s
;

841 i‡(
fûe
==
NULL
)

842  
UNZ_PARAMERROR
;

843 
s
=(
unz64_s
*)
fûe
;

845 
pglobÆ_öfo32
->
numbî_íåy
 = (
uL⁄g
)
s
->
gi
.number_entry;

846 
pglobÆ_öfo32
->
size_commít
 = 
s
->
gi
.size_comment;

847  
UNZ_OK
;

848 
	}
}

852 
loˇl
 
	$unz64loˇl_DosD©eToTmuD©e
 (
ZPOS64_T
 
ulDosD©e
, 
tm_unz
* 
±m
)

854 
ZPOS64_T
 
uD©e
;

855 
uD©e
 = (
ZPOS64_T
)(
ulDosD©e
>>16);

856 
±m
->
tm_mday
 = (
uI¡
)(
uD©e
&0x1f) ;

857 
±m
->
tm_m⁄
 = (
uI¡
)((((
uD©e
)&0x1E0)/0x20)-1) ;

858 
±m
->
tm_yór
 = (
uI¡
)(((
uD©e
&0x0FE00)/0x0200)+1980) ;

860 
±m
->
tm_hour
 = (
uI¡
Ë((
ulDosD©e
 &0xF800)/0x800);

861 
±m
->
tm_mö
 = (
uI¡
Ë((
ulDosD©e
&0x7E0)/0x20) ;

862 
±m
->
tm_£c
 = (
uI¡
Ë(2*(
ulDosD©e
&0x1f)) ;

863 
	}
}

868 
loˇl
 
unz64loˇl_GëCuºítFûeInfoI¡î«l
 
OF
((
unzFûe
 
fûe
,

869 
unz_fûe_öfo64
 *
pfûe_öfo
,

870 
unz_fûe_öfo64_öã∫Æ


871 *
pfûe_öfo_öã∫Æ
,

872 *
szFûeName
,

873 
uL⁄g
 
fûeNameBuf„rSize
,

874 *
exåaFõld
,

875 
uL⁄g
 
exåaFõldBuf„rSize
,

876 *
szCommít
,

877 
uL⁄g
 
commítBuf„rSize
));

879 
loˇl
 
	$unz64loˇl_GëCuºítFûeInfoI¡î«l
 (
unzFûe
 
fûe
,

880 
unz_fûe_öfo64
 *
pfûe_öfo
,

881 
unz_fûe_öfo64_öã∫Æ


882 *
pfûe_öfo_öã∫Æ
,

883 *
szFûeName
,

884 
uL⁄g
 
fûeNameBuf„rSize
,

885 *
exåaFõld
,

886 
uL⁄g
 
exåaFõldBuf„rSize
,

887 *
szCommít
,

888 
uL⁄g
 
commítBuf„rSize
)

890 
unz64_s
* 
s
;

891 
unz_fûe_öfo64
 
fûe_öfo
;

892 
unz_fûe_öfo64_öã∫Æ
 
fûe_öfo_öã∫Æ
;

893 
îr
=
UNZ_OK
;

894 
uL⁄g
 
uMagic
;

895 
lSìk
=0;

896 
uL⁄g
 
uL
;

898 i‡(
fûe
==
NULL
)

899  
UNZ_PARAMERROR
;

900 
s
=(
unz64_s
*)
fûe
;

901 i‡(
	`ZSEEK64
(
s
->
z_fûefunc
, s->
fûe°ªam
,

902 
s
->
pos_ö_˚¡øl_dú
+s->
byã_bef‹e_the_zùfûe
,

903 
ZLIB_FILEFUNC_SEEK_SET
)!=0)

904 
îr
=
UNZ_ERRNO
;

908 i‡(
îr
==
UNZ_OK
)

910 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uMagic
Ë!
UNZ_OK
)

911 
îr
=
UNZ_ERRNO
;

912 i‡(
uMagic
!=0x02014b50)

913 
îr
=
UNZ_BADZIPFILE
;

916 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
vîsi⁄
Ë!
UNZ_OK
)

917 
îr
=
UNZ_ERRNO
;

919 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
vîsi⁄_√eded
Ë!
UNZ_OK
)

920 
îr
=
UNZ_ERRNO
;

922 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
Êag
Ë!
UNZ_OK
)

923 
îr
=
UNZ_ERRNO
;

925 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
com¥essi⁄_mëhod
Ë!
UNZ_OK
)

926 
îr
=
UNZ_ERRNO
;

928 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
dosD©e
Ë!
UNZ_OK
)

929 
îr
=
UNZ_ERRNO
;

931 
	`unz64loˇl_DosD©eToTmuD©e
(
fûe_öfo
.
dosD©e
,&fûe_öfo.
tmu_d©e
);

933 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
¸c
Ë!
UNZ_OK
)

934 
îr
=
UNZ_ERRNO
;

936 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uL
Ë!
UNZ_OK
)

937 
îr
=
UNZ_ERRNO
;

938 
fûe_öfo
.
com¥es£d_size
 = 
uL
;

940 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uL
Ë!
UNZ_OK
)

941 
îr
=
UNZ_ERRNO
;

942 
fûe_öfo
.
uncom¥es£d_size
 = 
uL
;

944 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
size_fûíame
Ë!
UNZ_OK
)

945 
îr
=
UNZ_ERRNO
;

947 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
size_fûe_exåa
Ë!
UNZ_OK
)

948 
îr
=
UNZ_ERRNO
;

950 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
size_fûe_commít
Ë!
UNZ_OK
)

951 
îr
=
UNZ_ERRNO
;

953 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
disk_num_°¨t
Ë!
UNZ_OK
)

954 
îr
=
UNZ_ERRNO
;

956 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
öã∫Æ_Á
Ë!
UNZ_OK
)

957 
îr
=
UNZ_ERRNO
;

959 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
exã∫Æ_Á
Ë!
UNZ_OK
)

960 
îr
=
UNZ_ERRNO
;

963 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uL
Ë!
UNZ_OK
)

964 
îr
=
UNZ_ERRNO
;

965 
fûe_öfo_öã∫Æ
.
off£t_curfûe
 = 
uL
;

967 
lSìk
+=
fûe_öfo
.
size_fûíame
;

968 i‡((
îr
==
UNZ_OK
Ë&& (
szFûeName
!=
NULL
))

970 
uL⁄g
 
uSizeRód
 ;

971 i‡(
fûe_öfo
.
size_fûíame
<
fûeNameBuf„rSize
)

973 *(
szFûeName
+
fûe_öfo
.
size_fûíame
)='\0';

974 
uSizeRód
 = 
fûe_öfo
.
size_fûíame
;

977 
uSizeRód
 = 
fûeNameBuf„rSize
;

979 i‡((
fûe_öfo
.
size_fûíame
>0Ë&& (
fûeNameBuf„rSize
>0))

980 i‡(
	`ZREAD64
(
s
->
z_fûefunc
, s->
fûe°ªam
,
szFûeName
,
uSizeRód
)!=uSizeRead)

981 
îr
=
UNZ_ERRNO
;

982 
lSìk
 -
uSizeRód
;

986 i‡((
îr
==
UNZ_OK
Ë&& (
exåaFõld
!=
NULL
))

988 
ZPOS64_T
 
uSizeRód
 ;

989 i‡(
fûe_öfo
.
size_fûe_exåa
<
exåaFõldBuf„rSize
)

990 
uSizeRód
 = 
fûe_öfo
.
size_fûe_exåa
;

992 
uSizeRód
 = 
exåaFõldBuf„rSize
;

994 i‡(
lSìk
!=0)

996 i‡(
	`ZSEEK64
(
s
->
z_fûefunc
, s->
fûe°ªam
,
lSìk
,
ZLIB_FILEFUNC_SEEK_CUR
)==0)

997 
lSìk
=0;

999 
îr
=
UNZ_ERRNO
;

1002 i‡((
fûe_öfo
.
size_fûe_exåa
>0Ë&& (
exåaFõldBuf„rSize
>0))

1003 i‡(
	`ZREAD64
(
s
->
z_fûefunc
, s->
fûe°ªam
,
exåaFõld
,(
uL⁄g
)
uSizeRód
)!=uSizeRead)

1004 
îr
=
UNZ_ERRNO
;

1006 
lSìk
 +
fûe_öfo
.
size_fûe_exåa
 - (
uL⁄g
)
uSizeRód
;

1009 
lSìk
 +
fûe_öfo
.
size_fûe_exåa
;

1012 i‡((
îr
==
UNZ_OK
Ë&& (
fûe_öfo
.
size_fûe_exåa
 != 0))

1014 
uL⁄g
 
acc
 = 0;

1017 
lSìk
 -
fûe_öfo
.
size_fûe_exåa
;

1019 i‡(
lSìk
!=0)

1021 i‡(
	`ZSEEK64
(
s
->
z_fûefunc
, s->
fûe°ªam
,
lSìk
,
ZLIB_FILEFUNC_SEEK_CUR
)==0)

1022 
lSìk
=0;

1024 
îr
=
UNZ_ERRNO
;

1027 
acc
 < 
fûe_öfo
.
size_fûe_exåa
)

1029 
uL⁄g
 
hódîId
;

1030 
uL⁄g
 
d©aSize
;

1032 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
hódîId
Ë!
UNZ_OK
)

1033 
îr
=
UNZ_ERRNO
;

1035 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
d©aSize
Ë!
UNZ_OK
)

1036 
îr
=
UNZ_ERRNO
;

1039 i‡(
hódîId
 == 0x0001)

1041 
uL⁄g
 
uL
;

1043 if(
fûe_öfo
.
uncom¥es£d_size
 =
MAXU32
)

1045 i‡(
	`unz64loˇl_gëL⁄g64
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
uncom¥es£d_size
Ë!
UNZ_OK
)

1046 
îr
=
UNZ_ERRNO
;

1049 if(
fûe_öfo
.
com¥es£d_size
 =
MAXU32
)

1051 i‡(
	`unz64loˇl_gëL⁄g64
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo
.
com¥es£d_size
Ë!
UNZ_OK
)

1052 
îr
=
UNZ_ERRNO
;

1055 if(
fûe_öfo_öã∫Æ
.
off£t_curfûe
 =
MAXU32
)

1058 i‡(
	`unz64loˇl_gëL⁄g64
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
fûe_öfo_öã∫Æ
.
off£t_curfûe
Ë!
UNZ_OK
)

1059 
îr
=
UNZ_ERRNO
;

1062 if(
fûe_öfo
.
disk_num_°¨t
 =
MAXU32
)

1065 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uL
Ë!
UNZ_OK
)

1066 
îr
=
UNZ_ERRNO
;

1072 i‡(
	`ZSEEK64
(
s
->
z_fûefunc
, s->
fûe°ªam
,
d©aSize
,
ZLIB_FILEFUNC_SEEK_CUR
)!=0)

1073 
îr
=
UNZ_ERRNO
;

1076 
acc
 +2 + 2 + 
d©aSize
;

1080 i‡((
îr
==
UNZ_OK
Ë&& (
szCommít
!=
NULL
))

1082 
uL⁄g
 
uSizeRód
 ;

1083 i‡(
fûe_öfo
.
size_fûe_commít
<
commítBuf„rSize
)

1085 *(
szCommít
+
fûe_öfo
.
size_fûe_commít
)='\0';

1086 
uSizeRód
 = 
fûe_öfo
.
size_fûe_commít
;

1089 
uSizeRód
 = 
commítBuf„rSize
;

1091 i‡(
lSìk
!=0)

1093 i‡(
	`ZSEEK64
(
s
->
z_fûefunc
, s->
fûe°ªam
,
lSìk
,
ZLIB_FILEFUNC_SEEK_CUR
)==0)

1094 
lSìk
=0;

1096 
îr
=
UNZ_ERRNO
;

1099 i‡((
fûe_öfo
.
size_fûe_commít
>0Ë&& (
commítBuf„rSize
>0))

1100 i‡(
	`ZREAD64
(
s
->
z_fûefunc
, s->
fûe°ªam
,
szCommít
,
uSizeRód
)!=uSizeRead)

1101 
îr
=
UNZ_ERRNO
;

1102 
lSìk
+=
fûe_öfo
.
size_fûe_commít
 - 
uSizeRód
;

1105 
lSìk
+=
fûe_öfo
.
size_fûe_commít
;

1108 i‡((
îr
==
UNZ_OK
Ë&& (
pfûe_öfo
!=
NULL
))

1109 *
pfûe_öfo
=
fûe_öfo
;

1111 i‡((
îr
==
UNZ_OK
Ë&& (
pfûe_öfo_öã∫Æ
!=
NULL
))

1112 *
pfûe_öfo_öã∫Æ
=
fûe_öfo_öã∫Æ
;

1114  
îr
;

1115 
	}
}

1124 
ZEXPORT
 
	$unzGëCuºítFûeInfo64
 (
unzFûe
 
fûe
,

1125 
unz_fûe_öfo64
 * 
pfûe_öfo
,

1126 * 
szFûeName
, 
uL⁄g
 
fûeNameBuf„rSize
,

1127 *
exåaFõld
, 
uL⁄g
 
exåaFõldBuf„rSize
,

1128 * 
szCommít
, 
uL⁄g
 
commítBuf„rSize
)

1130  
	`unz64loˇl_GëCuºítFûeInfoI¡î«l
(
fûe
,
pfûe_öfo
,
NULL
,

1131 
szFûeName
,
fûeNameBuf„rSize
,

1132 
exåaFõld
,
exåaFõldBuf„rSize
,

1133 
szCommít
,
commítBuf„rSize
);

1134 
	}
}

1136 
ZEXPORT
 
	$unzGëCuºítFûeInfo
 (
unzFûe
 
fûe
,

1137 
unz_fûe_öfo
 * 
pfûe_öfo
,

1138 * 
szFûeName
, 
uL⁄g
 
fûeNameBuf„rSize
,

1139 *
exåaFõld
, 
uL⁄g
 
exåaFõldBuf„rSize
,

1140 * 
szCommít
, 
uL⁄g
 
commítBuf„rSize
)

1142 
îr
;

1143 
unz_fûe_öfo64
 
fûe_öfo64
;

1144 
îr
 = 
	`unz64loˇl_GëCuºítFûeInfoI¡î«l
(
fûe
,&
fûe_öfo64
,
NULL
,

1145 
szFûeName
,
fûeNameBuf„rSize
,

1146 
exåaFõld
,
exåaFõldBuf„rSize
,

1147 
szCommít
,
commítBuf„rSize
);

1148 i‡((
îr
==
UNZ_OK
Ë&& (
pfûe_öfo
 !
NULL
))

1150 
pfûe_öfo
->
vîsi⁄
 = 
fûe_öfo64
.version;

1151 
pfûe_öfo
->
vîsi⁄_√eded
 = 
fûe_öfo64
.version_needed;

1152 
pfûe_öfo
->
Êag
 = 
fûe_öfo64
.flag;

1153 
pfûe_öfo
->
com¥essi⁄_mëhod
 = 
fûe_öfo64
.compression_method;

1154 
pfûe_öfo
->
dosD©e
 = 
fûe_öfo64
.dosDate;

1155 
pfûe_öfo
->
¸c
 = 
fûe_öfo64
.crc;

1157 
pfûe_öfo
->
size_fûíame
 = 
fûe_öfo64
.size_filename;

1158 
pfûe_öfo
->
size_fûe_exåa
 = 
fûe_öfo64
.size_file_extra;

1159 
pfûe_öfo
->
size_fûe_commít
 = 
fûe_öfo64
.size_file_comment;

1161 
pfûe_öfo
->
disk_num_°¨t
 = 
fûe_öfo64
.disk_num_start;

1162 
pfûe_öfo
->
öã∫Æ_Á
 = 
fûe_öfo64
.internal_fa;

1163 
pfûe_öfo
->
exã∫Æ_Á
 = 
fûe_öfo64
.external_fa;

1165 
pfûe_öfo
->
tmu_d©e
 = 
fûe_öfo64
.tmu_date,

1168 
pfûe_öfo
->
com¥es£d_size
 = (
uL⁄g
)
fûe_öfo64
.compressed_size;

1169 
pfûe_öfo
->
uncom¥es£d_size
 = (
uL⁄g
)
fûe_öfo64
.uncompressed_size;

1172  
îr
;

1173 
	}
}

1178 
ZEXPORT
 
	$unzGoToFú°Fûe
 (
unzFûe
 
fûe
)

1180 
îr
=
UNZ_OK
;

1181 
unz64_s
* 
s
;

1182 i‡(
fûe
==
NULL
)

1183  
UNZ_PARAMERROR
;

1184 
s
=(
unz64_s
*)
fûe
;

1185 
s
->
pos_ö_˚¡øl_dú
=s->
off£t_˚¡øl_dú
;

1186 
s
->
num_fûe
=0;

1187 
îr
=
	`unz64loˇl_GëCuºítFûeInfoI¡î«l
(
fûe
,&
s
->
cur_fûe_öfo
,

1188 &
s
->
cur_fûe_öfo_öã∫Æ
,

1189 
NULL
,0,NULL,0,NULL,0);

1190 
s
->
cuºít_fûe_ok
 = (
îr
 =
UNZ_OK
);

1191  
îr
;

1192 
	}
}

1199 
ZEXPORT
 
	$unzGoToNextFûe
 (
unzFûe
 
fûe
)

1201 
unz64_s
* 
s
;

1202 
îr
;

1204 i‡(
fûe
==
NULL
)

1205  
UNZ_PARAMERROR
;

1206 
s
=(
unz64_s
*)
fûe
;

1207 i‡(!
s
->
cuºít_fûe_ok
)

1208  
UNZ_END_OF_LIST_OF_FILE
;

1209 i‡(
s
->
gi
.
numbî_íåy
 != 0xffff)

1210 i‡(
s
->
num_fûe
+1==s->
gi
.
numbî_íåy
)

1211  
UNZ_END_OF_LIST_OF_FILE
;

1213 
s
->
pos_ö_˚¡øl_dú
 +
SIZECENTRALDIRITEM
 + s->
cur_fûe_öfo
.
size_fûíame
 +

1214 
s
->
cur_fûe_öfo
.
size_fûe_exåa
 + s->cur_fûe_öfo.
size_fûe_commít
 ;

1215 
s
->
num_fûe
++;

1216 
îr
 = 
	`unz64loˇl_GëCuºítFûeInfoI¡î«l
(
fûe
,&
s
->
cur_fûe_öfo
,

1217 &
s
->
cur_fûe_öfo_öã∫Æ
,

1218 
NULL
,0,NULL,0,NULL,0);

1219 
s
->
cuºít_fûe_ok
 = (
îr
 =
UNZ_OK
);

1220  
îr
;

1221 
	}
}

1232 
ZEXPORT
 
	$unzLoˇãFûe
 (
unzFûe
 
fûe
, c⁄° *
szFûeName
, 
iCa£Sísôivôy
)

1234 
unz64_s
* 
s
;

1235 
îr
;

1240 
unz_fûe_öfo64
 
cur_fûe_öfoSaved
;

1241 
unz_fûe_öfo64_öã∫Æ
 
cur_fûe_öfo_öã∫ÆSaved
;

1242 
ZPOS64_T
 
num_fûeSaved
;

1243 
ZPOS64_T
 
pos_ö_˚¡øl_dúSaved
;

1246 i‡(
fûe
==
NULL
)

1247  
UNZ_PARAMERROR
;

1249 i‡(
	`°æí
(
szFûeName
)>=
UNZ_MAXFILENAMEINZIP
)

1250  
UNZ_PARAMERROR
;

1252 
s
=(
unz64_s
*)
fûe
;

1253 i‡(!
s
->
cuºít_fûe_ok
)

1254  
UNZ_END_OF_LIST_OF_FILE
;

1257 
num_fûeSaved
 = 
s
->
num_fûe
;

1258 
pos_ö_˚¡øl_dúSaved
 = 
s
->
pos_ö_˚¡øl_dú
;

1259 
cur_fûe_öfoSaved
 = 
s
->
cur_fûe_öfo
;

1260 
cur_fûe_öfo_öã∫ÆSaved
 = 
s
->
cur_fûe_öfo_öã∫Æ
;

1262 
îr
 = 
	`unzGoToFú°Fûe
(
fûe
);

1264 
îr
 =
UNZ_OK
)

1266 
szCuºítFûeName
[
UNZ_MAXFILENAMEINZIP
+1];

1267 
îr
 = 
	`unzGëCuºítFûeInfo64
(
fûe
,
NULL
,

1268 
szCuºítFûeName
,(szCurrentFileName)-1,

1269 
NULL
,0,NULL,0);

1270 i‡(
îr
 =
UNZ_OK
)

1272 i‡(
	`unzSåögFûeNameCom∑ª
(
szCuºítFûeName
,

1273 
szFûeName
,
iCa£Sísôivôy
)==0)

1274  
UNZ_OK
;

1275 
îr
 = 
	`unzGoToNextFûe
(
fûe
);

1282 
s
->
num_fûe
 = 
num_fûeSaved
 ;

1283 
s
->
pos_ö_˚¡øl_dú
 = 
pos_ö_˚¡øl_dúSaved
 ;

1284 
s
->
cur_fûe_öfo
 = 
cur_fûe_öfoSaved
;

1285 
s
->
cur_fûe_öfo_öã∫Æ
 = 
cur_fûe_öfo_öã∫ÆSaved
;

1286  
îr
;

1287 
	}
}

1308 
ZEXPORT
 
	$unzGëFûePos64
(
unzFûe
 
fûe
, 
unz64_fûe_pos
* 
fûe_pos
)

1310 
unz64_s
* 
s
;

1312 i‡(
fûe
==
NULL
 || 
fûe_pos
==NULL)

1313  
UNZ_PARAMERROR
;

1314 
s
=(
unz64_s
*)
fûe
;

1315 i‡(!
s
->
cuºít_fûe_ok
)

1316  
UNZ_END_OF_LIST_OF_FILE
;

1318 
fûe_pos
->
pos_ö_zù_dúe˘‹y
 = 
s
->
pos_ö_˚¡øl_dú
;

1319 
fûe_pos
->
num_of_fûe
 = 
s
->
num_fûe
;

1321  
UNZ_OK
;

1322 
	}
}

1324 
ZEXPORT
 
	$unzGëFûePos
(

1325 
unzFûe
 
fûe
,

1326 
unz_fûe_pos
* 
fûe_pos
)

1328 
unz64_fûe_pos
 
fûe_pos64
;

1329 
îr
 = 
	`unzGëFûePos64
(
fûe
,&
fûe_pos64
);

1330 i‡(
îr
==
UNZ_OK
)

1332 
fûe_pos
->
pos_ö_zù_dúe˘‹y
 = (
uL⁄g
)
fûe_pos64
.pos_in_zip_directory;

1333 
fûe_pos
->
num_of_fûe
 = (
uL⁄g
)
fûe_pos64
.num_of_file;

1335  
îr
;

1336 
	}
}

1338 
ZEXPORT
 
	$unzGoToFûePos64
(
unzFûe
 
fûe
, c⁄° 
unz64_fûe_pos
* 
fûe_pos
)

1340 
unz64_s
* 
s
;

1341 
îr
;

1343 i‡(
fûe
==
NULL
 || 
fûe_pos
==NULL)

1344  
UNZ_PARAMERROR
;

1345 
s
=(
unz64_s
*)
fûe
;

1348 
s
->
pos_ö_˚¡øl_dú
 = 
fûe_pos
->
pos_ö_zù_dúe˘‹y
;

1349 
s
->
num_fûe
 = 
fûe_pos
->
num_of_fûe
;

1352 
îr
 = 
	`unz64loˇl_GëCuºítFûeInfoI¡î«l
(
fûe
,&
s
->
cur_fûe_öfo
,

1353 &
s
->
cur_fûe_öfo_öã∫Æ
,

1354 
NULL
,0,NULL,0,NULL,0);

1356 
s
->
cuºít_fûe_ok
 = (
îr
 =
UNZ_OK
);

1357  
îr
;

1358 
	}
}

1360 
ZEXPORT
 
	$unzGoToFûePos
(

1361 
unzFûe
 
fûe
,

1362 
unz_fûe_pos
* 
fûe_pos
)

1364 
unz64_fûe_pos
 
fûe_pos64
;

1365 i‡(
fûe_pos
 =
NULL
)

1366  
UNZ_PARAMERROR
;

1368 
fûe_pos64
.
pos_ö_zù_dúe˘‹y
 = 
fûe_pos
->pos_in_zip_directory;

1369 
fûe_pos64
.
num_of_fûe
 = 
fûe_pos
->num_of_file;

1370  
	`unzGoToFûePos64
(
fûe
,&
fûe_pos64
);

1371 
	}
}

1385 
loˇl
 
	$unz64loˇl_CheckCuºítFûeCohîícyHódî
 (
unz64_s
* 
s
, 
uI¡
* 
piSizeV¨
,

1386 
ZPOS64_T
 * 
poff£t_loˇl_exåafõld
,

1387 
uI¡
 * 
psize_loˇl_exåafõld
)

1389 
uL⁄g
 
uMagic
,
uD©a
,
uFœgs
;

1390 
uL⁄g
 
size_fûíame
;

1391 
uL⁄g
 
size_exåa_fõld
;

1392 
îr
=
UNZ_OK
;

1394 *
piSizeV¨
 = 0;

1395 *
poff£t_loˇl_exåafõld
 = 0;

1396 *
psize_loˇl_exåafõld
 = 0;

1398 i‡(
	`ZSEEK64
(
s
->
z_fûefunc
, s->
fûe°ªam
,s->
cur_fûe_öfo_öã∫Æ
.
off£t_curfûe
 +

1399 
s
->
byã_bef‹e_the_zùfûe
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

1400  
UNZ_ERRNO
;

1403 i‡(
îr
==
UNZ_OK
)

1405 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uMagic
Ë!
UNZ_OK
)

1406 
îr
=
UNZ_ERRNO
;

1407 i‡(
uMagic
!=0x04034b50)

1408 
îr
=
UNZ_BADZIPFILE
;

1411 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uD©a
Ë!
UNZ_OK
)

1412 
îr
=
UNZ_ERRNO
;

1417 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uFœgs
Ë!
UNZ_OK
)

1418 
îr
=
UNZ_ERRNO
;

1420 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uD©a
Ë!
UNZ_OK
)

1421 
îr
=
UNZ_ERRNO
;

1422 i‡((
îr
==
UNZ_OK
Ë&& (
uD©a
!=
s
->
cur_fûe_öfo
.
com¥essi⁄_mëhod
))

1423 
îr
=
UNZ_BADZIPFILE
;

1425 i‡((
îr
==
UNZ_OK
Ë&& (
s
->
cur_fûe_öfo
.
com¥essi⁄_mëhod
!=0) &&

1427 (
s
->
cur_fûe_öfo
.
com¥essi⁄_mëhod
!=
Z_BZIP2ED
) &&

1429 (
s
->
cur_fûe_öfo
.
com¥essi⁄_mëhod
!=
Z_DEFLATED
))

1430 
îr
=
UNZ_BADZIPFILE
;

1432 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uD©a
Ë!
UNZ_OK
)

1433 
îr
=
UNZ_ERRNO
;

1435 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uD©a
Ë!
UNZ_OK
)

1436 
îr
=
UNZ_ERRNO
;

1437 i‡((
îr
==
UNZ_OK
Ë&& (
uD©a
!=
s
->
cur_fûe_öfo
.
¸c
Ë&& ((
uFœgs
 & 8)==0))

1438 
îr
=
UNZ_BADZIPFILE
;

1440 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uD©a
Ë!
UNZ_OK
)

1441 
îr
=
UNZ_ERRNO
;

1442 i‡(
uD©a
 !0xFFFFFFFF && (
îr
==
UNZ_OK
Ë&& (uD©a!=
s
->
cur_fûe_öfo
.
com¥es£d_size
Ë&& ((
uFœgs
 & 8)==0))

1443 
îr
=
UNZ_BADZIPFILE
;

1445 i‡(
	`unz64loˇl_gëL⁄g
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
uD©a
Ë!
UNZ_OK
)

1446 
îr
=
UNZ_ERRNO
;

1447 i‡(
uD©a
 !0xFFFFFFFF && (
îr
==
UNZ_OK
Ë&& (uD©a!=
s
->
cur_fûe_öfo
.
uncom¥es£d_size
Ë&& ((
uFœgs
 & 8)==0))

1448 
îr
=
UNZ_BADZIPFILE
;

1450 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
size_fûíame
Ë!
UNZ_OK
)

1451 
îr
=
UNZ_ERRNO
;

1452 i‡((
îr
==
UNZ_OK
Ë&& (
size_fûíame
!=
s
->
cur_fûe_öfo
.size_filename))

1453 
îr
=
UNZ_BADZIPFILE
;

1455 *
piSizeV¨
 +(
uI¡
)
size_fûíame
;

1457 i‡(
	`unz64loˇl_gëSh‹t
(&
s
->
z_fûefunc
, s->
fûe°ªam
,&
size_exåa_fõld
Ë!
UNZ_OK
)

1458 
îr
=
UNZ_ERRNO
;

1459 *
poff£t_loˇl_exåafõld

s
->
cur_fûe_öfo_öã∫Æ
.
off£t_curfûe
 +

1460 
SIZEZIPLOCALHEADER
 + 
size_fûíame
;

1461 *
psize_loˇl_exåafõld
 = (
uI¡
)
size_exåa_fõld
;

1463 *
piSizeV¨
 +(
uI¡
)
size_exåa_fõld
;

1465  
îr
;

1466 
	}
}

1472 
ZEXPORT
 
	$unzO≥nCuºítFûe3
 (
unzFûe
 
fûe
, * 
mëhod
,

1473 * 
Àvñ
, 
øw
, c⁄° * 
∑ssw‹d
)

1475 
îr
=
UNZ_OK
;

1476 
uI¡
 
iSizeV¨
;

1477 
unz64_s
* 
s
;

1478 
fûe_ö_zù64_ªad_öfo_s
* 
pfûe_ö_zù_ªad_öfo
;

1479 
ZPOS64_T
 
off£t_loˇl_exåafõld
;

1480 
uI¡
 
size_loˇl_exåafõld
;

1481 #i‚de‡
NOUNCRYPT


1482 
sour˚
[12];

1484 i‡(
∑ssw‹d
 !
NULL
)

1485  
UNZ_PARAMERROR
;

1488 i‡(
fûe
==
NULL
)

1489  
UNZ_PARAMERROR
;

1490 
s
=(
unz64_s
*)
fûe
;

1491 i‡(!
s
->
cuºít_fûe_ok
)

1492  
UNZ_PARAMERROR
;

1494 i‡(
s
->
pfûe_ö_zù_ªad
 !
NULL
)

1495 
	`unzClo£CuºítFûe
(
fûe
);

1497 i‡(
	`unz64loˇl_CheckCuºítFûeCohîícyHódî
(
s
,&
iSizeV¨
, &
off£t_loˇl_exåafõld
,&
size_loˇl_exåafõld
)!=
UNZ_OK
)

1498  
UNZ_BADZIPFILE
;

1500 
pfûe_ö_zù_ªad_öfo
 = (
fûe_ö_zù64_ªad_öfo_s
*)
	`ALLOC
((file_in_zip64_read_info_s));

1501 i‡(
pfûe_ö_zù_ªad_öfo
==
NULL
)

1502  
UNZ_INTERNALERROR
;

1504 
pfûe_ö_zù_ªad_öfo
->
ªad_buf„r
=(*)
	`ALLOC
(
UNZ_BUFSIZE
);

1505 
pfûe_ö_zù_ªad_öfo
->
off£t_loˇl_exåafõld
 = offset_local_extrafield;

1506 
pfûe_ö_zù_ªad_öfo
->
size_loˇl_exåafõld
 = size_local_extrafield;

1507 
pfûe_ö_zù_ªad_öfo
->
pos_loˇl_exåafõld
=0;

1508 
pfûe_ö_zù_ªad_öfo
->
øw
=raw;

1510 i‡(
pfûe_ö_zù_ªad_öfo
->
ªad_buf„r
==
NULL
)

1512 
	`TRYFREE
(
pfûe_ö_zù_ªad_öfo
);

1513  
UNZ_INTERNALERROR
;

1516 
pfûe_ö_zù_ªad_öfo
->
°ªam_öôüli£d
=0;

1518 i‡(
mëhod
!=
NULL
)

1519 *
mëhod
 = ()
s
->
cur_fûe_öfo
.
com¥essi⁄_mëhod
;

1521 i‡(
Àvñ
!=
NULL
)

1523 *
Àvñ
 = 6;

1524 
s
->
cur_fûe_öfo
.
Êag
 & 0x06)

1526 6 : *
Àvñ
 = 1; ;

1527 4 : *
Àvñ
 = 2; ;

1528 2 : *
Àvñ
 = 9; ;

1532 i‡((
s
->
cur_fûe_öfo
.
com¥essi⁄_mëhod
!=0) &&

1534 (
s
->
cur_fûe_öfo
.
com¥essi⁄_mëhod
!=
Z_BZIP2ED
) &&

1536 (
s
->
cur_fûe_öfo
.
com¥essi⁄_mëhod
!=
Z_DEFLATED
))

1538 
îr
=
UNZ_BADZIPFILE
;

1540 
pfûe_ö_zù_ªad_öfo
->
¸c32_waô
=
s
->
cur_fûe_öfo
.
¸c
;

1541 
pfûe_ö_zù_ªad_öfo
->
¸c32
=0;

1542 
pfûe_ö_zù_ªad_öfo
->
tŸÆ_out_64
=0;

1543 
pfûe_ö_zù_ªad_öfo
->
com¥essi⁄_mëhod
 = 
s
->
cur_fûe_öfo
.compression_method;

1544 
pfûe_ö_zù_ªad_öfo
->
fûe°ªam
=
s
->filestream;

1545 
pfûe_ö_zù_ªad_öfo
->
z_fûefunc
=
s
->z_filefunc;

1546 
pfûe_ö_zù_ªad_öfo
->
byã_bef‹e_the_zùfûe
=
s
->byte_before_the_zipfile;

1548 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
tŸÆ_out
 = 0;

1550 i‡((
s
->
cur_fûe_öfo
.
com¥essi⁄_mëhod
==
Z_BZIP2ED
Ë&& (!
øw
))

1552 #ifde‡
HAVE_BZIP2


1553 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
bzÆloc
 = (*(*) (*, , ))0;

1554 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
bz‰ì
 = (
‰ì_func
)0;

1555 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
›aque
 = (
voidpf
)0;

1556 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
°©e
 = (
voidpf
)0;

1558 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
zÆloc
 = (
Æloc_func
)0;

1559 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
z‰ì
 = (
‰ì_func
)0;

1560 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
›aque
 = (
voidpf
)0;

1561 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_ö
 = (
voidpf
)0;

1562 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
 = 0;

1564 
îr
=
	`BZ2_bzDecom¥essInô
(&
pfûe_ö_zù_ªad_öfo
->
b°ªam
, 0, 0);

1565 i‡(
îr
 =
Z_OK
)

1566 
pfûe_ö_zù_ªad_öfo
->
°ªam_öôüli£d
=
Z_BZIP2ED
;

1569 
	`TRYFREE
(
pfûe_ö_zù_ªad_öfo
);

1570  
îr
;

1573 
pfûe_ö_zù_ªad_öfo
->
øw
=1;

1576 i‡((
s
->
cur_fûe_öfo
.
com¥essi⁄_mëhod
==
Z_DEFLATED
Ë&& (!
øw
))

1578 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
zÆloc
 = (
Æloc_func
)0;

1579 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
z‰ì
 = (
‰ì_func
)0;

1580 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
›aque
 = (
voidpf
)0;

1581 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_ö
 = 0;

1582 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
 = 0;

1584 
îr
=
	`öÊ©eInô2
(&
pfûe_ö_zù_ªad_öfo
->
°ªam
, -
MAX_WBITS
);

1585 i‡(
îr
 =
Z_OK
)

1586 
pfûe_ö_zù_ªad_öfo
->
°ªam_öôüli£d
=
Z_DEFLATED
;

1589 
	`TRYFREE
(
pfûe_ö_zù_ªad_öfo
);

1590  
îr
;

1600 
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_com¥es£d
 =

1601 
s
->
cur_fûe_öfo
.
com¥es£d_size
 ;

1602 
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_uncom¥es£d
 =

1603 
s
->
cur_fûe_öfo
.
uncom¥es£d_size
 ;

1606 
pfûe_ö_zù_ªad_öfo
->
pos_ö_zùfûe
 =

1607 
s
->
cur_fûe_öfo_öã∫Æ
.
off£t_curfûe
 + 
SIZEZIPLOCALHEADER
 +

1608 
iSizeV¨
;

1610 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
 = (
uI¡
)0;

1612 
s
->
pfûe_ö_zù_ªad
 = 
pfûe_ö_zù_ªad_öfo
;

1613 
s
->
í¸y±ed
 = 0;

1615 #i‚de‡
NOUNCRYPT


1616 i‡(
∑ssw‹d
 !
NULL
)

1618 
i
;

1619 
s
->
p¸c_32_èb
 = 
	`gë_¸c_èbÀ
();

1620 
	`öô_keys
(
∑ssw‹d
,
s
->
keys
,s->
p¸c_32_èb
);

1621 i‡(
	`ZSEEK64
(
s
->
z_fûefunc
, s->
fûe°ªam
,

1622 
s
->
pfûe_ö_zù_ªad
->
pos_ö_zùfûe
 +

1623 
s
->
pfûe_ö_zù_ªad
->
byã_bef‹e_the_zùfûe
,

1624 
SEEK_SET
)!=0)

1625  
UNZ_INTERNALERROR
;

1626 if(
	`ZREAD64
(
s
->
z_fûefunc
, s->
fûe°ªam
,
sour˚
, 12)<12)

1627  
UNZ_INTERNALERROR
;

1629 
i
 = 0; i<12; i++)

1630 
	`zdecode
(
s
->
keys
,s->
p¸c_32_èb
,
sour˚
[
i
]);

1632 
s
->
pfûe_ö_zù_ªad
->
pos_ö_zùfûe
+=12;

1633 
s
->
í¸y±ed
=1;

1638  
UNZ_OK
;

1639 
	}
}

1641 
ZEXPORT
 
	$unzO≥nCuºítFûe
 (
unzFûe
 
fûe
)

1643  
	`unzO≥nCuºítFûe3
(
fûe
, 
NULL
, NULL, 0, NULL);

1644 
	}
}

1646 
ZEXPORT
 
	$unzO≥nCuºítFûePassw‹d
 (
unzFûe
 
fûe
, c⁄° * 
∑ssw‹d
)

1648  
	`unzO≥nCuºítFûe3
(
fûe
, 
NULL
, NULL, 0, 
∑ssw‹d
);

1649 
	}
}

1651 
ZEXPORT
 
	$unzO≥nCuºítFûe2
 (
unzFûe
 
fûe
, * 
mëhod
, * 
Àvñ
, 
øw
)

1653  
	`unzO≥nCuºítFûe3
(
fûe
, 
mëhod
, 
Àvñ
, 
øw
, 
NULL
);

1654 
	}
}

1658 
ZPOS64_T
 
ZEXPORT
 
	$unzGëCuºítFûeZSåómPos64
–
unzFûe
 
fûe
)

1660 
unz64_s
* 
s
;

1661 
fûe_ö_zù64_ªad_öfo_s
* 
pfûe_ö_zù_ªad_öfo
;

1662 
s
=(
unz64_s
*)
fûe
;

1663 i‡(
fûe
==
NULL
)

1665 
pfûe_ö_zù_ªad_öfo
=
s
->
pfûe_ö_zù_ªad
;

1666 i‡(
pfûe_ö_zù_ªad_öfo
==
NULL
)

1668  
pfûe_ö_zù_ªad_öfo
->
pos_ö_zùfûe
 +

1669 
pfûe_ö_zù_ªad_öfo
->
byã_bef‹e_the_zùfûe
;

1670 
	}
}

1684 
ZEXPORT
 
	$unzRódCuºítFûe
 (
unzFûe
 
fûe
, 
voidp
 
buf
, 
Àn
)

1686 
îr
=
UNZ_OK
;

1687 
uI¡
 
iRód
 = 0;

1688 
unz64_s
* 
s
;

1689 
fûe_ö_zù64_ªad_öfo_s
* 
pfûe_ö_zù_ªad_öfo
;

1690 i‡(
fûe
==
NULL
)

1691  
UNZ_PARAMERROR
;

1692 
s
=(
unz64_s
*)
fûe
;

1693 
pfûe_ö_zù_ªad_öfo
=
s
->
pfûe_ö_zù_ªad
;

1695 i‡(
pfûe_ö_zù_ªad_öfo
==
NULL
)

1696  
UNZ_PARAMERROR
;

1699 i‡(
pfûe_ö_zù_ªad_öfo
->
ªad_buf„r
 =
NULL
)

1700  
UNZ_END_OF_LIST_OF_FILE
;

1701 i‡(
Àn
==0)

1704 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_out
 = (
Byãf
*)
buf
;

1706 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_out
 = (
uI¡
)
Àn
;

1708 i‡((
Àn
>
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_uncom¥es£d
) &&

1709 (!(
pfûe_ö_zù_ªad_öfo
->
øw
)))

1710 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_out
 =

1711 (
uI¡
)
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_uncom¥es£d
;

1713 i‡((
Àn
>
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_com¥es£d
+

1714 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
) &&

1715 (
pfûe_ö_zù_ªad_öfo
->
øw
))

1716 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_out
 =

1717 (
uI¡
)
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_com¥es£d
+

1718 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
;

1720 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_out
>0)

1722 i‡((
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
==0) &&

1723 (
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_com¥es£d
>0))

1725 
uI¡
 
uRódThis
 = 
UNZ_BUFSIZE
;

1726 i‡(
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_com¥es£d
<
uRódThis
)

1727 
uRódThis
 = (
uI¡
)
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_com¥es£d
;

1728 i‡(
uRódThis
 == 0)

1729  
UNZ_EOF
;

1730 i‡(
	`ZSEEK64
(
pfûe_ö_zù_ªad_öfo
->
z_fûefunc
,

1731 
pfûe_ö_zù_ªad_öfo
->
fûe°ªam
,

1732 
pfûe_ö_zù_ªad_öfo
->
pos_ö_zùfûe
 +

1733 
pfûe_ö_zù_ªad_öfo
->
byã_bef‹e_the_zùfûe
,

1734 
ZLIB_FILEFUNC_SEEK_SET
)!=0)

1735  
UNZ_ERRNO
;

1736 i‡(
	`ZREAD64
(
pfûe_ö_zù_ªad_öfo
->
z_fûefunc
,

1737 
pfûe_ö_zù_ªad_öfo
->
fûe°ªam
,

1738 
pfûe_ö_zù_ªad_öfo
->
ªad_buf„r
,

1739 
uRódThis
)!=uReadThis)

1740  
UNZ_ERRNO
;

1743 #i‚de‡
NOUNCRYPT


1744 if(
s
->
í¸y±ed
)

1746 
uI¡
 
i
;

1747 
i
=0;i<
uRódThis
;i++)

1748 
pfûe_ö_zù_ªad_öfo
->
ªad_buf„r
[
i
] =

1749 
	`zdecode
(
s
->
keys
,s->
p¸c_32_èb
,

1750 
pfûe_ö_zù_ªad_öfo
->
ªad_buf„r
[
i
]);

1755 
pfûe_ö_zù_ªad_öfo
->
pos_ö_zùfûe
 +
uRódThis
;

1757 
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_com¥es£d
-=
uRódThis
;

1759 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_ö
 =

1760 (
Byãf
*)
pfûe_ö_zù_ªad_öfo
->
ªad_buf„r
;

1761 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
 = (
uI¡
)
uRódThis
;

1764 i‡((
pfûe_ö_zù_ªad_öfo
->
com¥essi⁄_mëhod
==0Ë|| (pfûe_ö_zù_ªad_öfo->
øw
))

1766 
uI¡
 
uDoC›y
,
i
 ;

1768 i‡((
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
 == 0) &&

1769 (
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_com¥es£d
 == 0))

1770  (
iRód
==0Ë? 
UNZ_EOF
 : iRead;

1772 i‡(
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_out
 <

1773 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
)

1774 
uDoC›y
 = 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_out
 ;

1776 
uDoC›y
 = 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
 ;

1778 
i
=0;i<
uDoC›y
;i++)

1779 *(
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_out
+
i
) =

1780 *(
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_ö
+
i
);

1782 
pfûe_ö_zù_ªad_öfo
->
tŸÆ_out_64
 =Öfûe_ö_zù_ªad_öfo->tŸÆ_out_64 + 
uDoC›y
;

1784 
pfûe_ö_zù_ªad_öfo
->
¸c32
 = 
	`¸c32
(pfile_in_zip_read_info->crc32,

1785 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_out
,

1786 
uDoC›y
);

1787 
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_uncom¥es£d
-=
uDoC›y
;

1788 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
 -
uDoC›y
;

1789 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_out
 -
uDoC›y
;

1790 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_out
 +
uDoC›y
;

1791 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_ö
 +
uDoC›y
;

1792 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
tŸÆ_out
 +
uDoC›y
;

1793 
iRód
 +
uDoC›y
;

1795 i‡(
pfûe_ö_zù_ªad_öfo
->
com¥essi⁄_mëhod
==
Z_BZIP2ED
)

1797 #ifde‡
HAVE_BZIP2


1798 
uL⁄g
 
uTŸÆOutBef‹e
,
uTŸÆOutA·î
;

1799 c⁄° 
Byãf
 *
bufBef‹e
;

1800 
uL⁄g
 
uOutThis
;

1802 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
√xt_ö
 = (*Ìfûe_ö_zù_ªad_öfo->
°ªam
.next_in;

1803 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
avaû_ö
 =Öfûe_ö_zù_ªad_öfo->
°ªam
.avail_in;

1804 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
tŸÆ_ö_lo32
 =Öfûe_ö_zù_ªad_öfo->
°ªam
.
tŸÆ_ö
;

1805 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
tŸÆ_ö_hi32
 = 0;

1806 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
√xt_out
 = (*Ìfûe_ö_zù_ªad_öfo->
°ªam
.next_out;

1807 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
avaû_out
 =Öfûe_ö_zù_ªad_öfo->
°ªam
.avail_out;

1808 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
tŸÆ_out_lo32
 =Öfûe_ö_zù_ªad_öfo->
°ªam
.
tŸÆ_out
;

1809 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
tŸÆ_out_hi32
 = 0;

1811 
uTŸÆOutBef‹e
 = 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
tŸÆ_out_lo32
;

1812 
bufBef‹e
 = (c⁄° 
Byãf
 *)
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
√xt_out
;

1814 
îr
=
	`BZ2_bzDecom¥ess
(&
pfûe_ö_zù_ªad_öfo
->
b°ªam
);

1816 
uTŸÆOutA·î
 = 
pfûe_ö_zù_ªad_öfo
->
b°ªam
.
tŸÆ_out_lo32
;

1817 
uOutThis
 = 
uTŸÆOutA·î
-
uTŸÆOutBef‹e
;

1819 
pfûe_ö_zù_ªad_öfo
->
tŸÆ_out_64
 =Öfûe_ö_zù_ªad_öfo->tŸÆ_out_64 + 
uOutThis
;

1821 
pfûe_ö_zù_ªad_öfo
->
¸c32
 = 
	`¸c32
’fûe_ö_zù_ªad_öfo->¸c32,
bufBef‹e
, (
uI¡
)(
uOutThis
));

1822 
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_uncom¥es£d
 -
uOutThis
;

1823 
iRód
 +(
uI¡
)(
uTŸÆOutA·î
 - 
uTŸÆOutBef‹e
);

1825 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_ö
 = (
Byãf
*Ìfûe_ö_zù_ªad_öfo->
b°ªam
.next_in;

1826 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_ö
 =Öfûe_ö_zù_ªad_öfo->
b°ªam
.avail_in;

1827 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
tŸÆ_ö
 =Öfûe_ö_zù_ªad_öfo->
b°ªam
.
tŸÆ_ö_lo32
;

1828 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_out
 = (
Byãf
*Ìfûe_ö_zù_ªad_öfo->
b°ªam
.next_out;

1829 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
avaû_out
 =Öfûe_ö_zù_ªad_öfo->
b°ªam
.avail_out;

1830 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
tŸÆ_out
 =Öfûe_ö_zù_ªad_öfo->
b°ªam
.
tŸÆ_out_lo32
;

1832 i‡(
îr
==
BZ_STREAM_END
)

1833  (
iRód
==0Ë? 
UNZ_EOF
 : iRead;

1834 i‡(
îr
!=
BZ_OK
)

1840 
ZPOS64_T
 
uTŸÆOutBef‹e
,
uTŸÆOutA·î
;

1841 c⁄° 
Byãf
 *
bufBef‹e
;

1842 
ZPOS64_T
 
uOutThis
;

1843 
Êush
=
Z_SYNC_FLUSH
;

1845 
uTŸÆOutBef‹e
 = 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
tŸÆ_out
;

1846 
bufBef‹e
 = 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
√xt_out
;

1854 
îr
=
	`öÊ©e
(&
pfûe_ö_zù_ªad_öfo
->
°ªam
,
Êush
);

1856 i‡((
îr
>=0Ë&& (
pfûe_ö_zù_ªad_öfo
->
°ªam
.
msg
!=
NULL
))

1857 
îr
 = 
Z_DATA_ERROR
;

1859 
uTŸÆOutA·î
 = 
pfûe_ö_zù_ªad_öfo
->
°ªam
.
tŸÆ_out
;

1860 
uOutThis
 = 
uTŸÆOutA·î
-
uTŸÆOutBef‹e
;

1862 
pfûe_ö_zù_ªad_öfo
->
tŸÆ_out_64
 =Öfûe_ö_zù_ªad_öfo->tŸÆ_out_64 + 
uOutThis
;

1864 
pfûe_ö_zù_ªad_öfo
->
¸c32
 =

1865 
	`¸c32
(
pfûe_ö_zù_ªad_öfo
->
¸c32
,
bufBef‹e
,

1866 (
uI¡
)(
uOutThis
));

1868 
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_uncom¥es£d
 -=

1869 
uOutThis
;

1871 
iRód
 +(
uI¡
)(
uTŸÆOutA·î
 - 
uTŸÆOutBef‹e
);

1873 i‡(
îr
==
Z_STREAM_END
)

1874  (
iRód
==0Ë? 
UNZ_EOF
 : iRead;

1875 i‡(
îr
!=
Z_OK
)

1880 i‡(
îr
==
Z_OK
)

1881  
iRód
;

1882  
îr
;

1883 
	}
}

1889 
z_off_t
 
ZEXPORT
 
	$unzãŒ
 (
unzFûe
 
fûe
)

1891 
unz64_s
* 
s
;

1892 
fûe_ö_zù64_ªad_öfo_s
* 
pfûe_ö_zù_ªad_öfo
;

1893 i‡(
fûe
==
NULL
)

1894  
UNZ_PARAMERROR
;

1895 
s
=(
unz64_s
*)
fûe
;

1896 
pfûe_ö_zù_ªad_öfo
=
s
->
pfûe_ö_zù_ªad
;

1898 i‡(
pfûe_ö_zù_ªad_öfo
==
NULL
)

1899  
UNZ_PARAMERROR
;

1901  (
z_off_t
)
pfûe_ö_zù_ªad_öfo
->
°ªam
.
tŸÆ_out
;

1902 
	}
}

1904 
ZPOS64_T
 
ZEXPORT
 
	$unzãŒ64
 (
unzFûe
 
fûe
)

1907 
unz64_s
* 
s
;

1908 
fûe_ö_zù64_ªad_öfo_s
* 
pfûe_ö_zù_ªad_öfo
;

1909 i‡(
fûe
==
NULL
)

1910  (
ZPOS64_T
)-1;

1911 
s
=(
unz64_s
*)
fûe
;

1912 
pfûe_ö_zù_ªad_öfo
=
s
->
pfûe_ö_zù_ªad
;

1914 i‡(
pfûe_ö_zù_ªad_öfo
==
NULL
)

1915  (
ZPOS64_T
)-1;

1917  
pfûe_ö_zù_ªad_öfo
->
tŸÆ_out_64
;

1918 
	}
}

1924 
ZEXPORT
 
	$unzeof
 (
unzFûe
 
fûe
)

1926 
unz64_s
* 
s
;

1927 
fûe_ö_zù64_ªad_öfo_s
* 
pfûe_ö_zù_ªad_öfo
;

1928 i‡(
fûe
==
NULL
)

1929  
UNZ_PARAMERROR
;

1930 
s
=(
unz64_s
*)
fûe
;

1931 
pfûe_ö_zù_ªad_öfo
=
s
->
pfûe_ö_zù_ªad
;

1933 i‡(
pfûe_ö_zù_ªad_öfo
==
NULL
)

1934  
UNZ_PARAMERROR
;

1936 i‡(
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_uncom¥es£d
 == 0)

1940 
	}
}

1956 
ZEXPORT
 
	$unzGëLoˇlExåafõld
 (
unzFûe
 
fûe
, 
voidp
 
buf
, 
Àn
)

1958 
unz64_s
* 
s
;

1959 
fûe_ö_zù64_ªad_öfo_s
* 
pfûe_ö_zù_ªad_öfo
;

1960 
uI¡
 
ªad_now
;

1961 
ZPOS64_T
 
size_to_ªad
;

1963 i‡(
fûe
==
NULL
)

1964  
UNZ_PARAMERROR
;

1965 
s
=(
unz64_s
*)
fûe
;

1966 
pfûe_ö_zù_ªad_öfo
=
s
->
pfûe_ö_zù_ªad
;

1968 i‡(
pfûe_ö_zù_ªad_öfo
==
NULL
)

1969  
UNZ_PARAMERROR
;

1971 
size_to_ªad
 = (
pfûe_ö_zù_ªad_öfo
->
size_loˇl_exåafõld
 -

1972 
pfûe_ö_zù_ªad_öfo
->
pos_loˇl_exåafõld
);

1974 i‡(
buf
==
NULL
)

1975  ()
size_to_ªad
;

1977 i‡(
Àn
>
size_to_ªad
)

1978 
ªad_now
 = (
uI¡
)
size_to_ªad
;

1980 
ªad_now
 = (
uI¡
)
Àn
 ;

1982 i‡(
ªad_now
==0)

1985 i‡(
	`ZSEEK64
(
pfûe_ö_zù_ªad_öfo
->
z_fûefunc
,

1986 
pfûe_ö_zù_ªad_öfo
->
fûe°ªam
,

1987 
pfûe_ö_zù_ªad_öfo
->
off£t_loˇl_exåafõld
 +

1988 
pfûe_ö_zù_ªad_öfo
->
pos_loˇl_exåafõld
,

1989 
ZLIB_FILEFUNC_SEEK_SET
)!=0)

1990  
UNZ_ERRNO
;

1992 i‡(
	`ZREAD64
(
pfûe_ö_zù_ªad_öfo
->
z_fûefunc
,

1993 
pfûe_ö_zù_ªad_öfo
->
fûe°ªam
,

1994 
buf
,
ªad_now
)!=read_now)

1995  
UNZ_ERRNO
;

1997  ()
ªad_now
;

1998 
	}
}

2004 
ZEXPORT
 
	$unzClo£CuºítFûe
 (
unzFûe
 
fûe
)

2006 
îr
=
UNZ_OK
;

2008 
unz64_s
* 
s
;

2009 
fûe_ö_zù64_ªad_öfo_s
* 
pfûe_ö_zù_ªad_öfo
;

2010 i‡(
fûe
==
NULL
)

2011  
UNZ_PARAMERROR
;

2012 
s
=(
unz64_s
*)
fûe
;

2013 
pfûe_ö_zù_ªad_öfo
=
s
->
pfûe_ö_zù_ªad
;

2015 i‡(
pfûe_ö_zù_ªad_öfo
==
NULL
)

2016  
UNZ_PARAMERROR
;

2019 i‡((
pfûe_ö_zù_ªad_öfo
->
ª°_ªad_uncom¥es£d
 == 0) &&

2020 (!
pfûe_ö_zù_ªad_öfo
->
øw
))

2022 i‡(
pfûe_ö_zù_ªad_öfo
->
¸c32
 !pfûe_ö_zù_ªad_öfo->
¸c32_waô
)

2023 
îr
=
UNZ_CRCERROR
;

2027 
	`TRYFREE
(
pfûe_ö_zù_ªad_öfo
->
ªad_buf„r
);

2028 
pfûe_ö_zù_ªad_öfo
->
ªad_buf„r
 = 
NULL
;

2029 i‡(
pfûe_ö_zù_ªad_öfo
->
°ªam_öôüli£d
 =
Z_DEFLATED
)

2030 
	`öÊ©eEnd
(&
pfûe_ö_zù_ªad_öfo
->
°ªam
);

2031 #ifde‡
HAVE_BZIP2


2032 i‡(
pfûe_ö_zù_ªad_öfo
->
°ªam_öôüli£d
 =
Z_BZIP2ED
)

2033 
	`BZ2_bzDecom¥essEnd
(&
pfûe_ö_zù_ªad_öfo
->
b°ªam
);

2037 
pfûe_ö_zù_ªad_öfo
->
°ªam_öôüli£d
 = 0;

2038 
	`TRYFREE
(
pfûe_ö_zù_ªad_öfo
);

2040 
s
->
pfûe_ö_zù_ªad
=
NULL
;

2042  
îr
;

2043 
	}
}

2051 
ZEXPORT
 
	$unzGëGlobÆCommít
 (
unzFûe
 
fûe
, * 
szCommít
, 
uL⁄g
 
uSizeBuf
)

2053 
unz64_s
* 
s
;

2054 
uL⁄g
 
uRódThis
 ;

2055 i‡(
fûe
==
NULL
)

2056  ()
UNZ_PARAMERROR
;

2057 
s
=(
unz64_s
*)
fûe
;

2059 
uRódThis
 = 
uSizeBuf
;

2060 i‡(
uRódThis
>
s
->
gi
.
size_commít
)

2061 
uRódThis
 = 
s
->
gi
.
size_commít
;

2063 i‡(
	`ZSEEK64
(
s
->
z_fûefunc
,s->
fûe°ªam
,s->
˚¡øl_pos
+22,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

2064  
UNZ_ERRNO
;

2066 i‡(
uRódThis
>0)

2068 *
szCommít
='\0';

2069 i‡(
	`ZREAD64
(
s
->
z_fûefunc
,s->
fûe°ªam
,
szCommít
,
uRódThis
)!=uReadThis)

2070  
UNZ_ERRNO
;

2073 i‡((
szCommít
 !
NULL
Ë&& (
uSizeBuf
 > 
s
->
gi
.
size_commít
))

2074 *(
szCommít
+
s
->
gi
.
size_commít
)='\0';

2075  ()
uRódThis
;

2076 
	}
}

2079 
ZPOS64_T
 
ZEXPORT
 
	$unzGëOff£t64
(
unzFûe
 
fûe
)

2081 
unz64_s
* 
s
;

2083 i‡(
fûe
==
NULL
)

2085 
s
=(
unz64_s
*)
fûe
;

2086 i‡(!
s
->
cuºít_fûe_ok
)

2088 i‡(
s
->
gi
.
numbî_íåy
 != 0 && s->gi.number_entry != 0xffff)

2089 i‡(
s
->
num_fûe
==s->
gi
.
numbî_íåy
)

2091  
s
->
pos_ö_˚¡øl_dú
;

2092 
	}
}

2094 
uL⁄g
 
ZEXPORT
 
	$unzGëOff£t
 (
unzFûe
 
fûe
)

2096 
ZPOS64_T
 
off£t64
;

2098 i‡(
fûe
==
NULL
)

2100 
off£t64
 = 
	`unzGëOff£t64
(
fûe
);

2101  (
uL⁄g
)
off£t64
;

2102 
	}
}

2104 
ZEXPORT
 
	$unzSëOff£t64
(
unzFûe
 
fûe
, 
ZPOS64_T
 
pos
)

2106 
unz64_s
* 
s
;

2107 
îr
;

2109 i‡(
fûe
==
NULL
)

2110  
UNZ_PARAMERROR
;

2111 
s
=(
unz64_s
*)
fûe
;

2113 
s
->
pos_ö_˚¡øl_dú
 = 
pos
;

2114 
s
->
num_fûe
 = s->
gi
.
numbî_íåy
;

2115 
îr
 = 
	`unz64loˇl_GëCuºítFûeInfoI¡î«l
(
fûe
,&
s
->
cur_fûe_öfo
,

2116 &
s
->
cur_fûe_öfo_öã∫Æ
,

2117 
NULL
,0,NULL,0,NULL,0);

2118 
s
->
cuºít_fûe_ok
 = (
îr
 =
UNZ_OK
);

2119  
îr
;

2120 
	}
}

2122 
ZEXPORT
 
	$unzSëOff£t
 (
unzFûe
 
fûe
, 
uL⁄g
 
pos
)

2124  
	`unzSëOff£t64
(
fûe
,
pos
);

2125 
	}
}

	@zlib-1.2.8/contrib/minizip/unzip.h

43 #i‚de‡
_unz64_H


44 
	#_unz64_H


	)

46 #ifde‡
__˝lu•lus


50 #i‚de‡
_ZLIB_H


51 
	~"zlib.h
"

54 #i‚de‡ 
_ZLIBIOAPI_H


55 
	~"iﬂpi.h
"

58 #ifde‡
HAVE_BZIP2


59 
	~"bzlib.h
"

62 
	#Z_BZIP2ED
 12

	)

64 #i‡
deföed
(
STRICTUNZIP
Ë|| deföed(
STRICTZIPUNZIP
)

67 
	sTagunzFûe__
 { 
unu£d
; } 
	tunzFûe__
;

68 
unzFûe__
 *
	tunzFûe
;

70 
voidp
 
	tunzFûe
;

74 
	#UNZ_OK
 (0)

	)

75 
	#UNZ_END_OF_LIST_OF_FILE
 (-100)

	)

76 
	#UNZ_ERRNO
 (
Z_ERRNO
)

	)

77 
	#UNZ_EOF
 (0)

	)

78 
	#UNZ_PARAMERROR
 (-102)

	)

79 
	#UNZ_BADZIPFILE
 (-103)

	)

80 
	#UNZ_INTERNALERROR
 (-104)

	)

81 
	#UNZ_CRCERROR
 (-105)

	)

84 
	stm_unz_s


86 
uI¡
 
tm_£c
;

87 
uI¡
 
tm_mö
;

88 
uI¡
 
tm_hour
;

89 
uI¡
 
tm_mday
;

90 
uI¡
 
tm_m⁄
;

91 
uI¡
 
tm_yór
;

92 } 
	ttm_unz
;

96 
	sunz_globÆ_öfo64_s


98 
ZPOS64_T
 
numbî_íåy
;

100 
uL⁄g
 
size_commít
;

101 } 
	tunz_globÆ_öfo64
;

103 
	sunz_globÆ_öfo_s


105 
uL⁄g
 
numbî_íåy
;

107 
uL⁄g
 
size_commít
;

108 } 
	tunz_globÆ_öfo
;

111 
	sunz_fûe_öfo64_s


113 
uL⁄g
 
vîsi⁄
;

114 
uL⁄g
 
vîsi⁄_√eded
;

115 
uL⁄g
 
Êag
;

116 
uL⁄g
 
com¥essi⁄_mëhod
;

117 
uL⁄g
 
dosD©e
;

118 
uL⁄g
 
¸c
;

119 
ZPOS64_T
 
com¥es£d_size
;

120 
ZPOS64_T
 
uncom¥es£d_size
;

121 
uL⁄g
 
size_fûíame
;

122 
uL⁄g
 
size_fûe_exåa
;

123 
uL⁄g
 
size_fûe_commít
;

125 
uL⁄g
 
disk_num_°¨t
;

126 
uL⁄g
 
öã∫Æ_Á
;

127 
uL⁄g
 
exã∫Æ_Á
;

129 
tm_unz
 
tmu_d©e
;

130 } 
	tunz_fûe_öfo64
;

132 
	sunz_fûe_öfo_s


134 
uL⁄g
 
vîsi⁄
;

135 
uL⁄g
 
vîsi⁄_√eded
;

136 
uL⁄g
 
Êag
;

137 
uL⁄g
 
com¥essi⁄_mëhod
;

138 
uL⁄g
 
dosD©e
;

139 
uL⁄g
 
¸c
;

140 
uL⁄g
 
com¥es£d_size
;

141 
uL⁄g
 
uncom¥es£d_size
;

142 
uL⁄g
 
size_fûíame
;

143 
uL⁄g
 
size_fûe_exåa
;

144 
uL⁄g
 
size_fûe_commít
;

146 
uL⁄g
 
disk_num_°¨t
;

147 
uL⁄g
 
öã∫Æ_Á
;

148 
uL⁄g
 
exã∫Æ_Á
;

150 
tm_unz
 
tmu_d©e
;

151 } 
	tunz_fûe_öfo
;

153 
ZEXPORT
 
unzSåögFûeNameCom∑ª
 
OF
 ((c⁄° * 
fûeName1
,

154 c⁄° * 
fûeName2
,

155 
iCa£Sísôivôy
));

166 
unzFûe
 
ZEXPORT
 
unzO≥n
 
OF
((c⁄° *
∑th
));

167 
unzFûe
 
ZEXPORT
 
unzO≥n64
 
OF
((c⁄° *
∑th
));

184 
unzFûe
 
ZEXPORT
 
unzO≥n2
 
OF
((c⁄° *
∑th
,

185 
zlib_fûefunc_def
* 
pzlib_fûefunc_def
));

191 
unzFûe
 
ZEXPORT
 
unzO≥n2_64
 
OF
((c⁄° *
∑th
,

192 
zlib_fûefunc64_def
* 
pzlib_fûefunc_def
));

198 
ZEXPORT
 
unzClo£
 
OF
((
unzFûe
 
fûe
));

205 
ZEXPORT
 
unzGëGlobÆInfo
 
OF
((
unzFûe
 
fûe
,

206 
unz_globÆ_öfo
 *
pglobÆ_öfo
));

208 
ZEXPORT
 
unzGëGlobÆInfo64
 
OF
((
unzFûe
 
fûe
,

209 
unz_globÆ_öfo64
 *
pglobÆ_öfo
));

216 
ZEXPORT
 
unzGëGlobÆCommít
 
OF
((
unzFûe
 
fûe
,

217 *
szCommít
,

218 
uL⁄g
 
uSizeBuf
));

229 
ZEXPORT
 
unzGoToFú°Fûe
 
OF
((
unzFûe
 
fûe
));

235 
ZEXPORT
 
unzGoToNextFûe
 
OF
((
unzFûe
 
fûe
));

242 
ZEXPORT
 
unzLoˇãFûe
 
OF
((
unzFûe
 
fûe
,

243 c⁄° *
szFûeName
,

244 
iCa£Sísôivôy
));

258 
	sunz_fûe_pos_s


260 
uL⁄g
 
	gpos_ö_zù_dúe˘‹y
;

261 
uL⁄g
 
	gnum_of_fûe
;

262 } 
	tunz_fûe_pos
;

264 
ZEXPORT
 
unzGëFûePos
(

265 
unzFûe
 
fûe
,

266 
unz_fûe_pos
* 
fûe_pos
);

268 
ZEXPORT
 
unzGoToFûePos
(

269 
unzFûe
 
fûe
,

270 
unz_fûe_pos
* 
fûe_pos
);

272 
	sunz64_fûe_pos_s


274 
ZPOS64_T
 
	gpos_ö_zù_dúe˘‹y
;

275 
ZPOS64_T
 
	gnum_of_fûe
;

276 } 
	tunz64_fûe_pos
;

278 
ZEXPORT
 
unzGëFûePos64
(

279 
unzFûe
 
fûe
,

280 
unz64_fûe_pos
* 
fûe_pos
);

282 
ZEXPORT
 
unzGoToFûePos64
(

283 
unzFûe
 
fûe
,

284 c⁄° 
unz64_fûe_pos
* 
fûe_pos
);

288 
ZEXPORT
 
unzGëCuºítFûeInfo64
 
OF
((
unzFûe
 
fûe
,

289 
unz_fûe_öfo64
 *
pfûe_öfo
,

290 *
szFûeName
,

291 
uL⁄g
 
fûeNameBuf„rSize
,

292 *
exåaFõld
,

293 
uL⁄g
 
exåaFõldBuf„rSize
,

294 *
szCommít
,

295 
uL⁄g
 
commítBuf„rSize
));

297 
ZEXPORT
 
unzGëCuºítFûeInfo
 
OF
((
unzFûe
 
fûe
,

298 
unz_fûe_öfo
 *
pfûe_öfo
,

299 *
szFûeName
,

300 
uL⁄g
 
fûeNameBuf„rSize
,

301 *
exåaFõld
,

302 
uL⁄g
 
exåaFõldBuf„rSize
,

303 *
szCommít
,

304 
uL⁄g
 
commítBuf„rSize
));

321 
ZPOS64_T
 
ZEXPORT
 
unzGëCuºítFûeZSåómPos64
 
OF
((
unzFûe
 
fûe
));

331 
ZEXPORT
 
unzO≥nCuºítFûe
 
OF
((
unzFûe
 
fûe
));

337 
ZEXPORT
 
unzO≥nCuºítFûePassw‹d
 
OF
((
unzFûe
 
fûe
,

338 c⁄° * 
∑ssw‹d
));

345 
ZEXPORT
 
unzO≥nCuºítFûe2
 
OF
((
unzFûe
 
fûe
,

346 * 
mëhod
,

347 * 
Àvñ
,

348 
øw
));

358 
ZEXPORT
 
unzO≥nCuºítFûe3
 
OF
((
unzFûe
 
fûe
,

359 * 
mëhod
,

360 * 
Àvñ
,

361 
øw
,

362 c⁄° * 
∑ssw‹d
));

373 
ZEXPORT
 
unzClo£CuºítFûe
 
OF
((
unzFûe
 
fûe
));

379 
ZEXPORT
 
unzRódCuºítFûe
 
OF
((
unzFûe
 
fûe
,

380 
voidp
 
buf
,

381 
Àn
));

393 
z_off_t
 
ZEXPORT
 
unzãŒ
 
OF
((
unzFûe
 
fûe
));

395 
ZPOS64_T
 
ZEXPORT
 
unzãŒ64
 
OF
((
unzFûe
 
fûe
));

400 
ZEXPORT
 
unzeof
 
OF
((
unzFûe
 
fûe
));

405 
ZEXPORT
 
unzGëLoˇlExåafõld
 
OF
((
unzFûe
 
fûe
,

406 
voidp
 
buf
,

407 
Àn
));

424 
ZPOS64_T
 
ZEXPORT
 
unzGëOff£t64
 (
unzFûe
 
fûe
);

425 
uL⁄g
 
ZEXPORT
 
unzGëOff£t
 (
unzFûe
 
fûe
);

428 
ZEXPORT
 
unzSëOff£t64
 (
unzFûe
 
fûe
, 
ZPOS64_T
 
pos
);

429 
ZEXPORT
 
unzSëOff£t
 (
unzFûe
 
fûe
, 
uL⁄g
 
pos
);

433 #ifde‡
__˝lu•lus


	@zlib-1.2.8/contrib/minizip/zip.c

25 
	~<°dio.h
>

26 
	~<°dlib.h
>

27 
	~<°rög.h
>

28 
	~<time.h
>

29 
	~"zlib.h
"

30 
	~"zù.h
"

32 #ifde‡
STDC


33 
	~<°ddef.h
>

34 
	~<°rög.h
>

35 
	~<°dlib.h
>

37 #ifde‡
NO_ERRNO_H


38 
î∫o
;

40 
	~<î∫o.h
>

44 #i‚de‡
loˇl


45 
	#loˇl
 

	)

49 #i‚de‡
VERSIONMADEBY


50 
	#VERSIONMADEBY
 (0x0Ë

	)

53 #i‚de‡
Z_BUFSIZE


54 
	#Z_BUFSIZE
 (64*1024)

56 

	)

57 #i‚de‡
Z_MAXFILENAMEINZIP


58 
	#Z_MAXFILENAMEINZIP
 (256)

	)

61 #i‚de‡
ALLOC


62 
	#ALLOC
(
size
Ë(
	`mÆloc
(size))

	)

64 #i‚de‡
TRYFREE


65 
	#TRYFREE
(
p
Ë{i‡’Ë
	`‰ì
’);}

	)

77 
	#MAKEULONG64
(
a
, 
b
Ë((
ZPOS64_T
)((()◊)Ë| ((ZPOS64_T)(()(b))Ë<< 32))

	)

79 #i‚de‡
SEEK_CUR


80 
	#SEEK_CUR
 1

	)

83 #i‚de‡
SEEK_END


84 
	#SEEK_END
 2

	)

87 #i‚de‡
SEEK_SET


88 
	#SEEK_SET
 0

	)

91 #i‚de‡
DEF_MEM_LEVEL


92 #i‡
MAX_MEM_LEVEL
 >= 8

93 
	#DEF_MEM_LEVEL
 8

	)

95 
	#DEF_MEM_LEVEL
 
MAX_MEM_LEVEL


	)

98 c⁄° 
	gzù_c›yright
[] =" zip 1.01 Copyright 1998-2004 Gilles Vollant - http://www.winimage.com/zLibDll";

101 
	#SIZEDATA_INDATABLOCK
 (4096-(4*4))

	)

103 
	#LOCALHEADERMAGIC
 (0x04034b50)

	)

104 
	#CENTRALHEADERMAGIC
 (0x02014b50)

	)

105 
	#ENDHEADERMAGIC
 (0x06054b50)

	)

106 
	#ZIP64ENDHEADERMAGIC
 (0x6064b50)

	)

107 
	#ZIP64ENDLOCHEADERMAGIC
 (0x7064b50)

	)

109 
	#FLAG_LOCALHEADER_OFFSET
 (0x06)

	)

110 
	#CRC_LOCALHEADER_OFFSET
 (0x0e)

	)

112 
	#SIZECENTRALHEADER
 (0x2eË

	)

114 
	slökedli°_d©ablock_öã∫Æ_s


116 
lökedli°_d©ablock_öã∫Æ_s
* 
	m√xt_d©ablock
;

117 
uL⁄g
 
	mavaû_ö_this_block
;

118 
uL⁄g
 
	mfûÀd_ö_this_block
;

119 
uL⁄g
 
	munu£d
;

120 
	md©a
[
SIZEDATA_INDATABLOCK
];

121 } 
	tlökedli°_d©ablock_öã∫Æ
;

123 
	slökedli°_d©a_s


125 
lökedli°_d©ablock_öã∫Æ
* 
	mfú°_block
;

126 
lökedli°_d©ablock_öã∫Æ
* 
	mœ°_block
;

127 } 
	tlökedli°_d©a
;

132 
z_°ªam
 
	m°ªam
;

133 #ifde‡
HAVE_BZIP2


134 
bz_°ªam
 
	mb°ªam
;

137 
	m°ªam_öôüli£d
;

138 
uI¡
 
	mpos_ö_buf„ªd_d©a
;

140 
ZPOS64_T
 
	mpos_loˇl_hódî
;

142 * 
	m˚¡øl_hódî
;

143 
uL⁄g
 
	msize_˚¡ølExåa
;

144 
uL⁄g
 
	msize_˚¡ølhódî
;

145 
uL⁄g
 
	msize_˚¡ølExåaFªe
;

146 
uL⁄g
 
	mÊag
;

148 
	mmëhod
;

149 
	møw
;

150 
Byã
 
	mbuf„ªd_d©a
[
Z_BUFSIZE
];

151 
uL⁄g
 
	mdosD©e
;

152 
uL⁄g
 
	m¸c32
;

153 
	mí¸y±
;

154 
	mzù64
;

155 
ZPOS64_T
 
	mpos_zù64exåaöfo
;

156 
ZPOS64_T
 
	mtŸÆCom¥es£dD©a
;

157 
ZPOS64_T
 
	mtŸÆUncom¥es£dD©a
;

158 #i‚de‡
NOCRYPT


159 
	mkeys
[3];

160 c⁄° 
z_¸c_t
* 
	mp¸c_32_èb
;

161 
	m¸y±_hódî_size
;

163 } 
	tcurfûe64_öfo
;

167 
zlib_fûefunc64_32_def
 
	mz_fûefunc
;

168 
voidpf
 
	mfûe°ªam
;

169 
lökedli°_d©a
 
	m˚¡øl_dú
;

170 
	mö_›íed_fûe_özù
;

171 
curfûe64_öfo
 
	mci
;

173 
ZPOS64_T
 
	mbegö_pos
;

174 
ZPOS64_T
 
	madd_posôi⁄_whí_wrôtög_off£t
;

175 
ZPOS64_T
 
	mnumbî_íåy
;

177 #i‚de‡
NO_ADDFILEINEXISTINGZIP


178 *
	mglobÆcommít
;

181 } 
	tzù64_öã∫Æ
;

184 #i‚de‡
NOCRYPT


185 
	#INCLUDECRYPTINGCODE_IFCRYPTALLOWED


	)

186 
	~"¸y±.h
"

189 
loˇl
 
lökedli°_d©ablock_öã∫Æ
* 
	$Æloˇã_√w_d©ablock
()

191 
lökedli°_d©ablock_öã∫Æ
* 
ldi
;

192 
ldi
 = (
lökedli°_d©ablock_öã∫Æ
*)

193 
	`ALLOC
((
lökedli°_d©ablock_öã∫Æ
));

194 i‡(
ldi
!=
NULL
)

196 
ldi
->
√xt_d©ablock
 = 
NULL
 ;

197 
ldi
->
fûÀd_ö_this_block
 = 0 ;

198 
ldi
->
avaû_ö_this_block
 = 
SIZEDATA_INDATABLOCK
 ;

200  
ldi
;

201 
	}
}

203 
loˇl
 
	$‰ì_d©ablock
(
lökedli°_d©ablock_öã∫Æ
* 
ldi
)

205 
ldi
!=
NULL
)

207 
lökedli°_d©ablock_öã∫Æ
* 
ldöext
 = 
ldi
->
√xt_d©ablock
;

208 
	`TRYFREE
(
ldi
);

209 
ldi
 = 
ldöext
;

211 
	}
}

213 
loˇl
 
	$öô_lökedli°
(
lökedli°_d©a
* 
Œ
)

215 
Œ
->
fú°_block
 =Ül->
œ°_block
 = 
NULL
;

216 
	}
}

218 
loˇl
 
	$‰ì_lökedli°
(
lökedli°_d©a
* 
Œ
)

220 
	`‰ì_d©ablock
(
Œ
->
fú°_block
);

221 
Œ
->
fú°_block
 =Ül->
œ°_block
 = 
NULL
;

222 
	}
}

225 
loˇl
 
	$add_d©a_ö_d©ablock
(
lökedli°_d©a
* 
Œ
, c⁄° * 
buf
, 
uL⁄g
 
Àn
)

227 
lökedli°_d©ablock_öã∫Æ
* 
ldi
;

228 c⁄° * 
‰om_c›y
;

230 i‡(
Œ
==
NULL
)

231  
ZIP_INTERNALERROR
;

233 i‡(
Œ
->
œ°_block
 =
NULL
)

235 
Œ
->
fú°_block
 =Ül->
œ°_block
 = 
	`Æloˇã_√w_d©ablock
();

236 i‡(
Œ
->
fú°_block
 =
NULL
)

237  
ZIP_INTERNALERROR
;

240 
ldi
 = 
Œ
->
œ°_block
;

241 
‰om_c›y
 = (*)
buf
;

243 
Àn
>0)

245 
uI¡
 
c›y_this
;

246 
uI¡
 
i
;

247 * 
to_c›y
;

249 i‡(
ldi
->
avaû_ö_this_block
==0)

251 
ldi
->
√xt_d©ablock
 = 
	`Æloˇã_√w_d©ablock
();

252 i‡(
ldi
->
√xt_d©ablock
 =
NULL
)

253  
ZIP_INTERNALERROR
;

254 
ldi
 =Üdi->
√xt_d©ablock
 ;

255 
Œ
->
œ°_block
 = 
ldi
;

258 i‡(
ldi
->
avaû_ö_this_block
 < 
Àn
)

259 
c›y_this
 = (
uI¡
)
ldi
->
avaû_ö_this_block
;

261 
c›y_this
 = (
uI¡
)
Àn
;

263 
to_c›y
 = &(
ldi
->
d©a
[ldi->
fûÀd_ö_this_block
]);

265 
i
=0;i<
c›y_this
;i++)

266 *(
to_c›y
+
i
)=*(
‰om_c›y
+i);

268 
ldi
->
fûÀd_ö_this_block
 +
c›y_this
;

269 
ldi
->
avaû_ö_this_block
 -
c›y_this
;

270 
‰om_c›y
 +
c›y_this
 ;

271 
Àn
 -
c›y_this
;

273  
ZIP_OK
;

274 
	}
}

280 #i‚de‡
NO_ADDFILEINEXISTINGZIP


286 
loˇl
 
zù64loˇl_putVÆue
 
OF
((c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
, 
voidpf
 
fûe°ªam
, 
ZPOS64_T
 
x
, 
nbByã
));

287 
loˇl
 
	$zù64loˇl_putVÆue
 (c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
, 
voidpf
 
fûe°ªam
, 
ZPOS64_T
 
x
, 
nbByã
)

289 
buf
[8];

290 
n
;

291 
n
 = 0;Ç < 
nbByã
;Ç++)

293 
buf
[
n
] = ()(
x
 & 0xff);

294 
x
 >>= 8;

296 i‡(
x
 != 0)

298 
n
 = 0;Ç < 
nbByã
;Ç++)

300 
buf
[
n
] = 0xff;

304 i‡(
	`ZWRITE64
(*
pzlib_fûefunc_def
,
fûe°ªam
,
buf
,
nbByã
)!=(
uL⁄g
)nbByte)

305  
ZIP_ERRNO
;

307  
ZIP_OK
;

308 
	}
}

310 
loˇl
 
zù64loˇl_putVÆue_ömem‹y
 
OF
((* 
de°
, 
ZPOS64_T
 
x
, 
nbByã
));

311 
loˇl
 
	$zù64loˇl_putVÆue_ömem‹y
 (* 
de°
, 
ZPOS64_T
 
x
, 
nbByã
)

313 * 
buf
=(*)
de°
;

314 
n
;

315 
n
 = 0;Ç < 
nbByã
;Ç++) {

316 
buf
[
n
] = ()(
x
 & 0xff);

317 
x
 >>= 8;

320 i‡(
x
 != 0)

322 
n
 = 0;Ç < 
nbByã
;Ç++)

324 
buf
[
n
] = 0xff;

327 
	}
}

332 
loˇl
 
uL⁄g
 
	$zù64loˇl_TmzD©eToDosD©e
(c⁄° 
tm_zù
* 
±m
)

334 
uL⁄g
 
yór
 = (uL⁄g)
±m
->
tm_yór
;

335 i‡(
yór
>=1980)

336 
yór
-=1980;

337 i‡(
yór
>=80)

338 
yór
-=80;

340 (
uL⁄g
Ë(((
±m
->
tm_mday
Ë+ (32 * (±m->
tm_m⁄
+1)Ë+ (512 * 
yór
)) << 16) |

341 ((
±m
->
tm_£c
/2Ë+ (32*Ötm->
tm_mö
Ë+ (2048 * (
uL⁄g
Ìtm->
tm_hour
));

342 
	}
}

347 
loˇl
 
zù64loˇl_gëByã
 
OF
((c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
, 
voidpf
 
fûe°ªam
, *
pi
));

349 
loˇl
 
	$zù64loˇl_gëByã
(c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
,
voidpf
 
fûe°ªam
,* 
pi
)

351 
c
;

352 
îr
 = ()
	`ZREAD64
(*
pzlib_fûefunc_def
,
fûe°ªam
,&
c
,1);

353 i‡(
îr
==1)

355 *
pi
 = ()
c
;

356  
ZIP_OK
;

360 i‡(
	`ZERROR64
(*
pzlib_fûefunc_def
,
fûe°ªam
))

361  
ZIP_ERRNO
;

363  
ZIP_EOF
;

365 
	}
}

371 
loˇl
 
zù64loˇl_gëSh‹t
 
OF
((c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
, 
voidpf
 
fûe°ªam
, 
uL⁄g
 *
pX
));

373 
loˇl
 
	$zù64loˇl_gëSh‹t
 (c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
, 
voidpf
 
fûe°ªam
, 
uL⁄g
* 
pX
)

375 
uL⁄g
 
x
 ;

376 
i
 = 0;

377 
îr
;

379 
îr
 = 
	`zù64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

380 
x
 = (
uL⁄g
)
i
;

382 i‡(
îr
==
ZIP_OK
)

383 
îr
 = 
	`zù64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

384 
x
 +((
uL⁄g
)
i
)<<8;

386 i‡(
îr
==
ZIP_OK
)

387 *
pX
 = 
x
;

389 *
pX
 = 0;

390  
îr
;

391 
	}
}

393 
loˇl
 
zù64loˇl_gëL⁄g
 
OF
((c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
, 
voidpf
 
fûe°ªam
, 
uL⁄g
 *
pX
));

395 
loˇl
 
	$zù64loˇl_gëL⁄g
 (c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
, 
voidpf
 
fûe°ªam
, 
uL⁄g
* 
pX
)

397 
uL⁄g
 
x
 ;

398 
i
 = 0;

399 
îr
;

401 
îr
 = 
	`zù64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

402 
x
 = (
uL⁄g
)
i
;

404 i‡(
îr
==
ZIP_OK
)

405 
îr
 = 
	`zù64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

406 
x
 +((
uL⁄g
)
i
)<<8;

408 i‡(
îr
==
ZIP_OK
)

409 
îr
 = 
	`zù64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

410 
x
 +((
uL⁄g
)
i
)<<16;

412 i‡(
îr
==
ZIP_OK
)

413 
îr
 = 
	`zù64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

414 
x
 +((
uL⁄g
)
i
)<<24;

416 i‡(
îr
==
ZIP_OK
)

417 *
pX
 = 
x
;

419 *
pX
 = 0;

420  
îr
;

421 
	}
}

423 
loˇl
 
zù64loˇl_gëL⁄g64
 
OF
((c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
, 
voidpf
 
fûe°ªam
, 
ZPOS64_T
 *
pX
));

426 
loˇl
 
	$zù64loˇl_gëL⁄g64
 (c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
, 
voidpf
 
fûe°ªam
, 
ZPOS64_T
 *
pX
)

428 
ZPOS64_T
 
x
;

429 
i
 = 0;

430 
îr
;

432 
îr
 = 
	`zù64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

433 
x
 = (
ZPOS64_T
)
i
;

435 i‡(
îr
==
ZIP_OK
)

436 
îr
 = 
	`zù64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

437 
x
 +((
ZPOS64_T
)
i
)<<8;

439 i‡(
îr
==
ZIP_OK
)

440 
îr
 = 
	`zù64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

441 
x
 +((
ZPOS64_T
)
i
)<<16;

443 i‡(
îr
==
ZIP_OK
)

444 
îr
 = 
	`zù64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

445 
x
 +((
ZPOS64_T
)
i
)<<24;

447 i‡(
îr
==
ZIP_OK
)

448 
îr
 = 
	`zù64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

449 
x
 +((
ZPOS64_T
)
i
)<<32;

451 i‡(
îr
==
ZIP_OK
)

452 
îr
 = 
	`zù64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

453 
x
 +((
ZPOS64_T
)
i
)<<40;

455 i‡(
îr
==
ZIP_OK
)

456 
îr
 = 
	`zù64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

457 
x
 +((
ZPOS64_T
)
i
)<<48;

459 i‡(
îr
==
ZIP_OK
)

460 
îr
 = 
	`zù64loˇl_gëByã
(
pzlib_fûefunc_def
,
fûe°ªam
,&
i
);

461 
x
 +((
ZPOS64_T
)
i
)<<56;

463 i‡(
îr
==
ZIP_OK
)

464 *
pX
 = 
x
;

466 *
pX
 = 0;

468  
îr
;

469 
	}
}

471 #i‚de‡
BUFREADCOMMENT


472 
	#BUFREADCOMMENT
 (0x400)

	)

478 
loˇl
 
ZPOS64_T
 
zù64loˇl_SórchCíåÆDú
 
OF
((c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
, 
voidpf
 
fûe°ªam
));

480 
loˇl
 
ZPOS64_T
 
	$zù64loˇl_SórchCíåÆDú
(c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
, 
voidpf
 
fûe°ªam
)

482 * 
buf
;

483 
ZPOS64_T
 
uSizeFûe
;

484 
ZPOS64_T
 
uBackRód
;

485 
ZPOS64_T
 
uMaxBack
=0xffff;

486 
ZPOS64_T
 
uPosFound
=0;

488 i‡(
	`ZSEEK64
(*
pzlib_fûefunc_def
,
fûe°ªam
,0,
ZLIB_FILEFUNC_SEEK_END
) != 0)

492 
uSizeFûe
 = 
	`ZTELL64
(*
pzlib_fûefunc_def
,
fûe°ªam
);

494 i‡(
uMaxBack
>
uSizeFûe
)

495 
uMaxBack
 = 
uSizeFûe
;

497 
buf
 = (*)
	`ALLOC
(
BUFREADCOMMENT
+4);

498 i‡(
buf
==
NULL
)

501 
uBackRód
 = 4;

502 
uBackRód
<
uMaxBack
)

504 
uL⁄g
 
uRódSize
;

505 
ZPOS64_T
 
uRódPos
 ;

506 
i
;

507 i‡(
uBackRód
+
BUFREADCOMMENT
>
uMaxBack
)

508 
uBackRód
 = 
uMaxBack
;

510 
uBackRód
+=
BUFREADCOMMENT
;

511 
uRódPos
 = 
uSizeFûe
-
uBackRód
 ;

513 
uRódSize
 = ((
BUFREADCOMMENT
+4Ë< (
uSizeFûe
-
uRódPos
)) ?

514 (
BUFREADCOMMENT
+4Ë: (
uL⁄g
)(
uSizeFûe
-
uRódPos
);

515 i‡(
	`ZSEEK64
(*
pzlib_fûefunc_def
,
fûe°ªam
,
uRódPos
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

518 i‡(
	`ZREAD64
(*
pzlib_fûefunc_def
,
fûe°ªam
,
buf
,
uRódSize
)!=uReadSize)

521 
i
=()
uRódSize
-3; (i--)>0;)

522 i‡(((*(
buf
+
i
))==0x50) && ((*(buf+i+1))==0x4b) &&

523 ((*(
buf
+
i
+2))==0x05) && ((*(buf+i+3))==0x06))

525 
uPosFound
 = 
uRódPos
+
i
;

529 i‡(
uPosFound
!=0)

532 
	`TRYFREE
(
buf
);

533  
uPosFound
;

534 
	}
}

540 
loˇl
 
ZPOS64_T
 
zù64loˇl_SórchCíåÆDú64
 
OF
((c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
, 
voidpf
 
fûe°ªam
));

542 
loˇl
 
ZPOS64_T
 
	$zù64loˇl_SórchCíåÆDú64
(c⁄° 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc_def
, 
voidpf
 
fûe°ªam
)

544 * 
buf
;

545 
ZPOS64_T
 
uSizeFûe
;

546 
ZPOS64_T
 
uBackRód
;

547 
ZPOS64_T
 
uMaxBack
=0xffff;

548 
ZPOS64_T
 
uPosFound
=0;

549 
uL⁄g
 
uL
;

550 
ZPOS64_T
 
ªœtiveOff£t
;

552 i‡(
	`ZSEEK64
(*
pzlib_fûefunc_def
,
fûe°ªam
,0,
ZLIB_FILEFUNC_SEEK_END
) != 0)

555 
uSizeFûe
 = 
	`ZTELL64
(*
pzlib_fûefunc_def
,
fûe°ªam
);

557 i‡(
uMaxBack
>
uSizeFûe
)

558 
uMaxBack
 = 
uSizeFûe
;

560 
buf
 = (*)
	`ALLOC
(
BUFREADCOMMENT
+4);

561 i‡(
buf
==
NULL
)

564 
uBackRód
 = 4;

565 
uBackRód
<
uMaxBack
)

567 
uL⁄g
 
uRódSize
;

568 
ZPOS64_T
 
uRódPos
;

569 
i
;

570 i‡(
uBackRód
+
BUFREADCOMMENT
>
uMaxBack
)

571 
uBackRód
 = 
uMaxBack
;

573 
uBackRód
+=
BUFREADCOMMENT
;

574 
uRódPos
 = 
uSizeFûe
-
uBackRód
 ;

576 
uRódSize
 = ((
BUFREADCOMMENT
+4Ë< (
uSizeFûe
-
uRódPos
)) ?

577 (
BUFREADCOMMENT
+4Ë: (
uL⁄g
)(
uSizeFûe
-
uRódPos
);

578 i‡(
	`ZSEEK64
(*
pzlib_fûefunc_def
,
fûe°ªam
,
uRódPos
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

581 i‡(
	`ZREAD64
(*
pzlib_fûefunc_def
,
fûe°ªam
,
buf
,
uRódSize
)!=uReadSize)

584 
i
=()
uRódSize
-3; (i--)>0;)

587 i‡(((*(
buf
+
i
))==0x50) && ((*(buf+i+1))==0x4b) && ((*(buf+i+2))==0x06) && ((*(buf+i+3))==0x07))

589 
uPosFound
 = 
uRódPos
+
i
;

594 i‡(
uPosFound
!=0)

598 
	`TRYFREE
(
buf
);

599 i‡(
uPosFound
 == 0)

603 i‡(
	`ZSEEK64
(*
pzlib_fûefunc_def
,
fûe°ªam
, 
uPosFound
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

607 i‡(
	`zù64loˇl_gëL⁄g
(
pzlib_fûefunc_def
,
fûe°ªam
,&
uL
)!=
ZIP_OK
)

611 i‡(
	`zù64loˇl_gëL⁄g
(
pzlib_fûefunc_def
,
fûe°ªam
,&
uL
)!=
ZIP_OK
)

613 i‡(
uL
 != 0)

617 i‡(
	`zù64loˇl_gëL⁄g64
(
pzlib_fûefunc_def
,
fûe°ªam
,&
ªœtiveOff£t
)!=
ZIP_OK
)

621 i‡(
	`zù64loˇl_gëL⁄g
(
pzlib_fûefunc_def
,
fûe°ªam
,&
uL
)!=
ZIP_OK
)

623 i‡(
uL
 != 1)

627 i‡(
	`ZSEEK64
(*
pzlib_fûefunc_def
,
fûe°ªam
, 
ªœtiveOff£t
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

631 i‡(
	`zù64loˇl_gëL⁄g
(
pzlib_fûefunc_def
,
fûe°ªam
,&
uL
)!=
ZIP_OK
)

634 i‡(
uL
 != 0x06064b50)

637  
ªœtiveOff£t
;

638 
	}
}

640 
	$LﬂdCíåÆDúe˘‹yRec‹d
(
zù64_öã∫Æ
* 
pziöô
)

642 
îr
=
ZIP_OK
;

643 
ZPOS64_T
 
byã_bef‹e_the_zùfûe
;

645 
ZPOS64_T
 
size_˚¡øl_dú
;

646 
ZPOS64_T
 
off£t_˚¡øl_dú
;

647 
ZPOS64_T
 
˚¡øl_pos
;

648 
uL⁄g
 
uL
;

650 
uL⁄g
 
numbî_disk
;

652 
uL⁄g
 
numbî_disk_wôh_CD
;

654 
ZPOS64_T
 
numbî_íåy
;

655 
ZPOS64_T
 
numbî_íåy_CD
;

658 
uL⁄g
 
Vîsi⁄MadeBy
;

659 
uL⁄g
 
Vîsi⁄Nìded
;

660 
uL⁄g
 
size_commít
;

662 
hasZIP64Rec‹d
 = 0;

665 
˚¡øl_pos
 = 
	`zù64loˇl_SórchCíåÆDú64
(&
pziöô
->
z_fûefunc
,pziöô->
fûe°ªam
);

666 if(
˚¡øl_pos
 > 0)

668 
hasZIP64Rec‹d
 = 1;

670 if(
˚¡øl_pos
 == 0)

672 
˚¡øl_pos
 = 
	`zù64loˇl_SórchCíåÆDú
(&
pziöô
->
z_fûefunc
,pziöô->
fûe°ªam
);

680 if(
hasZIP64Rec‹d
)

682 
ZPOS64_T
 
sizeEndOfCíåÆDúe˘‹y
;

683 i‡(
	`ZSEEK64
(
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
, 
˚¡øl_pos
, 
ZLIB_FILEFUNC_SEEK_SET
) != 0)

684 
îr
=
ZIP_ERRNO
;

687 i‡(
	`zù64loˇl_gëL⁄g
(&
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
,&
uL
)!=
ZIP_OK
)

688 
îr
=
ZIP_ERRNO
;

691 i‡(
	`zù64loˇl_gëL⁄g64
(&
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
, &
sizeEndOfCíåÆDúe˘‹y
)!=
ZIP_OK
)

692 
îr
=
ZIP_ERRNO
;

695 i‡(
	`zù64loˇl_gëSh‹t
(&
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
, &
Vîsi⁄MadeBy
)!=
ZIP_OK
)

696 
îr
=
ZIP_ERRNO
;

699 i‡(
	`zù64loˇl_gëSh‹t
(&
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
, &
Vîsi⁄Nìded
)!=
ZIP_OK
)

700 
îr
=
ZIP_ERRNO
;

703 i‡(
	`zù64loˇl_gëL⁄g
(&
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
,&
numbî_disk
)!=
ZIP_OK
)

704 
îr
=
ZIP_ERRNO
;

707 i‡(
	`zù64loˇl_gëL⁄g
(&
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
,&
numbî_disk_wôh_CD
)!=
ZIP_OK
)

708 
îr
=
ZIP_ERRNO
;

711 i‡(
	`zù64loˇl_gëL⁄g64
(&
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
, &
numbî_íåy
)!=
ZIP_OK
)

712 
îr
=
ZIP_ERRNO
;

715 i‡(
	`zù64loˇl_gëL⁄g64
(&
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
,&
numbî_íåy_CD
)!=
ZIP_OK
)

716 
îr
=
ZIP_ERRNO
;

718 i‡((
numbî_íåy_CD
!=
numbî_íåy
Ë|| (
numbî_disk_wôh_CD
!=0Ë|| (
numbî_disk
!=0))

719 
îr
=
ZIP_BADZIPFILE
;

722 i‡(
	`zù64loˇl_gëL⁄g64
(&
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
,&
size_˚¡øl_dú
)!=
ZIP_OK
)

723 
îr
=
ZIP_ERRNO
;

727 i‡(
	`zù64loˇl_gëL⁄g64
(&
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
,&
off£t_˚¡øl_dú
)!=
ZIP_OK
)

728 
îr
=
ZIP_ERRNO
;

732 
size_commít
 = 0;

737 i‡(
	`ZSEEK64
(
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
, 
˚¡øl_pos
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

738 
îr
=
ZIP_ERRNO
;

741 i‡(
	`zù64loˇl_gëL⁄g
(&
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
,&
uL
)!=
ZIP_OK
)

742 
îr
=
ZIP_ERRNO
;

745 i‡(
	`zù64loˇl_gëSh‹t
(&
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
,&
numbî_disk
)!=
ZIP_OK
)

746 
îr
=
ZIP_ERRNO
;

749 i‡(
	`zù64loˇl_gëSh‹t
(&
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
,&
numbî_disk_wôh_CD
)!=
ZIP_OK
)

750 
îr
=
ZIP_ERRNO
;

753 
numbî_íåy
 = 0;

754 i‡(
	`zù64loˇl_gëSh‹t
(&
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
, &
uL
)!=
ZIP_OK
)

755 
îr
=
ZIP_ERRNO
;

757 
numbî_íåy
 = 
uL
;

760 
numbî_íåy_CD
 = 0;

761 i‡(
	`zù64loˇl_gëSh‹t
(&
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
, &
uL
)!=
ZIP_OK
)

762 
îr
=
ZIP_ERRNO
;

764 
numbî_íåy_CD
 = 
uL
;

766 i‡((
numbî_íåy_CD
!=
numbî_íåy
Ë|| (
numbî_disk_wôh_CD
!=0Ë|| (
numbî_disk
!=0))

767 
îr
=
ZIP_BADZIPFILE
;

770 
size_˚¡øl_dú
 = 0;

771 i‡(
	`zù64loˇl_gëL⁄g
(&
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
, &
uL
)!=
ZIP_OK
)

772 
îr
=
ZIP_ERRNO
;

774 
size_˚¡øl_dú
 = 
uL
;

777 
off£t_˚¡øl_dú
 = 0;

778 i‡(
	`zù64loˇl_gëL⁄g
(&
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
, &
uL
)!=
ZIP_OK
)

779 
îr
=
ZIP_ERRNO
;

781 
off£t_˚¡øl_dú
 = 
uL
;

785 i‡(
	`zù64loˇl_gëSh‹t
(&
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
, &
size_commít
)!=
ZIP_OK
)

786 
îr
=
ZIP_ERRNO
;

789 i‡((
˚¡øl_pos
<
off£t_˚¡øl_dú
+
size_˚¡øl_dú
) &&

790 (
îr
==
ZIP_OK
))

791 
îr
=
ZIP_BADZIPFILE
;

793 i‡(
îr
!=
ZIP_OK
)

795 
	`ZCLOSE64
(
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
);

796  
ZIP_ERRNO
;

799 i‡(
size_commít
>0)

801 
pziöô
->
globÆcommít
 = (*)
	`ALLOC
(
size_commít
+1);

802 i‡(
pziöô
->
globÆcommít
)

804 
size_commít
 = 
	`ZREAD64
(
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
,Öziöô->
globÆcommít
,size_comment);

805 
pziöô
->
globÆcommít
[
size_commít
]=0;

809 
byã_bef‹e_the_zùfûe
 = 
˚¡øl_pos
 - (
off£t_˚¡øl_dú
+
size_˚¡øl_dú
);

810 
pziöô
->
add_posôi⁄_whí_wrôtög_off£t
 = 
byã_bef‹e_the_zùfûe
;

813 
ZPOS64_T
 
size_˚¡øl_dú_to_ªad
 = 
size_˚¡øl_dú
;

814 
size_t
 
buf_size
 = 
SIZEDATA_INDATABLOCK
;

815 * 
buf_ªad
 = (*)
	`ALLOC
(
buf_size
);

816 i‡(
	`ZSEEK64
(
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
, 
off£t_˚¡øl_dú
 + 
byã_bef‹e_the_zùfûe
, 
ZLIB_FILEFUNC_SEEK_SET
) != 0)

817 
îr
=
ZIP_ERRNO
;

819 (
size_˚¡øl_dú_to_ªad
>0Ë&& (
îr
==
ZIP_OK
))

821 
ZPOS64_T
 
ªad_this
 = 
SIZEDATA_INDATABLOCK
;

822 i‡(
ªad_this
 > 
size_˚¡øl_dú_to_ªad
)

823 
ªad_this
 = 
size_˚¡øl_dú_to_ªad
;

825 i‡(
	`ZREAD64
(
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
,
buf_ªad
,(
uL⁄g
)
ªad_this
) !=Ñead_this)

826 
îr
=
ZIP_ERRNO
;

828 i‡(
îr
==
ZIP_OK
)

829 
îr
 = 
	`add_d©a_ö_d©ablock
(&
pziöô
->
˚¡øl_dú
,
buf_ªad
, (
uL⁄g
)
ªad_this
);

831 
size_˚¡øl_dú_to_ªad
-=
ªad_this
;

833 
	`TRYFREE
(
buf_ªad
);

835 
pziöô
->
begö_pos
 = 
byã_bef‹e_the_zùfûe
;

836 
pziöô
->
numbî_íåy
 = 
numbî_íåy_CD
;

838 i‡(
	`ZSEEK64
(
pziöô
->
z_fûefunc
,Öziöô->
fûe°ªam
, 
off£t_˚¡øl_dú
+
byã_bef‹e_the_zùfûe
,
ZLIB_FILEFUNC_SEEK_SET
) != 0)

839 
îr
=
ZIP_ERRNO
;

841  
îr
;

842 
	}
}

849 
zùFûe
 
ZEXPORT
 
	$zùO≥n3
 (c⁄° *
∑th«me
, 
≠≥nd
, 
zùch¨pc
* 
globÆcommít
, 
zlib_fûefunc64_32_def
* 
pzlib_fûefunc64_32_def
)

851 
zù64_öã∫Æ
 
ziöô
;

852 
zù64_öã∫Æ
* 
zi
;

853 
îr
=
ZIP_OK
;

855 
ziöô
.
z_fûefunc
.
z£ek32_fûe
 = 
NULL
;

856 
ziöô
.
z_fûefunc
.
zãŒ32_fûe
 = 
NULL
;

857 i‡(
pzlib_fûefunc64_32_def
==
NULL
)

858 
	`fûl_f›í64_fûefunc
(&
ziöô
.
z_fûefunc
.
zfûe_func64
);

860 
ziöô
.
z_fûefunc
 = *
pzlib_fûefunc64_32_def
;

862 
ziöô
.
fûe°ªam
 = 
	`ZOPEN64
(ziöô.
z_fûefunc
,

863 
∑th«me
,

864 (
≠≥nd
 =
APPEND_STATUS_CREATE
) ?

865 (
ZLIB_FILEFUNC_MODE_READ
 | 
ZLIB_FILEFUNC_MODE_WRITE
 | 
ZLIB_FILEFUNC_MODE_CREATE
) :

866 (
ZLIB_FILEFUNC_MODE_READ
 | 
ZLIB_FILEFUNC_MODE_WRITE
 | 
ZLIB_FILEFUNC_MODE_EXISTING
));

868 i‡(
ziöô
.
fûe°ªam
 =
NULL
)

869  
NULL
;

871 i‡(
≠≥nd
 =
APPEND_STATUS_CREATEAFTER
)

872 
	`ZSEEK64
(
ziöô
.
z_fûefunc
,ziöô.
fûe°ªam
,0,
SEEK_END
);

874 
ziöô
.
begö_pos
 = 
	`ZTELL64
(ziöô.
z_fûefunc
,ziöô.
fûe°ªam
);

875 
ziöô
.
ö_›íed_fûe_özù
 = 0;

876 
ziöô
.
ci
.
°ªam_öôüli£d
 = 0;

877 
ziöô
.
numbî_íåy
 = 0;

878 
ziöô
.
add_posôi⁄_whí_wrôtög_off£t
 = 0;

879 
	`öô_lökedli°
(&(
ziöô
.
˚¡øl_dú
));

883 
zi
 = (
zù64_öã∫Æ
*)
	`ALLOC
((zip64_internal));

884 i‡(
zi
==
NULL
)

886 
	`ZCLOSE64
(
ziöô
.
z_fûefunc
,ziöô.
fûe°ªam
);

887  
NULL
;

891 #i‚de‡
NO_ADDFILEINEXISTINGZIP


892 
ziöô
.
globÆcommít
 = 
NULL
;

893 i‡(
≠≥nd
 =
APPEND_STATUS_ADDINZIP
)

896 
îr
 = 
	`LﬂdCíåÆDúe˘‹yRec‹d
(&
ziöô
);

897 
	}
}

899 i‡(
	gglobÆcommít
)

901 *
	gglobÆcommít
 = 
ziöô
.
globÆcommít
;

905 i‡(
	gîr
 !
ZIP_OK
)

907 #i‚de‡
NO_ADDFILEINEXISTINGZIP


908 
TRYFREE
(
ziöô
.
globÆcommít
);

910 
TRYFREE
(
zi
);

911  
	gNULL
;

915 *
	gzi
 = 
ziöô
;

916  (
	gzùFûe
)
	gzi
;

920 
zùFûe
 
ZEXPORT
 
	$zùO≥n2
 (c⁄° *
∑th«me
, 
≠≥nd
, 
zùch¨pc
* 
globÆcommít
, 
zlib_fûefunc_def
* 
pzlib_fûefunc32_def
)

922 i‡(
pzlib_fûefunc32_def
 !
NULL
)

924 
zlib_fûefunc64_32_def
 
zlib_fûefunc64_32_def_fûl
;

925 
	`fûl_zlib_fûefunc64_32_def_‰om_fûefunc32
(&
zlib_fûefunc64_32_def_fûl
,
pzlib_fûefunc32_def
);

926  
	`zùO≥n3
(
∑th«me
, 
≠≥nd
, 
globÆcommít
, &
zlib_fûefunc64_32_def_fûl
);

929  
	`zùO≥n3
(
∑th«me
, 
≠≥nd
, 
globÆcommít
, 
NULL
);

930 
	}
}

932 
zùFûe
 
ZEXPORT
 
	$zùO≥n2_64
 (c⁄° *
∑th«me
, 
≠≥nd
, 
zùch¨pc
* 
globÆcommít
, 
zlib_fûefunc64_def
* 
pzlib_fûefunc_def
)

934 i‡(
pzlib_fûefunc_def
 !
NULL
)

936 
zlib_fûefunc64_32_def
 
zlib_fûefunc64_32_def_fûl
;

937 
zlib_fûefunc64_32_def_fûl
.
zfûe_func64
 = *
pzlib_fûefunc_def
;

938 
zlib_fûefunc64_32_def_fûl
.
zãŒ32_fûe
 = 
NULL
;

939 
zlib_fûefunc64_32_def_fûl
.
z£ek32_fûe
 = 
NULL
;

940  
	`zùO≥n3
(
∑th«me
, 
≠≥nd
, 
globÆcommít
, &
zlib_fûefunc64_32_def_fûl
);

943  
	`zùO≥n3
(
∑th«me
, 
≠≥nd
, 
globÆcommít
, 
NULL
);

944 
	}
}

948 
zùFûe
 
ZEXPORT
 
	$zùO≥n
 (c⁄° * 
∑th«me
, 
≠≥nd
)

950  
	`zùO≥n3
((c⁄° *)
∑th«me
,
≠≥nd
,
NULL
,NULL);

951 
	}
}

953 
zùFûe
 
ZEXPORT
 
	$zùO≥n64
 (c⁄° * 
∑th«me
, 
≠≥nd
)

955  
	`zùO≥n3
(
∑th«me
,
≠≥nd
,
NULL
,NULL);

956 
	}
}

958 
	$Wrôe_LoˇlFûeHódî
(
zù64_öã∫Æ
* 
zi
, c⁄° * 
fûíame
, 
uI¡
 
size_exåafõld_loˇl
, c⁄° * 
exåafõld_loˇl
)

961 
îr
;

962 
uI¡
 
size_fûíame
 = (uI¡)
	`°æí
(
fûíame
);

963 
uI¡
 
size_exåafõld
 = 
size_exåafõld_loˇl
;

965 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)
LOCALHEADERMAGIC
, 4);

967 i‡(
îr
==
ZIP_OK
)

969 if(
zi
->
ci
.
zù64
)

970 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)45,2);

972 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)20,2);

975 i‡(
îr
==
ZIP_OK
)

976 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)zi->
ci
.
Êag
,2);

978 i‡(
îr
==
ZIP_OK
)

979 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)zi->
ci
.
mëhod
,2);

981 i‡(
îr
==
ZIP_OK
)

982 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)zi->
ci
.
dosD©e
,4);

985 i‡(
îr
==
ZIP_OK
)

986 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)0,4);

987 i‡(
îr
==
ZIP_OK
)

989 if(
zi
->
ci
.
zù64
)

990 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)0xFFFFFFFF,4);

992 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)0,4);

994 i‡(
îr
==
ZIP_OK
)

996 if(
zi
->
ci
.
zù64
)

997 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)0xFFFFFFFF,4);

999 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)0,4);

1002 i‡(
îr
==
ZIP_OK
)

1003 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)
size_fûíame
,2);

1005 if(
zi
->
ci
.
zù64
)

1007 
size_exåafõld
 += 20;

1010 i‡(
îr
==
ZIP_OK
)

1011 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)
size_exåafõld
,2);

1013 i‡((
îr
==
ZIP_OK
Ë&& (
size_fûíame
 > 0))

1015 i‡(
	`ZWRITE64
(
zi
->
z_fûefunc
,zi->
fûe°ªam
,
fûíame
,
size_fûíame
)!=size_filename)

1016 
îr
 = 
ZIP_ERRNO
;

1019 i‡((
îr
==
ZIP_OK
Ë&& (
size_exåafõld_loˇl
 > 0))

1021 i‡(
	`ZWRITE64
(
zi
->
z_fûefunc
, zi->
fûe°ªam
, 
exåafõld_loˇl
, 
size_exåafõld_loˇl
) != size_extrafield_local)

1022 
îr
 = 
ZIP_ERRNO
;

1026 i‡((
îr
==
ZIP_OK
Ë&& (
zi
->
ci
.
zù64
))

1029 
HódîID
 = 1;

1030 
D©aSize
 = 16;

1031 
ZPOS64_T
 
Com¥es£dSize
 = 0;

1032 
ZPOS64_T
 
Uncom¥es£dSize
 = 0;

1035 
zi
->
ci
.
pos_zù64exåaöfo
 = 
	`ZTELL64
(zi->
z_fûefunc
,zi->
fûe°ªam
);

1037 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
, zi->
fûe°ªam
, ()
HódîID
,2);

1038 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
, zi->
fûe°ªam
, ()
D©aSize
,2);

1040 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
, zi->
fûe°ªam
, (
ZPOS64_T
)
Uncom¥es£dSize
,8);

1041 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
, zi->
fûe°ªam
, (
ZPOS64_T
)
Com¥es£dSize
,8);

1044  
îr
;

1045 
	}
}

1055 
ZEXPORT
 
	$zùO≥nNewFûeInZù4_64
 (
zùFûe
 
fûe
, c⁄° * 
fûíame
, c⁄° 
zù_fûeöfo
* 
zùfi
,

1056 c⁄° * 
exåafõld_loˇl
, 
uI¡
 
size_exåafõld_loˇl
,

1057 c⁄° * 
exåafõld_globÆ
, 
uI¡
 
size_exåafõld_globÆ
,

1058 c⁄° * 
commít
, 
mëhod
, 
Àvñ
, 
øw
,

1059 
wödowBôs
,
memLevñ
, 
°øãgy
,

1060 c⁄° * 
∑ssw‹d
, 
uL⁄g
 
¸cF‹Cry±ög
,

1061 
uL⁄g
 
vîsi⁄MadeBy
, uL⁄g 
ÊagBa£
, 
zù64
)

1063 
zù64_öã∫Æ
* 
zi
;

1064 
uI¡
 
size_fûíame
;

1065 
uI¡
 
size_commít
;

1066 
uI¡
 
i
;

1067 
îr
 = 
ZIP_OK
;

1069 #ifde‡
NOCRYPT


1070 (
¸cF‹Cry±ög
);

1071 i‡(
∑ssw‹d
 !
NULL
)

1072  
ZIP_PARAMERROR
;

1075 i‡(
fûe
 =
NULL
)

1076  
ZIP_PARAMERROR
;

1078 #ifde‡
HAVE_BZIP2


1079 i‡((
mëhod
!=0Ë&& (mëhod!=
Z_DEFLATED
Ë&& (mëhod!=
Z_BZIP2ED
))

1080  
ZIP_PARAMERROR
;

1082 i‡((
mëhod
!=0Ë&& (mëhod!=
Z_DEFLATED
))

1083  
ZIP_PARAMERROR
;

1086 
zi
 = (
zù64_öã∫Æ
*)
fûe
;

1088 i‡(
zi
->
ö_›íed_fûe_özù
 == 1)

1090 
îr
 = 
	`zùClo£FûeInZù
 (
fûe
);

1091 i‡(
îr
 !
ZIP_OK
)

1092  
îr
;

1095 i‡(
fûíame
==
NULL
)

1096 
fûíame
="-";

1098 i‡(
commít
==
NULL
)

1099 
size_commít
 = 0;

1101 
size_commít
 = (
uI¡
)
	`°æí
(
commít
);

1103 
size_fûíame
 = (
uI¡
)
	`°æí
(
fûíame
);

1105 i‡(
zùfi
 =
NULL
)

1106 
zi
->
ci
.
dosD©e
 = 0;

1109 i‡(
zùfi
->
dosD©e
 != 0)

1110 
zi
->
ci
.
dosD©e
 = 
zùfi
->dosDate;

1112 
zi
->
ci
.
dosD©e
 = 
	`zù64loˇl_TmzD©eToDosD©e
(&
zùfi
->
tmz_d©e
);

1115 
zi
->
ci
.
Êag
 = 
ÊagBa£
;

1116 i‡((
Àvñ
==8) || (level==9))

1117 
zi
->
ci
.
Êag
 |= 2;

1118 i‡(
Àvñ
==2)

1119 
zi
->
ci
.
Êag
 |= 4;

1120 i‡(
Àvñ
==1)

1121 
zi
->
ci
.
Êag
 |= 6;

1122 i‡(
∑ssw‹d
 !
NULL
)

1123 
zi
->
ci
.
Êag
 |= 1;

1125 
zi
->
ci
.
¸c32
 = 0;

1126 
zi
->
ci
.
mëhod
 = method;

1127 
zi
->
ci
.
í¸y±
 = 0;

1128 
zi
->
ci
.
°ªam_öôüli£d
 = 0;

1129 
zi
->
ci
.
pos_ö_buf„ªd_d©a
 = 0;

1130 
zi
->
ci
.
øw
 =Ñaw;

1131 
zi
->
ci
.
pos_loˇl_hódî
 = 
	`ZTELL64
(zi->
z_fûefunc
,zi->
fûe°ªam
);

1133 
zi
->
ci
.
size_˚¡ølhódî
 = 
SIZECENTRALHEADER
 + 
size_fûíame
 + 
size_exåafõld_globÆ
 + 
size_commít
;

1134 
zi
->
ci
.
size_˚¡ølExåaFªe
 = 32;

1136 
zi
->
ci
.
˚¡øl_hódî
 = (*)
	`ALLOC
((
uI¡
)zi->ci.
size_˚¡ølhódî
 + zi->ci.
size_˚¡ølExåaFªe
);

1138 
zi
->
ci
.
size_˚¡ølExåa
 = 
size_exåafõld_globÆ
;

1139 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
,(
uL⁄g
)
CENTRALHEADERMAGIC
,4);

1141 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+4,(
uL⁄g
)
vîsi⁄MadeBy
,2);

1142 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+6,(
uL⁄g
)20,2);

1143 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+8,(
uL⁄g
)zi->ci.
Êag
,2);

1144 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+10,(
uL⁄g
)zi->ci.
mëhod
,2);

1145 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+12,(
uL⁄g
)zi->ci.
dosD©e
,4);

1146 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+16,(
uL⁄g
)0,4);

1147 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+20,(
uL⁄g
)0,4);

1148 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+24,(
uL⁄g
)0,4);

1149 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+28,(
uL⁄g
)
size_fûíame
,2);

1150 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+30,(
uL⁄g
)
size_exåafõld_globÆ
,2);

1151 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+32,(
uL⁄g
)
size_commít
,2);

1152 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+34,(
uL⁄g
)0,2);

1154 i‡(
zùfi
==
NULL
)

1155 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+36,(
uL⁄g
)0,2);

1157 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+36,(
uL⁄g
)
zùfi
->
öã∫Æ_Á
,2);

1159 i‡(
zùfi
==
NULL
)

1160 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+38,(
uL⁄g
)0,4);

1162 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+38,(
uL⁄g
)
zùfi
->
exã∫Æ_Á
,4);

1164 if(
zi
->
ci
.
pos_loˇl_hódî
 >= 0xffffffff)

1165 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+42,(
uL⁄g
)0xffffffff,4);

1167 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+42,(
uL⁄g
)zi->ci.
pos_loˇl_hódî
 - zi->
add_posôi⁄_whí_wrôtög_off£t
,4);

1169 
i
=0;i<
size_fûíame
;i++)

1170 *(
zi
->
ci
.
˚¡øl_hódî
+
SIZECENTRALHEADER
+
i
Ë*(
fûíame
+i);

1172 
i
=0;i<
size_exåafõld_globÆ
;i++)

1173 *(
zi
->
ci
.
˚¡øl_hódî
+
SIZECENTRALHEADER
+
size_fûíame
+
i
) =

1174 *(((c⁄° *)
exåafõld_globÆ
)+
i
);

1176 
i
=0;i<
size_commít
;i++)

1177 *(
zi
->
ci
.
˚¡øl_hódî
+
SIZECENTRALHEADER
+
size_fûíame
+

1178 
size_exåafõld_globÆ
+
i
Ë*(
commít
+i);

1179 i‡(
zi
->
ci
.
˚¡øl_hódî
 =
NULL
)

1180  
ZIP_INTERNALERROR
;

1182 
zi
->
ci
.
zù64
 = zip64;

1183 
zi
->
ci
.
tŸÆCom¥es£dD©a
 = 0;

1184 
zi
->
ci
.
tŸÆUncom¥es£dD©a
 = 0;

1185 
zi
->
ci
.
pos_zù64exåaöfo
 = 0;

1187 
îr
 = 
	`Wrôe_LoˇlFûeHódî
(
zi
, 
fûíame
, 
size_exåafõld_loˇl
, 
exåafõld_loˇl
);

1189 #ifde‡
HAVE_BZIP2


1190 
zi
->
ci
.
b°ªam
.
avaû_ö
 = (
uI¡
)0;

1191 
zi
->
ci
.
b°ªam
.
avaû_out
 = (
uI¡
)
Z_BUFSIZE
;

1192 
zi
->
ci
.
b°ªam
.
√xt_out
 = (*)zi->ci.
buf„ªd_d©a
;

1193 
zi
->
ci
.
b°ªam
.
tŸÆ_ö_hi32
 = 0;

1194 
zi
->
ci
.
b°ªam
.
tŸÆ_ö_lo32
 = 0;

1195 
zi
->
ci
.
b°ªam
.
tŸÆ_out_hi32
 = 0;

1196 
zi
->
ci
.
b°ªam
.
tŸÆ_out_lo32
 = 0;

1199 
zi
->
ci
.
°ªam
.
avaû_ö
 = (
uI¡
)0;

1200 
zi
->
ci
.
°ªam
.
avaû_out
 = (
uI¡
)
Z_BUFSIZE
;

1201 
zi
->
ci
.
°ªam
.
√xt_out
 = zi->ci.
buf„ªd_d©a
;

1202 
zi
->
ci
.
°ªam
.
tŸÆ_ö
 = 0;

1203 
zi
->
ci
.
°ªam
.
tŸÆ_out
 = 0;

1204 
zi
->
ci
.
°ªam
.
d©a_ty≥
 = 
Z_BINARY
;

1206 #ifde‡
HAVE_BZIP2


1207 i‡((
îr
==
ZIP_OK
Ë&& (
zi
->
ci
.
mëhod
 =
Z_DEFLATED
 || zi->ci.mëhod =
Z_BZIP2ED
Ë&& (!zi->ci.
øw
))

1209 i‡((
îr
==
ZIP_OK
Ë&& (
zi
->
ci
.
mëhod
 =
Z_DEFLATED
Ë&& (!zi->ci.
øw
))

1212 if(
zi
->
ci
.
mëhod
 =
Z_DEFLATED
)

1214 
zi
->
ci
.
°ªam
.
zÆloc
 = (
Æloc_func
)0;

1215 
zi
->
ci
.
°ªam
.
z‰ì
 = (
‰ì_func
)0;

1216 
zi
->
ci
.
°ªam
.
›aque
 = (
voidpf
)0;

1218 i‡(
wödowBôs
>0)

1219 
wödowBôs
 = -windowBits;

1221 
îr
 = 
	`deÊ©eInô2
(&
zi
->
ci
.
°ªam
, 
Àvñ
, 
Z_DEFLATED
, 
wödowBôs
, 
memLevñ
, 
°øãgy
);

1223 i‡(
îr
==
Z_OK
)

1224 
zi
->
ci
.
°ªam_öôüli£d
 = 
Z_DEFLATED
;

1226 if(
zi
->
ci
.
mëhod
 =
Z_BZIP2ED
)

1228 #ifde‡
HAVE_BZIP2


1230 
zi
->
ci
.
b°ªam
.
bzÆloc
 = 0;

1231 
zi
->
ci
.
b°ªam
.
bz‰ì
 = 0;

1232 
zi
->
ci
.
b°ªam
.
›aque
 = (
voidpf
)0;

1234 
îr
 = 
	`BZ2_bzCom¥essInô
(&
zi
->
ci
.
b°ªam
, 
Àvñ
, 0,35);

1235 if(
îr
 =
BZ_OK
)

1236 
zi
->
ci
.
°ªam_öôüli£d
 = 
Z_BZIP2ED
;

1242 #i‚de‡
NOCRYPT


1243 
zi
->
ci
.
¸y±_hódî_size
 = 0;

1244 i‡((
îr
==
Z_OK
Ë&& (
∑ssw‹d
 !
NULL
))

1246 
bufHód
[
RAND_HEAD_LEN
];

1247 
sizeHód
;

1248 
zi
->
ci
.
í¸y±
 = 1;

1249 
zi
->
ci
.
p¸c_32_èb
 = 
	`gë_¸c_èbÀ
();

1252 
sizeHód
=
	`¸y±hód
(
∑ssw‹d
,
bufHód
,
RAND_HEAD_LEN
,
zi
->
ci
.
keys
,zi->ci.
p¸c_32_èb
,
¸cF‹Cry±ög
);

1253 
zi
->
ci
.
¸y±_hódî_size
 = 
sizeHód
;

1255 i‡(
	`ZWRITE64
(
zi
->
z_fûefunc
,zi->
fûe°ªam
,
bufHód
,
sizeHód
) != sizeHead)

1256 
îr
 = 
ZIP_ERRNO
;

1260 i‡(
îr
==
Z_OK
)

1261 
zi
->
ö_›íed_fûe_özù
 = 1;

1262  
îr
;

1263 
	}
}

1265 
ZEXPORT
 
	$zùO≥nNewFûeInZù4
 (
zùFûe
 
fûe
, c⁄° * 
fûíame
, c⁄° 
zù_fûeöfo
* 
zùfi
,

1266 c⁄° * 
exåafõld_loˇl
, 
uI¡
 
size_exåafõld_loˇl
,

1267 c⁄° * 
exåafõld_globÆ
, 
uI¡
 
size_exåafõld_globÆ
,

1268 c⁄° * 
commít
, 
mëhod
, 
Àvñ
, 
øw
,

1269 
wödowBôs
,
memLevñ
, 
°øãgy
,

1270 c⁄° * 
∑ssw‹d
, 
uL⁄g
 
¸cF‹Cry±ög
,

1271 
uL⁄g
 
vîsi⁄MadeBy
, uL⁄g 
ÊagBa£
)

1273  
	`zùO≥nNewFûeInZù4_64
 (
fûe
, 
fûíame
, 
zùfi
,

1274 
exåafõld_loˇl
, 
size_exåafõld_loˇl
,

1275 
exåafõld_globÆ
, 
size_exåafõld_globÆ
,

1276 
commít
, 
mëhod
, 
Àvñ
, 
øw
,

1277 
wödowBôs
, 
memLevñ
, 
°øãgy
,

1278 
∑ssw‹d
, 
¸cF‹Cry±ög
, 
vîsi⁄MadeBy
, 
ÊagBa£
, 0);

1279 
	}
}

1281 
ZEXPORT
 
	$zùO≥nNewFûeInZù3
 (
zùFûe
 
fûe
, c⁄° * 
fûíame
, c⁄° 
zù_fûeöfo
* 
zùfi
,

1282 c⁄° * 
exåafõld_loˇl
, 
uI¡
 
size_exåafõld_loˇl
,

1283 c⁄° * 
exåafõld_globÆ
, 
uI¡
 
size_exåafõld_globÆ
,

1284 c⁄° * 
commít
, 
mëhod
, 
Àvñ
, 
øw
,

1285 
wödowBôs
,
memLevñ
, 
°øãgy
,

1286 c⁄° * 
∑ssw‹d
, 
uL⁄g
 
¸cF‹Cry±ög
)

1288  
	`zùO≥nNewFûeInZù4_64
 (
fûe
, 
fûíame
, 
zùfi
,

1289 
exåafõld_loˇl
, 
size_exåafõld_loˇl
,

1290 
exåafõld_globÆ
, 
size_exåafõld_globÆ
,

1291 
commít
, 
mëhod
, 
Àvñ
, 
øw
,

1292 
wödowBôs
, 
memLevñ
, 
°øãgy
,

1293 
∑ssw‹d
, 
¸cF‹Cry±ög
, 
VERSIONMADEBY
, 0, 0);

1294 
	}
}

1296 
ZEXPORT
 
	$zùO≥nNewFûeInZù3_64
(
zùFûe
 
fûe
, c⁄° * 
fûíame
, c⁄° 
zù_fûeöfo
* 
zùfi
,

1297 c⁄° * 
exåafõld_loˇl
, 
uI¡
 
size_exåafõld_loˇl
,

1298 c⁄° * 
exåafõld_globÆ
, 
uI¡
 
size_exåafõld_globÆ
,

1299 c⁄° * 
commít
, 
mëhod
, 
Àvñ
, 
øw
,

1300 
wödowBôs
,
memLevñ
, 
°øãgy
,

1301 c⁄° * 
∑ssw‹d
, 
uL⁄g
 
¸cF‹Cry±ög
, 
zù64
)

1303  
	`zùO≥nNewFûeInZù4_64
 (
fûe
, 
fûíame
, 
zùfi
,

1304 
exåafõld_loˇl
, 
size_exåafõld_loˇl
,

1305 
exåafõld_globÆ
, 
size_exåafõld_globÆ
,

1306 
commít
, 
mëhod
, 
Àvñ
, 
øw
,

1307 
wödowBôs
, 
memLevñ
, 
°øãgy
,

1308 
∑ssw‹d
, 
¸cF‹Cry±ög
, 
VERSIONMADEBY
, 0, 
zù64
);

1309 
	}
}

1311 
ZEXPORT
 
	$zùO≥nNewFûeInZù2
(
zùFûe
 
fûe
, c⁄° * 
fûíame
, c⁄° 
zù_fûeöfo
* 
zùfi
,

1312 c⁄° * 
exåafõld_loˇl
, 
uI¡
 
size_exåafõld_loˇl
,

1313 c⁄° * 
exåafõld_globÆ
, 
uI¡
 
size_exåafõld_globÆ
,

1314 c⁄° * 
commít
, 
mëhod
, 
Àvñ
, 
øw
)

1316  
	`zùO≥nNewFûeInZù4_64
 (
fûe
, 
fûíame
, 
zùfi
,

1317 
exåafõld_loˇl
, 
size_exåafõld_loˇl
,

1318 
exåafõld_globÆ
, 
size_exåafõld_globÆ
,

1319 
commít
, 
mëhod
, 
Àvñ
, 
øw
,

1320 -
MAX_WBITS
, 
DEF_MEM_LEVEL
, 
Z_DEFAULT_STRATEGY
,

1321 
NULL
, 0, 
VERSIONMADEBY
, 0, 0);

1322 
	}
}

1324 
ZEXPORT
 
	$zùO≥nNewFûeInZù2_64
(
zùFûe
 
fûe
, c⁄° * 
fûíame
, c⁄° 
zù_fûeöfo
* 
zùfi
,

1325 c⁄° * 
exåafõld_loˇl
, 
uI¡
 
size_exåafõld_loˇl
,

1326 c⁄° * 
exåafõld_globÆ
, 
uI¡
 
size_exåafõld_globÆ
,

1327 c⁄° * 
commít
, 
mëhod
, 
Àvñ
, 
øw
, 
zù64
)

1329  
	`zùO≥nNewFûeInZù4_64
 (
fûe
, 
fûíame
, 
zùfi
,

1330 
exåafõld_loˇl
, 
size_exåafõld_loˇl
,

1331 
exåafõld_globÆ
, 
size_exåafõld_globÆ
,

1332 
commít
, 
mëhod
, 
Àvñ
, 
øw
,

1333 -
MAX_WBITS
, 
DEF_MEM_LEVEL
, 
Z_DEFAULT_STRATEGY
,

1334 
NULL
, 0, 
VERSIONMADEBY
, 0, 
zù64
);

1335 
	}
}

1337 
ZEXPORT
 
	$zùO≥nNewFûeInZù64
 (
zùFûe
 
fûe
, c⁄° * 
fûíame
, c⁄° 
zù_fûeöfo
* 
zùfi
,

1338 c⁄° * 
exåafõld_loˇl
, 
uI¡
 
size_exåafõld_loˇl
,

1339 c⁄° *
exåafõld_globÆ
, 
uI¡
 
size_exåafõld_globÆ
,

1340 c⁄° * 
commít
, 
mëhod
, 
Àvñ
, 
zù64
)

1342  
	`zùO≥nNewFûeInZù4_64
 (
fûe
, 
fûíame
, 
zùfi
,

1343 
exåafõld_loˇl
, 
size_exåafõld_loˇl
,

1344 
exåafõld_globÆ
, 
size_exåafõld_globÆ
,

1345 
commít
, 
mëhod
, 
Àvñ
, 0,

1346 -
MAX_WBITS
, 
DEF_MEM_LEVEL
, 
Z_DEFAULT_STRATEGY
,

1347 
NULL
, 0, 
VERSIONMADEBY
, 0, 
zù64
);

1348 
	}
}

1350 
ZEXPORT
 
	$zùO≥nNewFûeInZù
 (
zùFûe
 
fûe
, c⁄° * 
fûíame
, c⁄° 
zù_fûeöfo
* 
zùfi
,

1351 c⁄° * 
exåafõld_loˇl
, 
uI¡
 
size_exåafõld_loˇl
,

1352 c⁄° *
exåafõld_globÆ
, 
uI¡
 
size_exåafõld_globÆ
,

1353 c⁄° * 
commít
, 
mëhod
, 
Àvñ
)

1355  
	`zùO≥nNewFûeInZù4_64
 (
fûe
, 
fûíame
, 
zùfi
,

1356 
exåafõld_loˇl
, 
size_exåafõld_loˇl
,

1357 
exåafõld_globÆ
, 
size_exåafõld_globÆ
,

1358 
commít
, 
mëhod
, 
Àvñ
, 0,

1359 -
MAX_WBITS
, 
DEF_MEM_LEVEL
, 
Z_DEFAULT_STRATEGY
,

1360 
NULL
, 0, 
VERSIONMADEBY
, 0, 0);

1361 
	}
}

1363 
loˇl
 
	$zù64FlushWrôeBuf„r
(
zù64_öã∫Æ
* 
zi
)

1365 
îr
=
ZIP_OK
;

1367 i‡(
zi
->
ci
.
í¸y±
 != 0)

1369 #i‚de‡
NOCRYPT


1370 
uI¡
 
i
;

1371 
t
;

1372 
i
=0;i<
zi
->
ci
.
pos_ö_buf„ªd_d©a
;i++)

1373 
zi
->
ci
.
buf„ªd_d©a
[
i
] = 
	`zícode
(zi->ci.
keys
, zi->ci.
p¸c_32_èb
, zi->ci.buf„ªd_d©a[i],
t
);

1377 i‡(
	`ZWRITE64
(
zi
->
z_fûefunc
,zi->
fûe°ªam
,zi->
ci
.
buf„ªd_d©a
,zi->ci.
pos_ö_buf„ªd_d©a
) != zi->ci.pos_in_buffered_data)

1378 
îr
 = 
ZIP_ERRNO
;

1380 
zi
->
ci
.
tŸÆCom¥es£dD©a
 +zi->ci.
pos_ö_buf„ªd_d©a
;

1382 #ifde‡
HAVE_BZIP2


1383 if(
zi
->
ci
.
mëhod
 =
Z_BZIP2ED
)

1385 
zi
->
ci
.
tŸÆUncom¥es£dD©a
 +zi->ci.
b°ªam
.
tŸÆ_ö_lo32
;

1386 
zi
->
ci
.
b°ªam
.
tŸÆ_ö_lo32
 = 0;

1387 
zi
->
ci
.
b°ªam
.
tŸÆ_ö_hi32
 = 0;

1392 
zi
->
ci
.
tŸÆUncom¥es£dD©a
 +zi->ci.
°ªam
.
tŸÆ_ö
;

1393 
zi
->
ci
.
°ªam
.
tŸÆ_ö
 = 0;

1397 
zi
->
ci
.
pos_ö_buf„ªd_d©a
 = 0;

1399  
îr
;

1400 
	}
}

1402 
ZEXPORT
 
	$zùWrôeInFûeInZù
 (
zùFûe
 
fûe
,c⁄° * 
buf
,
Àn
)

1404 
zù64_öã∫Æ
* 
zi
;

1405 
îr
=
ZIP_OK
;

1407 i‡(
fûe
 =
NULL
)

1408  
ZIP_PARAMERROR
;

1409 
zi
 = (
zù64_öã∫Æ
*)
fûe
;

1411 i‡(
zi
->
ö_›íed_fûe_özù
 == 0)

1412  
ZIP_PARAMERROR
;

1414 
zi
->
ci
.
¸c32
 = 
	`¸c32
(zi->ci.¸c32,
buf
,(
uI¡
)
Àn
);

1416 #ifde‡
HAVE_BZIP2


1417 if(
zi
->
ci
.
mëhod
 =
Z_BZIP2ED
 && (!zi->ci.
øw
))

1419 
zi
->
ci
.
b°ªam
.
√xt_ö
 = (*)
buf
;

1420 
zi
->
ci
.
b°ªam
.
avaû_ö
 = 
Àn
;

1421 
îr
 = 
BZ_RUN_OK
;

1423 (
îr
==
BZ_RUN_OK
Ë&& (
zi
->
ci
.
b°ªam
.
avaû_ö
>0))

1425 i‡(
zi
->
ci
.
b°ªam
.
avaû_out
 == 0)

1427 i‡(
	`zù64FlushWrôeBuf„r
(
zi
Ë=
ZIP_ERRNO
)

1428 
îr
 = 
ZIP_ERRNO
;

1429 
zi
->
ci
.
b°ªam
.
avaû_out
 = (
uI¡
)
Z_BUFSIZE
;

1430 
zi
->
ci
.
b°ªam
.
√xt_out
 = (*)zi->ci.
buf„ªd_d©a
;

1434 if(
îr
 !
BZ_RUN_OK
)

1437 i‡((
zi
->
ci
.
mëhod
 =
Z_BZIP2ED
Ë&& (!zi->ci.
øw
))

1439 
uL⁄g
 
uTŸÆOutBef‹e_lo
 = 
zi
->
ci
.
b°ªam
.
tŸÆ_out_lo32
;

1441 
îr
=
	`BZ2_bzCom¥ess
(&
zi
->
ci
.
b°ªam
, 
BZ_RUN
);

1443 
zi
->
ci
.
pos_ö_buf„ªd_d©a
 +(
uI¡
)(zi->ci.
b°ªam
.
tŸÆ_out_lo32
 - 
uTŸÆOutBef‹e_lo
) ;

1447 if(
îr
 =
BZ_RUN_OK
)

1448 
îr
 = 
ZIP_OK
;

1453 
zi
->
ci
.
°ªam
.
√xt_ö
 = (
Byãf
*)
buf
;

1454 
zi
->
ci
.
°ªam
.
avaû_ö
 = 
Àn
;

1456 (
îr
==
ZIP_OK
Ë&& (
zi
->
ci
.
°ªam
.
avaû_ö
>0))

1458 i‡(
zi
->
ci
.
°ªam
.
avaû_out
 == 0)

1460 i‡(
	`zù64FlushWrôeBuf„r
(
zi
Ë=
ZIP_ERRNO
)

1461 
îr
 = 
ZIP_ERRNO
;

1462 
zi
->
ci
.
°ªam
.
avaû_out
 = (
uI¡
)
Z_BUFSIZE
;

1463 
zi
->
ci
.
°ªam
.
√xt_out
 = zi->ci.
buf„ªd_d©a
;

1467 if(
îr
 !
ZIP_OK
)

1470 i‡((
zi
->
ci
.
mëhod
 =
Z_DEFLATED
Ë&& (!zi->ci.
øw
))

1472 
uL⁄g
 
uTŸÆOutBef‹e
 = 
zi
->
ci
.
°ªam
.
tŸÆ_out
;

1473 
îr
=
	`deÊ©e
(&
zi
->
ci
.
°ªam
, 
Z_NO_FLUSH
);

1474 if(
uTŸÆOutBef‹e
 > 
zi
->
ci
.
°ªam
.
tŸÆ_out
)

1476 
bBªak
 = 0;

1477 
bBªak
++;

1480 
zi
->
ci
.
pos_ö_buf„ªd_d©a
 +(
uI¡
)(zi->ci.
°ªam
.
tŸÆ_out
 - 
uTŸÆOutBef‹e
) ;

1484 
uI¡
 
c›y_this
,
i
;

1485 i‡(
zi
->
ci
.
°ªam
.
avaû_ö
 < zi->ci.°ªam.
avaû_out
)

1486 
c›y_this
 = 
zi
->
ci
.
°ªam
.
avaû_ö
;

1488 
c›y_this
 = 
zi
->
ci
.
°ªam
.
avaû_out
;

1490 
i
 = 0; i < 
c›y_this
; i++)

1491 *(((*)
zi
->
ci
.
°ªam
.
√xt_out
)+
i
) =

1492 *(((c⁄° *)
zi
->
ci
.
°ªam
.
√xt_ö
)+
i
);

1494 
zi
->
ci
.
°ªam
.
avaû_ö
 -
c›y_this
;

1495 
zi
->
ci
.
°ªam
.
avaû_out
-
c›y_this
;

1496 
zi
->
ci
.
°ªam
.
√xt_ö
+
c›y_this
;

1497 
zi
->
ci
.
°ªam
.
√xt_out
+
c›y_this
;

1498 
zi
->
ci
.
°ªam
.
tŸÆ_ö
+
c›y_this
;

1499 
zi
->
ci
.
°ªam
.
tŸÆ_out
+
c›y_this
;

1500 
zi
->
ci
.
pos_ö_buf„ªd_d©a
 +
c›y_this
;

1506  
îr
;

1507 
	}
}

1509 
ZEXPORT
 
	$zùClo£FûeInZùRaw
 (
zùFûe
 
fûe
, 
uL⁄g
 
uncom¥es£d_size
, uL⁄g 
¸c32
)

1511  
	`zùClo£FûeInZùRaw64
 (
fûe
, 
uncom¥es£d_size
, 
¸c32
);

1512 
	}
}

1514 
ZEXPORT
 
	$zùClo£FûeInZùRaw64
 (
zùFûe
 
fûe
, 
ZPOS64_T
 
uncom¥es£d_size
, 
uL⁄g
 
¸c32
)

1516 
zù64_öã∫Æ
* 
zi
;

1517 
ZPOS64_T
 
com¥es£d_size
;

1518 
uL⁄g
 
övÆidVÆue
 = 0xffffffff;

1519 
d©asize
 = 0;

1520 
îr
=
ZIP_OK
;

1522 i‡(
fûe
 =
NULL
)

1523  
ZIP_PARAMERROR
;

1524 
zi
 = (
zù64_öã∫Æ
*)
fûe
;

1526 i‡(
zi
->
ö_›íed_fûe_özù
 == 0)

1527  
ZIP_PARAMERROR
;

1528 
zi
->
ci
.
°ªam
.
avaû_ö
 = 0;

1530 i‡((
zi
->
ci
.
mëhod
 =
Z_DEFLATED
Ë&& (!zi->ci.
øw
))

1532 
îr
==
ZIP_OK
)

1534 
uL⁄g
 
uTŸÆOutBef‹e
;

1535 i‡(
zi
->
ci
.
°ªam
.
avaû_out
 == 0)

1537 i‡(
	`zù64FlushWrôeBuf„r
(
zi
Ë=
ZIP_ERRNO
)

1538 
îr
 = 
ZIP_ERRNO
;

1539 
zi
->
ci
.
°ªam
.
avaû_out
 = (
uI¡
)
Z_BUFSIZE
;

1540 
zi
->
ci
.
°ªam
.
√xt_out
 = zi->ci.
buf„ªd_d©a
;

1542 
uTŸÆOutBef‹e
 = 
zi
->
ci
.
°ªam
.
tŸÆ_out
;

1543 
îr
=
	`deÊ©e
(&
zi
->
ci
.
°ªam
, 
Z_FINISH
);

1544 
zi
->
ci
.
pos_ö_buf„ªd_d©a
 +(
uI¡
)(zi->ci.
°ªam
.
tŸÆ_out
 - 
uTŸÆOutBef‹e
) ;

1547 i‡((
zi
->
ci
.
mëhod
 =
Z_BZIP2ED
Ë&& (!zi->ci.
øw
))

1549 #ifde‡
HAVE_BZIP2


1550 
îr
 = 
BZ_FINISH_OK
;

1551 
îr
==
BZ_FINISH_OK
)

1553 
uL⁄g
 
uTŸÆOutBef‹e
;

1554 i‡(
zi
->
ci
.
b°ªam
.
avaû_out
 == 0)

1556 i‡(
	`zù64FlushWrôeBuf„r
(
zi
Ë=
ZIP_ERRNO
)

1557 
îr
 = 
ZIP_ERRNO
;

1558 
zi
->
ci
.
b°ªam
.
avaû_out
 = (
uI¡
)
Z_BUFSIZE
;

1559 
zi
->
ci
.
b°ªam
.
√xt_out
 = (*)zi->ci.
buf„ªd_d©a
;

1561 
uTŸÆOutBef‹e
 = 
zi
->
ci
.
b°ªam
.
tŸÆ_out_lo32
;

1562 
îr
=
	`BZ2_bzCom¥ess
(&
zi
->
ci
.
b°ªam
, 
BZ_FINISH
);

1563 if(
îr
 =
BZ_STREAM_END
)

1564 
îr
 = 
Z_STREAM_END
;

1566 
zi
->
ci
.
pos_ö_buf„ªd_d©a
 +(
uI¡
)(zi->ci.
b°ªam
.
tŸÆ_out_lo32
 - 
uTŸÆOutBef‹e
);

1569 if(
îr
 =
BZ_FINISH_OK
)

1570 
îr
 = 
ZIP_OK
;

1574 i‡(
îr
==
Z_STREAM_END
)

1575 
îr
=
ZIP_OK
;

1577 i‡((
zi
->
ci
.
pos_ö_buf„ªd_d©a
>0Ë&& (
îr
==
ZIP_OK
))

1579 i‡(
	`zù64FlushWrôeBuf„r
(
zi
)==
ZIP_ERRNO
)

1580 
îr
 = 
ZIP_ERRNO
;

1583 i‡((
zi
->
ci
.
mëhod
 =
Z_DEFLATED
Ë&& (!zi->ci.
øw
))

1585 
tmp_îr
 = 
	`deÊ©eEnd
(&
zi
->
ci
.
°ªam
);

1586 i‡(
îr
 =
ZIP_OK
)

1587 
îr
 = 
tmp_îr
;

1588 
zi
->
ci
.
°ªam_öôüli£d
 = 0;

1590 #ifde‡
HAVE_BZIP2


1591 if((
zi
->
ci
.
mëhod
 =
Z_BZIP2ED
Ë&& (!zi->ci.
øw
))

1593 
tm≥º
 = 
	`BZ2_bzCom¥essEnd
(&
zi
->
ci
.
b°ªam
);

1594 i‡(
îr
==
ZIP_OK
)

1595 
îr
 = 
tm≥º
;

1596 
zi
->
ci
.
°ªam_öôüli£d
 = 0;

1600 i‡(!
zi
->
ci
.
øw
)

1602 
¸c32
 = (
uL⁄g
)
zi
->
ci
.crc32;

1603 
uncom¥es£d_size
 = 
zi
->
ci
.
tŸÆUncom¥es£dD©a
;

1605 
com¥es£d_size
 = 
zi
->
ci
.
tŸÆCom¥es£dD©a
;

1607 #i‚de‡
NOCRYPT


1608 
com¥es£d_size
 +
zi
->
ci
.
¸y±_hódî_size
;

1612 if(
com¥es£d_size
 >0xfffffff‡|| 
uncom¥es£d_size
 >0xfffffff‡|| 
zi
->
ci
.
pos_loˇl_hódî
 >= 0xffffffff)

1615 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+4,(
uL⁄g
)45,2);

1617 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+6,(
uL⁄g
)45,2);

1621 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+16,
¸c32
,4);

1624 if(
com¥es£d_size
 >= 0xffffffff)

1625 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+20, 
övÆidVÆue
,4);

1627 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+20, 
com¥es£d_size
,4);

1630 i‡(
zi
->
ci
.
°ªam
.
d©a_ty≥
 =
Z_ASCII
)

1631 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+36,(
uL⁄g
)
Z_ASCII
,2);

1633 if(
uncom¥es£d_size
 >= 0xffffffff)

1634 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+24, 
övÆidVÆue
,4);

1636 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+24, 
uncom¥es£d_size
,4);

1639 if(
uncom¥es£d_size
 >= 0xffffffff)

1640 
d©asize
 += 8;

1643 if(
com¥es£d_size
 >= 0xffffffff)

1644 
d©asize
 += 8;

1647 if(
zi
->
ci
.
pos_loˇl_hódî
 >= 0xffffffff)

1648 
d©asize
 += 8;

1650 if(
d©asize
 > 0)

1652 * 
p
 = 
NULL
;

1654 if((
uL⁄g
)(
d©asize
 + 4Ë> 
zi
->
ci
.
size_˚¡ølExåaFªe
)

1657  
ZIP_BADZIPFILE
;

1660 
p
 = 
zi
->
ci
.
˚¡øl_hódî
 + zi->ci.
size_˚¡ølhódî
;

1663 
	`zù64loˇl_putVÆue_ömem‹y
(
p
, 0x0001, 2);

1664 
p
 += 2;

1665 
	`zù64loˇl_putVÆue_ömem‹y
(
p
, 
d©asize
, 2);

1666 
p
 += 2;

1668 if(
uncom¥es£d_size
 >= 0xffffffff)

1670 
	`zù64loˇl_putVÆue_ömem‹y
(
p
, 
uncom¥es£d_size
, 8);

1671 
p
 += 8;

1674 if(
com¥es£d_size
 >= 0xffffffff)

1676 
	`zù64loˇl_putVÆue_ömem‹y
(
p
, 
com¥es£d_size
, 8);

1677 
p
 += 8;

1680 if(
zi
->
ci
.
pos_loˇl_hódî
 >= 0xffffffff)

1682 
	`zù64loˇl_putVÆue_ömem‹y
(
p
, 
zi
->
ci
.
pos_loˇl_hódî
, 8);

1683 
p
 += 8;

1689 
zi
->
ci
.
size_˚¡ølExåaFªe
 -
d©asize
 + 4;

1690 
zi
->
ci
.
size_˚¡ølhódî
 +
d©asize
 + 4;

1693 
zi
->
ci
.
size_˚¡ølExåa
 +
d©asize
 + 4;

1694 
	`zù64loˇl_putVÆue_ömem‹y
(
zi
->
ci
.
˚¡øl_hódî
+30,(
uL⁄g
)zi->ci.
size_˚¡ølExåa
,2);

1697 i‡(
îr
==
ZIP_OK
)

1698 
îr
 = 
	`add_d©a_ö_d©ablock
(&
zi
->
˚¡øl_dú
, zi->
ci
.
˚¡øl_hódî
, (
uL⁄g
)zi->ci.
size_˚¡ølhódî
);

1700 
	`‰ì
(
zi
->
ci
.
˚¡øl_hódî
);

1702 i‡(
îr
==
ZIP_OK
)

1706 
ZPOS64_T
 
cur_pos_özù
 = 
	`ZTELL64
(
zi
->
z_fûefunc
,zi->
fûe°ªam
);

1708 i‡(
	`ZSEEK64
(
zi
->
z_fûefunc
,zi->
fûe°ªam
, zi->
ci
.
pos_loˇl_hódî
 + 14,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

1709 
îr
 = 
ZIP_ERRNO
;

1711 i‡(
îr
==
ZIP_OK
)

1712 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,
¸c32
,4);

1714 if(
uncom¥es£d_size
 >0xfffffff‡|| 
com¥es£d_size
 >= 0xffffffff )

1716 if(
zi
->
ci
.
pos_zù64exåaöfo
 > 0)

1719 i‡(
	`ZSEEK64
(
zi
->
z_fûefunc
,zi->
fûe°ªam
, zi->
ci
.
pos_zù64exåaöfo
 + 4,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

1720 
îr
 = 
ZIP_ERRNO
;

1722 i‡(
îr
==
ZIP_OK
)

1723 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
, zi->
fûe°ªam
, 
uncom¥es£d_size
, 8);

1725 i‡(
îr
==
ZIP_OK
)

1726 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
, zi->
fûe°ªam
, 
com¥es£d_size
, 8);

1729 
îr
 = 
ZIP_BADZIPFILE
;

1733 i‡(
îr
==
ZIP_OK
)

1734 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,
com¥es£d_size
,4);

1736 i‡(
îr
==
ZIP_OK
)

1737 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,
uncom¥es£d_size
,4);

1740 i‡(
	`ZSEEK64
(
zi
->
z_fûefunc
,zi->
fûe°ªam
, 
cur_pos_özù
,
ZLIB_FILEFUNC_SEEK_SET
)!=0)

1741 
îr
 = 
ZIP_ERRNO
;

1744 
zi
->
numbî_íåy
 ++;

1745 
zi
->
ö_›íed_fûe_özù
 = 0;

1747  
îr
;

1748 
	}
}

1750 
ZEXPORT
 
	$zùClo£FûeInZù
 (
zùFûe
 
fûe
)

1752  
	`zùClo£FûeInZùRaw
 (
fûe
,0,0);

1753 
	}
}

1755 
	$Wrôe_Zù64EndOfCíåÆDúe˘‹yLoˇt‹
(
zù64_öã∫Æ
* 
zi
, 
ZPOS64_T
 
zù64eocd_pos_özù
)

1757 
îr
 = 
ZIP_OK
;

1758 
ZPOS64_T
 
pos
 = 
zù64eocd_pos_özù
 - 
zi
->
add_posôi⁄_whí_wrôtög_off£t
;

1760 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)
ZIP64ENDLOCHEADERMAGIC
,4);

1763 i‡(
îr
==
ZIP_OK
)

1764 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)0,4);

1767 i‡(
îr
==
ZIP_OK
)

1768 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
, 
pos
,8);

1771 i‡(
îr
==
ZIP_OK
)

1772 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)1,4);

1774  
îr
;

1775 
	}
}

1777 
	$Wrôe_Zù64EndOfCíåÆDúe˘‹yRec‹d
(
zù64_öã∫Æ
* 
zi
, 
uL⁄g
 
size_˚¡øldú
, 
ZPOS64_T
 
˚¡øldú_pos_özù
)

1779 
îr
 = 
ZIP_OK
;

1781 
uL⁄g
 
Zù64D©aSize
 = 44;

1783 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)
ZIP64ENDHEADERMAGIC
,4);

1785 i‡(
îr
==
ZIP_OK
)

1786 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
ZPOS64_T
)
Zù64D©aSize
,8);

1788 i‡(
îr
==
ZIP_OK
)

1789 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)45,2);

1791 i‡(
îr
==
ZIP_OK
)

1792 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)45,2);

1794 i‡(
îr
==
ZIP_OK
)

1795 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)0,4);

1797 i‡(
îr
==
ZIP_OK
)

1798 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)0,4);

1800 i‡(
îr
==
ZIP_OK
)

1801 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
, zi->
fûe°ªam
, zi->
numbî_íåy
, 8);

1803 i‡(
îr
==
ZIP_OK
)

1804 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
, zi->
fûe°ªam
, zi->
numbî_íåy
, 8);

1806 i‡(
îr
==
ZIP_OK
)

1807 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
ZPOS64_T
)
size_˚¡øldú
,8);

1809 i‡(
îr
==
ZIP_OK
)

1811 
ZPOS64_T
 
pos
 = 
˚¡øldú_pos_özù
 - 
zi
->
add_posôi⁄_whí_wrôtög_off£t
;

1812 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
, (
ZPOS64_T
)
pos
,8);

1814  
îr
;

1815 
	}
}

1816 
	$Wrôe_EndOfCíåÆDúe˘‹yRec‹d
(
zù64_öã∫Æ
* 
zi
, 
uL⁄g
 
size_˚¡øldú
, 
ZPOS64_T
 
˚¡øldú_pos_özù
)

1818 
îr
 = 
ZIP_OK
;

1821 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)
ENDHEADERMAGIC
,4);

1823 i‡(
îr
==
ZIP_OK
)

1824 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)0,2);

1826 i‡(
îr
==
ZIP_OK
)

1827 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)0,2);

1829 i‡(
îr
==
ZIP_OK
)

1832 if(
zi
->
numbî_íåy
 >= 0xFFFF)

1833 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)0xffff,2);

1835 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)zi->
numbî_íåy
,2);

1839 i‡(
îr
==
ZIP_OK
)

1841 if(
zi
->
numbî_íåy
 >= 0xFFFF)

1842 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)0xffff,2);

1844 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)zi->
numbî_íåy
,2);

1847 i‡(
îr
==
ZIP_OK
)

1848 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)
size_˚¡øldú
,4);

1850 i‡(
îr
==
ZIP_OK
)

1852 
ZPOS64_T
 
pos
 = 
˚¡øldú_pos_özù
 - 
zi
->
add_posôi⁄_whí_wrôtög_off£t
;

1853 if(
pos
 >= 0xffffffff)

1855 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
, (
uL⁄g
)0xffffffff,4);

1858 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
, (
uL⁄g
)(
˚¡øldú_pos_özù
 - zi->
add_posôi⁄_whí_wrôtög_off£t
),4);

1861  
îr
;

1862 
	}
}

1864 
	$Wrôe_GlobÆCommít
(
zù64_öã∫Æ
* 
zi
, c⁄° * 
globÆ_commít
)

1866 
îr
 = 
ZIP_OK
;

1867 
uI¡
 
size_globÆ_commít
 = 0;

1869 if(
globÆ_commít
 !
NULL
)

1870 
size_globÆ_commít
 = (
uI¡
)
	`°æí
(
globÆ_commít
);

1872 
îr
 = 
	`zù64loˇl_putVÆue
(&
zi
->
z_fûefunc
,zi->
fûe°ªam
,(
uL⁄g
)
size_globÆ_commít
,2);

1874 i‡(
îr
 =
ZIP_OK
 && 
size_globÆ_commít
 > 0)

1876 i‡(
	`ZWRITE64
(
zi
->
z_fûefunc
,zi->
fûe°ªam
, 
globÆ_commít
, 
size_globÆ_commít
) != size_global_comment)

1877 
îr
 = 
ZIP_ERRNO
;

1879  
îr
;

1880 
	}
}

1882 
ZEXPORT
 
	$zùClo£
 (
zùFûe
 
fûe
, c⁄° * 
globÆ_commít
)

1884 
zù64_öã∫Æ
* 
zi
;

1885 
îr
 = 0;

1886 
uL⁄g
 
size_˚¡øldú
 = 0;

1887 
ZPOS64_T
 
˚¡øldú_pos_özù
;

1888 
ZPOS64_T
 
pos
;

1890 i‡(
fûe
 =
NULL
)

1891  
ZIP_PARAMERROR
;

1893 
zi
 = (
zù64_öã∫Æ
*)
fûe
;

1895 i‡(
zi
->
ö_›íed_fûe_özù
 == 1)

1897 
îr
 = 
	`zùClo£FûeInZù
 (
fûe
);

1900 #i‚de‡
NO_ADDFILEINEXISTINGZIP


1901 i‡(
globÆ_commít
==
NULL
)

1902 
globÆ_commít
 = 
zi
->
globÆcommít
;

1905 
˚¡øldú_pos_özù
 = 
	`ZTELL64
(
zi
->
z_fûefunc
,zi->
fûe°ªam
);

1907 i‡(
îr
==
ZIP_OK
)

1909 
lökedli°_d©ablock_öã∫Æ
* 
ldi
 = 
zi
->
˚¡øl_dú
.
fú°_block
;

1910 
ldi
!=
NULL
)

1912 i‡((
îr
==
ZIP_OK
Ë&& (
ldi
->
fûÀd_ö_this_block
>0))

1914 i‡(
	`ZWRITE64
(
zi
->
z_fûefunc
,zi->
fûe°ªam
, 
ldi
->
d©a
,Üdi->
fûÀd_ö_this_block
) !=Üdi->filled_in_this_block)

1915 
îr
 = 
ZIP_ERRNO
;

1918 
size_˚¡øldú
 +
ldi
->
fûÀd_ö_this_block
;

1919 
ldi
 =Üdi->
√xt_d©ablock
;

1922 
	`‰ì_lökedli°
(&(
zi
->
˚¡øl_dú
));

1924 
pos
 = 
˚¡øldú_pos_özù
 - 
zi
->
add_posôi⁄_whí_wrôtög_off£t
;

1925 if(
pos
 >0xfffffff‡|| 
zi
->
numbî_íåy
 > 0xFFFF)

1927 
ZPOS64_T
 
Zù64EOCDpos
 = 
	`ZTELL64
(
zi
->
z_fûefunc
,zi->
fûe°ªam
);

1928 
	`Wrôe_Zù64EndOfCíåÆDúe˘‹yRec‹d
(
zi
, 
size_˚¡øldú
, 
˚¡øldú_pos_özù
);

1930 
	`Wrôe_Zù64EndOfCíåÆDúe˘‹yLoˇt‹
(
zi
, 
Zù64EOCDpos
);

1933 i‡(
îr
==
ZIP_OK
)

1934 
îr
 = 
	`Wrôe_EndOfCíåÆDúe˘‹yRec‹d
(
zi
, 
size_˚¡øldú
, 
˚¡øldú_pos_özù
);

1936 if(
îr
 =
ZIP_OK
)

1937 
îr
 = 
	`Wrôe_GlobÆCommít
(
zi
, 
globÆ_commít
);

1939 i‡(
	`ZCLOSE64
(
zi
->
z_fûefunc
,zi->
fûe°ªam
) != 0)

1940 i‡(
îr
 =
ZIP_OK
)

1941 
îr
 = 
ZIP_ERRNO
;

1943 #i‚de‡
NO_ADDFILEINEXISTINGZIP


1944 
	`TRYFREE
(
zi
->
globÆcommít
);

1946 
	`TRYFREE
(
zi
);

1948  
îr
;

1949 
	}
}

1951 
ZEXPORT
 
	$zùRemoveExåaInfoBlock
 (* 
pD©a
, * 
d©aLí
, 
sHódî
)

1953 * 
p
 = 
pD©a
;

1954 
size
 = 0;

1955 * 
pNewHódî
;

1956 * 
pTmp
;

1957 
hódî
;

1958 
d©aSize
;

1960 
ªtVÆ
 = 
ZIP_OK
;

1962 if(
pD©a
 =
NULL
 || *
d©aLí
 < 4)

1963  
ZIP_PARAMERROR
;

1965 
pNewHódî
 = (*)
	`ALLOC
(*
d©aLí
);

1966 
pTmp
 = 
pNewHódî
;

1968 
p
 < (
pD©a
 + *
d©aLí
))

1970 
hódî
 = *(*)
p
;

1971 
d©aSize
 = *(((*)
p
)+1);

1973 if–
hódî
 =
sHódî
 )

1975 
p
 +
d©aSize
 + 4;

1980 
	`mem˝y
(
pTmp
, 
p
, 
d©aSize
 + 4);

1981 
p
 +
d©aSize
 + 4;

1982 
size
 +
d©aSize
 + 4;

1987 if(
size
 < *
d©aLí
)

1990 
	`mem£t
(
pD©a
,0, *
d©aLí
);

1993 if(
size
 > 0)

1994 
	`mem˝y
(
pD©a
, 
pNewHódî
, 
size
);

1997 *
d©aLí
 = 
size
;

1999 
ªtVÆ
 = 
ZIP_OK
;

2002 
ªtVÆ
 = 
ZIP_ERRNO
;

2004 
	`TRYFREE
(
pNewHódî
);

2006  
ªtVÆ
;

2007 
	}
}

	@zlib-1.2.8/contrib/minizip/zip.h

40 #i‚de‡
_zù12_H


41 
	#_zù12_H


	)

43 #ifde‡
__˝lu•lus


49 #i‚de‡
_ZLIB_H


50 
	~"zlib.h
"

53 #i‚de‡
_ZLIBIOAPI_H


54 
	~"iﬂpi.h
"

57 #ifde‡
HAVE_BZIP2


58 
	~"bzlib.h
"

61 
	#Z_BZIP2ED
 12

	)

63 #i‡
deföed
(
STRICTZIP
Ë|| deföed(
STRICTZIPUNZIP
)

66 
	sTagzùFûe__
 { 
unu£d
; } 
	tzùFûe__
;

67 
zùFûe__
 *
	tzùFûe
;

69 
voidp
 
	tzùFûe
;

72 
	#ZIP_OK
 (0)

	)

73 
	#ZIP_EOF
 (0)

	)

74 
	#ZIP_ERRNO
 (
Z_ERRNO
)

	)

75 
	#ZIP_PARAMERROR
 (-102)

	)

76 
	#ZIP_BADZIPFILE
 (-103)

	)

77 
	#ZIP_INTERNALERROR
 (-104)

	)

79 #i‚de‡
DEF_MEM_LEVEL


80 #i‡
MAX_MEM_LEVEL
 >= 8

81 
	#DEF_MEM_LEVEL
 8

	)

83 
	#DEF_MEM_LEVEL
 
MAX_MEM_LEVEL


	)

89 
	stm_zù_s


91 
uI¡
 
tm_£c
;

92 
uI¡
 
tm_mö
;

93 
uI¡
 
tm_hour
;

94 
uI¡
 
tm_mday
;

95 
uI¡
 
tm_m⁄
;

96 
uI¡
 
tm_yór
;

97 } 
	ttm_zù
;

101 
tm_zù
 
tmz_d©e
;

102 
uL⁄g
 
dosD©e
;

105 
uL⁄g
 
öã∫Æ_Á
;

106 
uL⁄g
 
exã∫Æ_Á
;

107 } 
	tzù_fûeöfo
;

109 c⁄° * 
	tzùch¨pc
;

112 
	#APPEND_STATUS_CREATE
 (0)

	)

113 
	#APPEND_STATUS_CREATEAFTER
 (1)

	)

114 
	#APPEND_STATUS_ADDINZIP
 (2)

	)

116 
zùFûe
 
ZEXPORT
 
zùO≥n
 
OF
((c⁄° *
∑th«me
, 
≠≥nd
));

117 
zùFûe
 
ZEXPORT
 
zùO≥n64
 
OF
((c⁄° *
∑th«me
, 
≠≥nd
));

137 
zùFûe
 
ZEXPORT
 
zùO≥n2
 
OF
((c⁄° *
∑th«me
,

138 
≠≥nd
,

139 
zùch¨pc
* 
globÆcommít
,

140 
zlib_fûefunc_def
* 
pzlib_fûefunc_def
));

142 
zùFûe
 
ZEXPORT
 
zùO≥n2_64
 
OF
((c⁄° *
∑th«me
,

143 
≠≥nd
,

144 
zùch¨pc
* 
globÆcommít
,

145 
zlib_fûefunc64_def
* 
pzlib_fûefunc_def
));

147 
ZEXPORT
 
zùO≥nNewFûeInZù
 
OF
((
zùFûe
 
fûe
,

148 c⁄° * 
fûíame
,

149 c⁄° 
zù_fûeöfo
* 
zùfi
,

150 c⁄° * 
exåafõld_loˇl
,

151 
uI¡
 
size_exåafõld_loˇl
,

152 c⁄° * 
exåafõld_globÆ
,

153 
uI¡
 
size_exåafõld_globÆ
,

154 c⁄° * 
commít
,

155 
mëhod
,

156 
Àvñ
));

158 
ZEXPORT
 
zùO≥nNewFûeInZù64
 
OF
((
zùFûe
 
fûe
,

159 c⁄° * 
fûíame
,

160 c⁄° 
zù_fûeöfo
* 
zùfi
,

161 c⁄° * 
exåafõld_loˇl
,

162 
uI¡
 
size_exåafõld_loˇl
,

163 c⁄° * 
exåafõld_globÆ
,

164 
uI¡
 
size_exåafõld_globÆ
,

165 c⁄° * 
commít
,

166 
mëhod
,

167 
Àvñ
,

168 
zù64
));

187 
ZEXPORT
 
zùO≥nNewFûeInZù2
 
OF
((
zùFûe
 
fûe
,

188 c⁄° * 
fûíame
,

189 c⁄° 
zù_fûeöfo
* 
zùfi
,

190 c⁄° * 
exåafõld_loˇl
,

191 
uI¡
 
size_exåafõld_loˇl
,

192 c⁄° * 
exåafõld_globÆ
,

193 
uI¡
 
size_exåafõld_globÆ
,

194 c⁄° * 
commít
,

195 
mëhod
,

196 
Àvñ
,

197 
øw
));

200 
ZEXPORT
 
zùO≥nNewFûeInZù2_64
 
OF
((
zùFûe
 
fûe
,

201 c⁄° * 
fûíame
,

202 c⁄° 
zù_fûeöfo
* 
zùfi
,

203 c⁄° * 
exåafõld_loˇl
,

204 
uI¡
 
size_exåafõld_loˇl
,

205 c⁄° * 
exåafõld_globÆ
,

206 
uI¡
 
size_exåafõld_globÆ
,

207 c⁄° * 
commít
,

208 
mëhod
,

209 
Àvñ
,

210 
øw
,

211 
zù64
));

216 
ZEXPORT
 
zùO≥nNewFûeInZù3
 
OF
((
zùFûe
 
fûe
,

217 c⁄° * 
fûíame
,

218 c⁄° 
zù_fûeöfo
* 
zùfi
,

219 c⁄° * 
exåafõld_loˇl
,

220 
uI¡
 
size_exåafõld_loˇl
,

221 c⁄° * 
exåafõld_globÆ
,

222 
uI¡
 
size_exåafõld_globÆ
,

223 c⁄° * 
commít
,

224 
mëhod
,

225 
Àvñ
,

226 
øw
,

227 
wödowBôs
,

228 
memLevñ
,

229 
°øãgy
,

230 c⁄° * 
∑ssw‹d
,

231 
uL⁄g
 
¸cF‹Cry±ög
));

233 
ZEXPORT
 
zùO≥nNewFûeInZù3_64
 
OF
((
zùFûe
 
fûe
,

234 c⁄° * 
fûíame
,

235 c⁄° 
zù_fûeöfo
* 
zùfi
,

236 c⁄° * 
exåafõld_loˇl
,

237 
uI¡
 
size_exåafõld_loˇl
,

238 c⁄° * 
exåafõld_globÆ
,

239 
uI¡
 
size_exåafõld_globÆ
,

240 c⁄° * 
commít
,

241 
mëhod
,

242 
Àvñ
,

243 
øw
,

244 
wödowBôs
,

245 
memLevñ
,

246 
°øãgy
,

247 c⁄° * 
∑ssw‹d
,

248 
uL⁄g
 
¸cF‹Cry±ög
,

249 
zù64


259 
ZEXPORT
 
zùO≥nNewFûeInZù4
 
OF
((
zùFûe
 
fûe
,

260 c⁄° * 
fûíame
,

261 c⁄° 
zù_fûeöfo
* 
zùfi
,

262 c⁄° * 
exåafõld_loˇl
,

263 
uI¡
 
size_exåafõld_loˇl
,

264 c⁄° * 
exåafõld_globÆ
,

265 
uI¡
 
size_exåafõld_globÆ
,

266 c⁄° * 
commít
,

267 
mëhod
,

268 
Àvñ
,

269 
øw
,

270 
wödowBôs
,

271 
memLevñ
,

272 
°øãgy
,

273 c⁄° * 
∑ssw‹d
,

274 
uL⁄g
 
¸cF‹Cry±ög
,

275 
uL⁄g
 
vîsi⁄MadeBy
,

276 
uL⁄g
 
ÊagBa£


280 
ZEXPORT
 
zùO≥nNewFûeInZù4_64
 
OF
((
zùFûe
 
fûe
,

281 c⁄° * 
fûíame
,

282 c⁄° 
zù_fûeöfo
* 
zùfi
,

283 c⁄° * 
exåafõld_loˇl
,

284 
uI¡
 
size_exåafõld_loˇl
,

285 c⁄° * 
exåafõld_globÆ
,

286 
uI¡
 
size_exåafõld_globÆ
,

287 c⁄° * 
commít
,

288 
mëhod
,

289 
Àvñ
,

290 
øw
,

291 
wödowBôs
,

292 
memLevñ
,

293 
°øãgy
,

294 c⁄° * 
∑ssw‹d
,

295 
uL⁄g
 
¸cF‹Cry±ög
,

296 
uL⁄g
 
vîsi⁄MadeBy
,

297 
uL⁄g
 
ÊagBa£
,

298 
zù64


307 
ZEXPORT
 
zùWrôeInFûeInZù
 
OF
((
zùFûe
 
fûe
,

308 c⁄° * 
buf
,

309 
Àn
));

314 
ZEXPORT
 
zùClo£FûeInZù
 
OF
((
zùFûe
 
fûe
));

319 
ZEXPORT
 
zùClo£FûeInZùRaw
 
OF
((
zùFûe
 
fûe
,

320 
uL⁄g
 
uncom¥es£d_size
,

321 
uL⁄g
 
¸c32
));

323 
ZEXPORT
 
zùClo£FûeInZùRaw64
 
OF
((
zùFûe
 
fûe
,

324 
ZPOS64_T
 
uncom¥es£d_size
,

325 
uL⁄g
 
¸c32
));

333 
ZEXPORT
 
zùClo£
 
OF
((
zùFûe
 
fûe
,

334 c⁄° * 
globÆ_commít
));

340 
ZEXPORT
 
zùRemoveExåaInfoBlock
 
OF
((* 
pD©a
, * 
d©aLí
, 
sHódî
));

358 #ifde‡
__˝lu•lus


	@zlib-1.2.8/contrib/puff/puff.c

82 
	~<£tjmp.h
>

83 
	~"puff.h
"

85 
	#loˇl
 

	)

91 
	#MAXBITS
 15

	)

92 
	#MAXLCODES
 286

	)

93 
	#MAXDCODES
 30

	)

94 
	#MAXCODES
 (
MAXLCODES
+
MAXDCODES
Ë

	)

95 
	#FIXLCODES
 288

	)

98 
	s°©e
 {

100 *
	mout
;

101 
	mouéí
;

102 
	mout˙t
;

105 c⁄° *
	mö
;

106 
	möÀn
;

107 
	mö˙t
;

108 
	mbôbuf
;

109 
	mbô˙t
;

112 
jmp_buf
 
	mív
;

126 
loˇl
 
	$bôs
(
°©e
 *
s
, 
√ed
)

128 
vÆ
;

131 
vÆ
 = 
s
->
bôbuf
;

132 
s
->
bô˙t
 < 
√ed
) {

133 i‡(
s
->
ö˙t
 =s->
öÀn
)

134 
	`l⁄gjmp
(
s
->
ív
, 1);

135 
vÆ
 |()(
s
->
ö
[s->
ö˙t
++]Ë<< s->
bô˙t
;

136 
s
->
bô˙t
 += 8;

140 
s
->
bôbuf
 = ()(
vÆ
 >> 
√ed
);

141 
s
->
bô˙t
 -
√ed
;

144  ()(
vÆ
 & ((1L << 
√ed
) - 1));

145 
	}
}

164 
loˇl
 
	$°‹ed
(
°©e
 *
s
)

166 
Àn
;

169 
s
->
bôbuf
 = 0;

170 
s
->
bô˙t
 = 0;

173 i‡(
s
->
ö˙t
 + 4 > s->
öÀn
)

175 
Àn
 = 
s
->
ö
[s->
ö˙t
++];

176 
Àn
 |
s
->
ö
[s->
ö˙t
++] << 8;

177 i‡(
s
->
ö
[s->
ö˙t
++] !(~
Àn
 & 0xff) ||

178 
s
->
ö
[s->
ö˙t
++] !((~
Àn
 >> 8) & 0xff))

182 i‡(
s
->
ö˙t
 + 
Àn
 > s->
öÀn
)

184 i‡(
s
->
out
 !
NIL
) {

185 i‡(
s
->
out˙t
 + 
Àn
 > s->
ouéí
)

187 
Àn
--)

188 
s
->
out
[s->
out˙t
++] = s->
ö
[s->
ö˙t
++];

191 
s
->
out˙t
 +
Àn
;

192 
s
->
ö˙t
 +
Àn
;

197 
	}
}

206 
	shuffm™
 {

207 *
	mcou¡
;

208 *
	msymbﬁ
;

234 #ifde‡
SLOW


235 
loˇl
 
	$decode
(
°©e
 *
s
, c⁄° 
huffm™
 *
h
)

237 
Àn
;

238 
code
;

239 
fú°
;

240 
cou¡
;

241 
ödex
;

243 
code
 = 
fú°
 = 
ödex
 = 0;

244 
Àn
 = 1;Üí <
MAXBITS
;Üen++) {

245 
code
 |
	`bôs
(
s
, 1);

246 
cou¡
 = 
h
->cou¡[
Àn
];

247 i‡(
code
 - 
cou¡
 < 
fú°
)

248  
h
->
symbﬁ
[
ödex
 + (
code
 - 
fú°
)];

249 
ödex
 +
cou¡
;

250 
fú°
 +
cou¡
;

251 
fú°
 <<= 1;

252 
code
 <<= 1;

255 
	}
}

263 
loˇl
 
	$decode
(
°©e
 *
s
, c⁄° 
huffm™
 *
h
)

265 
Àn
;

266 
code
;

267 
fú°
;

268 
cou¡
;

269 
ödex
;

270 
bôbuf
;

271 
À·
;

272 *
√xt
;

274 
bôbuf
 = 
s
->bitbuf;

275 
À·
 = 
s
->
bô˙t
;

276 
code
 = 
fú°
 = 
ödex
 = 0;

277 
Àn
 = 1;

278 
√xt
 = 
h
->
cou¡
 + 1;

280 
À·
--) {

281 
code
 |
bôbuf
 & 1;

282 
bôbuf
 >>= 1;

283 
cou¡
 = *
√xt
++;

284 i‡(
code
 - 
cou¡
 < 
fú°
) {

285 
s
->
bôbuf
 = bitbuf;

286 
s
->
bô˙t
 = (s->bô˙à- 
Àn
) & 7;

287  
h
->
symbﬁ
[
ödex
 + (
code
 - 
fú°
)];

289 
ödex
 +
cou¡
;

290 
fú°
 +
cou¡
;

291 
fú°
 <<= 1;

292 
code
 <<= 1;

293 
Àn
++;

295 
À·
 = (
MAXBITS
+1Ë- 
Àn
;

296 i‡(
À·
 == 0)

298 i‡(
s
->
ö˙t
 =s->
öÀn
)

299 
	`l⁄gjmp
(
s
->
ív
, 1);

300 
bôbuf
 = 
s
->
ö
[s->
ö˙t
++];

301 i‡(
À·
 > 8)

302 
À·
 = 8;

305 
	}
}

340 
loˇl
 
	$c⁄°ru˘
(
huffm™
 *
h
, c⁄° *
Àngth
, 
n
)

342 
symbﬁ
;

343 
Àn
;

344 
À·
;

345 
offs
[
MAXBITS
+1];

348 
Àn
 = 0;Üí <
MAXBITS
;Üen++)

349 
h
->
cou¡
[
Àn
] = 0;

350 
symbﬁ
 = 0; symbﬁ < 
n
; symbol++)

351 (
h
->
cou¡
[
Àngth
[
symbﬁ
]])++;

352 i‡(
h
->
cou¡
[0] =
n
)

356 
À·
 = 1;

357 
Àn
 = 1;Üí <
MAXBITS
;Üen++) {

358 
À·
 <<= 1;

359 
À·
 -
h
->
cou¡
[
Àn
];

360 i‡(
À·
 < 0)

361  
À·
;

365 
offs
[1] = 0;

366 
Àn
 = 1;Üí < 
MAXBITS
;Üen++)

367 
offs
[
Àn
 + 1] = offs[Àn] + 
h
->
cou¡
[len];

373 
symbﬁ
 = 0; symbﬁ < 
n
; symbol++)

374 i‡(
Àngth
[
symbﬁ
] != 0)

375 
h
->
symbﬁ
[
offs
[
Àngth
[symbol]]++] = symbol;

378  
À·
;

379 
	}
}

436 
loˇl
 
	$codes
(
°©e
 *
s
,

437 c⁄° 
huffm™
 *
Àncode
,

438 c⁄° 
huffm™
 *
di°code
)

440 
symbﬁ
;

441 
Àn
;

442 
di°
;

443 c⁄° 
Àns
[29] = {

446 c⁄° 
Àxt
[29] = {

449 c⁄° 
di°s
[30] = {

453 c⁄° 
dext
[30] = {

460 
symbﬁ
 = 
	`decode
(
s
, 
Àncode
);

461 i‡(
symbﬁ
 < 0)

462  
symbﬁ
;

463 i‡(
symbﬁ
 < 256) {

465 i‡(
s
->
out
 !
NIL
) {

466 i‡(
s
->
out˙t
 =s->
ouéí
)

468 
s
->
out
[s->
out˙t
] = 
symbﬁ
;

470 
s
->
out˙t
++;

472 i‡(
symbﬁ
 > 256) {

474 
symbﬁ
 -= 257;

475 i‡(
symbﬁ
 >= 29)

477 
Àn
 = 
Àns
[
symbﬁ
] + 
	`bôs
(
s
, 
Àxt
[symbol]);

480 
symbﬁ
 = 
	`decode
(
s
, 
di°code
);

481 i‡(
symbﬁ
 < 0)

482  
symbﬁ
;

483 
di°
 = 
di°s
[
symbﬁ
] + 
	`bôs
(
s
, 
dext
[symbol]);

484 #i‚de‡
INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR


485 i‡(
di°
 > 
s
->
out˙t
)

490 i‡(
s
->
out
 !
NIL
) {

491 i‡(
s
->
out˙t
 + 
Àn
 > s->
ouéí
)

493 
Àn
--) {

494 
s
->
out
[s->
out˙t
] =

495 #ifde‡
INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR


496 
di°
 > 
s
->
out˙t
 ?

499 
s
->
out
[s->
out˙t
 - 
di°
];

500 
s
->
out˙t
++;

504 
s
->
out˙t
 +
Àn
;

506 } 
symbﬁ
 != 256);

510 
	}
}

536 
loˇl
 
	$fixed
(
°©e
 *
s
)

538 
vúgö
 = 1;

539 
Àn˙t
[
MAXBITS
+1], 
Ànsym
[
FIXLCODES
];

540 
di°˙t
[
MAXBITS
+1], 
di°sym
[
MAXDCODES
];

541 
huffm™
 
Àncode
, 
di°code
;

544 i‡(
vúgö
) {

545 
symbﬁ
;

546 
Àngths
[
FIXLCODES
];

549 
Àncode
.
cou¡
 = 
Àn˙t
;

550 
Àncode
.
symbﬁ
 = 
Ànsym
;

551 
di°code
.
cou¡
 = 
di°˙t
;

552 
di°code
.
symbﬁ
 = 
di°sym
;

555 
symbﬁ
 = 0; symbol < 144; symbol++)

556 
Àngths
[
symbﬁ
] = 8;

557 ; 
symbﬁ
 < 256; symbol++)

558 
Àngths
[
symbﬁ
] = 9;

559 ; 
symbﬁ
 < 280; symbol++)

560 
Àngths
[
symbﬁ
] = 7;

561 ; 
symbﬁ
 < 
FIXLCODES
; symbol++)

562 
Àngths
[
symbﬁ
] = 8;

563 
	`c⁄°ru˘
(&
Àncode
, 
Àngths
, 
FIXLCODES
);

566 
symbﬁ
 = 0; symbﬁ < 
MAXDCODES
; symbol++)

567 
Àngths
[
symbﬁ
] = 5;

568 
	`c⁄°ru˘
(&
di°code
, 
Àngths
, 
MAXDCODES
);

571 
vúgö
 = 0;

575  
	`codes
(
s
, &
Àncode
, &
di°code
);

576 
	}
}

665 
loˇl
 
	$dy«mic
(
°©e
 *
s
)

667 
∆í
, 
ndi°
, 
ncode
;

668 
ödex
;

669 
îr
;

670 
Àngths
[
MAXCODES
];

671 
Àn˙t
[
MAXBITS
+1], 
Ànsym
[
MAXLCODES
];

672 
di°˙t
[
MAXBITS
+1], 
di°sym
[
MAXDCODES
];

673 
huffm™
 
Àncode
, 
di°code
;

674 c⁄° 
‹dî
[19] =

678 
Àncode
.
cou¡
 = 
Àn˙t
;

679 
Àncode
.
symbﬁ
 = 
Ànsym
;

680 
di°code
.
cou¡
 = 
di°˙t
;

681 
di°code
.
symbﬁ
 = 
di°sym
;

684 
∆í
 = 
	`bôs
(
s
, 5) + 257;

685 
ndi°
 = 
	`bôs
(
s
, 5) + 1;

686 
ncode
 = 
	`bôs
(
s
, 4) + 4;

687 i‡(
∆í
 > 
MAXLCODES
 || 
ndi°
 > 
MAXDCODES
)

691 
ödex
 = 0; index < 
ncode
; index++)

692 
Àngths
[
‹dî
[
ödex
]] = 
	`bôs
(
s
, 3);

693 ; 
ödex
 < 19; index++)

694 
Àngths
[
‹dî
[
ödex
]] = 0;

697 
îr
 = 
	`c⁄°ru˘
(&
Àncode
, 
Àngths
, 19);

698 i‡(
îr
 != 0)

702 
ödex
 = 0;

703 
ödex
 < 
∆í
 + 
ndi°
) {

704 
symbﬁ
;

705 
Àn
;

707 
symbﬁ
 = 
	`decode
(
s
, &
Àncode
);

708 i‡(
symbﬁ
 < 0)

709  
symbﬁ
;

710 i‡(
symbﬁ
 < 16)

711 
Àngths
[
ödex
++] = 
symbﬁ
;

713 
Àn
 = 0;

714 i‡(
symbﬁ
 == 16) {

715 i‡(
ödex
 == 0)

717 
Àn
 = 
Àngths
[
ödex
 - 1];

718 
symbﬁ
 = 3 + 
	`bôs
(
s
, 2);

720 i‡(
symbﬁ
 == 17)

721 
symbﬁ
 = 3 + 
	`bôs
(
s
, 3);

723 
symbﬁ
 = 11 + 
	`bôs
(
s
, 7);

724 i‡(
ödex
 + 
symbﬁ
 > 
∆í
 + 
ndi°
)

726 
symbﬁ
--)

727 
Àngths
[
ödex
++] = 
Àn
;

732 i‡(
Àngths
[256] == 0)

736 
îr
 = 
	`c⁄°ru˘
(&
Àncode
, 
Àngths
, 
∆í
);

737 i‡(
îr
 && (î∏< 0 || 
∆í
 !
Àncode
.
cou¡
[0] +Üencode.count[1]))

741 
îr
 = 
	`c⁄°ru˘
(&
di°code
, 
Àngths
 + 
∆í
, 
ndi°
);

742 i‡(
îr
 && (î∏< 0 || 
ndi°
 !
di°code
.
cou¡
[0] + distcode.count[1]))

746  
	`codes
(
s
, &
Àncode
, &
di°code
);

747 
	}
}

793 
	$puff
(*
de°
,

794 *
de°Àn
,

795 c⁄° *
sour˚
,

796 *
sour˚Àn
)

798 
°©e
 
s
;

799 
œ°
, 
ty≥
;

800 
îr
;

803 
s
.
out
 = 
de°
;

804 
s
.
ouéí
 = *
de°Àn
;

805 
s
.
out˙t
 = 0;

808 
s
.
ö
 = 
sour˚
;

809 
s
.
öÀn
 = *
sour˚Àn
;

810 
s
.
ö˙t
 = 0;

811 
s
.
bôbuf
 = 0;

812 
s
.
bô˙t
 = 0;

815 i‡(
	`£tjmp
(
s
.
ív
) != 0)

816 
îr
 = 2;

820 
œ°
 = 
	`bôs
(&
s
, 1);

821 
ty≥
 = 
	`bôs
(&
s
, 2);

822 
îr
 = 
ty≥
 == 0 ?

823 
	`°‹ed
(&
s
) :

824 (
ty≥
 == 1 ?

825 
	`fixed
(&
s
) :

826 (
ty≥
 == 2 ?

827 
	`dy«mic
(&
s
) :

829 i‡(
îr
 != 0)

831 } !
œ°
);

835 i‡(
îr
 <= 0) {

836 *
de°Àn
 = 
s
.
out˙t
;

837 *
sour˚Àn
 = 
s
.
ö˙t
;

839  
îr
;

840 
	}
}

	@zlib-1.2.8/contrib/puff/puff.h

28 #i‚de‡
NIL


29 
	#NIL
 ((*)0Ë

	)

32 
puff
(*
de°
,

33 *
de°Àn
,

34 c⁄° *
sour˚
,

35 *
sour˚Àn
);

	@zlib-1.2.8/contrib/puff/pufftest.c

19 
	~<°dio.h
>

20 
	~<°dlib.h
>

21 
	~"puff.h
"

23 #i‡
deföed
(
MSDOS
Ë|| deföed(
OS2
Ë|| deföed(
WIN32
Ë|| deföed(
__CYGWIN__
)

24 
	~<f˙é.h
>

25 
	~<io.h
>

26 
	#SET_BINARY_MODE
(
fûe
Ë
	`£tmode
(
	`fûío
(fûe), 
O_BINARY
)

	)

28 
	#SET_BINARY_MODE
(
fûe
)

	)

31 
	#loˇl
 

	)

37 
loˇl
 
size_t
 
	$bythúds
(
size_t
 
size
)

39 
n
;

40 
size_t
 
m
;

42 
m
 = 
size
;

43 
n
 = 0; 
m
;Ç++)

44 
m
 >>= 1;

45 i‡(
n
 < 3)

46  
size
 + 1;

47 
n
 -= 3;

48 
m
 = 
size
 >> 
n
;

49 
m
 += m == 6 ? 2 : 1;

50 
m
 <<
n
;

51  
m
 > 
size
 ? m : (
size_t
)(-1);

52 
	}
}

60 
loˇl
 *
	$lﬂd
(c⁄° *
«me
, 
size_t
 *
Àn
)

62 
size_t
 
size
;

63 *
buf
, *
sw≠
;

64 
FILE
 *
ö
;

66 *
Àn
 = 0;

67 
buf
 = 
	`mÆloc
(
size
 = 4096);

68 i‡(
buf
 =
NULL
)

69  
NULL
;

70 
ö
 = 
«me
 =
NULL
 ? 
°dö
 : 
	`f›í
(name, "rb");

71 i‡(
ö
 !
NULL
) {

73 *
Àn
 +
	`‰ód
((*)
buf
 + *Àn, 1, 
size
 - *Àn, 
ö
);

74 i‡(*
Àn
 < 
size
) ;

75 
size
 = 
	`bythúds
(size);

76 i‡(
size
 =*
Àn
 || (
sw≠
 = 
	`ªÆloc
(
buf
, size)Ë=
NULL
) {

77 
	`‰ì
(
buf
);

78 
buf
 = 
NULL
;

81 
buf
 = 
sw≠
;

83 
	`f˛o£
(
ö
);

85  
buf
;

86 
	}
}

88 
	$maö
(
¨gc
, **
¨gv
)

90 
ªt
, 
put
 = 0, 
Áû
 = 0;

91 
skù
 = 0;

92 *
¨g
, *
«me
 = 
NULL
;

93 *
sour˚
 = 
NULL
, *
de°
;

94 
size_t
 
Àn
 = 0;

95 
sour˚Àn
, 
de°Àn
;

98 
¨g
 = *++
¨gv
, --
¨gc
)

99 i‡(
¨g
[0] == '-') {

100 i‡(
¨g
[1] == 'w' &&árg[2] == 0)

101 
put
 = 1;

102 i‡(
¨g
[1] == 'f' &&árg[2] == 0)

103 
Áû
 = 1, 
put
 = 1;

104 i‡(
¨g
[1] >= '0' &&árg[1] <= '9')

105 
skù
 = ()
	`©oi
(
¨g
 + 1);

107 
	`Ârötf
(
°dîr
, "övÆid o±i⁄ %s\n", 
¨g
);

111 i‡(
«me
 !
NULL
) {

112 
	`Ârötf
(
°dîr
, "only one fileÇameállowed\n");

116 
«me
 = 
¨g
;

117 
sour˚
 = 
	`lﬂd
(
«me
, &
Àn
);

118 i‡(
sour˚
 =
NULL
) {

119 
	`Ârötf
(
°dîr
, "memoryállocation failure\n");

122 i‡(
Àn
 == 0) {

123 
	`Ârötf
(
°dîr
, "couldÇotÑead %s, or it wasÉmpty\n",

124 
«me
 =
NULL
 ? "<stdin>" :Çame);

125 
	`‰ì
(
sour˚
);

128 i‡(
skù
 >
Àn
) {

129 
	`Ârötf
(
°dîr
, "skùÑeque° o‡%dÜóve†nÿöput\n", 
skù
);

130 
	`‰ì
(
sour˚
);

135 
Àn
 -
skù
;

136 
sour˚Àn
 = ()
Àn
;

137 
ªt
 = 
	`puff
(
NIL
, &
de°Àn
, 
sour˚
 + 
skù
, &
sour˚Àn
);

138 i‡(
ªt
)

139 
	`Ârötf
(
°dîr
, "puff(ËÁûed wôhÑëu∫ codê%d\n", 
ªt
);

141 
	`Ârötf
(
°dîr
, "puff(Ësuc˚eded uncom¥essög %lu byãs\n", 
de°Àn
);

142 i‡(
sour˚Àn
 < 
Àn
Ë
	`Ârötf
(
°dîr
, "%lu compressed bytes unused\n",

143 
Àn
 - 
sour˚Àn
);

147 i‡(
put
 && 
ªt
 == 0) {

148 i‡(
Áû
)

149 
de°Àn
 >>= 1;

150 
de°
 = 
	`mÆloc
(
de°Àn
);

151 i‡(
de°
 =
NULL
) {

152 
	`Ârötf
(
°dîr
, "memoryállocation failure\n");

153 
	`‰ì
(
sour˚
);

156 
	`puff
(
de°
, &
de°Àn
, 
sour˚
 + 
skù
, &
sour˚Àn
);

157 
	`SET_BINARY_MODE
(
°dout
);

158 
	`fwrôe
(
de°
, 1, 
de°Àn
, 
°dout
);

159 
	`‰ì
(
de°
);

163 
	`‰ì
(
sour˚
);

164  
ªt
;

165 
	}
}

	@zlib-1.2.8/contrib/testzlib/testzlib.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~<wödows.h
>

5 
	~"zlib.h
"

8 
	$MyDoMöus64
(
LARGE_INTEGER
 *
R
,LARGE_INTEGER 
A
,LARGE_INTEGER 
B
)

10 
R
->
HighP¨t
 = 
A
.HighP¨à- 
B
.HighPart;

11 i‡(
A
.
LowP¨t
 >
B
.LowPart)

12 
R
->
LowP¨t
 = 
A
.LowP¨à- 
B
.LowPart;

15 
R
->
LowP¨t
 = 
A
.LowP¨à- 
B
.LowPart;

16 
R
->
HighP¨t
 --;

18 
	}
}

20 #ifde‡
_M_X64


22 
__öt64
 
__rdtsc
();

23 
	$BegöCou¡Rdtsc
(
LARGE_INTEGER
 * 
pbegöTime64
)

26 
pbegöTime64
->
QuadP¨t
=
	`__rdtsc
();

27 
	}
}

29 
LARGE_INTEGER
 
	$GëResRdtsc
(
LARGE_INTEGER
 
begöTime64
,
BOOL
 
fCompuãTimeQuîyPîf
)

31 
LARGE_INTEGER
 
LIªs
;

32 
_öt64
 
ªs
=
	`__rdtsc
()-((_öt64)(
begöTime64
.
QuadP¨t
));

33 
LIªs
.
QuadP¨t
=
ªs
;

35  
LIªs
;

36 
	}
}

38 #ifde‡
_M_IX86


39 
	$myGëRDTSC32
(
LARGE_INTEGER
 * 
pbegöTime64
)

41 
DWORD
 
dwEdx
,
dwEax
;

42 
_asm


44 
rdtsc


45 
mov
 
dwEax
,
óx


46 
mov
 
dwEdx
,
edx


48 
pbegöTime64
->
LowP¨t
=
dwEax
;

49 
pbegöTime64
->
HighP¨t
=
dwEdx
;

50 
	}
}

52 
	$BegöCou¡Rdtsc
(
LARGE_INTEGER
 * 
pbegöTime64
)

54 
	`myGëRDTSC32
(
pbegöTime64
);

55 
	}
}

57 
LARGE_INTEGER
 
	$GëResRdtsc
(
LARGE_INTEGER
 
begöTime64
,
BOOL
 
fCompuãTimeQuîyPîf
)

59 
LARGE_INTEGER
 
LIªs
,
ídTime64
;

60 
	`myGëRDTSC32
(&
ídTime64
);

62 
LIªs
.
LowP¨t
=LIªs.
HighP¨t
=0;

63 
	`MyDoMöus64
(&
LIªs
,
ídTime64
,
begöTime64
);

64  
LIªs
;

65 
	}
}

67 
	$myGëRDTSC32
(
LARGE_INTEGER
 * 
pbegöTime64
)

69 
	}
}

71 
	$BegöCou¡Rdtsc
(
LARGE_INTEGER
 * 
pbegöTime64
)

73 
	}
}

75 
LARGE_INTEGER
 
	$GëResRdtsc
(
LARGE_INTEGER
 
begöTime64
,
BOOL
 
fCompuãTimeQuîyPîf
)

77 
LARGE_INTEGER
 
Ã
;

78 
Ã
.
QuadP¨t
=0;

79  
Ã
;

80 
	}
}

84 
	$BegöCou¡PîfCou¡î
(
LARGE_INTEGER
 * 
pbegöTime64
,
BOOL
 
fCompuãTimeQuîyPîf
)

86 i‡((!
fCompuãTimeQuîyPîf
Ë|| (!
	`QuîyPîf‹m™˚Cou¡î
(
pbegöTime64
)))

88 
pbegöTime64
->
LowP¨t
 = 
	`GëTickCou¡
();

89 
pbegöTime64
->
HighP¨t
 = 0;

91 
	}
}

93 
DWORD
 
	$GëM£cSö˚PîfCou¡î
(
LARGE_INTEGER
 
begöTime64
,
BOOL
 
fCompuãTimeQuîyPîf
)

95 
LARGE_INTEGER
 
ídTime64
,
ticksPîSec⁄d
,
ticks
;

96 
DWORDLONG
 
ticksShi·ed
,
tickSecShi·ed
;

97 
DWORD
 
dwLog
=16+0;

98 
DWORD
 
dwRë
;

99 i‡((!
fCompuãTimeQuîyPîf
Ë|| (!
	`QuîyPîf‹m™˚Cou¡î
(&
ídTime64
)))

100 
dwRë
 = (
	`GëTickCou¡
(Ë- 
begöTime64
.
LowP¨t
)*1;

103 
	`MyDoMöus64
(&
ticks
,
ídTime64
,
begöTime64
);

104 
	`QuîyPîf‹m™˚Fªquícy
(&
ticksPîSec⁄d
);

108 
ticksShi·ed
 = 
	`I¡64ShæMod32
(*(
DWORDLONG
*)&
ticks
,
dwLog
);

109 
tickSecShi·ed
 = 
	`I¡64ShæMod32
(*(
DWORDLONG
*)&
ticksPîSec⁄d
,
dwLog
);

113 
dwRë
 = (
DWORD
)((((DWORD)
ticksShi·ed
)*1000)/(DWORD)(
tickSecShi·ed
));

114 
dwRë
 *=1;

116  
dwRë
;

117 
	}
}

119 
	$RódFûeMem‹y
(c⁄° * 
fûíame
,* 
∂FûeSize
,** 
pFûePå
)

121 
FILE
* 
°ªam
;

122 * 
±r
;

123 
ªtVÆ
=1;

124 
°ªam
=
	`f›í
(
fûíame
, "rb");

125 i‡(
°ªam
==
NULL
)

128 
	`f£ek
(
°ªam
,0,
SEEK_END
);

130 *
∂FûeSize
=
	`·ñl
(
°ªam
);

131 
	`f£ek
(
°ªam
,0,
SEEK_SET
);

132 
±r
=
	`mÆloc
((*
∂FûeSize
)+1);

133 i‡(
±r
==
NULL
)

134 
ªtVÆ
=0;

137 i‡(
	`‰ód
(
±r
, 1, *
∂FûeSize
,
°ªam
) != (*plFileSize))

138 
ªtVÆ
=0;

140 
	`f˛o£
(
°ªam
);

141 *
pFûePå
=
±r
;

142  
ªtVÆ
;

143 
	}
}

145 
	$maö
(
¨gc
, *
¨gv
[])

147 
BlockSizeCom¥ess
=0x8000;

148 
BlockSizeUncom¥ess
=0x8000;

149 
˝rLevñ
=
Z_DEFAULT_COMPRESSION
 ;

150 
lFûeSize
;

151 * 
FûePå
;

152 
lBuf„rSizeC¥
;

153 
lBuf„rSizeUn˝r
;

154 
lCom¥es£dSize
=0;

155 * 
C¥På
;

156 * 
Un˝rPå
;

157 
lSizeC¥
,
lSizeUn˝r
;

158 
DWORD
 
dwGëTick
,
dwM£cQP
;

159 
LARGE_INTEGER
 
li_qp
,
li_rdtsc
,
dwResRdtsc
;

161 i‡(
¨gc
<=1)

163 
	`¥ötf
("run TestZlib <File> [BlockSizeCompress] [BlockSizeUncompress] [compres.Üevel]\n");

167 i‡(
	`RódFûeMem‹y
(
¨gv
[1],&
lFûeSize
,&
FûePå
)==0)

169 
	`¥ötf
("îr‹Ñódög %s\n",
¨gv
[1]);

172 
	`¥ötf
("fûê%†ªad, %u byãs\n",
¨gv
[1],
lFûeSize
);

174 i‡(
¨gc
>=3)

175 
BlockSizeCom¥ess
=
	`©ﬁ
(
¨gv
[2]);

177 i‡(
¨gc
>=4)

178 
BlockSizeUncom¥ess
=
	`©ﬁ
(
¨gv
[3]);

180 i‡(
¨gc
>=5)

181 
˝rLevñ
=()
	`©ﬁ
(
¨gv
[4]);

183 
lBuf„rSizeC¥
 = 
lFûeSize
 + (lFileSize/0x10) + 0x200;

184 
lBuf„rSizeUn˝r
 = 
lBuf„rSizeC¥
;

186 
C¥På
=(*)
	`mÆloc
(
lBuf„rSizeC¥
 + 
BlockSizeCom¥ess
);

188 
	`BegöCou¡PîfCou¡î
(&
li_qp
,
TRUE
);

189 
dwGëTick
=
	`GëTickCou¡
();

190 
	`BegöCou¡Rdtsc
(&
li_rdtsc
);

192 
z_°ªam
 
z˝r
;

193 
ªt
=
Z_OK
;

194 
lOrigToDo
 = 
lFûeSize
;

195 
lOrigD⁄e
 = 0;

196 
°ï
=0;

197 
	`mem£t
(&
z˝r
,0,(
z_°ªam
));

198 
	`deÊ©eInô
(&
z˝r
,
˝rLevñ
);

200 
z˝r
.
√xt_ö
 = 
FûePå
;

201 
z˝r
.
√xt_out
 = 
C¥På
;

206 
Æl_ªad_bef‹e
 = 
z˝r
.
tŸÆ_ö
;

207 
z˝r
.
avaû_ö
 = 
	`mö
(
lOrigToDo
,
BlockSizeCom¥ess
);

208 
z˝r
.
avaû_out
 = 
BlockSizeCom¥ess
;

209 
ªt
=
	`deÊ©e
(&
z˝r
,(z˝r.
avaû_ö
==
lOrigToDo
Ë? 
Z_FINISH
 : 
Z_SYNC_FLUSH
);

210 
lOrigD⁄e
 +(
z˝r
.
tŸÆ_ö
-
Æl_ªad_bef‹e
);

211 
lOrigToDo
 -(
z˝r
.
tŸÆ_ö
-
Æl_ªad_bef‹e
);

212 
°ï
++;

213 } 
ªt
==
Z_OK
);

215 
lSizeC¥
=
z˝r
.
tŸÆ_out
;

216 
	`deÊ©eEnd
(&
z˝r
);

217 
dwGëTick
=
	`GëTickCou¡
()-dwGetTick;

218 
dwM£cQP
=
	`GëM£cSö˚PîfCou¡î
(
li_qp
,
TRUE
);

219 
dwResRdtsc
=
	`GëResRdtsc
(
li_rdtsc
,
TRUE
);

220 
	`¥ötf
("tŸÆ com¥es†sizê%u, i¿%u sãp\n",
lSizeC¥
,
°ï
);

221 
	`¥ötf
("timê%u m£¯%‡£c\n",
dwGëTick
,dwGetTick/()1000.);

222 
	`¥ötf
("def˝∏timêQP = %u m£¯%‡£c\n",
dwM£cQP
,dwMsecQP/()1000.);

223 
	`¥ötf
("def˝∏ªsu…Ñdts¯%I64x\n\n",
dwResRdtsc
.
QuadP¨t
);

226 
C¥På
=(*)
	`ªÆloc
(C¥På,
lSizeC¥
);

227 
Un˝rPå
=(*)
	`mÆloc
(
lBuf„rSizeUn˝r
 + 
BlockSizeUncom¥ess
);

229 
	`BegöCou¡PîfCou¡î
(&
li_qp
,
TRUE
);

230 
dwGëTick
=
	`GëTickCou¡
();

231 
	`BegöCou¡Rdtsc
(&
li_rdtsc
);

233 
z_°ªam
 
z˝r
;

234 
ªt
=
Z_OK
;

235 
lOrigToDo
 = 
lSizeC¥
;

236 
lOrigD⁄e
 = 0;

237 
°ï
=0;

238 
	`mem£t
(&
z˝r
,0,(
z_°ªam
));

239 
	`öÊ©eInô
(&
z˝r
);

241 
z˝r
.
√xt_ö
 = 
C¥På
;

242 
z˝r
.
√xt_out
 = 
Un˝rPå
;

247 
Æl_ªad_bef‹e
 = 
z˝r
.
tŸÆ_ö
;

248 
z˝r
.
avaû_ö
 = 
	`mö
(
lOrigToDo
,
BlockSizeUncom¥ess
);

249 
z˝r
.
avaû_out
 = 
BlockSizeUncom¥ess
;

250 
ªt
=
	`öÊ©e
(&
z˝r
,
Z_SYNC_FLUSH
);

251 
lOrigD⁄e
 +(
z˝r
.
tŸÆ_ö
-
Æl_ªad_bef‹e
);

252 
lOrigToDo
 -(
z˝r
.
tŸÆ_ö
-
Æl_ªad_bef‹e
);

253 
°ï
++;

254 } 
ªt
==
Z_OK
);

256 
lSizeUn˝r
=
z˝r
.
tŸÆ_out
;

257 
	`öÊ©eEnd
(&
z˝r
);

258 
dwGëTick
=
	`GëTickCou¡
()-dwGetTick;

259 
dwM£cQP
=
	`GëM£cSö˚PîfCou¡î
(
li_qp
,
TRUE
);

260 
dwResRdtsc
=
	`GëResRdtsc
(
li_rdtsc
,
TRUE
);

261 
	`¥ötf
("tŸÆ uncom¥es†sizê%u, i¿%u sãp\n",
lSizeUn˝r
,
°ï
);

262 
	`¥ötf
("timê%u m£¯%‡£c\n",
dwGëTick
,dwGetTick/()1000.);

263 
	`¥ötf
("un˝∏ÅimêQP = %u m£¯%‡£c\n",
dwM£cQP
,dwMsecQP/()1000.);

264 
	`¥ötf
("un˝∏Ñesu…Ñdts¯%I64x\n\n",
dwResRdtsc
.
QuadP¨t
);

267 i‡(
lSizeUn˝r
==
lFûeSize
)

269 i‡(
	`memcmp
(
FûePå
,
Un˝rPå
,
lFûeSize
)==0)

270 
	`¥ötf
("compare ok\n");

275 
	}
}

	@zlib-1.2.8/contrib/untgz/untgz.c

9 
	~<°dio.h
>

10 
	~<°dlib.h
>

11 
	~<°rög.h
>

12 
	~<time.h
>

13 
	~<î∫o.h
>

15 
	~"zlib.h
"

17 #ifde‡
unix


18 
	~<uni°d.h
>

20 
	~<dúe˘.h
>

21 
	~<io.h
>

24 #ifde‡
WIN32


25 
	~<wödows.h
>

26 #i‚de‡
F_OK


27 
	#F_OK
 0

	)

29 
	#mkdú
(
dú«me
,
mode
Ë
	`_mkdú
(dú«me)

	)

30 #ifde‡
_MSC_VER


31 
	#ac˚ss
(
∑th
,
mode
Ë
	`_ac˚ss
’©h,mode)

	)

32 
	#chmod
(
∑th
,
mode
Ë
	`_chmod
’©h,mode)

	)

33 
	#°rdup
(
°r
Ë
	`_°rdup
(°r)

	)

36 
	~<utime.h
>

42 
	#REGTYPE
 '0'

	)

43 
	#AREGTYPE
 '\0'

	)

44 
	#LNKTYPE
 '1'

	)

45 
	#SYMTYPE
 '2'

	)

46 
	#CHRTYPE
 '3'

	)

47 
	#BLKTYPE
 '4'

	)

48 
	#DIRTYPE
 '5'

	)

49 
	#FIFOTYPE
 '6'

	)

50 
	#CONTTYPE
 '7'

	)

54 
	#GNUTYPE_DUMPDIR
 'D'

	)

55 
	#GNUTYPE_LONGLINK
 'K'

	)

56 
	#GNUTYPE_LONGNAME
 'L'

	)

57 
	#GNUTYPE_MULTIVOL
 'M'

	)

58 
	#GNUTYPE_NAMES
 'N'

	)

59 
	#GNUTYPE_SPARSE
 'S'

	)

60 
	#GNUTYPE_VOLHDR
 'V'

	)

65 
	#BLOCKSIZE
 512

	)

66 
	#SHORTNAMESIZE
 100

	)

68 
	sèr_hódî


70 
	m«me
[100];

71 
	mmode
[8];

72 
	muid
[8];

73 
	mgid
[8];

74 
	msize
[12];

75 
	mmtime
[12];

76 
	mchksum
[8];

77 
	mty≥Êag
;

78 
	mlök«me
[100];

79 
	mmagic
[6];

80 
	mvîsi⁄
[2];

81 
	mu«me
[32];

82 
	mg«me
[32];

83 
	mdevmaj‹
[8];

84 
	mdevmö‹
[8];

85 
	m¥efix
[155];

89 
	uèr_buf„r


91 
	mbuf„r
[
BLOCKSIZE
];

92 
èr_hódî
 
	mhódî
;

95 
	s©å_ôem


97 
©å_ôem
 *
	m√xt
;

98 *
	m‚ame
;

99 
	mmode
;

100 
time_t
 
	mtime
;

103 íum { 
	mTGZ_EXTRACT
, 
	mTGZ_LIST
, 
	mTGZ_INVALID
 };

105 *
TGZ‚ame
 
OF
((const *));

106 
TGZnŸfound
 
OF
((const *));

108 
gëo˘
 
OF
((*, ));

109 *
°πime
 
OF
((
time_t
 *));

110 
£tfûëime
 
OF
((*, 
time_t
));

111 
push_©å
 
OF
((
©å_ôem
 **, *, , 
time_t
));

112 
ª°‹e_©å
 
OF
((
©å_ôem
 **));

114 
Ex¥M©ch
 
OF
((*, *));

116 
makedú
 
OF
((*));

117 
m©ch«me
 
OF
((, , **, *));

119 
îr‹
 
OF
((const *));

120 
èr
 
OF
((
gzFûe
, , , , **));

122 
hñp
 
OF
(());

123 
maö
 
OF
((, **));

125 *
	g¥og
;

127 c⁄° *
	gTGZsuffix
[] = { "\0", ".èr", ".èr.gz", ".èz", ".tgz", 
NULL
 };

132 *
	$TGZ‚ame
 (c⁄° *
¨˙ame
)

134 
buf„r
[1024];

135 
‹igÀn
,
i
;

137 
	`°r˝y
(
buf„r
,
¨˙ame
);

138 
‹igÀn
 = 
	`°æí
(
buf„r
);

140 
i
=0; 
TGZsuffix
[i]; i++)

142 
	`°r˝y
(
buf„r
+
‹igÀn
,
TGZsuffix
[
i
]);

143 i‡(
	`ac˚ss
(
buf„r
,
F_OK
) == 0)

144  
buf„r
;

146  
NULL
;

147 
	}
}

152 
	$TGZnŸfound
 (c⁄° *
¨˙ame
)

154 
i
;

156 
	`Ârötf
(
°dîr
,"%s: Couldn'àföd ",
¥og
);

157 
i
=0;
TGZsuffix
[i];i++)

158 
	`Ârötf
(
°dîr
,(
TGZsuffix
[
i
+1]) ? "%s%s, " : "or %s%s\n",

159 
¨˙ame
,

160 
TGZsuffix
[
i
]);

161 
	`exô
(1);

162 
	}
}

168 
	$gëo˘
 (*
p
,
width
)

170 
ªsu…
 = 0;

171 
c
;

173 
width
--)

175 
c
 = *
p
++;

176 i‡(
c
 == 0)

178 i‡(
c
 == ' ')

180 i‡(
c
 < '0' || c > '7')

182 
ªsu…
 =Ñesu… * 8 + (
c
 - '0');

184  
ªsu…
;

185 
	}
}

191 *
	$°πime
 (
time_t
 *
t
)

193 
tm
 *
loˇl
;

194 
ªsu…
[32];

196 
loˇl
 = 
	`loˇ…ime
(
t
);

197 
	`•rötf
(
ªsu…
,"%4d/%02d/%02d %02d:%02d:%02d",

198 
loˇl
->
tm_yór
+1900,Üoˇl->
tm_m⁄
+1,Üoˇl->
tm_mday
,

199 
loˇl
->
tm_hour
,Üoˇl->
tm_mö
,Üoˇl->
tm_£c
);

200  
ªsu…
;

201 
	}
}

206 
	$£tfûëime
 (*
‚ame
,
time_t
 
·ime
)

208 #ifde‡
WIN32


209 
isWöNT
 = -1;

210 
SYSTEMTIME
 
°
;

211 
FILETIME
 
loc·
, 
mod·
;

212 
tm
 *
lo˘m
;

213 
HANDLE
 
hFûe
;

214 
ªsu…
;

216 
lo˘m
 = 
	`loˇ…ime
(&
·ime
);

217 i‡(
lo˘m
 =
NULL
)

220 
°
.
wYór
 = (
WORD
)
lo˘m
->
tm_yór
 + 1900;

221 
°
.
wM⁄th
 = (
WORD
)
lo˘m
->
tm_m⁄
 + 1;

222 
°
.
wDayOfWìk
 = (
WORD
)
lo˘m
->
tm_wday
;

223 
°
.
wDay
 = (
WORD
)
lo˘m
->
tm_mday
;

224 
°
.
wHour
 = (
WORD
)
lo˘m
->
tm_hour
;

225 
°
.
wMöuã
 = (
WORD
)
lo˘m
->
tm_mö
;

226 
°
.
wSec⁄d
 = (
WORD
)
lo˘m
->
tm_£c
;

227 
°
.
wMûli£c⁄ds
 = 0;

228 i‡(!
	`Sy°emTimeToFûeTime
(&
°
, &
loc·
) ||

229 !
	`LoˇlFûeTimeToFûeTime
(&
loc·
, &
mod·
))

232 i‡(
isWöNT
 < 0)

233 
isWöNT
 = (
	`GëVîsi⁄
() < 0x80000000) ? 1 : 0;

234 
hFûe
 = 
	`Cª©eFûe
(
‚ame
, 
GENERIC_WRITE
, 0, 
NULL
, 
OPEN_EXISTING
,

235 (
isWöNT
 ? 
FILE_FLAG_BACKUP_SEMANTICS
 : 0),

236 
NULL
);

237 i‡(
hFûe
 =
INVALID_HANDLE_VALUE
)

239 
ªsu…
 = 
	`SëFûeTime
(
hFûe
, 
NULL
, NULL, &
mod·
) ? 0 : -1;

240 
	`Clo£H™dÀ
(
hFûe
);

241  
ªsu…
;

243 
utimbuf
 
£âime
;

245 
£âime
.
a˘ime
 = sëtime.
modtime
 = 
·ime
;

246  
	`utime
(
‚ame
,&
£âime
);

248 
	}
}

253 
	$push_©å
(
©å_ôem
 **
li°
,*
‚ame
,
mode
,
time_t
 
time
)

255 
©å_ôem
 *
ôem
;

257 
ôem
 = (
©å_ôem
 *)
	`mÆloc
((attr_item));

258 i‡(
ôem
 =
NULL
)

259 
	`îr‹
("Out of memory");

260 
ôem
->
‚ame
 = 
	`°rdup
(fname);

261 
ôem
->
mode
 = mode;

262 
ôem
->
time
 =Åime;

263 
ôem
->
√xt
 = *
li°
;

264 *
li°
 = 
ôem
;

265 
	}
}

270 
	$ª°‹e_©å
(
©å_ôem
 **
li°
)

272 
©å_ôem
 *
ôem
, *
¥ev
;

274 
ôem
 = *
li°
; iãm !
NULL
; )

276 
	`£tfûëime
(
ôem
->
‚ame
,ôem->
time
);

277 
	`chmod
(
ôem
->
‚ame
,ôem->
mode
);

278 
¥ev
 = 
ôem
;

279 
ôem
 = iãm->
√xt
;

280 
	`‰ì
(
¥ev
);

282 *
li°
 = 
NULL
;

283 
	}
}

288 
	#ISSPECIAL
(
c
Ë(((cË='*'Ë|| ((cË='/'))

	)

290 
	$Ex¥M©ch
 (*
°rög
,*
ex¥
)

294 i‡(
	`ISSPECIAL
(*
ex¥
))

296 i‡(*
ex¥
 == '/')

298 i‡(*
°rög
 != '\\' && *string != '/')

300 
°rög
 ++; 
ex¥
++;

302 i‡(*
ex¥
 == '*')

304 i‡(*
ex¥
 ++ == 0)

306 *++
°rög
 !*
ex¥
)

307 i‡(*
°rög
 == 0)

313 i‡(*
°rög
 !*
ex¥
)

315 i‡(*
ex¥
++ == 0)

317 
°rög
++;

320 
	}
}

328 
	$makedú
 (*
√wdú
)

330 *
buf„r
 = 
	`°rdup
(
√wdú
);

331 *
p
;

332 
Àn
 = 
	`°æí
(
buf„r
);

334 i‡(
Àn
 <= 0) {

335 
	`‰ì
(
buf„r
);

338 i‡(
buf„r
[
Àn
-1] == '/') {

339 
buf„r
[
Àn
-1] = '\0';

341 i‡(
	`mkdú
(
buf„r
, 0755) == 0)

343 
	`‰ì
(
buf„r
);

347 
p
 = 
buf„r
+1;

350 
hﬁd
;

352 *
p
 && *p != '\\' && *p != '/')

353 
p
++;

354 
hﬁd
 = *
p
;

355 *
p
 = 0;

356 i‡((
	`mkdú
(
buf„r
, 0755Ë=-1Ë&& (
î∫o
 =
ENOENT
))

358 
	`Ârötf
(
°dîr
,"%s: Couldn'à¸óã dúe˘‹y %s\n",
¥og
,
buf„r
);

359 
	`‰ì
(
buf„r
);

362 i‡(
hﬁd
 == 0)

364 *
p
++ = 
hﬁd
;

366 
	`‰ì
(
buf„r
);

368 
	}
}

371 
	$m©ch«me
 (
¨g
,
¨gc
,**
¨gv
,*
‚ame
)

373 i‡(
¨g
 =
¨gc
)

376 
¨g
 < 
¨gc
)

377 i‡(
	`Ex¥M©ch
(
‚ame
,
¨gv
[
¨g
++]))

381 
	}
}

386 
	$èr
 (
gzFûe
 
ö
,
a˘i⁄
,
¨g
,
¨gc
,**
¨gv
)

388 
èr_buf„r
 
buf„r
;

389 
Àn
;

390 
îr
;

391 
gëhódî
 = 1;

392 
ªmaöög
 = 0;

393 
FILE
 *
outfûe
 = 
NULL
;

394 
‚ame
[
BLOCKSIZE
];

395 
èrmode
;

396 
time_t
 
èπime
;

397 
©å_ôem
 *
©åibuãs
 = 
NULL
;

399 i‡(
a˘i⁄
 =
TGZ_LIST
)

400 
	`¥ötf
(" dateÅime size file\n"

404 
Àn
 = 
	`gzªad
(
ö
, &
buf„r
, 
BLOCKSIZE
);

405 i‡(
Àn
 < 0)

406 
	`îr‹
(
	`gzîr‹
(
ö
, &
îr
));

411 i‡(
Àn
 !
BLOCKSIZE
)

413 
a˘i⁄
 = 
TGZ_INVALID
;

414 
ªmaöög
 = 0;

420 i‡(
gëhódî
 >= 1)

427 i‡(
Àn
 =0 || 
buf„r
.
hódî
.
«me
[0] == 0)

430 
èrmode
 = 
	`gëo˘
(
buf„r
.
hódî
.
mode
,8);

431 
èπime
 = (
time_t
)
	`gëo˘
(
buf„r
.
hódî
.
mtime
,12);

432 i‡(
èrmode
 =-1 || 
èπime
 =(
time_t
)-1)

434 
buf„r
.
hódî
.
«me
[0] = 0;

435 
a˘i⁄
 = 
TGZ_INVALID
;

438 i‡(
gëhódî
 == 1)

440 
	`°∫˝y
(
‚ame
,
buf„r
.
hódî
.
«me
,
SHORTNAMESIZE
);

441 i‡(
‚ame
[
SHORTNAMESIZE
-1] != 0)

442 
‚ame
[
SHORTNAMESIZE
] = 0;

449 i‡(
	`°∫cmp
(
‚ame
,
buf„r
.
hódî
.
«me
,
SHORTNAMESIZE
-1) != 0)

450 
	`îr‹
("badÜongÇame");

451 
gëhódî
 = 1;

457 
buf„r
.
hódî
.
ty≥Êag
)

459 
DIRTYPE
:

460 i‡(
a˘i⁄
 =
TGZ_LIST
)

461 
	`¥ötf
(" %† <dú> %s\n",
	`°πime
(&
èπime
),
‚ame
);

462 i‡(
a˘i⁄
 =
TGZ_EXTRACT
)

464 
	`makedú
(
‚ame
);

465 
	`push_©å
(&
©åibuãs
,
‚ame
,
èrmode
,
èπime
);

468 
REGTYPE
:

469 
AREGTYPE
:

470 
ªmaöög
 = 
	`gëo˘
(
buf„r
.
hódî
.
size
,12);

471 i‡(
ªmaöög
 == -1)

473 
a˘i⁄
 = 
TGZ_INVALID
;

476 i‡(
a˘i⁄
 =
TGZ_LIST
)

477 
	`¥ötf
(" %†%9d %s\n",
	`°πime
(&
èπime
),
ªmaöög
,
‚ame
);

478 i‡(
a˘i⁄
 =
TGZ_EXTRACT
)

480 i‡(
	`m©ch«me
(
¨g
,
¨gc
,
¨gv
,
‚ame
))

482 
outfûe
 = 
	`f›í
(
‚ame
,"wb");

483 i‡(
outfûe
 =
NULL
) {

485 *
p
 = 
	`°ºchr
(
‚ame
, '/');

486 i‡(
p
 !
NULL
) {

487 *
p
 = '\0';

488 
	`makedú
(
‚ame
);

489 *
p
 = '/';

490 
outfûe
 = 
	`f›í
(
‚ame
,"wb");

493 i‡(
outfûe
 !
NULL
)

494 
	`¥ötf
("Exåa˘ög %s\n",
‚ame
);

496 
	`Ârötf
(
°dîr
, "%s: Couldn'à¸óã %s",
¥og
,
‚ame
);

499 
outfûe
 = 
NULL
;

501 
gëhódî
 = 0;

503 
GNUTYPE_LONGLINK
:

504 
GNUTYPE_LONGNAME
:

505 
ªmaöög
 = 
	`gëo˘
(
buf„r
.
hódî
.
size
,12);

506 i‡(
ªmaöög
 < 0 ||Ñemaöög >
BLOCKSIZE
)

508 
a˘i⁄
 = 
TGZ_INVALID
;

511 
Àn
 = 
	`gzªad
(
ö
, 
‚ame
, 
BLOCKSIZE
);

512 i‡(
Àn
 < 0)

513 
	`îr‹
(
	`gzîr‹
(
ö
, &
îr
));

514 i‡(
‚ame
[
BLOCKSIZE
-1] !0 || ()
	`°æí
(‚ameË> 
ªmaöög
)

516 
a˘i⁄
 = 
TGZ_INVALID
;

519 
gëhódî
 = 2;

522 i‡(
a˘i⁄
 =
TGZ_LIST
)

523 
	`¥ötf
(" %† <---> %s\n",
	`°πime
(&
èπime
),
‚ame
);

529 
byãs
 = (
ªmaöög
 > 
BLOCKSIZE
) ? BLOCKSIZE :Ñemaining;

531 i‡(
outfûe
 !
NULL
)

533 i‡(
	`fwrôe
(&
buf„r
,(),
byãs
,
outfûe
) != bytes)

535 
	`Ârötf
(
°dîr
,

536 "%s: Eº‹ wrôög %†-- skùpög\n",
¥og
,
‚ame
);

537 
	`f˛o£
(
outfûe
);

538 
outfûe
 = 
NULL
;

539 
	`ªmove
(
‚ame
);

542 
ªmaöög
 -
byãs
;

545 i‡(
ªmaöög
 == 0)

547 
gëhódî
 = 1;

548 i‡(
outfûe
 !
NULL
)

550 
	`f˛o£
(
outfûe
);

551 
outfûe
 = 
NULL
;

552 i‡(
a˘i⁄
 !
TGZ_INVALID
)

553 
	`push_©å
(&
©åibuãs
,
‚ame
,
èrmode
,
èπime
);

560 i‡(
a˘i⁄
 =
TGZ_INVALID
)

562 
	`îr‹
("brokenárchive");

570 
	`ª°‹e_©å
(&
©åibuãs
);

572 i‡(
	`gz˛o£
(
ö
Ë!
Z_OK
)

573 
	`îr‹
("failed gzclose");

576 
	}
}

581 
	$hñp
(
exôvÆ
)

583 
	`¥ötf
("untgz version 0.2.1\n"

585 
	`zlibVîsi⁄
());

586 
	`¥ötf
("Usage: untgz file.tgzÉxtractáll files\n"

590 
	`exô
(
exôvÆ
);

591 
	}
}

593 
	$îr‹
(c⁄° *
msg
)

595 
	`Ârötf
(
°dîr
, "%s: %s\n", 
¥og
, 
msg
);

596 
	`exô
(1);

597 
	}
}

602 #i‡
deföed
(
WIN32
Ë&& deföed(
__GNUC__
)

603 
	g_CRT_glob
 = 0;

606 
	$maö
(
¨gc
,**
¨gv
)

608 
a˘i⁄
 = 
TGZ_EXTRACT
;

609 
¨g
 = 1;

610 *
TGZfûe
;

611 
gzFûe
 *
f
;

613 
¥og
 = 
	`°ºchr
(
¨gv
[0],'\\');

614 i‡(
¥og
 =
NULL
)

616 
¥og
 = 
	`°ºchr
(
¨gv
[0],'/');

617 i‡(
¥og
 =
NULL
)

619 
¥og
 = 
	`°ºchr
(
¨gv
[0],':');

620 i‡(
¥og
 =
NULL
)

621 
¥og
 = 
¨gv
[0];

623 
¥og
++;

626 
¥og
++;

629 
¥og
++;

631 i‡(
¨gc
 == 1)

632 
	`hñp
(0);

634 i‡(
	`°rcmp
(
¨gv
[
¨g
],"-l") == 0)

636 
a˘i⁄
 = 
TGZ_LIST
;

637 i‡(
¨gc
 =++
¨g
)

638 
	`hñp
(0);

640 i‡(
	`°rcmp
(
¨gv
[
¨g
],"-h") == 0)

642 
	`hñp
(0);

645 i‡((
TGZfûe
 = 
	`TGZ‚ame
(
¨gv
[
¨g
])Ë=
NULL
)

646 
	`TGZnŸfound
(
¨gv
[
¨g
]);

648 ++
¨g
;

649 i‡((
a˘i⁄
 =
TGZ_LIST
Ë&& (
¨g
 !
¨gc
))

650 
	`hñp
(1);

655 
a˘i⁄
)

657 
TGZ_LIST
:

658 
TGZ_EXTRACT
:

659 
f
 = 
	`gz›í
(
TGZfûe
,"rb");

660 i‡(
f
 =
NULL
)

662 
	`Ârötf
(
°dîr
,"%s: Couldn'àgz›í %s\n",
¥og
,
TGZfûe
);

665 
	`exô
(
	`èr
(
f
, 
a˘i⁄
, 
¨g
, 
¨gc
, 
¨gv
));

669 
	`îr‹
("Unknown option");

670 
	`exô
(1);

674 
	}
}

	@zlib-1.2.8/crc32.c

24 #ifde‡
MAKECRCH


25 
	~<°dio.h
>

26 #i‚de‡
DYNAMIC_CRC_TABLE


27 
	#DYNAMIC_CRC_TABLE


	)

31 
	~"zutû.h
"

33 
	#loˇl
 

	)

36 #i‡!
deföed
(
NOBYFOUR
Ë&& deföed(
Z_U4
)

37 
	#BYFOUR


	)

39 #ifde‡
BYFOUR


40 
loˇl
 
¸c32_lôée
 
OF
((,

41 c⁄° 
FAR
 *, ));

42 
loˇl
 
¸c32_big
 
OF
((,

43 c⁄° 
FAR
 *, ));

44 
	#TBLS
 8

	)

46 
	#TBLS
 1

	)

50 
loˇl
 
gf2_m©rix_times
 
OF
((*
m©
,

51 
vec
));

52 
loˇl
 
gf2_m©rix_squ¨e
 
OF
((*
squ¨e
, *
m©
));

53 
loˇl
 
uL⁄g
 
¸c32_comböe_
 
OF
((uL⁄g 
¸c1
, uL⁄g 
¸c2
, 
z_off64_t
 
Àn2
));

56 #ifde‡
DYNAMIC_CRC_TABLE


58 
loˇl
 vﬁ©ûê
	g¸c_èbÀ_em±y
 = 1;

59 
loˇl
 
z_¸c_t
 
FAR
 
	g¸c_èbÀ
[
TBLS
][256];

60 
loˇl
 
make_¸c_èbÀ
 
OF
(());

61 #ifde‡
MAKECRCH


62 
loˇl
 
wrôe_èbÀ
 
OF
((
FILE
 *, c⁄° 
z_¸c_t
 
FAR
 *));

90 
loˇl
 
	$make_¸c_èbÀ
()

92 
z_¸c_t
 
c
;

93 
n
, 
k
;

94 
z_¸c_t
 
pﬁy
;

96 vﬁ©ûê
fú°
 = 1;

97 c⁄° 
p
[] = {0,1,2,4,5,7,8,10,11,12,16,22,23,26};

102 i‡(
fú°
) {

103 
fú°
 = 0;

106 
pﬁy
 = 0;

107 
n
 = 0;Ç < ()((
p
)/());Ç++)

108 
pﬁy
 |(
z_¸c_t
)1 << (31 - 
p
[
n
]);

111 
n
 = 0;Ç < 256;Ç++) {

112 
c
 = (
z_¸c_t
)
n
;

113 
k
 = 0; k < 8; k++)

114 
c
 = c & 1 ? 
pﬁy
 ^ (c >> 1) : c >> 1;

115 
¸c_èbÀ
[0][
n
] = 
c
;

118 #ifde‡
BYFOUR


121 
n
 = 0;Ç < 256;Ç++) {

122 
c
 = 
¸c_èbÀ
[0][
n
];

123 
¸c_èbÀ
[4][
n
] = 
	`ZSWAP32
(
c
);

124 
k
 = 1; k < 4; k++) {

125 
c
 = 
¸c_èbÀ
[0][c & 0xff] ^ (c >> 8);

126 
¸c_èbÀ
[
k
][
n
] = 
c
;

127 
¸c_èbÀ
[
k
 + 4][
n
] = 
	`ZSWAP32
(
c
);

132 
¸c_èbÀ_em±y
 = 0;

136 
¸c_èbÀ_em±y
)

140 #ifde‡
MAKECRCH


143 
FILE
 *
out
;

145 
out
 = 
	`f›í
("crc32.h", "w");

146 i‡(
out
 =
NULL
) ;

147 
	`Ârötf
(
out
, "/* crc32.h --Åables forÑapid CRC calculation\n");

148 
	`Ârötf
(
out
, " * Generatedáutomatically by crc32.c\n */\n\n");

149 
	`Ârötf
(
out
, "local const z_crc_t FAR ");

150 
	`Ârötf
(
out
, "crc_table[TBLS][256] =\n{\n {\n");

151 
	`wrôe_èbÀ
(
out
, 
¸c_èbÀ
[0]);

152 #ifde‡
BYFOUR


153 
	`Ârötf
(
out
, "#ifdef BYFOUR\n");

154 
k
 = 1; k < 8; k++) {

155 
	`Ârötf
(
out
, " },\n {\n");

156 
	`wrôe_èbÀ
(
out
, 
¸c_èbÀ
[
k
]);

158 
	`Ârötf
(
out
, "#endif\n");

160 
	`Ârötf
(
out
, " }\n};\n");

161 
	`f˛o£
(
out
);

164 
	}
}

166 #ifde‡
MAKECRCH


167 
loˇl
 
	$wrôe_èbÀ
(
out
, 
èbÀ
)

168 
FILE
 *
out
;

169 c⁄° 
z_¸c_t
 
FAR
 *
èbÀ
;

171 
n
;

173 
n
 = 0;Ç < 256;Ç++)

174 
	`Ârötf
(
out
, "%s0x%08lxUL%s", 
n
 % 5 ? "" : " ",

175 ()(
èbÀ
[
n
]),

176 
n
 == 255 ? "\n" : (n % 5 == 4 ? ",\n" : ", "));

177 
	}
}

184 
	~"¸c32.h
"

190 c⁄° 
z_¸c_t
 
FAR
 * 
ZEXPORT
 
	$gë_¸c_èbÀ
()

192 #ifde‡
DYNAMIC_CRC_TABLE


193 i‡(
¸c_èbÀ_em±y
)

194 
	`make_¸c_èbÀ
();

196  (c⁄° 
z_¸c_t
 
FAR
 *)
¸c_èbÀ
;

197 
	}
}

200 
	#DO1
 
¸c
 = 
¸c_èbÀ
[0][(()¸¯^ (*
buf
++)Ë& 0xff] ^ (¸¯>> 8)

	)

201 
	#DO8
 
DO1
; DO1; DO1; DO1; DO1; DO1; DO1; 
	)
DO1

204 
ZEXPORT
 
	$¸c32
(
¸c
, 
buf
, 
Àn
)

205 
¸c
;

206 c⁄° 
FAR
 *
buf
;

207 
uI¡
 
Àn
;

209 i‡(
buf
 =
Z_NULL
)  0UL;

211 #ifde‡
DYNAMIC_CRC_TABLE


212 i‡(
¸c_èbÀ_em±y
)

213 
	`make_¸c_èbÀ
();

216 #ifde‡
BYFOUR


217 i‡((*Ë=(
±rdiff_t
)) {

218 
z_¸c_t
 
ídün
;

220 
ídün
 = 1;

221 i‡(*((*)(&
ídün
)))

222  
	`¸c32_lôée
(
¸c
, 
buf
, 
Àn
);

224  
	`¸c32_big
(
¸c
, 
buf
, 
Àn
);

227 
¸c
 = crc ^ 0xffffffffUL;

228 
Àn
 >= 8) {

229 
DO8
;

230 
Àn
 -= 8;

232 i‡(
Àn
) do {

233 
DO1
;

234 } --
Àn
);

235  
¸c
 ^ 0xffffffffUL;

236 
	}
}

238 #ifde‡
BYFOUR


241 
	#DOLIT4
 
c
 ^*
buf4
++; \

242 
c
 = 
¸c_èbÀ
[3][c & 0xff] ^ crc_table[2][(c >> 8) & 0xff] ^ \

243 
¸c_èbÀ
[1][(
c
 >> 16Ë& 0xff] ^ crc_èbÀ[0][¯>> 24]

	)

244 
	#DOLIT32
 
DOLIT4
; DOLIT4; DOLIT4; DOLIT4; DOLIT4; DOLIT4; DOLIT4; 
	)
DOLIT4

247 
loˇl
 
	$¸c32_lôée
(
¸c
, 
buf
, 
Àn
)

248 
¸c
;

249 c⁄° 
FAR
 *
buf
;

250 
Àn
;

252 
z_¸c_t
 
c
;

253 c⁄° 
z_¸c_t
 
FAR
 *
buf4
;

255 
c
 = (
z_¸c_t
)
¸c
;

256 
c
 = ~c;

257 
Àn
 && ((
±rdiff_t
)
buf
 & 3)) {

258 
c
 = 
¸c_èbÀ
[0][(¯^ *
buf
++) & 0xff] ^ (c >> 8);

259 
Àn
--;

262 
buf4
 = (c⁄° 
z_¸c_t
 
FAR
 *)(c⁄° FAR *)
buf
;

263 
Àn
 >= 32) {

264 
DOLIT32
;

265 
Àn
 -= 32;

267 
Àn
 >= 4) {

268 
DOLIT4
;

269 
Àn
 -= 4;

271 
buf
 = (c⁄° 
FAR
 *)
buf4
;

273 i‡(
Àn
) do {

274 
c
 = 
¸c_èbÀ
[0][(¯^ *
buf
++) & 0xff] ^ (c >> 8);

275 } --
Àn
);

276 
c
 = ~c;

277  ()
c
;

278 
	}
}

281 
	#DOBIG4
 
c
 ^*++
buf4
; \

282 
c
 = 
¸c_èbÀ
[4][c & 0xff] ^ crc_table[5][(c >> 8) & 0xff] ^ \

283 
¸c_èbÀ
[6][(
c
 >> 16Ë& 0xff] ^ crc_èbÀ[7][¯>> 24]

	)

284 
	#DOBIG32
 
DOBIG4
; DOBIG4; DOBIG4; DOBIG4; DOBIG4; DOBIG4; DOBIG4; 
	)
DOBIG4

287 
loˇl
 
	$¸c32_big
(
¸c
, 
buf
, 
Àn
)

288 
¸c
;

289 c⁄° 
FAR
 *
buf
;

290 
Àn
;

292 
z_¸c_t
 
c
;

293 c⁄° 
z_¸c_t
 
FAR
 *
buf4
;

295 
c
 = 
	`ZSWAP32
((
z_¸c_t
)
¸c
);

296 
c
 = ~c;

297 
Àn
 && ((
±rdiff_t
)
buf
 & 3)) {

298 
c
 = 
¸c_èbÀ
[4][(¯>> 24Ë^ *
buf
++] ^ (c << 8);

299 
Àn
--;

302 
buf4
 = (c⁄° 
z_¸c_t
 
FAR
 *)(c⁄° FAR *)
buf
;

303 
buf4
--;

304 
Àn
 >= 32) {

305 
DOBIG32
;

306 
Àn
 -= 32;

308 
Àn
 >= 4) {

309 
DOBIG4
;

310 
Àn
 -= 4;

312 
buf4
++;

313 
buf
 = (c⁄° 
FAR
 *)
buf4
;

315 i‡(
Àn
) do {

316 
c
 = 
¸c_èbÀ
[4][(¯>> 24Ë^ *
buf
++] ^ (c << 8);

317 } --
Àn
);

318 
c
 = ~c;

319  ()(
	`ZSWAP32
(
c
));

320 
	}
}

324 
	#GF2_DIM
 32

	)

327 
loˇl
 
	$gf2_m©rix_times
(
m©
, 
vec
)

328 *
m©
;

329 
vec
;

331 
sum
;

333 
sum
 = 0;

334 
vec
) {

335 i‡(
vec
 & 1)

336 
sum
 ^*
m©
;

337 
vec
 >>= 1;

338 
m©
++;

340  
sum
;

341 
	}
}

344 
loˇl
 
	$gf2_m©rix_squ¨e
(
squ¨e
, 
m©
)

345 *
squ¨e
;

346 *
m©
;

348 
n
;

350 
n
 = 0;Ç < 
GF2_DIM
;Ç++)

351 
squ¨e
[
n
] = 
	`gf2_m©rix_times
(
m©
, mat[n]);

352 
	}
}

355 
loˇl
 
uL⁄g
 
	$¸c32_comböe_
(
¸c1
, 
¸c2
, 
Àn2
)

356 
uL⁄g
 
¸c1
;

357 
uL⁄g
 
¸c2
;

358 
z_off64_t
 
Àn2
;

360 
n
;

361 
row
;

362 
eví
[
GF2_DIM
];

363 
odd
[
GF2_DIM
];

366 i‡(
Àn2
 <= 0)

367  
¸c1
;

370 
odd
[0] = 0xedb88320UL;

371 
row
 = 1;

372 
n
 = 1;Ç < 
GF2_DIM
;Ç++) {

373 
odd
[
n
] = 
row
;

374 
row
 <<= 1;

378 
	`gf2_m©rix_squ¨e
(
eví
, 
odd
);

381 
	`gf2_m©rix_squ¨e
(
odd
, 
eví
);

387 
	`gf2_m©rix_squ¨e
(
eví
, 
odd
);

388 i‡(
Àn2
 & 1)

389 
¸c1
 = 
	`gf2_m©rix_times
(
eví
, crc1);

390 
Àn2
 >>= 1;

393 i‡(
Àn2
 == 0)

397 
	`gf2_m©rix_squ¨e
(
odd
, 
eví
);

398 i‡(
Àn2
 & 1)

399 
¸c1
 = 
	`gf2_m©rix_times
(
odd
, crc1);

400 
Àn2
 >>= 1;

403 } 
Àn2
 != 0);

406 
¸c1
 ^
¸c2
;

407  
¸c1
;

408 
	}
}

411 
uL⁄g
 
ZEXPORT
 
	$¸c32_comböe
(
¸c1
, 
¸c2
, 
Àn2
)

412 
uL⁄g
 
¸c1
;

413 
uL⁄g
 
¸c2
;

414 
z_off_t
 
Àn2
;

416  
	`¸c32_comböe_
(
¸c1
, 
¸c2
, 
Àn2
);

417 
	}
}

419 
uL⁄g
 
ZEXPORT
 
	$¸c32_comböe64
(
¸c1
, 
¸c2
, 
Àn2
)

420 
uL⁄g
 
¸c1
;

421 
uL⁄g
 
¸c2
;

422 
z_off64_t
 
Àn2
;

424  
	`¸c32_comböe_
(
¸c1
, 
¸c2
, 
Àn2
);

425 
	}
}

	@zlib-1.2.8/crc32.h

5 
loˇl
 c⁄° 
z_¸c_t
 
FAR
 
	g¸c_èbÀ
[
TBLS
][256] =

60 #ifde‡
BYFOUR


	@zlib-1.2.8/deflate.c

52 
	~"deÊ©e.h
"

54 c⁄° 
	gdeÊ©e_c›yright
[] =

67 
	m√ed_m‹e
,

68 
	mblock_d⁄e
,

69 
	mföish_°¨ãd
,

70 
	mföish_d⁄e


71 } 
	tblock_°©e
;

73 
	$block_°©e
 (*
	tcom¥ess_func
Ë
	tOF
((
	tdeÊ©e_°©e
 *
	ts
, 
	tÊush
));

76 
loˇl
 
fûl_wödow
 
	`OF
((
deÊ©e_°©e
 *
s
));

77 
loˇl
 
block_°©e
 
deÊ©e_°‹ed
 
	`OF
((
deÊ©e_°©e
 *
s
, 
Êush
));

78 
loˇl
 
block_°©e
 
deÊ©e_Á°
 
	`OF
((
deÊ©e_°©e
 *
s
, 
Êush
));

79 #i‚de‡
FASTEST


80 
loˇl
 
block_°©e
 
deÊ©e_¶ow
 
	`OF
((
deÊ©e_°©e
 *
s
, 
Êush
));

82 
loˇl
 
block_°©e
 
deÊ©e_æe
 
	`OF
((
deÊ©e_°©e
 *
s
, 
Êush
));

83 
loˇl
 
block_°©e
 
deÊ©e_huff
 
	`OF
((
deÊ©e_°©e
 *
s
, 
Êush
));

84 
loˇl
 
lm_öô
 
	`OF
((
deÊ©e_°©e
 *
s
));

85 
loˇl
 
putSh‹tMSB
 
	`OF
((
deÊ©e_°©e
 *
s
, 
uI¡
 
b
));

86 
loˇl
 
Êush_≥ndög
 
	`OF
((
z_°ªamp
 
°rm
));

87 
loˇl
 
ªad_buf
 
	`OF
((
z_°ªamp
 
°rm
, 
Byãf
 *
buf
, 
size
));

88 #ifde‡
ASMV


89 
m©ch_öô
 
	`OF
(());

90 
uI¡
 
l⁄ge°_m©ch
 
	`OF
((
deÊ©e_°©e
 *
s
, 
IPos
 
cur_m©ch
));

92 
loˇl
 
uI¡
 
l⁄ge°_m©ch
 
	`OF
((
deÊ©e_°©e
 *
s
, 
IPos
 
cur_m©ch
));

95 #ifde‡
DEBUG


96 
loˇl
 
check_m©ch
 
	`OF
((
deÊ©e_°©e
 *
s
, 
IPos
 
°¨t
, IPo†
m©ch
,

97 
Àngth
));

104 
	#NIL
 0

	)

107 #i‚de‡
TOO_FAR


108 
	#TOO_FAR
 4096

	)

117 
	sc⁄fig_s
 {

118 
ush
 
good_Àngth
;

119 
ush
 
max_œzy
;

120 
ush
 
ni˚_Àngth
;

121 
ush
 
max_chaö
;

122 
com¥ess_func
 
func
;

123 } 
	tc⁄fig
;

125 #ifde‡
FASTEST


126 
loˇl
 c⁄° 
c⁄fig
 
c⁄figuøti⁄_èbÀ
[2] = {

128  {0, 0, 0, 0, 
deÊ©e_°‹ed
},

129  {4, 4, 8, 4, 
deÊ©e_Á°
}
	}
};

131 
loˇl
 c⁄° 
c⁄fig
 
	gc⁄figuøti⁄_èbÀ
[10] = {

133  {0, 0, 0, 0, 
deÊ©e_°‹ed
},

134  {4, 4, 8, 4, 
deÊ©e_Á°
},

135  {4, 5, 16, 8, 
deÊ©e_Á°
},

136  {4, 6, 32, 32, 
deÊ©e_Á°
},

138  {4, 4, 16, 16, 
deÊ©e_¶ow
},

139  {8, 16, 32, 32, 
deÊ©e_¶ow
},

140  {8, 16, 128, 128, 
deÊ©e_¶ow
},

141  {8, 32, 128, 256, 
deÊ©e_¶ow
},

142  {32, 128, 258, 1024, 
deÊ©e_¶ow
},

143  {32, 258, 258, 4096, 
deÊ©e_¶ow
}};

151 
	#EQUAL
 0

	)

154 #i‚de‡
NO_DUMMY_DECL


155 
	s°©ic_åì_desc_s
 {
	mdummy
;};

159 
	#RANK
(
f
Ë(((fË<< 1Ë- ((fË> 4 ? 9 : 0))

	)

167 
	#UPDATE_HASH
(
s
,
h
,
c
Ë(h = (((h)<<s->
hash_shi·
Ë^ (c)Ë& s->
hash_mask
)

	)

180 #ifde‡
FASTEST


181 
	#INSERT_STRING
(
s
, 
°r
, 
m©ch_hód
) \

182 (
	`UPDATE_HASH
(
s
, s->
ös_h
, s->
wödow
[(
°r
Ë+ (
MIN_MATCH
-1)]), \

183 
m©ch_hód
 = 
s
->
hód
[s->
ös_h
], \

184 
s
->
hód
[s->
ös_h
] = (
Pos
)(
°r
))

	)

186 
	#INSERT_STRING
(
s
, 
°r
, 
m©ch_hód
) \

187 (
	`UPDATE_HASH
(
s
, s->
ös_h
, s->
wödow
[(
°r
Ë+ (
MIN_MATCH
-1)]), \

188 
m©ch_hód
 = 
s
->
¥ev
[(
°r
Ë& s->
w_mask
] = s->
hód
[s->
ös_h
], \

189 
s
->
hód
[s->
ös_h
] = (
Pos
)(
°r
))

	)

196 
	#CLEAR_HASH
(
s
) \

197 
s
->
hód
[s->
hash_size
-1] = 
NIL
; \

198 
	`zmemzîo
((
Byãf
 *)
s
->
hód
, ()(s->
hash_size
-1)*(*s->hód));

	)

201 
ZEXPORT
 
	$deÊ©eInô_
(
°rm
, 
Àvñ
, 
vîsi⁄
, 
°ªam_size
)

202 
z_°ªamp
 
°rm
;

203 
Àvñ
;

204 c⁄° *
vîsi⁄
;

205 
°ªam_size
;

207  
	`deÊ©eInô2_
(
°rm
, 
Àvñ
, 
Z_DEFLATED
, 
MAX_WBITS
, 
DEF_MEM_LEVEL
,

208 
Z_DEFAULT_STRATEGY
, 
vîsi⁄
, 
°ªam_size
);

210 
	}
}

213 
ZEXPORT
 
	$deÊ©eInô2_
(
°rm
, 
Àvñ
, 
mëhod
, 
wödowBôs
, 
memLevñ
, 
°øãgy
,

214 
vîsi⁄
, 
°ªam_size
)

215 
z_°ªamp
 
°rm
;

216 
Àvñ
;

217 
mëhod
;

218 
wödowBôs
;

219 
memLevñ
;

220 
°øãgy
;

221 c⁄° *
vîsi⁄
;

222 
°ªam_size
;

224 
deÊ©e_°©e
 *
s
;

225 
wøp
 = 1;

226 c⁄° 
my_vîsi⁄
[] = 
ZLIB_VERSION
;

228 
ushf
 *
ovîœy
;

233 i‡(
vîsi⁄
 =
Z_NULL
 || vîsi⁄[0] !
my_vîsi⁄
[0] ||

234 
°ªam_size
 !(
z_°ªam
)) {

235  
Z_VERSION_ERROR
;

237 i‡(
°rm
 =
Z_NULL
Ë 
Z_STREAM_ERROR
;

239 
°rm
->
msg
 = 
Z_NULL
;

240 i‡(
°rm
->
zÆloc
 =(
Æloc_func
)0) {

241 #ifde‡
Z_SOLO


242  
Z_STREAM_ERROR
;

244 
°rm
->
zÆloc
 = 
zˇŒoc
;

245 
°rm
->
›aque
 = (
voidpf
)0;

248 i‡(
°rm
->
z‰ì
 =(
‰ì_func
)0)

249 #ifde‡
Z_SOLO


250  
Z_STREAM_ERROR
;

252 
°rm
->
z‰ì
 = 
zc‰ì
;

255 #ifde‡
FASTEST


256 i‡(
Àvñ
 != 0)Üevel = 1;

258 i‡(
Àvñ
 =
Z_DEFAULT_COMPRESSION
)Üevel = 6;

261 i‡(
wödowBôs
 < 0) {

262 
wøp
 = 0;

263 
wödowBôs
 = -windowBits;

265 #ifde‡
GZIP


266 i‡(
wödowBôs
 > 15) {

267 
wøp
 = 2;

268 
wödowBôs
 -= 16;

271 i‡(
memLevñ
 < 1 || memLevñ > 
MAX_MEM_LEVEL
 || 
mëhod
 !
Z_DEFLATED
 ||

272 
wödowBôs
 < 8 || wödowBô†> 15 || 
Àvñ
 < 0 ||Üevel > 9 ||

273 
°øãgy
 < 0 || så©egy > 
Z_FIXED
) {

274  
Z_STREAM_ERROR
;

276 i‡(
wödowBôs
 == 8) windowBits = 9;

277 
s
 = (
deÊ©e_°©e
 *Ë
	`ZALLOC
(
°rm
, 1, (deflate_state));

278 i‡(
s
 =
Z_NULL
Ë 
Z_MEM_ERROR
;

279 
°rm
->
°©e
 = (
öã∫Æ_°©e
 
FAR
 *)
s
;

280 
s
->
°rm
 = strm;

282 
s
->
wøp
 = wrap;

283 
s
->
gzhód
 = 
Z_NULL
;

284 
s
->
w_bôs
 = 
wödowBôs
;

285 
s
->
w_size
 = 1 << s->
w_bôs
;

286 
s
->
w_mask
 = s->
w_size
 - 1;

288 
s
->
hash_bôs
 = 
memLevñ
 + 7;

289 
s
->
hash_size
 = 1 << s->
hash_bôs
;

290 
s
->
hash_mask
 = s->
hash_size
 - 1;

291 
s
->
hash_shi·
 = ((s->
hash_bôs
+
MIN_MATCH
-1)/MIN_MATCH);

293 
s
->
wödow
 = (
Byãf
 *Ë
	`ZALLOC
(
°rm
, s->
w_size
, 2*(
Byã
));

294 
s
->
¥ev
 = (
Posf
 *Ë
	`ZALLOC
(
°rm
, s->
w_size
, (
Pos
));

295 
s
->
hód
 = (
Posf
 *Ë
	`ZALLOC
(
°rm
, s->
hash_size
, (
Pos
));

297 
s
->
high_w©î
 = 0;

299 
s
->
lô_bufsize
 = 1 << (
memLevñ
 + 6);

301 
ovîœy
 = (
ushf
 *Ë
	`ZALLOC
(
°rm
, 
s
->
lô_bufsize
, (
ush
)+2);

302 
s
->
≥ndög_buf
 = (
uchf
 *Ë
ovîœy
;

303 
s
->
≥ndög_buf_size
 = (
ulg
)s->
lô_bufsize
 * ((
ush
)+2L);

305 i‡(
s
->
wödow
 =
Z_NULL
 || s->
¥ev
 =Z_NULL || s->
hód
 == Z_NULL ||

306 
s
->
≥ndög_buf
 =
Z_NULL
) {

307 
s
->
°©us
 = 
FINISH_STATE
;

308 
°rm
->
msg
 = 
	`ERR_MSG
(
Z_MEM_ERROR
);

309 
	`deÊ©eEnd
 (
°rm
);

310  
Z_MEM_ERROR
;

312 
s
->
d_buf
 = 
ovîœy
 + s->
lô_bufsize
/(
ush
);

313 
s
->
l_buf
 = s->
≥ndög_buf
 + (1+(
ush
))*s->
lô_bufsize
;

315 
s
->
Àvñ
 =Üevel;

316 
s
->
°øãgy
 = strategy;

317 
s
->
mëhod
 = (
Byã
)method;

319  
	`deÊ©eRe£t
(
°rm
);

320 
	}
}

323 
ZEXPORT
 
	$deÊ©eSëDi˘i⁄¨y
 (
°rm
, 
di˘i⁄¨y
, 
di˘Lígth
)

324 
z_°ªamp
 
°rm
;

325 c⁄° 
Byãf
 *
di˘i⁄¨y
;

326 
uI¡
 
di˘Lígth
;

328 
deÊ©e_°©e
 *
s
;

329 
uI¡
 
°r
, 
n
;

330 
wøp
;

331 
avaû
;

332 
z_c⁄°
 *
√xt
;

334 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 =Z_NULL || 
di˘i⁄¨y
 == Z_NULL)

335  
Z_STREAM_ERROR
;

336 
s
 = 
°rm
->
°©e
;

337 
wøp
 = 
s
->wrap;

338 i‡(
wøp
 =2 || (wø∞=1 && 
s
->
°©us
 !
INIT_STATE
Ë|| s->
lookahód
)

339  
Z_STREAM_ERROR
;

342 i‡(
wøp
 == 1)

343 
°rm
->
adÀr
 = 
	`adÀr32
(°rm->adÀr, 
di˘i⁄¨y
, 
di˘Lígth
);

344 
s
->
wøp
 = 0;

347 i‡(
di˘Lígth
 >
s
->
w_size
) {

348 i‡(
wøp
 == 0) {

349 
	`CLEAR_HASH
(
s
);

350 
s
->
°r°¨t
 = 0;

351 
s
->
block_°¨t
 = 0L;

352 
s
->
ö£π
 = 0;

354 
di˘i⁄¨y
 +
di˘Lígth
 - 
s
->
w_size
;

355 
di˘Lígth
 = 
s
->
w_size
;

359 
avaû
 = 
°rm
->
avaû_ö
;

360 
√xt
 = 
°rm
->
√xt_ö
;

361 
°rm
->
avaû_ö
 = 
di˘Lígth
;

362 
°rm
->
√xt_ö
 = (
z_c⁄°
 
Byãf
 *)
di˘i⁄¨y
;

363 
	`fûl_wödow
(
s
);

364 
s
->
lookahód
 >
MIN_MATCH
) {

365 
°r
 = 
s
->
°r°¨t
;

366 
n
 = 
s
->
lookahód
 - (
MIN_MATCH
-1);

368 
	`UPDATE_HASH
(
s
, s->
ös_h
, s->
wödow
[
°r
 + 
MIN_MATCH
-1]);

369 #i‚de‡
FASTEST


370 
s
->
¥ev
[
°r
 & s->
w_mask
] = s->
hód
[s->
ös_h
];

372 
s
->
hód
[s->
ös_h
] = (
Pos
)
°r
;

373 
°r
++;

374 } --
n
);

375 
s
->
°r°¨t
 = 
°r
;

376 
s
->
lookahód
 = 
MIN_MATCH
-1;

377 
	`fûl_wödow
(
s
);

379 
s
->
°r°¨t
 +s->
lookahód
;

380 
s
->
block_°¨t
 = ()s->
°r°¨t
;

381 
s
->
ö£π
 = s->
lookahód
;

382 
s
->
lookahód
 = 0;

383 
s
->
m©ch_Àngth
 = s->
¥ev_Àngth
 = 
MIN_MATCH
-1;

384 
s
->
m©ch_avaûabÀ
 = 0;

385 
°rm
->
√xt_ö
 = 
√xt
;

386 
°rm
->
avaû_ö
 = 
avaû
;

387 
s
->
wøp
 = wrap;

388  
Z_OK
;

389 
	}
}

392 
ZEXPORT
 
	$deÊ©eRe£tKìp
 (
°rm
)

393 
z_°ªamp
 
°rm
;

395 
deÊ©e_°©e
 *
s
;

397 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 == Z_NULL ||

398 
°rm
->
zÆloc
 =(
Æloc_func
)0 || såm->
z‰ì
 =(
‰ì_func
)0) {

399  
Z_STREAM_ERROR
;

402 
°rm
->
tŸÆ_ö
 = såm->
tŸÆ_out
 = 0;

403 
°rm
->
msg
 = 
Z_NULL
;

404 
°rm
->
d©a_ty≥
 = 
Z_UNKNOWN
;

406 
s
 = (
deÊ©e_°©e
 *)
°rm
->
°©e
;

407 
s
->
≥ndög
 = 0;

408 
s
->
≥ndög_out
 = s->
≥ndög_buf
;

410 i‡(
s
->
wøp
 < 0) {

411 
s
->
wøp
 = -s->wrap;

413 
s
->
°©us
 = s->
wøp
 ? 
INIT_STATE
 : 
BUSY_STATE
;

414 
°rm
->
adÀr
 =

415 #ifde‡
GZIP


416 
s
->
wøp
 =2 ? 
	`¸c32
(0L, 
Z_NULL
, 0) :

418 
	`adÀr32
(0L, 
Z_NULL
, 0);

419 
s
->
œ°_Êush
 = 
Z_NO_FLUSH
;

421 
	`_å_öô
(
s
);

423  
Z_OK
;

424 
	}
}

427 
ZEXPORT
 
	$deÊ©eRe£t
 (
°rm
)

428 
z_°ªamp
 
°rm
;

430 
ªt
;

432 
ªt
 = 
	`deÊ©eRe£tKìp
(
°rm
);

433 i‡(
ªt
 =
Z_OK
)

434 
	`lm_öô
(
°rm
->
°©e
);

435  
ªt
;

436 
	}
}

439 
ZEXPORT
 
	$deÊ©eSëHódî
 (
°rm
, 
hód
)

440 
z_°ªamp
 
°rm
;

441 
gz_hódîp
 
hód
;

443 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 =Z_NULLË 
Z_STREAM_ERROR
;

444 i‡(
°rm
->
°©e
->
wøp
 !2Ë 
Z_STREAM_ERROR
;

445 
°rm
->
°©e
->
gzhód
 = 
hód
;

446  
Z_OK
;

447 
	}
}

450 
ZEXPORT
 
	$deÊ©ePídög
 (
°rm
, 
≥ndög
, 
bôs
)

451 *
≥ndög
;

452 *
bôs
;

453 
z_°ªamp
 
°rm
;

455 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 =Z_NULLË 
Z_STREAM_ERROR
;

456 i‡(
≥ndög
 !
Z_NULL
)

457 *
≥ndög
 = 
°rm
->
°©e
->pending;

458 i‡(
bôs
 !
Z_NULL
)

459 *
bôs
 = 
°rm
->
°©e
->
bi_vÆid
;

460  
Z_OK
;

461 
	}
}

464 
ZEXPORT
 
	$deÊ©ePrime
 (
°rm
, 
bôs
, 
vÆue
)

465 
z_°ªamp
 
°rm
;

466 
bôs
;

467 
vÆue
;

469 
deÊ©e_°©e
 *
s
;

470 
put
;

472 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 =Z_NULLË 
Z_STREAM_ERROR
;

473 
s
 = 
°rm
->
°©e
;

474 i‡((
Byãf
 *)(
s
->
d_buf
Ë< s->
≥ndög_out
 + ((
Buf_size
 + 7) >> 3))

475  
Z_BUF_ERROR
;

477 
put
 = 
Buf_size
 - 
s
->
bi_vÆid
;

478 i‡(
put
 > 
bôs
)

479 
put
 = 
bôs
;

480 
s
->
bi_buf
 |(
ush
)((
vÆue
 & ((1 << 
put
Ë- 1)Ë<< s->
bi_vÆid
);

481 
s
->
bi_vÆid
 +
put
;

482 
	`_å_Êush_bôs
(
s
);

483 
vÆue
 >>
put
;

484 
bôs
 -
put
;

485 } 
bôs
);

486  
Z_OK
;

487 
	}
}

490 
ZEXPORT
 
	$deÊ©eP¨ams
(
°rm
, 
Àvñ
, 
°øãgy
)

491 
z_°ªamp
 
°rm
;

492 
Àvñ
;

493 
°øãgy
;

495 
deÊ©e_°©e
 *
s
;

496 
com¥ess_func
 
func
;

497 
îr
 = 
Z_OK
;

499 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 =Z_NULLË 
Z_STREAM_ERROR
;

500 
s
 = 
°rm
->
°©e
;

502 #ifde‡
FASTEST


503 i‡(
Àvñ
 != 0)Üevel = 1;

505 i‡(
Àvñ
 =
Z_DEFAULT_COMPRESSION
)Üevel = 6;

507 i‡(
Àvñ
 < 0 ||Üevñ > 9 || 
°øãgy
 < 0 || så©egy > 
Z_FIXED
) {

508  
Z_STREAM_ERROR
;

510 
func
 = 
c⁄figuøti⁄_èbÀ
[
s
->
Àvñ
].func;

512 i‡((
°øãgy
 !
s
->°øãgy || 
func
 !
c⁄figuøti⁄_èbÀ
[
Àvñ
].func) &&

513 
°rm
->
tŸÆ_ö
 != 0) {

515 
îr
 = 
	`deÊ©e
(
°rm
, 
Z_BLOCK
);

516 i‡(
îr
 =
Z_BUF_ERROR
 && 
s
->
≥ndög
 == 0)

517 
îr
 = 
Z_OK
;

519 i‡(
s
->
Àvñ
 !=Üevel) {

520 
s
->
Àvñ
 =Üevel;

521 
s
->
max_œzy_m©ch
 = 
c⁄figuøti⁄_èbÀ
[
Àvñ
].
max_œzy
;

522 
s
->
good_m©ch
 = 
c⁄figuøti⁄_èbÀ
[
Àvñ
].
good_Àngth
;

523 
s
->
ni˚_m©ch
 = 
c⁄figuøti⁄_èbÀ
[
Àvñ
].
ni˚_Àngth
;

524 
s
->
max_chaö_Àngth
 = 
c⁄figuøti⁄_èbÀ
[
Àvñ
].
max_chaö
;

526 
s
->
°øãgy
 = strategy;

527  
îr
;

528 
	}
}

531 
ZEXPORT
 
	$deÊ©eTu√
(
°rm
, 
good_Àngth
, 
max_œzy
, 
ni˚_Àngth
, 
max_chaö
)

532 
z_°ªamp
 
°rm
;

533 
good_Àngth
;

534 
max_œzy
;

535 
ni˚_Àngth
;

536 
max_chaö
;

538 
deÊ©e_°©e
 *
s
;

540 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 =Z_NULLË 
Z_STREAM_ERROR
;

541 
s
 = 
°rm
->
°©e
;

542 
s
->
good_m©ch
 = 
good_Àngth
;

543 
s
->
max_œzy_m©ch
 = 
max_œzy
;

544 
s
->
ni˚_m©ch
 = 
ni˚_Àngth
;

545 
s
->
max_chaö_Àngth
 = 
max_chaö
;

546  
Z_OK
;

547 
	}
}

566 
uL⁄g
 
ZEXPORT
 
	$deÊ©eBound
(
°rm
, 
sour˚Lí
)

567 
z_°ªamp
 
°rm
;

568 
uL⁄g
 
sour˚Lí
;

570 
deÊ©e_°©e
 *
s
;

571 
uL⁄g
 
com∂í
, 
wø∂í
;

572 
Byãf
 *
°r
;

575 
com∂í
 = 
sour˚Lí
 +

576 ((
sour˚Lí
 + 7) >> 3) + ((sourceLen + 63) >> 6) + 5;

579 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 == Z_NULL)

580  
com∂í
 + 6;

583 
s
 = 
°rm
->
°©e
;

584 
s
->
wøp
) {

586 
wø∂í
 = 0;

589 
wø∂í
 = 6 + (
s
->
°r°¨t
 ? 4 : 0);

592 
wø∂í
 = 18;

593 i‡(
s
->
gzhód
 !
Z_NULL
) {

594 i‡(
s
->
gzhód
->
exåa
 !
Z_NULL
)

595 
wø∂í
 +2 + 
s
->
gzhód
->
exåa_Àn
;

596 
°r
 = 
s
->
gzhód
->
«me
;

597 i‡(
°r
 !
Z_NULL
)

599 
wø∂í
++;

600 } *
°r
++);

601 
°r
 = 
s
->
gzhód
->
commít
;

602 i‡(
°r
 !
Z_NULL
)

604 
wø∂í
++;

605 } *
°r
++);

606 i‡(
s
->
gzhód
->
h¸c
)

607 
wø∂í
 += 2;

611 
wø∂í
 = 6;

615 i‡(
s
->
w_bôs
 !15 || s->
hash_bôs
 != 8 + 7)

616  
com∂í
 + 
wø∂í
;

619  
sour˚Lí
 + (sourceLen >> 12) + (sourceLen >> 14) +

620 (
sour˚Lí
 >> 25Ë+ 13 - 6 + 
wø∂í
;

621 
	}
}

628 
loˇl
 
	$putSh‹tMSB
 (
s
, 
b
)

629 
deÊ©e_°©e
 *
s
;

630 
uI¡
 
b
;

632 
	`put_byã
(
s
, (
Byã
)(
b
 >> 8));

633 
	`put_byã
(
s
, (
Byã
)(
b
 & 0xff));

634 
	}
}

642 
loˇl
 
	$Êush_≥ndög
(
°rm
)

643 
z_°ªamp
 
°rm
;

645 
Àn
;

646 
deÊ©e_°©e
 *
s
 = 
°rm
->
°©e
;

648 
	`_å_Êush_bôs
(
s
);

649 
Àn
 = 
s
->
≥ndög
;

650 i‡(
Àn
 > 
°rm
->
avaû_out
)Üen = strm->avail_out;

651 i‡(
Àn
 == 0) ;

653 
	`zmem˝y
(
°rm
->
√xt_out
, 
s
->
≥ndög_out
, 
Àn
);

654 
°rm
->
√xt_out
 +
Àn
;

655 
s
->
≥ndög_out
 +
Àn
;

656 
°rm
->
tŸÆ_out
 +
Àn
;

657 
°rm
->
avaû_out
 -
Àn
;

658 
s
->
≥ndög
 -
Àn
;

659 i‡(
s
->
≥ndög
 == 0) {

660 
s
->
≥ndög_out
 = s->
≥ndög_buf
;

662 
	}
}

665 
ZEXPORT
 
	$deÊ©e
 (
°rm
, 
Êush
)

666 
z_°ªamp
 
°rm
;

667 
Êush
;

669 
ﬁd_Êush
;

670 
deÊ©e_°©e
 *
s
;

672 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 == Z_NULL ||

673 
Êush
 > 
Z_BLOCK
 || flush < 0) {

674  
Z_STREAM_ERROR
;

676 
s
 = 
°rm
->
°©e
;

678 i‡(
°rm
->
√xt_out
 =
Z_NULL
 ||

679 (
°rm
->
√xt_ö
 =
Z_NULL
 && såm->
avaû_ö
 != 0) ||

680 (
s
->
°©us
 =
FINISH_STATE
 && 
Êush
 !
Z_FINISH
)) {

681 
	`ERR_RETURN
(
°rm
, 
Z_STREAM_ERROR
);

683 i‡(
°rm
->
avaû_out
 =0Ë
	`ERR_RETURN
(°rm, 
Z_BUF_ERROR
);

685 
s
->
°rm
 = strm;

686 
ﬁd_Êush
 = 
s
->
œ°_Êush
;

687 
s
->
œ°_Êush
 = 
Êush
;

690 i‡(
s
->
°©us
 =
INIT_STATE
) {

691 #ifde‡
GZIP


692 i‡(
s
->
wøp
 == 2) {

693 
°rm
->
adÀr
 = 
	`¸c32
(0L, 
Z_NULL
, 0);

694 
	`put_byã
(
s
, 31);

695 
	`put_byã
(
s
, 139);

696 
	`put_byã
(
s
, 8);

697 i‡(
s
->
gzhód
 =
Z_NULL
) {

698 
	`put_byã
(
s
, 0);

699 
	`put_byã
(
s
, 0);

700 
	`put_byã
(
s
, 0);

701 
	`put_byã
(
s
, 0);

702 
	`put_byã
(
s
, 0);

703 
	`put_byã
(
s
, s->
Àvñ
 == 9 ? 2 :

704 (
s
->
°øãgy
 >
Z_HUFFMAN_ONLY
 || s->
Àvñ
 < 2 ?

706 
	`put_byã
(
s
, 
OS_CODE
);

707 
s
->
°©us
 = 
BUSY_STATE
;

710 
	`put_byã
(
s
, (s->
gzhód
->
ãxt
 ? 1 : 0) +

711 (
s
->
gzhód
->
h¸c
 ? 2 : 0) +

712 (
s
->
gzhód
->
exåa
 =
Z_NULL
 ? 0 : 4) +

713 (
s
->
gzhód
->
«me
 =
Z_NULL
 ? 0 : 8) +

714 (
s
->
gzhód
->
commít
 =
Z_NULL
 ? 0 : 16)

716 
	`put_byã
(
s
, (
Byã
)(s->
gzhód
->
time
 & 0xff));

717 
	`put_byã
(
s
, (
Byã
)((s->
gzhód
->
time
 >> 8) & 0xff));

718 
	`put_byã
(
s
, (
Byã
)((s->
gzhód
->
time
 >> 16) & 0xff));

719 
	`put_byã
(
s
, (
Byã
)((s->
gzhód
->
time
 >> 24) & 0xff));

720 
	`put_byã
(
s
, s->
Àvñ
 == 9 ? 2 :

721 (
s
->
°øãgy
 >
Z_HUFFMAN_ONLY
 || s->
Àvñ
 < 2 ?

723 
	`put_byã
(
s
, s->
gzhód
->
os
 & 0xff);

724 i‡(
s
->
gzhód
->
exåa
 !
Z_NULL
) {

725 
	`put_byã
(
s
, s->
gzhód
->
exåa_Àn
 & 0xff);

726 
	`put_byã
(
s
, (s->
gzhód
->
exåa_Àn
 >> 8) & 0xff);

728 i‡(
s
->
gzhód
->
h¸c
)

729 
°rm
->
adÀr
 = 
	`¸c32
(°rm->adÀr, 
s
->
≥ndög_buf
,

730 
s
->
≥ndög
);

731 
s
->
gzödex
 = 0;

732 
s
->
°©us
 = 
EXTRA_STATE
;

738 
uI¡
 
hódî
 = (
Z_DEFLATED
 + ((
s
->
w_bôs
-8)<<4)) << 8;

739 
uI¡
 
Àvñ_Êags
;

741 i‡(
s
->
°øãgy
 >
Z_HUFFMAN_ONLY
 || s->
Àvñ
 < 2)

742 
Àvñ_Êags
 = 0;

743 i‡(
s
->
Àvñ
 < 6)

744 
Àvñ_Êags
 = 1;

745 i‡(
s
->
Àvñ
 == 6)

746 
Àvñ_Êags
 = 2;

748 
Àvñ_Êags
 = 3;

749 
hódî
 |(
Àvñ_Êags
 << 6);

750 i‡(
s
->
°r°¨t
 !0Ë
hódî
 |
PRESET_DICT
;

751 
hódî
 += 31 - (header % 31);

753 
s
->
°©us
 = 
BUSY_STATE
;

754 
	`putSh‹tMSB
(
s
, 
hódî
);

757 i‡(
s
->
°r°¨t
 != 0) {

758 
	`putSh‹tMSB
(
s
, (
uI¡
)(
°rm
->
adÀr
 >> 16));

759 
	`putSh‹tMSB
(
s
, (
uI¡
)(
°rm
->
adÀr
 & 0xffff));

761 
°rm
->
adÀr
 = 
	`adÀr32
(0L, 
Z_NULL
, 0);

764 #ifde‡
GZIP


765 i‡(
s
->
°©us
 =
EXTRA_STATE
) {

766 i‡(
s
->
gzhód
->
exåa
 !
Z_NULL
) {

767 
uI¡
 
beg
 = 
s
->
≥ndög
;

769 
s
->
gzödex
 < (s->
gzhód
->
exåa_Àn
 & 0xffff)) {

770 i‡(
s
->
≥ndög
 =s->
≥ndög_buf_size
) {

771 i‡(
s
->
gzhód
->
h¸c
 && s->
≥ndög
 > 
beg
)

772 
°rm
->
adÀr
 = 
	`¸c32
(°rm->adÀr, 
s
->
≥ndög_buf
 + 
beg
,

773 
s
->
≥ndög
 - 
beg
);

774 
	`Êush_≥ndög
(
°rm
);

775 
beg
 = 
s
->
≥ndög
;

776 i‡(
s
->
≥ndög
 =s->
≥ndög_buf_size
)

779 
	`put_byã
(
s
, s->
gzhód
->
exåa
[s->
gzödex
]);

780 
s
->
gzödex
++;

782 i‡(
s
->
gzhód
->
h¸c
 && s->
≥ndög
 > 
beg
)

783 
°rm
->
adÀr
 = 
	`¸c32
(°rm->adÀr, 
s
->
≥ndög_buf
 + 
beg
,

784 
s
->
≥ndög
 - 
beg
);

785 i‡(
s
->
gzödex
 =s->
gzhód
->
exåa_Àn
) {

786 
s
->
gzödex
 = 0;

787 
s
->
°©us
 = 
NAME_STATE
;

791 
s
->
°©us
 = 
NAME_STATE
;

793 i‡(
s
->
°©us
 =
NAME_STATE
) {

794 i‡(
s
->
gzhód
->
«me
 !
Z_NULL
) {

795 
uI¡
 
beg
 = 
s
->
≥ndög
;

796 
vÆ
;

799 i‡(
s
->
≥ndög
 =s->
≥ndög_buf_size
) {

800 i‡(
s
->
gzhód
->
h¸c
 && s->
≥ndög
 > 
beg
)

801 
°rm
->
adÀr
 = 
	`¸c32
(°rm->adÀr, 
s
->
≥ndög_buf
 + 
beg
,

802 
s
->
≥ndög
 - 
beg
);

803 
	`Êush_≥ndög
(
°rm
);

804 
beg
 = 
s
->
≥ndög
;

805 i‡(
s
->
≥ndög
 =s->
≥ndög_buf_size
) {

806 
vÆ
 = 1;

810 
vÆ
 = 
s
->
gzhód
->
«me
[s->
gzödex
++];

811 
	`put_byã
(
s
, 
vÆ
);

812 } 
vÆ
 != 0);

813 i‡(
s
->
gzhód
->
h¸c
 && s->
≥ndög
 > 
beg
)

814 
°rm
->
adÀr
 = 
	`¸c32
(°rm->adÀr, 
s
->
≥ndög_buf
 + 
beg
,

815 
s
->
≥ndög
 - 
beg
);

816 i‡(
vÆ
 == 0) {

817 
s
->
gzödex
 = 0;

818 
s
->
°©us
 = 
COMMENT_STATE
;

822 
s
->
°©us
 = 
COMMENT_STATE
;

824 i‡(
s
->
°©us
 =
COMMENT_STATE
) {

825 i‡(
s
->
gzhód
->
commít
 !
Z_NULL
) {

826 
uI¡
 
beg
 = 
s
->
≥ndög
;

827 
vÆ
;

830 i‡(
s
->
≥ndög
 =s->
≥ndög_buf_size
) {

831 i‡(
s
->
gzhód
->
h¸c
 && s->
≥ndög
 > 
beg
)

832 
°rm
->
adÀr
 = 
	`¸c32
(°rm->adÀr, 
s
->
≥ndög_buf
 + 
beg
,

833 
s
->
≥ndög
 - 
beg
);

834 
	`Êush_≥ndög
(
°rm
);

835 
beg
 = 
s
->
≥ndög
;

836 i‡(
s
->
≥ndög
 =s->
≥ndög_buf_size
) {

837 
vÆ
 = 1;

841 
vÆ
 = 
s
->
gzhód
->
commít
[s->
gzödex
++];

842 
	`put_byã
(
s
, 
vÆ
);

843 } 
vÆ
 != 0);

844 i‡(
s
->
gzhód
->
h¸c
 && s->
≥ndög
 > 
beg
)

845 
°rm
->
adÀr
 = 
	`¸c32
(°rm->adÀr, 
s
->
≥ndög_buf
 + 
beg
,

846 
s
->
≥ndög
 - 
beg
);

847 i‡(
vÆ
 == 0)

848 
s
->
°©us
 = 
HCRC_STATE
;

851 
s
->
°©us
 = 
HCRC_STATE
;

853 i‡(
s
->
°©us
 =
HCRC_STATE
) {

854 i‡(
s
->
gzhód
->
h¸c
) {

855 i‡(
s
->
≥ndög
 + 2 > s->
≥ndög_buf_size
)

856 
	`Êush_≥ndög
(
°rm
);

857 i‡(
s
->
≥ndög
 + 2 <s->
≥ndög_buf_size
) {

858 
	`put_byã
(
s
, (
Byã
)(
°rm
->
adÀr
 & 0xff));

859 
	`put_byã
(
s
, (
Byã
)((
°rm
->
adÀr
 >> 8) & 0xff));

860 
°rm
->
adÀr
 = 
	`¸c32
(0L, 
Z_NULL
, 0);

861 
s
->
°©us
 = 
BUSY_STATE
;

865 
s
->
°©us
 = 
BUSY_STATE
;

870 i‡(
s
->
≥ndög
 != 0) {

871 
	`Êush_≥ndög
(
°rm
);

872 i‡(
°rm
->
avaû_out
 == 0) {

879 
s
->
œ°_Êush
 = -1;

880  
Z_OK
;

887 } i‡(
°rm
->
avaû_ö
 =0 && 
	`RANK
(
Êush
Ë<RANK(
ﬁd_Êush
) &&

888 
Êush
 !
Z_FINISH
) {

889 
	`ERR_RETURN
(
°rm
, 
Z_BUF_ERROR
);

893 i‡(
s
->
°©us
 =
FINISH_STATE
 && 
°rm
->
avaû_ö
 != 0) {

894 
	`ERR_RETURN
(
°rm
, 
Z_BUF_ERROR
);

899 i‡(
°rm
->
avaû_ö
 !0 || 
s
->
lookahód
 != 0 ||

900 (
Êush
 !
Z_NO_FLUSH
 && 
s
->
°©us
 !
FINISH_STATE
)) {

901 
block_°©e
 
b°©e
;

903 
b°©e
 = 
s
->
°øãgy
 =
Z_HUFFMAN_ONLY
 ? 
	`deÊ©e_huff
(s, 
Êush
) :

904 (
s
->
°øãgy
 =
Z_RLE
 ? 
	`deÊ©e_æe
(s, 
Êush
) :

905 (*(
c⁄figuøti⁄_èbÀ
[
s
->
Àvñ
].
func
))(s, 
Êush
));

907 i‡(
b°©e
 =
föish_°¨ãd
 || b°©ê=
föish_d⁄e
) {

908 
s
->
°©us
 = 
FINISH_STATE
;

910 i‡(
b°©e
 =
√ed_m‹e
 || b°©ê=
föish_°¨ãd
) {

911 i‡(
°rm
->
avaû_out
 == 0) {

912 
s
->
œ°_Êush
 = -1;

914  
Z_OK
;

923 i‡(
b°©e
 =
block_d⁄e
) {

924 i‡(
Êush
 =
Z_PARTIAL_FLUSH
) {

925 
	`_å_Æign
(
s
);

926 } i‡(
Êush
 !
Z_BLOCK
) {

927 
	`_å_°‹ed_block
(
s
, (*)0, 0L, 0);

931 i‡(
Êush
 =
Z_FULL_FLUSH
) {

932 
	`CLEAR_HASH
(
s
);

933 i‡(
s
->
lookahód
 == 0) {

934 
s
->
°r°¨t
 = 0;

935 
s
->
block_°¨t
 = 0L;

936 
s
->
ö£π
 = 0;

940 
	`Êush_≥ndög
(
°rm
);

941 i‡(
°rm
->
avaû_out
 == 0) {

942 
s
->
œ°_Êush
 = -1;

943  
Z_OK
;

947 
	`As£π
(
°rm
->
avaû_out
 > 0, "bug2");

949 i‡(
Êush
 !
Z_FINISH
Ë 
Z_OK
;

950 i‡(
s
->
wøp
 <0Ë 
Z_STREAM_END
;

953 #ifde‡
GZIP


954 i‡(
s
->
wøp
 == 2) {

955 
	`put_byã
(
s
, (
Byã
)(
°rm
->
adÀr
 & 0xff));

956 
	`put_byã
(
s
, (
Byã
)((
°rm
->
adÀr
 >> 8) & 0xff));

957 
	`put_byã
(
s
, (
Byã
)((
°rm
->
adÀr
 >> 16) & 0xff));

958 
	`put_byã
(
s
, (
Byã
)((
°rm
->
adÀr
 >> 24) & 0xff));

959 
	`put_byã
(
s
, (
Byã
)(
°rm
->
tŸÆ_ö
 & 0xff));

960 
	`put_byã
(
s
, (
Byã
)((
°rm
->
tŸÆ_ö
 >> 8) & 0xff));

961 
	`put_byã
(
s
, (
Byã
)((
°rm
->
tŸÆ_ö
 >> 16) & 0xff));

962 
	`put_byã
(
s
, (
Byã
)((
°rm
->
tŸÆ_ö
 >> 24) & 0xff));

967 
	`putSh‹tMSB
(
s
, (
uI¡
)(
°rm
->
adÀr
 >> 16));

968 
	`putSh‹tMSB
(
s
, (
uI¡
)(
°rm
->
adÀr
 & 0xffff));

970 
	`Êush_≥ndög
(
°rm
);

974 i‡(
s
->
wøp
 > 0) s->wrap = -s->wrap;

975  
s
->
≥ndög
 !0 ? 
Z_OK
 : 
Z_STREAM_END
;

976 
	}
}

979 
ZEXPORT
 
	$deÊ©eEnd
 (
°rm
)

980 
z_°ªamp
 
°rm
;

982 
°©us
;

984 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 =Z_NULLË 
Z_STREAM_ERROR
;

986 
°©us
 = 
°rm
->
°©e
->status;

987 i‡(
°©us
 !
INIT_STATE
 &&

988 
°©us
 !
EXTRA_STATE
 &&

989 
°©us
 !
NAME_STATE
 &&

990 
°©us
 !
COMMENT_STATE
 &&

991 
°©us
 !
HCRC_STATE
 &&

992 
°©us
 !
BUSY_STATE
 &&

993 
°©us
 !
FINISH_STATE
) {

994  
Z_STREAM_ERROR
;

998 
	`TRY_FREE
(
°rm
, såm->
°©e
->
≥ndög_buf
);

999 
	`TRY_FREE
(
°rm
, såm->
°©e
->
hód
);

1000 
	`TRY_FREE
(
°rm
, såm->
°©e
->
¥ev
);

1001 
	`TRY_FREE
(
°rm
, såm->
°©e
->
wödow
);

1003 
	`ZFREE
(
°rm
, såm->
°©e
);

1004 
°rm
->
°©e
 = 
Z_NULL
;

1006  
°©us
 =
BUSY_STATE
 ? 
Z_DATA_ERROR
 : 
Z_OK
;

1007 
	}
}

1014 
ZEXPORT
 
	$deÊ©eC›y
 (
de°
, 
sour˚
)

1015 
z_°ªamp
 
de°
;

1016 
z_°ªamp
 
sour˚
;

1018 #ifde‡
MAXSEG_64K


1019  
Z_STREAM_ERROR
;

1021 
deÊ©e_°©e
 *
ds
;

1022 
deÊ©e_°©e
 *
ss
;

1023 
ushf
 *
ovîœy
;

1026 i‡(
sour˚
 =
Z_NULL
 || 
de°
 =Z_NULL || sour˚->
°©e
 == Z_NULL) {

1027  
Z_STREAM_ERROR
;

1030 
ss
 = 
sour˚
->
°©e
;

1032 
	`zmem˝y
((
voidpf
)
de°
, (voidpf)
sour˚
, (
z_°ªam
));

1034 
ds
 = (
deÊ©e_°©e
 *Ë
	`ZALLOC
(
de°
, 1, (deflate_state));

1035 i‡(
ds
 =
Z_NULL
Ë 
Z_MEM_ERROR
;

1036 
de°
->
°©e
 = (
öã∫Æ_°©e
 
FAR
 *Ë
ds
;

1037 
	`zmem˝y
((
voidpf
)
ds
, (voidpf)
ss
, (
deÊ©e_°©e
));

1038 
ds
->
°rm
 = 
de°
;

1040 
ds
->
wödow
 = (
Byãf
 *Ë
	`ZALLOC
(
de°
, ds->
w_size
, 2*(
Byã
));

1041 
ds
->
¥ev
 = (
Posf
 *Ë
	`ZALLOC
(
de°
, ds->
w_size
, (
Pos
));

1042 
ds
->
hód
 = (
Posf
 *Ë
	`ZALLOC
(
de°
, ds->
hash_size
, (
Pos
));

1043 
ovîœy
 = (
ushf
 *Ë
	`ZALLOC
(
de°
, 
ds
->
lô_bufsize
, (
ush
)+2);

1044 
ds
->
≥ndög_buf
 = (
uchf
 *Ë
ovîœy
;

1046 i‡(
ds
->
wödow
 =
Z_NULL
 || ds->
¥ev
 =Z_NULL || ds->
hód
 == Z_NULL ||

1047 
ds
->
≥ndög_buf
 =
Z_NULL
) {

1048 
	`deÊ©eEnd
 (
de°
);

1049  
Z_MEM_ERROR
;

1052 
	`zmem˝y
(
ds
->
wödow
, 
ss
->wödow, ds->
w_size
 * 2 * (
Byã
));

1053 
	`zmem˝y
((
voidpf
)
ds
->
¥ev
, (voidpf)
ss
->¥ev, ds->
w_size
 * (
Pos
));

1054 
	`zmem˝y
((
voidpf
)
ds
->
hód
, (voidpf)
ss
->hód, ds->
hash_size
 * (
Pos
));

1055 
	`zmem˝y
(
ds
->
≥ndög_buf
, 
ss
->≥ndög_buf, (
uI¡
)ds->
≥ndög_buf_size
);

1057 
ds
->
≥ndög_out
 = ds->
≥ndög_buf
 + (
ss
->pending_out - ss->pending_buf);

1058 
ds
->
d_buf
 = 
ovîœy
 + ds->
lô_bufsize
/(
ush
);

1059 
ds
->
l_buf
 = ds->
≥ndög_buf
 + (1+(
ush
))*ds->
lô_bufsize
;

1061 
ds
->
l_desc
.
dyn_åì
 = ds->
dyn_…ªe
;

1062 
ds
->
d_desc
.
dyn_åì
 = ds->
dyn_dåì
;

1063 
ds
->
bl_desc
.
dyn_åì
 = ds->
bl_åì
;

1065  
Z_OK
;

1067 
	}
}

1076 
loˇl
 
	$ªad_buf
(
°rm
, 
buf
, 
size
)

1077 
z_°ªamp
 
°rm
;

1078 
Byãf
 *
buf
;

1079 
size
;

1081 
Àn
 = 
°rm
->
avaû_ö
;

1083 i‡(
Àn
 > 
size
)Üen = size;

1084 i‡(
Àn
 == 0)  0;

1086 
°rm
->
avaû_ö
 -
Àn
;

1088 
	`zmem˝y
(
buf
, 
°rm
->
√xt_ö
, 
Àn
);

1089 i‡(
°rm
->
°©e
->
wøp
 == 1) {

1090 
°rm
->
adÀr
 = 
	`adÀr32
(°rm->adÀr, 
buf
, 
Àn
);

1092 #ifde‡
GZIP


1093 i‡(
°rm
->
°©e
->
wøp
 == 2) {

1094 
°rm
->
adÀr
 = 
	`¸c32
(°rm->adÀr, 
buf
, 
Àn
);

1097 
°rm
->
√xt_ö
 +
Àn
;

1098 
°rm
->
tŸÆ_ö
 +
Àn
;

1100  ()
Àn
;

1101 
	}
}

1106 
loˇl
 
	$lm_öô
 (
s
)

1107 
deÊ©e_°©e
 *
s
;

1109 
s
->
wödow_size
 = (
ulg
)2L*s->
w_size
;

1111 
	`CLEAR_HASH
(
s
);

1115 
s
->
max_œzy_m©ch
 = 
c⁄figuøti⁄_èbÀ
[s->
Àvñ
].
max_œzy
;

1116 
s
->
good_m©ch
 = 
c⁄figuøti⁄_èbÀ
[s->
Àvñ
].
good_Àngth
;

1117 
s
->
ni˚_m©ch
 = 
c⁄figuøti⁄_èbÀ
[s->
Àvñ
].
ni˚_Àngth
;

1118 
s
->
max_chaö_Àngth
 = 
c⁄figuøti⁄_èbÀ
[s->
Àvñ
].
max_chaö
;

1120 
s
->
°r°¨t
 = 0;

1121 
s
->
block_°¨t
 = 0L;

1122 
s
->
lookahód
 = 0;

1123 
s
->
ö£π
 = 0;

1124 
s
->
m©ch_Àngth
 = s->
¥ev_Àngth
 = 
MIN_MATCH
-1;

1125 
s
->
m©ch_avaûabÀ
 = 0;

1126 
s
->
ös_h
 = 0;

1127 #i‚de‡
FASTEST


1128 #ifde‡
ASMV


1129 
	`m©ch_öô
();

1132 
	}
}

1134 #i‚de‡
FASTEST


1144 #i‚de‡
ASMV


1148 
loˇl
 
uI¡
 
	$l⁄ge°_m©ch
(
s
, 
cur_m©ch
)

1149 
deÊ©e_°©e
 *
s
;

1150 
IPos
 
cur_m©ch
;

1152 
chaö_Àngth
 = 
s
->
max_chaö_Àngth
;

1153 
Byãf
 *
sˇn
 = 
s
->
wödow
 + s->
°r°¨t
;

1154 
Byãf
 *
m©ch
;

1155 
Àn
;

1156 
be°_Àn
 = 
s
->
¥ev_Àngth
;

1157 
ni˚_m©ch
 = 
s
->nice_match;

1158 
IPos
 
limô
 = 
s
->
°r°¨t
 > (IPos)
	`MAX_DIST
(s) ?

1159 
s
->
°r°¨t
 - (
IPos
)
	`MAX_DIST
(sË: 
NIL
;

1163 
Posf
 *
¥ev
 = 
s
->prev;

1164 
uI¡
 
wmask
 = 
s
->
w_mask
;

1166 #ifde‡
UNALIGNED_OK


1170 
Byãf
 *
°ªnd
 = 
s
->
wödow
 + s->
°r°¨t
 + 
MAX_MATCH
 - 1;

1171 
ush
 
sˇn_°¨t
 = *(
ushf
*)
sˇn
;

1172 
ush
 
sˇn_íd
 = *(
ushf
*)(
sˇn
+
be°_Àn
-1);

1174 
Byãf
 *
°ªnd
 = 
s
->
wödow
 + s->
°r°¨t
 + 
MAX_MATCH
;

1175 
Byã
 
sˇn_íd1
 = 
sˇn
[
be°_Àn
-1];

1176 
Byã
 
sˇn_íd
 = 
sˇn
[
be°_Àn
];

1182 
	`As£π
(
s
->
hash_bôs
 >8 && 
MAX_MATCH
 == 258, "CodeÅoo clever");

1185 i‡(
s
->
¥ev_Àngth
 >s->
good_m©ch
) {

1186 
chaö_Àngth
 >>= 2;

1191 i‡((
uI¡
)
ni˚_m©ch
 > 
s
->
lookahód
)Çice_match = s->lookahead;

1193 
	`As£π
((
ulg
)
s
->
°r°¨t
 <s->
wödow_size
-
MIN_LOOKAHEAD
, "needÜookahead");

1196 
	`As£π
(
cur_m©ch
 < 
s
->
°r°¨t
, "no future");

1197 
m©ch
 = 
s
->
wödow
 + 
cur_m©ch
;

1207 #i‡(
	`deföed
(
UNALIGNED_OK
Ë&& 
MAX_MATCH
 == 258)

1211 i‡(*(
ushf
*)(
m©ch
+
be°_Àn
-1Ë!
sˇn_íd
 ||

1212 *(
ushf
*)
m©ch
 !
sˇn_°¨t
) ;

1223 
	`As£π
(
sˇn
[2] =
m©ch
[2], "scan[2]?");

1224 
sˇn
++, 
m©ch
++;

1226 } *(
ushf
*)(
sˇn
+=2Ë=*(ushf*)(
m©ch
+=2) &&

1227 *(
ushf
*)(
sˇn
+=2Ë=*(ushf*)(
m©ch
+=2) &&

1228 *(
ushf
*)(
sˇn
+=2Ë=*(ushf*)(
m©ch
+=2) &&

1229 *(
ushf
*)(
sˇn
+=2Ë=*(ushf*)(
m©ch
+=2) &&

1230 
sˇn
 < 
°ªnd
);

1234 
	`As£π
(
sˇn
 <
s
->
wödow
+()(s->
wödow_size
-1), "wild scan");

1235 i‡(*
sˇn
 =*
m©ch
) scan++;

1237 
Àn
 = (
MAX_MATCH
 - 1Ë- ()(
°ªnd
-
sˇn
);

1238 
sˇn
 = 
°ªnd
 - (
MAX_MATCH
-1);

1242 i‡(
m©ch
[
be°_Àn
] !
sˇn_íd
 ||

1243 
m©ch
[
be°_Àn
-1] !
sˇn_íd1
 ||

1244 *
m©ch
 !*
sˇn
 ||

1245 *++
m©ch
 !
sˇn
[1]) ;

1253 
sˇn
 +2, 
m©ch
++;

1254 
	`As£π
(*
sˇn
 =*
m©ch
, "match[2]?");

1260 } *++
sˇn
 =*++
m©ch
 && *++scan == *++match &&

1261 *++
sˇn
 =*++
m©ch
 && *++scan == *++match &&

1262 *++
sˇn
 =*++
m©ch
 && *++scan == *++match &&

1263 *++
sˇn
 =*++
m©ch
 && *++scan == *++match &&

1264 
sˇn
 < 
°ªnd
);

1266 
	`As£π
(
sˇn
 <
s
->
wödow
+()(s->
wödow_size
-1), "wild scan");

1268 
Àn
 = 
MAX_MATCH
 - ()(
°ªnd
 - 
sˇn
);

1269 
sˇn
 = 
°ªnd
 - 
MAX_MATCH
;

1273 i‡(
Àn
 > 
be°_Àn
) {

1274 
s
->
m©ch_°¨t
 = 
cur_m©ch
;

1275 
be°_Àn
 = 
Àn
;

1276 i‡(
Àn
 >
ni˚_m©ch
) ;

1277 #ifde‡
UNALIGNED_OK


1278 
sˇn_íd
 = *(
ushf
*)(
sˇn
+
be°_Àn
-1);

1280 
sˇn_íd1
 = 
sˇn
[
be°_Àn
-1];

1281 
sˇn_íd
 = 
sˇn
[
be°_Àn
];

1284 } (
cur_m©ch
 = 
¥ev
[cur_m©ch & 
wmask
]Ë> 
limô


1285 && --
chaö_Àngth
 != 0);

1287 i‡((
uI¡
)
be°_Àn
 <
s
->
lookahód
)  (uInt)best_len;

1288  
s
->
lookahód
;

1289 
	}
}

1297 
loˇl
 
uI¡
 
	$l⁄ge°_m©ch
(
s
, 
cur_m©ch
)

1298 
deÊ©e_°©e
 *
s
;

1299 
IPos
 
cur_m©ch
;

1301 
Byãf
 *
sˇn
 = 
s
->
wödow
 + s->
°r°¨t
;

1302 
Byãf
 *
m©ch
;

1303 
Àn
;

1304 
Byãf
 *
°ªnd
 = 
s
->
wödow
 + s->
°r°¨t
 + 
MAX_MATCH
;

1309 
	`As£π
(
s
->
hash_bôs
 >8 && 
MAX_MATCH
 == 258, "CodeÅoo clever");

1311 
	`As£π
((
ulg
)
s
->
°r°¨t
 <s->
wödow_size
-
MIN_LOOKAHEAD
, "needÜookahead");

1313 
	`As£π
(
cur_m©ch
 < 
s
->
°r°¨t
, "no future");

1315 
m©ch
 = 
s
->
wödow
 + 
cur_m©ch
;

1319 i‡(
m©ch
[0] !
sˇn
[0] || m©ch[1] !sˇn[1]Ë 
MIN_MATCH
-1;

1327 
sˇn
 +2, 
m©ch
 += 2;

1328 
	`As£π
(*
sˇn
 =*
m©ch
, "match[2]?");

1334 } *++
sˇn
 =*++
m©ch
 && *++scan == *++match &&

1335 *++
sˇn
 =*++
m©ch
 && *++scan == *++match &&

1336 *++
sˇn
 =*++
m©ch
 && *++scan == *++match &&

1337 *++
sˇn
 =*++
m©ch
 && *++scan == *++match &&

1338 
sˇn
 < 
°ªnd
);

1340 
	`As£π
(
sˇn
 <
s
->
wödow
+()(s->
wödow_size
-1), "wild scan");

1342 
Àn
 = 
MAX_MATCH
 - ()(
°ªnd
 - 
sˇn
);

1344 i‡(
Àn
 < 
MIN_MATCH
)  MIN_MATCH - 1;

1346 
s
->
m©ch_°¨t
 = 
cur_m©ch
;

1347  (
uI¡
)
Àn
 <
s
->
lookahód
 ? (uInt)len : s->lookahead;

1348 
	}
}

1352 #ifde‡
DEBUG


1356 
loˇl
 
	$check_m©ch
(
s
, 
°¨t
, 
m©ch
, 
Àngth
)

1357 
deÊ©e_°©e
 *
s
;

1358 
IPos
 
°¨t
, 
m©ch
;

1359 
Àngth
;

1362 i‡(
	`zmemcmp
(
s
->
wödow
 + 
m©ch
,

1363 
s
->
wödow
 + 
°¨t
, 
Àngth
Ë!
EQUAL
) {

1364 
	`Ârötf
(
°dîr
, " start %u, match %u,Üength %d\n",

1365 
°¨t
, 
m©ch
, 
Àngth
);

1367 
	`Ârötf
(
°dîr
, "%c%c", 
s
->
wödow
[
m©ch
++], s->wödow[
°¨t
++]);

1368 } --
Àngth
 != 0);

1369 
	`z_îr‹
("invalid match");

1371 i‡(
z_vîbo£
 > 1) {

1372 
	`Ârötf
(
°dîr
,"\\[%d,%d]", 
°¨t
-
m©ch
, 
Àngth
);

1373 dÿ{ 
	`putc
(
s
->
wödow
[
°¨t
++], 
°dîr
); } --
Àngth
 != 0);

1375 
	}
}

1377 
	#check_m©ch
(
s
, 
°¨t
, 
m©ch
, 
Àngth
)

	)

1390 
loˇl
 
	$fûl_wödow
(
s
)

1391 
deÊ©e_°©e
 *
s
;

1393 
n
, 
m
;

1394 
Posf
 *
p
;

1395 
m‹e
;

1396 
uI¡
 
wsize
 = 
s
->
w_size
;

1398 
	`As£π
(
s
->
lookahód
 < 
MIN_LOOKAHEAD
, "alreadyÉnoughÜookahead");

1401 
m‹e
 = ()(
s
->
wödow_size
 -(
ulg
)s->
lookahód
 -(ulg)s->
°r°¨t
);

1405 i‡(
m‹e
 =0 && 
s
->
°r°¨t
 =0 && s->
lookahód
 == 0) {

1406 
m‹e
 = 
wsize
;

1408 } i‡(
m‹e
 == ()(-1)) {

1412 
m‹e
--;

1419 i‡(
s
->
°r°¨t
 >
wsize
+
	`MAX_DIST
(s)) {

1421 
	`zmem˝y
(
s
->
wödow
, s->wödow+
wsize
, ()wsize);

1422 
s
->
m©ch_°¨t
 -
wsize
;

1423 
s
->
°r°¨t
 -
wsize
;

1424 
s
->
block_°¨t
 -(Ë
wsize
;

1432 
n
 = 
s
->
hash_size
;

1433 
p
 = &
s
->
hód
[
n
];

1435 
m
 = *--
p
;

1436 *
p
 = (
Pos
)(
m
 >
wsize
 ? m-wsizê: 
NIL
);

1437 } --
n
);

1439 
n
 = 
wsize
;

1440 #i‚de‡
FASTEST


1441 
p
 = &
s
->
¥ev
[
n
];

1443 
m
 = *--
p
;

1444 *
p
 = (
Pos
)(
m
 >
wsize
 ? m-wsizê: 
NIL
);

1448 } --
n
);

1450 
m‹e
 +
wsize
;

1452 i‡(
s
->
°rm
->
avaû_ö
 == 0) ;

1465 
	`As£π
(
m‹e
 >= 2, "more < 2");

1467 
n
 = 
	`ªad_buf
(
s
->
°rm
, s->
wödow
 + s->
°r°¨t
 + s->
lookahód
, 
m‹e
);

1468 
s
->
lookahód
 +
n
;

1471 i‡(
s
->
lookahód
 + s->
ö£π
 >
MIN_MATCH
) {

1472 
uI¡
 
°r
 = 
s
->
°r°¨t
 - s->
ö£π
;

1473 
s
->
ös_h
 = s->
wödow
[
°r
];

1474 
	`UPDATE_HASH
(
s
, s->
ös_h
, s->
wödow
[
°r
 + 1]);

1475 #i‡
MIN_MATCH
 != 3

1476 
CÆl
 
	`UPDATE_HASH
(Ë
MIN_MATCH
-3 
m‹e
 
times


1478 
s
->
ö£π
) {

1479 
	`UPDATE_HASH
(
s
, s->
ös_h
, s->
wödow
[
°r
 + 
MIN_MATCH
-1]);

1480 #i‚de‡
FASTEST


1481 
s
->
¥ev
[
°r
 & s->
w_mask
] = s->
hód
[s->
ös_h
];

1483 
s
->
hód
[s->
ös_h
] = (
Pos
)
°r
;

1484 
°r
++;

1485 
s
->
ö£π
--;

1486 i‡(
s
->
lookahód
 + s->
ö£π
 < 
MIN_MATCH
)

1494 } 
s
->
lookahód
 < 
MIN_LOOKAHEAD
 && s->
°rm
->
avaû_ö
 != 0);

1503 i‡(
s
->
high_w©î
 < s->
wödow_size
) {

1504 
ulg
 
cuº
 = 
s
->
°r°¨t
 + (ulg)(s->
lookahód
);

1505 
ulg
 
öô
;

1507 i‡(
s
->
high_w©î
 < 
cuº
) {

1511 
öô
 = 
s
->
wödow_size
 - 
cuº
;

1512 i‡(
öô
 > 
WIN_INIT
)

1513 
öô
 = 
WIN_INIT
;

1514 
	`zmemzîo
(
s
->
wödow
 + 
cuº
, ()
öô
);

1515 
s
->
high_w©î
 = 
cuº
 + 
öô
;

1517 i‡(
s
->
high_w©î
 < (
ulg
)
cuº
 + 
WIN_INIT
) {

1522 
öô
 = (
ulg
)
cuº
 + 
WIN_INIT
 - 
s
->
high_w©î
;

1523 i‡(
öô
 > 
s
->
wödow_size
 - s->
high_w©î
)

1524 
öô
 = 
s
->
wödow_size
 - s->
high_w©î
;

1525 
	`zmemzîo
(
s
->
wödow
 + s->
high_w©î
, ()
öô
);

1526 
s
->
high_w©î
 +
öô
;

1530 
	`As£π
((
ulg
)
s
->
°r°¨t
 <s->
wödow_size
 - 
MIN_LOOKAHEAD
,

1532 
	}
}

1538 
	#FLUSH_BLOCK_ONLY
(
s
, 
œ°
) { \

1539 
	`_å_Êush_block
(
s
, (s->
block_°¨t
 >= 0L ? \

1540 (
ch¨f
 *)&
s
->
wödow
[()s->
block_°¨t
] : \

1541 (
ch¨f
 *)
Z_NULL
), \

1542 (
ulg
)(()
s
->
°r°¨t
 - s->
block_°¨t
), \

1543 (
œ°
)); \

1544 
s
->
block_°¨t
 = s->
°r°¨t
; \

1545 
	`Êush_≥ndög
(
s
->
°rm
); \

1546 
	`Tø˚v
((
°dîr
,"[FLUSH]")); \

1547 }

	)

1550 
	#FLUSH_BLOCK
(
s
, 
œ°
) { \

1551 
	`FLUSH_BLOCK_ONLY
(
s
, 
œ°
); \

1552 i‡(
s
->
°rm
->
avaû_out
 =0Ë (
œ°
Ë? 
föish_°¨ãd
 : 
√ed_m‹e
; \

1553 }

	)

1564 
loˇl
 
block_°©e
 
	$deÊ©e_°‹ed
(
s
, 
Êush
)

1565 
deÊ©e_°©e
 *
s
;

1566 
Êush
;

1571 
ulg
 
max_block_size
 = 0xffff;

1572 
ulg
 
max_°¨t
;

1574 i‡(
max_block_size
 > 
s
->
≥ndög_buf_size
 - 5) {

1575 
max_block_size
 = 
s
->
≥ndög_buf_size
 - 5;

1581 i‡(
s
->
lookahód
 <= 1) {

1583 
	`As£π
(
s
->
°r°¨t
 < s->
w_size
+
	`MAX_DIST
(s) ||

1584 
s
->
block_°¨t
 >()s->
w_size
, "slideÅooÜate");

1586 
	`fûl_wödow
(
s
);

1587 i‡(
s
->
lookahód
 =0 && 
Êush
 =
Z_NO_FLUSH
Ë 
√ed_m‹e
;

1589 i‡(
s
->
lookahód
 == 0) ;

1591 
	`As£π
(
s
->
block_°¨t
 >= 0L, "block gone");

1593 
s
->
°r°¨t
 +s->
lookahód
;

1594 
s
->
lookahód
 = 0;

1597 
max_°¨t
 = 
s
->
block_°¨t
 + 
max_block_size
;

1598 i‡(
s
->
°r°¨t
 =0 || (
ulg
)s->°r°¨à>
max_°¨t
) {

1600 
s
->
lookahód
 = (
uI¡
)(s->
°r°¨t
 - 
max_°¨t
);

1601 
s
->
°r°¨t
 = (
uI¡
)
max_°¨t
;

1602 
	`FLUSH_BLOCK
(
s
, 0);

1607 i‡(
s
->
°r°¨t
 - (
uI¡
)s->
block_°¨t
 >
	`MAX_DIST
(s)) {

1608 
	`FLUSH_BLOCK
(
s
, 0);

1611 
s
->
ö£π
 = 0;

1612 i‡(
Êush
 =
Z_FINISH
) {

1613 
	`FLUSH_BLOCK
(
s
, 1);

1614  
föish_d⁄e
;

1616 i‡(()
s
->
°r°¨t
 > s->
block_°¨t
)

1617 
	`FLUSH_BLOCK
(
s
, 0);

1618  
block_d⁄e
;

1619 
	}
}

1628 
loˇl
 
block_°©e
 
	$deÊ©e_Á°
(
s
, 
Êush
)

1629 
deÊ©e_°©e
 *
s
;

1630 
Êush
;

1632 
IPos
 
hash_hód
;

1633 
bÊush
;

1641 i‡(
s
->
lookahód
 < 
MIN_LOOKAHEAD
) {

1642 
	`fûl_wödow
(
s
);

1643 i‡(
s
->
lookahód
 < 
MIN_LOOKAHEAD
 && 
Êush
 =
Z_NO_FLUSH
) {

1644  
√ed_m‹e
;

1646 i‡(
s
->
lookahód
 == 0) ;

1652 
hash_hód
 = 
NIL
;

1653 i‡(
s
->
lookahód
 >
MIN_MATCH
) {

1654 
	`INSERT_STRING
(
s
, s->
°r°¨t
, 
hash_hód
);

1660 i‡(
hash_hód
 !
NIL
 && 
s
->
°r°¨t
 - hash_hód <
	`MAX_DIST
(s)) {

1665 
s
->
m©ch_Àngth
 = 
	`l⁄ge°_m©ch
 (s, 
hash_hód
);

1668 i‡(
s
->
m©ch_Àngth
 >
MIN_MATCH
) {

1669 
	`check_m©ch
(
s
, s->
°r°¨t
, s->
m©ch_°¨t
, s->
m©ch_Àngth
);

1671 
	`_å_èŒy_di°
(
s
, s->
°r°¨t
 - s->
m©ch_°¨t
,

1672 
s
->
m©ch_Àngth
 - 
MIN_MATCH
, 
bÊush
);

1674 
s
->
lookahód
 -s->
m©ch_Àngth
;

1679 #i‚de‡
FASTEST


1680 i‡(
s
->
m©ch_Àngth
 <s->
max_ö£π_Àngth
 &&

1681 
s
->
lookahód
 >
MIN_MATCH
) {

1682 
s
->
m©ch_Àngth
--;

1684 
s
->
°r°¨t
++;

1685 
	`INSERT_STRING
(
s
, s->
°r°¨t
, 
hash_hód
);

1689 } --
s
->
m©ch_Àngth
 != 0);

1690 
s
->
°r°¨t
++;

1694 
s
->
°r°¨t
 +s->
m©ch_Àngth
;

1695 
s
->
m©ch_Àngth
 = 0;

1696 
s
->
ös_h
 = s->
wödow
[s->
°r°¨t
];

1697 
	`UPDATE_HASH
(
s
, s->
ös_h
, s->
wödow
[s->
°r°¨t
+1]);

1698 #i‡
MIN_MATCH
 != 3

1699 
CÆl
 
	`UPDATE_HASH
(Ë
MIN_MATCH
-3 
m‹e
 
times


1707 
	`Tø˚vv
((
°dîr
,"%c", 
s
->
wödow
[s->
°r°¨t
]));

1708 
	`_å_èŒy_lô
 (
s
, s->
wödow
[s->
°r°¨t
], 
bÊush
);

1709 
s
->
lookahód
--;

1710 
s
->
°r°¨t
++;

1712 i‡(
bÊush
Ë
	`FLUSH_BLOCK
(
s
, 0);

1714 
s
->
ö£π
 = s->
°r°¨t
 < 
MIN_MATCH
-1 ? s->strstart : MIN_MATCH-1;

1715 i‡(
Êush
 =
Z_FINISH
) {

1716 
	`FLUSH_BLOCK
(
s
, 1);

1717  
föish_d⁄e
;

1719 i‡(
s
->
œ°_lô
)

1720 
	`FLUSH_BLOCK
(
s
, 0);

1721  
block_d⁄e
;

1722 
	}
}

1724 #i‚de‡
FASTEST


1730 
loˇl
 
block_°©e
 
	$deÊ©e_¶ow
(
s
, 
Êush
)

1731 
deÊ©e_°©e
 *
s
;

1732 
Êush
;

1734 
IPos
 
hash_hód
;

1735 
bÊush
;

1744 i‡(
s
->
lookahód
 < 
MIN_LOOKAHEAD
) {

1745 
	`fûl_wödow
(
s
);

1746 i‡(
s
->
lookahód
 < 
MIN_LOOKAHEAD
 && 
Êush
 =
Z_NO_FLUSH
) {

1747  
√ed_m‹e
;

1749 i‡(
s
->
lookahód
 == 0) ;

1755 
hash_hód
 = 
NIL
;

1756 i‡(
s
->
lookahód
 >
MIN_MATCH
) {

1757 
	`INSERT_STRING
(
s
, s->
°r°¨t
, 
hash_hód
);

1762 
s
->
¥ev_Àngth
 = s->
m©ch_Àngth
, s->
¥ev_m©ch
 = s->
m©ch_°¨t
;

1763 
s
->
m©ch_Àngth
 = 
MIN_MATCH
-1;

1765 i‡(
hash_hód
 !
NIL
 && 
s
->
¥ev_Àngth
 < s->
max_œzy_m©ch
 &&

1766 
s
->
°r°¨t
 - 
hash_hód
 <
	`MAX_DIST
(s)) {

1771 
s
->
m©ch_Àngth
 = 
	`l⁄ge°_m©ch
 (s, 
hash_hód
);

1774 i‡(
s
->
m©ch_Àngth
 <5 && (s->
°øãgy
 =
Z_FILTERED


1775 #i‡
TOO_FAR
 <= 32767

1776 || (
s
->
m©ch_Àngth
 =
MIN_MATCH
 &&

1777 
s
->
°r°¨t
 - s->
m©ch_°¨t
 > 
TOO_FAR
)

1784 
s
->
m©ch_Àngth
 = 
MIN_MATCH
-1;

1790 i‡(
s
->
¥ev_Àngth
 >
MIN_MATCH
 && s->
m©ch_Àngth
 <= s->prev_length) {

1791 
uI¡
 
max_ö£π
 = 
s
->
°r°¨t
 + s->
lookahód
 - 
MIN_MATCH
;

1794 
	`check_m©ch
(
s
, s->
°r°¨t
-1, s->
¥ev_m©ch
, s->
¥ev_Àngth
);

1796 
	`_å_èŒy_di°
(
s
, s->
°r°¨t
 -1 - s->
¥ev_m©ch
,

1797 
s
->
¥ev_Àngth
 - 
MIN_MATCH
, 
bÊush
);

1804 
s
->
lookahód
 -s->
¥ev_Àngth
-1;

1805 
s
->
¥ev_Àngth
 -= 2;

1807 i‡(++
s
->
°r°¨t
 <
max_ö£π
) {

1808 
	`INSERT_STRING
(
s
, s->
°r°¨t
, 
hash_hód
);

1810 } --
s
->
¥ev_Àngth
 != 0);

1811 
s
->
m©ch_avaûabÀ
 = 0;

1812 
s
->
m©ch_Àngth
 = 
MIN_MATCH
-1;

1813 
s
->
°r°¨t
++;

1815 i‡(
bÊush
Ë
	`FLUSH_BLOCK
(
s
, 0);

1817 } i‡(
s
->
m©ch_avaûabÀ
) {

1822 
	`Tø˚vv
((
°dîr
,"%c", 
s
->
wödow
[s->
°r°¨t
-1]));

1823 
	`_å_èŒy_lô
(
s
, s->
wödow
[s->
°r°¨t
-1], 
bÊush
);

1824 i‡(
bÊush
) {

1825 
	`FLUSH_BLOCK_ONLY
(
s
, 0);

1827 
s
->
°r°¨t
++;

1828 
s
->
lookahód
--;

1829 i‡(
s
->
°rm
->
avaû_out
 =0Ë 
√ed_m‹e
;

1834 
s
->
m©ch_avaûabÀ
 = 1;

1835 
s
->
°r°¨t
++;

1836 
s
->
lookahód
--;

1839 
	`As£π
 (
Êush
 !
Z_NO_FLUSH
, "no flush?");

1840 i‡(
s
->
m©ch_avaûabÀ
) {

1841 
	`Tø˚vv
((
°dîr
,"%c", 
s
->
wödow
[s->
°r°¨t
-1]));

1842 
	`_å_èŒy_lô
(
s
, s->
wödow
[s->
°r°¨t
-1], 
bÊush
);

1843 
s
->
m©ch_avaûabÀ
 = 0;

1845 
s
->
ö£π
 = s->
°r°¨t
 < 
MIN_MATCH
-1 ? s->strstart : MIN_MATCH-1;

1846 i‡(
Êush
 =
Z_FINISH
) {

1847 
	`FLUSH_BLOCK
(
s
, 1);

1848  
föish_d⁄e
;

1850 i‡(
s
->
œ°_lô
)

1851 
	`FLUSH_BLOCK
(
s
, 0);

1852  
block_d⁄e
;

1853 
	}
}

1861 
loˇl
 
block_°©e
 
	$deÊ©e_æe
(
s
, 
Êush
)

1862 
deÊ©e_°©e
 *
s
;

1863 
Êush
;

1865 
bÊush
;

1866 
uI¡
 
¥ev
;

1867 
Byãf
 *
sˇn
, *
°ªnd
;

1874 i‡(
s
->
lookahód
 <
MAX_MATCH
) {

1875 
	`fûl_wödow
(
s
);

1876 i‡(
s
->
lookahód
 <
MAX_MATCH
 && 
Êush
 =
Z_NO_FLUSH
) {

1877  
√ed_m‹e
;

1879 i‡(
s
->
lookahód
 == 0) ;

1883 
s
->
m©ch_Àngth
 = 0;

1884 i‡(
s
->
lookahód
 >
MIN_MATCH
 && s->
°r°¨t
 > 0) {

1885 
sˇn
 = 
s
->
wödow
 + s->
°r°¨t
 - 1;

1886 
¥ev
 = *
sˇn
;

1887 i‡(
¥ev
 =*++
sˇn
 &&Örev == *++scan &&Örev == *++scan) {

1888 
°ªnd
 = 
s
->
wödow
 + s->
°r°¨t
 + 
MAX_MATCH
;

1890 } 
¥ev
 =*++
sˇn
 &&Örev == *++scan &&

1891 
¥ev
 =*++
sˇn
 &&Örev == *++scan &&

1892 
¥ev
 =*++
sˇn
 &&Örev == *++scan &&

1893 
¥ev
 =*++
sˇn
 &&Örev == *++scan &&

1894 
sˇn
 < 
°ªnd
);

1895 
s
->
m©ch_Àngth
 = 
MAX_MATCH
 - ()(
°ªnd
 - 
sˇn
);

1896 i‡(
s
->
m©ch_Àngth
 > s->
lookahód
)

1897 
s
->
m©ch_Àngth
 = s->
lookahód
;

1899 
	`As£π
(
sˇn
 <
s
->
wödow
+(
uI¡
)(s->
wödow_size
-1), "wild scan");

1903 i‡(
s
->
m©ch_Àngth
 >
MIN_MATCH
) {

1904 
	`check_m©ch
(
s
, s->
°r°¨t
, s->°r°¨à- 1, s->
m©ch_Àngth
);

1906 
	`_å_èŒy_di°
(
s
, 1, s->
m©ch_Àngth
 - 
MIN_MATCH
, 
bÊush
);

1908 
s
->
lookahód
 -s->
m©ch_Àngth
;

1909 
s
->
°r°¨t
 +s->
m©ch_Àngth
;

1910 
s
->
m©ch_Àngth
 = 0;

1913 
	`Tø˚vv
((
°dîr
,"%c", 
s
->
wödow
[s->
°r°¨t
]));

1914 
	`_å_èŒy_lô
 (
s
, s->
wödow
[s->
°r°¨t
], 
bÊush
);

1915 
s
->
lookahód
--;

1916 
s
->
°r°¨t
++;

1918 i‡(
bÊush
Ë
	`FLUSH_BLOCK
(
s
, 0);

1920 
s
->
ö£π
 = 0;

1921 i‡(
Êush
 =
Z_FINISH
) {

1922 
	`FLUSH_BLOCK
(
s
, 1);

1923  
föish_d⁄e
;

1925 i‡(
s
->
œ°_lô
)

1926 
	`FLUSH_BLOCK
(
s
, 0);

1927  
block_d⁄e
;

1928 
	}
}

1934 
loˇl
 
block_°©e
 
	$deÊ©e_huff
(
s
, 
Êush
)

1935 
deÊ©e_°©e
 *
s
;

1936 
Êush
;

1938 
bÊush
;

1942 i‡(
s
->
lookahód
 == 0) {

1943 
	`fûl_wödow
(
s
);

1944 i‡(
s
->
lookahód
 == 0) {

1945 i‡(
Êush
 =
Z_NO_FLUSH
)

1946  
√ed_m‹e
;

1952 
s
->
m©ch_Àngth
 = 0;

1953 
	`Tø˚vv
((
°dîr
,"%c", 
s
->
wödow
[s->
°r°¨t
]));

1954 
	`_å_èŒy_lô
 (
s
, s->
wödow
[s->
°r°¨t
], 
bÊush
);

1955 
s
->
lookahód
--;

1956 
s
->
°r°¨t
++;

1957 i‡(
bÊush
Ë
	`FLUSH_BLOCK
(
s
, 0);

1959 
s
->
ö£π
 = 0;

1960 i‡(
Êush
 =
Z_FINISH
) {

1961 
	`FLUSH_BLOCK
(
s
, 1);

1962  
föish_d⁄e
;

1964 i‡(
s
->
œ°_lô
)

1965 
	`FLUSH_BLOCK
(
s
, 0);

1966  
block_d⁄e
;

1967 
	}
}

	@zlib-1.2.8/deflate.h

13 #i‚de‡
DEFLATE_H


14 
	#DEFLATE_H


	)

16 
	~"zutû.h
"

22 #i‚de‡
NO_GZIP


23 
	#GZIP


	)

30 
	#LENGTH_CODES
 29

	)

33 
	#LITERALS
 256

	)

36 
	#L_CODES
 (
LITERALS
+1+
LENGTH_CODES
)

	)

39 
	#D_CODES
 30

	)

42 
	#BL_CODES
 19

	)

45 
	#HEAP_SIZE
 (2*
L_CODES
+1)

	)

48 
	#MAX_BITS
 15

	)

51 
	#Buf_size
 16

	)

54 
	#INIT_STATE
 42

	)

55 
	#EXTRA_STATE
 69

	)

56 
	#NAME_STATE
 73

	)

57 
	#COMMENT_STATE
 91

	)

58 
	#HCRC_STATE
 103

	)

59 
	#BUSY_STATE
 113

	)

60 
	#FINISH_STATE
 666

	)

65 
	s˘_d©a_s
 {

67 
ush
 
	m‰eq
;

68 
ush
 
	mcode
;

69 } 
	mfc
;

71 
ush
 
	mdad
;

72 
ush
 
	mÀn
;

73 } 
	mdl
;

74 } 
	tFAR
 
	t˘_d©a
;

76 
	#Fªq
 
fc
.
‰eq


	)

77 
	#Code
 
fc
.
code


	)

78 
	#Dad
 
dl
.
dad


	)

79 
	#Lí
 
dl
.
Àn


	)

81 
°©ic_åì_desc_s
 
	t°©ic_åì_desc
;

83 
	såì_desc_s
 {

84 
˘_d©a
 *
	mdyn_åì
;

85 
	mmax_code
;

86 
°©ic_åì_desc
 *
	m°©_desc
;

87 } 
	tFAR
 
	tåì_desc
;

89 
ush
 
	tPos
;

90 
Pos
 
	tFAR
 
	tPosf
;

91 
	tIPos
;

97 
	söã∫Æ_°©e
 {

98 
z_°ªamp
 
	m°rm
;

99 
	m°©us
;

100 
Byãf
 *
	m≥ndög_buf
;

101 
ulg
 
	m≥ndög_buf_size
;

102 
Byãf
 *
	m≥ndög_out
;

103 
uI¡
 
	m≥ndög
;

104 
	mwøp
;

105 
gz_hódîp
 
	mgzhód
;

106 
uI¡
 
	mgzödex
;

107 
Byã
 
	mmëhod
;

108 
	mœ°_Êush
;

112 
uI¡
 
	mw_size
;

113 
uI¡
 
	mw_bôs
;

114 
uI¡
 
	mw_mask
;

116 
Byãf
 *
	mwödow
;

126 
ulg
 
	mwödow_size
;

131 
Posf
 *
	m¥ev
;

137 
Posf
 *
	mhód
;

139 
uI¡
 
	mös_h
;

140 
uI¡
 
	mhash_size
;

141 
uI¡
 
	mhash_bôs
;

142 
uI¡
 
	mhash_mask
;

144 
uI¡
 
	mhash_shi·
;

151 
	mblock_°¨t
;

156 
uI¡
 
	mm©ch_Àngth
;

157 
IPos
 
	m¥ev_m©ch
;

158 
	mm©ch_avaûabÀ
;

159 
uI¡
 
	m°r°¨t
;

160 
uI¡
 
	mm©ch_°¨t
;

161 
uI¡
 
	mlookahód
;

163 
uI¡
 
	m¥ev_Àngth
;

168 
uI¡
 
	mmax_chaö_Àngth
;

174 
uI¡
 
	mmax_œzy_m©ch
;

179 
	#max_ö£π_Àngth
 
max_œzy_m©ch


	)

185 
	mÀvñ
;

186 
	m°øãgy
;

188 
uI¡
 
	mgood_m©ch
;

191 
	mni˚_m©ch
;

195 
˘_d©a_s
 
	mdyn_…ªe
[
HEAP_SIZE
];

196 
˘_d©a_s
 
	mdyn_dåì
[2*
D_CODES
+1];

197 
˘_d©a_s
 
	mbl_åì
[2*
BL_CODES
+1];

199 
åì_desc_s
 
	ml_desc
;

200 
åì_desc_s
 
	md_desc
;

201 
åì_desc_s
 
	mbl_desc
;

203 
ush
 
	mbl_cou¡
[
MAX_BITS
+1];

206 
	mhóp
[2*
L_CODES
+1];

207 
	mhóp_Àn
;

208 
	mhóp_max
;

213 
uch
 
	mdïth
[2*
L_CODES
+1];

217 
uchf
 *
	ml_buf
;

219 
uI¡
 
	mlô_bufsize
;

239 
uI¡
 
	mœ°_lô
;

241 
ushf
 *
	md_buf
;

247 
ulg
 
	m›t_Àn
;

248 
ulg
 
	m°©ic_Àn
;

249 
uI¡
 
	mm©ches
;

250 
uI¡
 
	mö£π
;

252 #ifde‡
DEBUG


253 
ulg
 
	mcom¥es£d_Àn
;

254 
ulg
 
	mbôs_£¡
;

257 
ush
 
	mbi_buf
;

261 
	mbi_vÆid
;

266 
ulg
 
	mhigh_w©î
;

273 } 
	tFAR
 
	tdeÊ©e_°©e
;

278 
	#put_byã
(
s
, 
c
Ë{s->
≥ndög_buf
[s->
≥ndög
++] = (c);}

	)

281 
	#MIN_LOOKAHEAD
 (
MAX_MATCH
+
MIN_MATCH
+1)

	)

286 
	#MAX_DIST
(
s
Ë((s)->
w_size
-
MIN_LOOKAHEAD
)

	)

291 
	#WIN_INIT
 
MAX_MATCH


	)

296 
ZLIB_INTERNAL
 
_å_öô
 
OF
((
deÊ©e_°©e
 *
s
));

297 
ZLIB_INTERNAL
 
_å_èŒy
 
OF
((
deÊ©e_°©e
 *
s
, 
di°
, 
lc
));

298 
ZLIB_INTERNAL
 
_å_Êush_block
 
OF
((
deÊ©e_°©e
 *
s
, 
ch¨f
 *
buf
,

299 
ulg
 
°‹ed_Àn
, 
œ°
));

300 
ZLIB_INTERNAL
 
_å_Êush_bôs
 
OF
((
deÊ©e_°©e
 *
s
));

301 
ZLIB_INTERNAL
 
_å_Æign
 
OF
((
deÊ©e_°©e
 *
s
));

302 
ZLIB_INTERNAL
 
_å_°‹ed_block
 
OF
((
deÊ©e_°©e
 *
s
, 
ch¨f
 *
buf
,

303 
ulg
 
°‹ed_Àn
, 
œ°
));

305 
	#d_code
(
di°
) \

306 ((
di°
Ë< 256 ? 
_di°_code
[di°] : _di°_code[256+((di°)>>7)])

	)

312 #i‚de‡
DEBUG


315 #i‡
deföed
(
GEN_TREES_H
Ë|| !deföed(
STDC
)

316 
uch
 
ZLIB_INTERNAL
 
_Àngth_code
[];

317 
uch
 
ZLIB_INTERNAL
 
_di°_code
[];

319 c⁄° 
uch
 
ZLIB_INTERNAL
 
_Àngth_code
[];

320 c⁄° 
uch
 
ZLIB_INTERNAL
 
_di°_code
[];

323 
	#_å_èŒy_lô
(
s
, 
c
, 
Êush
) \

324 { 
uch
 
cc
 = (
c
); \

325 
s
->
d_buf
[s->
œ°_lô
] = 0; \

326 
s
->
l_buf
[s->
œ°_lô
++] = 
cc
; \

327 
s
->
dyn_…ªe
[
cc
].
Fªq
++; \

328 
Êush
 = (
s
->
œ°_lô
 =s->
lô_bufsize
-1); \

329 }

	)

330 
	#_å_èŒy_di°
(
s
, 
di°™˚
, 
Àngth
, 
Êush
) \

331 { 
uch
 
Àn
 = (
Àngth
); \

332 
ush
 
di°
 = (
di°™˚
); \

333 
s
->
d_buf
[s->
œ°_lô
] = 
di°
; \

334 
s
->
l_buf
[s->
œ°_lô
++] = 
Àn
; \

335 
di°
--; \

336 
s
->
dyn_…ªe
[
_Àngth_code
[
Àn
]+
LITERALS
+1].
Fªq
++; \

337 
s
->
dyn_dåì
[
	`d_code
(
di°
)].
Fªq
++; \

338 
Êush
 = (
s
->
œ°_lô
 =s->
lô_bufsize
-1); \

339 }

	)

341 
	#_å_èŒy_lô
(
s
, 
c
, 
Êush
ËÊush = 
	`_å_èŒy
(s, 0, c)

	)

342 
	#_å_èŒy_di°
(
s
, 
di°™˚
, 
Àngth
, 
Êush
) \

343 
Êush
 = 
	`_å_èŒy
(
s
, 
di°™˚
, 
Àngth
)

	)

	@zlib-1.2.8/examples/enough.c

102 
	~<°dio.h
>

103 
	~<°dlib.h
>

104 
	~<°rög.h
>

105 
	~<as£π.h
>

107 
	#loˇl
 

	)

110 
	tbig_t
;

111 
	tcode_t
;

112 
	sèb
 {

113 
size_t
 
	mÀn
;

114 *
	mvec
;

170 
loˇl
 
	gmax
;

171 
loˇl
 
	groŸ
;

172 
loˇl
 
	gœrge
;

173 
loˇl
 
size_t
 
	gsize
;

174 
loˇl
 *
	gcode
;

175 
loˇl
 
big_t
 *
	gnum
;

176 
loˇl
 
èb
 *
	gd⁄e
;

179 
	#INDEX
(
i
,
j
,
k
Ë(((
size_t
)((i-1)>>1)*((i-2)>>1)+(j>>1)-1)*(
max
-1)+k-1)

	)

182 
loˇl
 
	$˛ónup
()

184 
size_t
 
n
;

186 i‡(
d⁄e
 !
NULL
) {

187 
n
 = 0;Ç < 
size
;Ç++)

188 i‡(
d⁄e
[
n
].
Àn
)

189 
	`‰ì
(
d⁄e
[
n
].
vec
);

190 
	`‰ì
(
d⁄e
);

192 i‡(
num
 !
NULL
)

193 
	`‰ì
(
num
);

194 i‡(
code
 !
NULL
)

195 
	`‰ì
(
code
);

196 
	}
}

203 
loˇl
 
big_t
 
	$cou¡
(
syms
, 
Àn
, 
À·
)

205 
big_t
 
sum
;

206 
big_t
 
gŸ
;

207 
Àa°
;

208 
mo°
;

209 
u£
;

210 
size_t
 
ödex
;

213 i‡(
syms
 =
À·
)

217 
	`as£π
(
syms
 > 
À·
 &&Üe· > 0 && 
Àn
 < 
max
);

220 
ödex
 = 
	`INDEX
(
syms
, 
À·
, 
Àn
);

221 
gŸ
 = 
num
[
ödex
];

222 i‡(
gŸ
)

223  
gŸ
;

227 
Àa°
 = (
À·
 << 1Ë- 
syms
;

228 i‡(
Àa°
 < 0)

229 
Àa°
 = 0;

234 
mo°
 = (((
code_t
)
À·
 << (
max
 - 
Àn
)Ë- 
syms
) /

235 (((
code_t
)1 << (
max
 - 
Àn
)) - 1);

238 
sum
 = 0;

239 
u£
 = 
Àa°
; u£ <
mo°
; use++) {

240 
gŸ
 = 
	`cou¡
(
syms
 - 
u£
, 
Àn
 + 1, (
À·
 - use) << 1);

241 
sum
 +
gŸ
;

242 i‡(
gŸ
 =(
big_t
)0 - 1 || 
sum
 < got)

243  (
big_t
)0 - 1;

247 
	`as£π
(
sum
 != 0);

250 
num
[
ödex
] = 
sum
;

251  
sum
;

252 
	}
}

258 
loˇl
 
	$bìnhîe
(
syms
, 
Àn
, 
À·
, 
mem
, 
ªm
)

260 
size_t
 
ödex
;

261 
size_t
 
off£t
;

262 
bô
;

263 
size_t
 
Àngth
;

264 *
ve˘‹
;

267 
ödex
 = 
	`INDEX
(
syms
, 
À·
, 
Àn
);

268 
mem
 -1 << 
roŸ
;

269 
off£t
 = (
mem
 >> 3Ë+ 
ªm
;

270 
off£t
 = ((off£à* (off£à+ 1)Ë>> 1Ë+ 
ªm
;

271 
bô
 = 1 << (
mem
 & 7);

274 
Àngth
 = 
d⁄e
[
ödex
].
Àn
;

275 i‡(
off£t
 < 
Àngth
 && (
d⁄e
[
ödex
].
vec
[off£t] & 
bô
) != 0)

281 i‡(
Àngth
 <
off£t
) {

283 i‡(
Àngth
) {

285 
Àngth
 <<= 1;

286 } 
Àngth
 <
off£t
);

287 
ve˘‹
 = 
	`ªÆloc
(
d⁄e
[
ödex
].
vec
, 
Àngth
);

288 i‡(
ve˘‹
 !
NULL
)

289 
	`mem£t
(
ve˘‹
 + 
d⁄e
[
ödex
].
Àn
, 0, 
Àngth
 - done[index].len);

294 
Àngth
 = 1 << (
Àn
 - 
roŸ
);

295 
Àngth
 <
off£t
)

296 
Àngth
 <<= 1;

297 
ve˘‹
 = 
	`ˇŒoc
(
Àngth
, ());

301 i‡(
ve˘‹
 =
NULL
) {

302 
	`Âuts
("ab‹t: u«bÀÅÿÆloˇãÉnough mem‹y\n", 
°dîr
);

303 
	`˛ónup
();

304 
	`exô
(1);

308 
d⁄e
[
ödex
].
Àn
 = 
Àngth
;

309 
d⁄e
[
ödex
].
vec
 = 
ve˘‹
;

313 
d⁄e
[
ödex
].
vec
[
off£t
] |
bô
;

315 
	}
}

322 
loˇl
 
	$examöe
(
syms
, 
Àn
, 
À·
, 
mem
, 
ªm
)

324 
Àa°
;

325 
mo°
;

326 
u£
;

329 i‡(
syms
 =
À·
) {

331 
code
[
Àn
] = 
À·
;

334 
ªm
 < 
À·
) {

335 
À·
 -
ªm
;

336 
ªm
 = 1 << (
Àn
 - 
roŸ
);

337 
mem
 +
ªm
;

339 
	`as£π
(
ªm
 =
À·
);

342 i‡(
mem
 > 
œrge
) {

343 
œrge
 = 
mem
;

344 
	`¥ötf
("max %d: ", 
mem
);

345 
u£
 = 
roŸ
 + 1; u£ <
max
; use++)

346 i‡(
code
[
u£
])

347 
	`¥ötf
("%d[%d] ", 
code
[
u£
], use);

348 
	`putch¨
('\n');

349 
	`fÊush
(
°dout
);

353 
code
[
Àn
] = 0;

358 i‡(
	`bìnhîe
(
syms
, 
Àn
, 
À·
, 
mem
, 
ªm
))

363 
Àa°
 = (
À·
 << 1Ë- 
syms
;

364 i‡(
Àa°
 < 0)

365 
Àa°
 = 0;

370 
mo°
 = (((
code_t
)
À·
 << (
max
 - 
Àn
)Ë- 
syms
) /

371 (((
code_t
)1 << (
max
 - 
Àn
)) - 1);

374 
u£
 = 
Àa°
;

375 
ªm
 < 
u£
) {

376 
u£
 -
ªm
;

377 
ªm
 = 1 << (
Àn
 - 
roŸ
);

378 
mem
 +
ªm
;

380 
ªm
 -
u£
;

383 
u£
 = 
Àa°
; u£ <
mo°
; use++) {

384 
code
[
Àn
] = 
u£
;

385 
	`examöe
(
syms
 - 
u£
, 
Àn
 + 1, (
À·
 - use) << 1,

386 
mem
 + (
ªm
 ? 1 << (
Àn
 - 
roŸ
) : 0),Ñem << 1);

387 i‡(
ªm
 == 0) {

388 
ªm
 = 1 << (
Àn
 - 
roŸ
);

389 
mem
 +
ªm
;

391 
ªm
--;

395 
code
[
Àn
] = 0;

396 
	}
}

403 
loˇl
 
	$íough
(
syms
)

405 
n
;

406 
À·
;

407 
size_t
 
ödex
;

410 
n
 = 0;Ç <
max
;Ç++)

411 
code
[
n
] = 0;

414 
œrge
 = 1 << 
roŸ
;

415 i‡(
roŸ
 < 
max
)

416 
n
 = 3;Ç <
syms
;Ç++)

417 
À·
 = 2;Üe· < 
n
;Üeft += 2)

421 
ödex
 = 
	`INDEX
(
n
, 
À·
, 
roŸ
 + 1);

422 i‡(
roŸ
 + 1 < 
max
 && 
num
[
ödex
])

423 
	`examöe
(
n
, 
roŸ
 + 1, 
À·
, 1 <<Ñoot, 0);

427 i‡(
num
[
ödex
 - 1] && 
n
 <
À·
 << 1)

428 
	`examöe
((
n
 - 
À·
Ë<< 1, 
roŸ
 + 1, (n -Üeft) << 1,

429 1 << 
roŸ
, 0);

433 
	`¥ötf
("d⁄e: maximum o‡%dÅabÀÉ¡rõs\n", 
œrge
);

434 
	}
}

458 
	$maö
(
¨gc
, **
¨gv
)

460 
syms
;

461 
n
;

462 
big_t
 
gŸ
;

463 
big_t
 
sum
;

464 
code_t
 
w‹d
;

467 
code
 = 
NULL
;

468 
num
 = 
NULL
;

469 
d⁄e
 = 
NULL
;

472 
syms
 = 286;

473 
roŸ
 = 9;

474 
max
 = 15;

475 i‡(
¨gc
 > 1) {

476 
syms
 = 
	`©oi
(
¨gv
[1]);

477 i‡(
¨gc
 > 2) {

478 
roŸ
 = 
	`©oi
(
¨gv
[2]);

479 i‡(
¨gc
 > 3)

480 
max
 = 
	`©oi
(
¨gv
[3]);

483 i‡(
¨gc
 > 4 || 
syms
 < 2 || 
roŸ
 < 1 || 
max
 < 1) {

484 
	`Âuts
("invalidárguments,Çeed: [sym >= 2 [root >= 1 [max >= 1]]]\n",

485 
°dîr
);

490 i‡(
max
 > 
syms
 - 1)

491 
max
 = 
syms
 - 1;

494 
n
 = 0, 
w‹d
 = 1; word;Ç++, word <<= 1)

498 i‡(
max
 > 
n
 || (
code_t
)(
syms
 - 2) >= (((code_t)0 - 1) >> (max - 1))) {

499 
	`Âuts
("ab‹t: codêÀngthÅoÿl⁄g f‹ i¡î«»ty≥s\n", 
°dîr
);

504 i‡((
code_t
)(
syms
 - 1Ë> ((code_t)1 << 
max
) - 1) {

505 
	`Ârötf
(
°dîr
, "%d symbols cannot be coded in %d bits\n",

506 
syms
, 
max
);

511 
code
 = 
	`ˇŒoc
(
max
 + 1, ());

512 i‡(
code
 =
NULL
) {

513 
	`Âuts
("ab‹t: u«bÀÅÿÆloˇãÉnough mem‹y\n", 
°dîr
);

519 i‡(
syms
 == 2)

520 
num
 = 
NULL
;

522 
size
 = 
syms
 >> 1;

523 i‡(
size
 > ((
size_t
)0 - 1Ë/ (
n
 = (
syms
 - 1) >> 1) ||

524 (
size
 *
n
, sizê> ((
size_t
)0 - 1Ë/ (¿
max
 - 1)) ||

525 (
size
 *
n
, sizê> ((
size_t
)0 - 1Ë/ (
big_t
)) ||

526 (
num
 = 
	`ˇŒoc
(
size
, (
big_t
))Ë=
NULL
) {

527 
	`Âuts
("ab‹t: u«bÀÅÿÆloˇãÉnough mem‹y\n", 
°dîr
);

528 
	`˛ónup
();

534 
sum
 = 0;

535 
n
 = 2;Ç <
syms
;Ç++) {

536 
gŸ
 = 
	`cou¡
(
n
, 1, 2);

537 
sum
 +
gŸ
;

538 i‡(
gŸ
 =(
big_t
)0 - 1 || 
sum
 < got) {

539 
	`Âuts
("ab‹t: c™'àcou¡Åh© high!\n", 
°dîr
);

540 
	`˛ónup
();

543 
	`¥ötf
("%Œu %d-codes\n", 
gŸ
, 
n
);

545 
	`¥ötf
("%ŒuÅŸÆ code†f‹ 2Åÿ%d symbﬁs", 
sum
, 
syms
);

546 i‡(
max
 < 
syms
 - 1)

547 
	`¥ötf
(" (%d-bôÜígthÜimô)\n", 
max
);

549 
	`puts
(" (noÜengthÜimit)");

552 i‡(
syms
 == 2)

553 
d⁄e
 = 
NULL
;

554 i‡(
size
 > ((
size_t
)0 - 1Ë/ (
èb
) ||

555 (
d⁄e
 = 
	`ˇŒoc
(
size
, (
èb
))Ë=
NULL
) {

556 
	`Âuts
("ab‹t: u«bÀÅÿÆloˇãÉnough mem‹y\n", 
°dîr
);

557 
	`˛ónup
();

562 i‡(
roŸ
 > 
max
)

563 
roŸ
 = 
max
;

564 i‡((
code_t
)
syms
 < ((code_t)1 << (
roŸ
 + 1)))

565 
	`íough
(
syms
);

567 
	`puts
("cannot handle minimum codeÜengths >Ñoot");

570 
	`˛ónup
();

572 
	}
}

	@zlib-1.2.8/examples/fitblk.c

54 
	~<°dio.h
>

55 
	~<°dlib.h
>

56 
	~<as£π.h
>

57 
	~"zlib.h
"

59 
	#loˇl
 

	)

62 
loˇl
 
	$quô
(*
why
)

64 
	`Ârötf
(
°dîr
, "fôblkáb‹t: %s\n", 
why
);

65 
	`exô
(1);

66 
	}
}

68 
	#RAWLEN
 4096

	)

73 
loˇl
 
	$∑πcom¥ess
(
FILE
 *
ö
, 
z_°ªamp
 
def
)

75 
ªt
, 
Êush
;

76 
øw
[
RAWLEN
];

78 
Êush
 = 
Z_NO_FLUSH
;

80 
def
->
avaû_ö
 = 
	`‰ód
(
øw
, 1, 
RAWLEN
, 
ö
);

81 i‡(
	`„º‹
(
ö
))

82  
Z_ERRNO
;

83 
def
->
√xt_ö
 = 
øw
;

84 i‡(
	`„of
(
ö
))

85 
Êush
 = 
Z_FINISH
;

86 
ªt
 = 
	`deÊ©e
(
def
, 
Êush
);

87 
	`as£π
(
ªt
 !
Z_STREAM_ERROR
);

88 } 
def
->
avaû_out
 !0 && 
Êush
 =
Z_NO_FLUSH
);

89  
ªt
;

90 
	}
}

96 
loˇl
 
	$ªcom¥ess
(
z_°ªamp
 
öf
, z_°ªam∞
def
)

98 
ªt
, 
Êush
;

99 
øw
[
RAWLEN
];

101 
Êush
 = 
Z_NO_FLUSH
;

104 
öf
->
avaû_out
 = 
RAWLEN
;

105 
öf
->
√xt_out
 = 
øw
;

106 
ªt
 = 
	`öÊ©e
(
öf
, 
Z_NO_FLUSH
);

107 
	`as£π
(
ªt
 !
Z_STREAM_ERROR
 &&Ñë !
Z_DATA_ERROR
 &&

108 
ªt
 !
Z_NEED_DICT
);

109 i‡(
ªt
 =
Z_MEM_ERROR
)

110  
ªt
;

113 
def
->
avaû_ö
 = 
RAWLEN
 - 
öf
->
avaû_out
;

114 
def
->
√xt_ö
 = 
øw
;

115 i‡(
öf
->
avaû_out
 != 0)

116 
Êush
 = 
Z_FINISH
;

117 
ªt
 = 
	`deÊ©e
(
def
, 
Êush
);

118 
	`as£π
(
ªt
 !
Z_STREAM_ERROR
);

119 } 
ªt
 !
Z_STREAM_END
 && 
def
->
avaû_out
 != 0);

120  
ªt
;

121 
	}
}

123 
	#EXCESS
 256

	)

124 
	#MARGIN
 8

	)

127 
	$maö
(
¨gc
, **
¨gv
)

129 
ªt
;

130 
size
;

131 
have
;

132 *
blk
;

133 *
tmp
;

134 
z_°ªam
 
def
, 
öf
;

137 i‡(
¨gc
 != 2)

138 
	`quô
("need oneárgument: size of output block");

139 
ªt
 = 
	`°πﬁ
(
¨gv
[1],árgv + 1, 10);

140 i‡(
¨gv
[1][0] != 0)

141 
	`quô
("argument must beáÇumber");

142 i‡(
ªt
 < 8)

143 
	`quô
("needÖositive size of 8 or greater");

144 
size
 = ()
ªt
;

147 
blk
 = 
	`mÆloc
(
size
 + 
EXCESS
);

148 
def
.
zÆloc
 = 
Z_NULL
;

149 
def
.
z‰ì
 = 
Z_NULL
;

150 
def
.
›aque
 = 
Z_NULL
;

151 
ªt
 = 
	`deÊ©eInô
(&
def
, 
Z_DEFAULT_COMPRESSION
);

152 i‡(
ªt
 !
Z_OK
 || 
blk
 =
NULL
)

153 
	`quô
("out of memory");

156 
def
.
avaû_out
 = 
size
 + 
EXCESS
;

157 
def
.
√xt_out
 = 
blk
;

158 
ªt
 = 
	`∑πcom¥ess
(
°dö
, &
def
);

159 i‡(
ªt
 =
Z_ERRNO
)

160 
	`quô
("errorÑeading input");

163 i‡(
ªt
 =
Z_STREAM_END
 && 
def
.
avaû_out
 >
EXCESS
) {

165 
have
 = 
size
 + 
EXCESS
 - 
def
.
avaû_out
;

166 i‡(
	`fwrôe
(
blk
, 1, 
have
, 
°dout
Ë!havê|| 
	`„º‹
(stdout))

167 
	`quô
("error writing output");

170 
ªt
 = 
	`deÊ©eEnd
(&
def
);

171 
	`as£π
(
ªt
 !
Z_STREAM_ERROR
);

172 
	`‰ì
(
blk
);

173 
	`Ârötf
(
°dîr
,

175 
size
 - 
have
, size);

180 
öf
.
zÆloc
 = 
Z_NULL
;

181 
öf
.
z‰ì
 = 
Z_NULL
;

182 
öf
.
›aque
 = 
Z_NULL
;

183 
öf
.
avaû_ö
 = 0;

184 
öf
.
√xt_ö
 = 
Z_NULL
;

185 
ªt
 = 
	`öÊ©eInô
(&
öf
);

186 
tmp
 = 
	`mÆloc
(
size
 + 
EXCESS
);

187 i‡(
ªt
 !
Z_OK
 || 
tmp
 =
NULL
)

188 
	`quô
("out of memory");

189 
ªt
 = 
	`deÊ©eRe£t
(&
def
);

190 
	`as£π
(
ªt
 !
Z_STREAM_ERROR
);

193 
öf
.
avaû_ö
 = 
size
 + 
EXCESS
;

194 
öf
.
√xt_ö
 = 
blk
;

195 
def
.
avaû_out
 = 
size
 + 
EXCESS
;

196 
def
.
√xt_out
 = 
tmp
;

197 
ªt
 = 
	`ªcom¥ess
(&
öf
, &
def
);

198 i‡(
ªt
 =
Z_MEM_ERROR
)

199 
	`quô
("out of memory");

202 
ªt
 = 
	`öÊ©eRe£t
(&
öf
);

203 
	`as£π
(
ªt
 !
Z_STREAM_ERROR
);

204 
ªt
 = 
	`deÊ©eRe£t
(&
def
);

205 
	`as£π
(
ªt
 !
Z_STREAM_ERROR
);

208 
öf
.
avaû_ö
 = 
size
 - 
MARGIN
;

209 
öf
.
√xt_ö
 = 
tmp
;

210 
def
.
avaû_out
 = 
size
;

211 
def
.
√xt_out
 = 
blk
;

212 
ªt
 = 
	`ªcom¥ess
(&
öf
, &
def
);

213 i‡(
ªt
 =
Z_MEM_ERROR
)

214 
	`quô
("out of memory");

215 
	`as£π
(
ªt
 =
Z_STREAM_END
);

218 
have
 = 
size
 - 
def
.
avaû_out
;

219 i‡(
	`fwrôe
(
blk
, 1, 
have
, 
°dout
Ë!havê|| 
	`„º‹
(stdout))

220 
	`quô
("error writing output");

223 
	`‰ì
(
tmp
);

224 
ªt
 = 
	`öÊ©eEnd
(&
öf
);

225 
	`as£π
(
ªt
 !
Z_STREAM_ERROR
);

226 
ªt
 = 
	`deÊ©eEnd
(&
def
);

227 
	`as£π
(
ªt
 !
Z_STREAM_ERROR
);

228 
	`‰ì
(
blk
);

229 
	`Ârötf
(
°dîr
,

231 
size
 - 
have
, size, 
def
.
tŸÆ_ö
);

233 
	}
}

	@zlib-1.2.8/examples/gun.c

60 
	~<°dio.h
>

61 
	~<°dlib.h
>

62 
	~<°rög.h
>

63 
	~<î∫o.h
>

64 
	~<f˙é.h
>

65 
	~<uni°d.h
>

66 
	~<sys/ty≥s.h
>

67 
	~<sys/°©.h
>

68 
	~<utime.h
>

69 
	~"zlib.h
"

73 
	#loˇl
 

	)

76 
	#SIZE
 32768U

	)

77 
	#PIECE
 16384

	)

81 
	söd
 {

82 
	möfûe
;

83 *
	möbuf
;

89 
loˇl
 
	$ö
(*
ö_desc
, 
z_c⁄°
 **
buf
)

91 
ªt
;

92 
Àn
;

93 *
√xt
;

94 
öd
 *
me
 = (öd *)
ö_desc
;

96 
√xt
 = 
me
->
öbuf
;

97 *
buf
 = 
√xt
;

98 
Àn
 = 0;

100 
ªt
 = 
PIECE
;

101 i‡(()
ªt
 > 
SIZE
 - 
Àn
)

102 
ªt
 = ()(
SIZE
 - 
Àn
);

103 
ªt
 = ()
	`ªad
(
me
->
öfûe
, 
√xt
,Ñet);

104 i‡(
ªt
 == -1) {

105 
Àn
 = 0;

108 
√xt
 +
ªt
;

109 
Àn
 +
ªt
;

110 } 
ªt
 !0 && 
Àn
 < 
SIZE
);

111  
Àn
;

112 
	}
}

119 
	soutd
 {

120 
	moutfûe
;

121 
	mcheck
;

122 
	m¸c
;

123 
	mtŸÆ
;

131 
loˇl
 
	$out
(*
out_desc
, *
buf
, 
Àn
)

133 
ªt
;

134 
outd
 *
me
 = (outd *)
out_desc
;

136 i‡(
me
->
check
) {

137 
me
->
¸c
 = 
	`¸c32
(me->¸c, 
buf
, 
Àn
);

138 
me
->
tŸÆ
 +
Àn
;

140 i‡(
me
->
outfûe
 != -1)

142 
ªt
 = 
PIECE
;

143 i‡(()
ªt
 > 
Àn
)

144 
ªt
 = ()
Àn
;

145 
ªt
 = ()
	`wrôe
(
me
->
outfûe
, 
buf
,Ñet);

146 i‡(
ªt
 == -1)

148 
buf
 +
ªt
;

149 
Àn
 -
ªt
;

150 } 
Àn
 != 0);

152 
	}
}

155 
	#NEXT
(Ë(
have
 ? 0 : (havê
	`ö
(
ödp
, &
√xt
)), \

156 
œ°
 = 
have
 ? (have--, ()(*
√xt
++)Ë: -1)

	)

161 
	göbuf
[
SIZE
];

162 
	goutbuf
[
SIZE
];

163 
	g¥efix
[65536];

164 
	gsuffix
[65536];

165 
	gm©ch
[65280 + 2];

171 
	#FLUSHCODE
() \

173 
À·
 = 0; \

174 
ªm
 = 0; \

175 i‡(
chunk
 > 
have
) { \

176 
chunk
 -
have
; \

177 
have
 = 0; \

178 i‡(
	`NEXT
() == -1) \

180 
chunk
--; \

181 i‡(
chunk
 > 
have
) { \

182 
chunk
 = 
have
 = 0; \

186 
have
 -
chunk
; \

187 
√xt
 +
chunk
; \

188 
chunk
 = 0; \

189 } 0)

	)

200 
loˇl
 
	$lu≈ùe
(
have
, 
z_c⁄°
 *
√xt
, 
öd
 *
ödp
,

201 
outfûe
, 
z_°ªam
 *
°rm
)

203 
œ°
;

204 
chunk
;

205 
À·
;

206 
ªm
;

207 
bôs
;

208 
code
;

209 
mask
;

210 
max
;

211 
Êags
;

212 
íd
;

213 
ãmp
;

214 
¥ev
;

215 
föÆ
;

216 
°ack
;

217 
out˙t
;

218 
outd
 outd;

219 *
p
;

222 
outd
.
outfûe
 = outfile;

223 
outd
.
check
 = 0;

226 
Êags
 = 
	`NEXT
();

227 i‡(
œ°
 == -1)

228  
Z_BUF_ERROR
;

229 i‡(
Êags
 & 0x60) {

230 
°rm
->
msg
 = (*)"unknownÜzw flags set";

231  
Z_DATA_ERROR
;

233 
max
 = 
Êags
 & 0x1f;

234 i‡(
max
 < 9 || max > 16) {

235 
°rm
->
msg
 = (*)"lzw bits out ofÑange";

236  
Z_DATA_ERROR
;

238 i‡(
max
 == 9)

239 
max
 = 10;

240 
Êags
 &= 0x80;

243 
bôs
 = 9;

244 
mask
 = 0x1ff;

245 
íd
 = 
Êags
 ? 256 : 255;

249 i‡(
	`NEXT
() == -1)

250  
Z_OK
;

251 
föÆ
 = 
¥ev
 = ()
œ°
;

252 i‡(
	`NEXT
() == -1)

253  
Z_BUF_ERROR
;

254 i‡(
œ°
 & 1) {

255 
°rm
->
msg
 = (*)"invalidÜzw code";

256  
Z_DATA_ERROR
;

258 
ªm
 = ()
œ°
 >> 1;

259 
À·
 = 7;

260 
chunk
 = 
bôs
 - 2;

261 
outbuf
[0] = ()
föÆ
;

262 
out˙t
 = 1;

265 
°ack
 = 0;

268 i‡(
íd
 >
mask
 && 
bôs
 < 
max
) {

269 
	`FLUSHCODE
();

270 
bôs
++;

271 
mask
 <<= 1;

272 
mask
++;

276 i‡(
chunk
 == 0)

277 
chunk
 = 
bôs
;

278 
code
 = 
ªm
;

279 i‡(
	`NEXT
() == -1) {

281 i‡(
out˙t
 && 
	`out
(&
outd
, 
outbuf
, outcnt)) {

282 
°rm
->
√xt_ö
 = 
outbuf
;

283  
Z_BUF_ERROR
;

285  
Z_OK
;

287 
code
 +()
œ°
 << 
À·
;

288 
À·
 += 8;

289 
chunk
--;

290 i‡(
bôs
 > 
À·
) {

291 i‡(
	`NEXT
() == -1)

292  
Z_BUF_ERROR
;

293 
code
 +()
œ°
 << 
À·
;

294 
À·
 += 8;

295 
chunk
--;

297 
code
 &
mask
;

298 
À·
 -
bôs
;

299 
ªm
 = ()
œ°
 >> (8 - 
À·
);

302 i‡(
code
 =256 && 
Êags
) {

303 
	`FLUSHCODE
();

304 
bôs
 = 9;

305 
mask
 = 0x1ff;

306 
íd
 = 255;

311 
ãmp
 = 
code
;

312 i‡(
code
 > 
íd
) {

321 i‡(
code
 !
íd
 + 1 || 
¥ev
 >Énd) {

322 
°rm
->
msg
 = (*)"invalidÜzw code";

323  
Z_DATA_ERROR
;

325 
m©ch
[
°ack
++] = ()
föÆ
;

326 
code
 = 
¥ev
;

330 
p
 = 
m©ch
 + 
°ack
;

331 
code
 >= 256) {

332 *
p
++ = 
suffix
[
code
];

333 
code
 = 
¥efix
[code];

335 
°ack
 = 
p
 - 
m©ch
;

336 
m©ch
[
°ack
++] = ()
code
;

337 
föÆ
 = 
code
;

340 i‡(
íd
 < 
mask
) {

341 
íd
++;

342 
¥efix
[
íd
] = ()
¥ev
;

343 
suffix
[
íd
] = ()
föÆ
;

347 
¥ev
 = 
ãmp
;

350 
°ack
 > 
SIZE
 - 
out˙t
) {

351 
out˙t
 < 
SIZE
)

352 
outbuf
[
out˙t
++] = 
m©ch
[--
°ack
];

353 i‡(
	`out
(&
outd
, 
outbuf
, 
out˙t
)) {

354 
°rm
->
√xt_ö
 = 
outbuf
;

355  
Z_BUF_ERROR
;

357 
out˙t
 = 0;

359 
p
 = 
m©ch
 + 
°ack
;

361 
outbuf
[
out˙t
++] = *--
p
;

362 } 
p
 > 
m©ch
);

363 
°ack
 = 0;

369 
	}
}

383 
loˇl
 
	$gu≈ùe
(
z_°ªam
 *
°rm
, 
öfûe
, 
outfûe
)

385 
ªt
, 
fú°
, 
œ°
;

386 
have
, 
Êags
, 
Àn
;

387 
z_c⁄°
 *
√xt
 = 
NULL
;

388 
öd
 ind, *
ödp
;

389 
outd
 outd;

392 
öd
.
öfûe
 = infile;

393 
öd
.
öbuf
 = inbuf;

394 
ödp
 = &
öd
;

397 
have
 = 0;

398 
fú°
 = 1;

399 
°rm
->
√xt_ö
 = 
Z_NULL
;

402 i‡(
	`NEXT
() == -1) {

403 
ªt
 = 
Z_OK
;

406 i‡(
œ°
 !31 || (
	`NEXT
() != 139 &&Üast != 157)) {

407 
°rm
->
msg
 = (*)"incorrect header check";

408 
ªt
 = 
fú°
 ? 
Z_DATA_ERROR
 : 
Z_ERRNO
;

411 
fú°
 = 0;

414 i‡(
œ°
 == 157) {

415 
ªt
 = 
	`lu≈ùe
(
have
, 
√xt
, 
ödp
, 
outfûe
, 
°rm
);

420 
ªt
 = 
Z_BUF_ERROR
;

421 i‡(
	`NEXT
() != 8) {

422 i‡(
œ°
 == -1) ;

423 
°rm
->
msg
 = (*)"unknown compression method";

424 
ªt
 = 
Z_DATA_ERROR
;

427 
Êags
 = 
	`NEXT
();

428 
	`NEXT
();

429 
	`NEXT
();

430 
	`NEXT
();

431 
	`NEXT
();

432 
	`NEXT
();

433 
	`NEXT
();

434 i‡(
œ°
 == -1) ;

435 i‡(
Êags
 & 0xe0) {

436 
°rm
->
msg
 = (*)"unknown header flags set";

437 
ªt
 = 
Z_DATA_ERROR
;

440 i‡(
Êags
 & 4) {

441 
Àn
 = 
	`NEXT
();

442 
Àn
 +()(
	`NEXT
()) << 8;

443 i‡(
œ°
 == -1) ;

444 
Àn
 > 
have
) {

445 
Àn
 -
have
;

446 
have
 = 0;

447 i‡(
	`NEXT
() == -1) ;

448 
Àn
--;

450 i‡(
œ°
 == -1) ;

451 
have
 -
Àn
;

452 
√xt
 +
Àn
;

454 i‡(
Êags
 & 8)

455 
	`NEXT
(Ë!0 && 
œ°
 != -1)

457 i‡(
Êags
 & 16)

458 
	`NEXT
(Ë!0 && 
œ°
 != -1)

460 i‡(
Êags
 & 2) {

461 
	`NEXT
();

462 
	`NEXT
();

464 i‡(
œ°
 == -1) ;

467 
outd
.
outfûe
 = outfile;

468 
outd
.
check
 = 1;

469 
outd
.
¸c
 = 
	`¸c32
(0L, 
Z_NULL
, 0);

470 
outd
.
tŸÆ
 = 0;

473 
°rm
->
√xt_ö
 = 
√xt
;

474 
°rm
->
avaû_ö
 = 
have
;

475 
ªt
 = 
	`öÊ©eBack
(
°rm
, 
ö
, 
ödp
, 
out
, &
outd
);

476 i‡(
ªt
 !
Z_STREAM_END
) ;

477 
√xt
 = 
°rm
->
√xt_ö
;

478 
have
 = 
°rm
->
avaû_ö
;

479 
°rm
->
√xt_ö
 = 
Z_NULL
;

482 
ªt
 = 
Z_BUF_ERROR
;

483 i‡(
	`NEXT
(Ë!()(
outd
.
¸c
 & 0xff) ||

484 
	`NEXT
(Ë!()((
outd
.
¸c
 >> 8) & 0xff) ||

485 
	`NEXT
(Ë!()((
outd
.
¸c
 >> 16) & 0xff) ||

486 
	`NEXT
(Ë!()((
outd
.
¸c
 >> 24) & 0xff)) {

488 i‡(
œ°
 != -1) {

489 
°rm
->
msg
 = (*)"incorrect data check";

490 
ªt
 = 
Z_DATA_ERROR
;

494 i‡(
	`NEXT
(Ë!()(
outd
.
tŸÆ
 & 0xff) ||

495 
	`NEXT
(Ë!()((
outd
.
tŸÆ
 >> 8) & 0xff) ||

496 
	`NEXT
(Ë!()((
outd
.
tŸÆ
 >> 16) & 0xff) ||

497 
	`NEXT
(Ë!()((
outd
.
tŸÆ
 >> 24) & 0xff)) {

499 i‡(
œ°
 != -1) {

500 
°rm
->
msg
 = (*)"incorrectÜength check";

501 
ªt
 = 
Z_DATA_ERROR
;

510  
ªt
;

511 
	}
}

517 
loˇl
 
	$c›ymëa
(*
‰om
, *
to
)

519 
°©
 
was
;

520 
utimbuf
 
whí
;

523 i‡(
	`°©
(
‰om
, &
was
Ë!0 || (was.
°_mode
 & 
S_IFMT
Ë!
S_IFREG
)

527 ()
	`chmod
(
to
, 
was
.
°_mode
 & 07777);

530 ()
	`chown
(
to
, 
was
.
°_uid
, was.
°_gid
);

533 
whí
.
a˘ime
 = 
was
.
°_©ime
;

534 
whí
.
modtime
 = 
was
.
°_mtime
;

535 ()
	`utime
(
to
, &
whí
);

536 
	}
}

548 
loˇl
 
	$gunzù
(
z_°ªam
 *
°rm
, *
ö«me
, *
ouäame
, 
ã°
)

550 
ªt
;

551 
öfûe
, 
outfûe
;

554 i‡(
ö«me
 =
NULL
 || *inname == 0) {

555 
ö«me
 = "-";

556 
öfûe
 = 0;

559 
öfûe
 = 
	`›í
(
ö«me
, 
O_RDONLY
, 0);

560 i‡(
öfûe
 == -1) {

561 
	`Ârötf
(
°dîr
, "gu¿ˇ¬Ÿ o≥¿%s\n", 
ö«me
);

565 i‡(
ã°
)

566 
outfûe
 = -1;

567 i‡(
ouäame
 =
NULL
 || *outname == 0) {

568 
ouäame
 = "-";

569 
outfûe
 = 1;

572 
outfûe
 = 
	`›í
(
ouäame
, 
O_CREAT
 | 
O_TRUNC
 | 
O_WRONLY
, 0666);

573 i‡(
outfûe
 == -1) {

574 
	`˛o£
(
öfûe
);

575 
	`Ârötf
(
°dîr
, "gu¿ˇ¬Ÿ cª©ê%s\n", 
ouäame
);

579 
î∫o
 = 0;

582 
ªt
 = 
	`gu≈ùe
(
°rm
, 
öfûe
, 
outfûe
);

583 i‡(
outfûe
 > 2Ë
	`˛o£
(outfile);

584 i‡(
öfûe
 > 2Ë
	`˛o£
(infile);

587 
ªt
) {

588 
Z_OK
:

589 
Z_ERRNO
:

590 i‡(
öfûe
 > 2 && 
outfûe
 > 2) {

591 
	`c›ymëa
(
ö«me
, 
ouäame
);

592 
	`u∆ök
(
ö«me
);

594 i‡(
ªt
 =
Z_ERRNO
)

595 
	`Ârötf
(
°dîr
, "gun warning:Årailing garbage ignored in %s\n",

596 
ö«me
);

598 
Z_DATA_ERROR
:

599 i‡(
outfûe
 > 2Ë
	`u∆ök
(
ouäame
);

600 
	`Ârötf
(
°dîr
, "gu¿d©®îr‹ o¿%s: %s\n", 
ö«me
, 
°rm
->
msg
);

602 
Z_MEM_ERROR
:

603 i‡(
outfûe
 > 2Ë
	`u∆ök
(
ouäame
);

604 
	`Ârötf
(
°dîr
, "gun out of memoryÉrror--aborting\n");

606 
Z_BUF_ERROR
:

607 i‡(
outfûe
 > 2Ë
	`u∆ök
(
ouäame
);

608 i‡(
°rm
->
√xt_ö
 !
Z_NULL
) {

609 
	`Ârötf
(
°dîr
, "gun writeÉrror on %s: %s\n",

610 
ouäame
, 
	`°ªº‹
(
î∫o
));

612 i‡(
î∫o
) {

613 
	`Ârötf
(
°dîr
, "gunÑeadÉrror on %s: %s\n",

614 
ö«me
, 
	`°ªº‹
(
î∫o
));

617 
	`Ârötf
(
°dîr
, "gun unexpectedÉnd of file on %s\n",

618 
ö«me
);

622 i‡(
outfûe
 > 2Ë
	`u∆ök
(
ouäame
);

623 
	`Ârötf
(
°dîr
, "gun internalÉrror--aborting\n");

627 
	}
}

631 
	$maö
(
¨gc
, **
¨gv
)

633 
ªt
, 
Àn
, 
ã°
;

634 *
ouäame
;

635 *
wödow
;

636 
z_°ªam
 
°rm
;

639 
wödow
 = 
m©ch
;

640 
°rm
.
zÆloc
 = 
Z_NULL
;

641 
°rm
.
z‰ì
 = 
Z_NULL
;

642 
°rm
.
›aque
 = 
Z_NULL
;

643 
ªt
 = 
	`öÊ©eBackInô
(&
°rm
, 15, 
wödow
);

644 i‡(
ªt
 !
Z_OK
) {

645 
	`Ârötf
(
°dîr
, "gun out of memoryÉrror--aborting\n");

650 
¨gc
--;

651 
¨gv
++;

652 
ã°
 = 0;

653 i‡(
¨gc
 && 
	`°rcmp
(*
¨gv
, "-h") == 0) {

654 
	`Ârötf
(
°dîr
, "gun 1.6 (17 Jan 2010)\n");

655 
	`Ârötf
(
°dîr
, "Copyright (C) 2003-2010 Mark Adler\n");

656 
	`Ârötf
(
°dîr
, "usage: gun [-t] [file1.gz [file2.Z ...]]\n");

659 i‡(
¨gc
 && 
	`°rcmp
(*
¨gv
, "-t") == 0) {

660 
ã°
 = 1;

661 
¨gc
--;

662 
¨gv
++;

664 i‡(
¨gc
)

666 i‡(
ã°
)

667 
ouäame
 = 
NULL
;

669 
Àn
 = ()
	`°æí
(*
¨gv
);

670 i‡(
	`°rcmp
(*
¨gv
 + 
Àn
 - 3, ".gz") == 0 ||

671 
	`°rcmp
(*
¨gv
 + 
Àn
 - 3, "-gz") == 0)

672 
Àn
 -= 3;

673 i‡(
	`°rcmp
(*
¨gv
 + 
Àn
 - 2, ".z") == 0 ||

674 
	`°rcmp
(*
¨gv
 + 
Àn
 - 2, "-z") == 0 ||

675 
	`°rcmp
(*
¨gv
 + 
Àn
 - 2, "_z") == 0 ||

676 
	`°rcmp
(*
¨gv
 + 
Àn
 - 2, ".Z") == 0)

677 
Àn
 -= 2;

679 
	`Ârötf
(
°dîr
, "gunÉrror:Ço gzÅype on %s--skipping\n",

680 *
¨gv
);

683 
ouäame
 = 
	`mÆloc
(
Àn
 + 1);

684 i‡(
ouäame
 =
NULL
) {

685 
	`Ârötf
(
°dîr
, "gun out of memoryÉrror--aborting\n");

686 
ªt
 = 1;

689 
	`mem˝y
(
ouäame
, *
¨gv
, 
Àn
);

690 
ouäame
[
Àn
] = 0;

692 
ªt
 = 
	`gunzù
(&
°rm
, *
¨gv
, 
ouäame
, 
ã°
);

693 i‡(
ouäame
 !
NULL
Ë
	`‰ì
(outname);

694 i‡(
ªt
) ;

695 } 
¨gv
++, --
¨gc
);

697 
ªt
 = 
	`gunzù
(&
°rm
, 
NULL
, NULL, 
ã°
);

700 
	`öÊ©eBackEnd
(&
°rm
);

701  
ªt
;

702 
	}
}

	@zlib-1.2.8/examples/gzappend.c

80 
	~<°dio.h
>

81 
	~<°dlib.h
>

82 
	~<°rög.h
>

83 
	~<f˙é.h
>

84 
	~<uni°d.h
>

85 
	~"zlib.h
"

87 
	#loˇl
 

	)

88 
	#LGCHUNK
 14

	)

89 
	#CHUNK
 (1U << 
LGCHUNK
)

	)

90 
	#DSIZE
 32768U

	)

93 
loˇl
 
	$bye
(*
msg1
, *
msg2
)

95 
	`Ârötf
(
°dîr
, "gz≠≥ndÉº‹: %s%s\n", 
msg1
, 
msg2
);

96 
	`exô
(1);

97 
	}
}

102 
loˇl
 
	$gcd
(
a
, 
b
)

104 
c
;

106 
a
 && 
b
)

107 i‡(
a
 > 
b
) {

108 
c
 = 
b
;

109 
a
 - 
c
 >= c)

110 
c
 <<= 1;

111 
a
 -
c
;

114 
c
 = 
a
;

115 
b
 - 
c
 >= c)

116 
c
 <<= 1;

117 
b
 -
c
;

119  
a
 + 
b
;

120 
	}
}

123 
loˇl
 
	$rŸ©e
(*
li°
, 
Àn
, 
rŸ
)

125 
tmp
;

126 
cy˛es
;

127 *
°¨t
, *
œ°
, *
to
, *
‰om
;

130 i‡(
Àn
 < 2) ;

131 i‡(
rŸ
 >
Àn
)Ñot %=Üen;

132 i‡(
rŸ
 == 0) ;

135 
œ°
 = 
li°
 + (
Àn
 - 1);

138 i‡(
rŸ
 == 1) {

139 
tmp
 = *
li°
;

140 
	`mem˝y
(
li°
,Üi° + 1, 
Àn
 - 1);

141 *
œ°
 = 
tmp
;

146 i‡(
rŸ
 =
Àn
 - 1) {

147 
tmp
 = *
œ°
;

148 
	`memmove
(
li°
 + 1,Üi°, 
Àn
 - 1);

149 *
li°
 = 
tmp
;

154 
cy˛es
 = 
	`gcd
(
Àn
, 
rŸ
);

156 
°¨t
 = 
‰om
 = 
li°
 + 
cy˛es
;

157 
tmp
 = *
‰om
;

159 
to
 = 
‰om
;

160 
‰om
 +
rŸ
;

161 i‡(
‰om
 > 
œ°
Ë‰om -
Àn
;

162 i‡(
‰om
 =
°¨t
) ;

163 *
to
 = *
‰om
;

165 *
to
 = 
tmp
;

166 } --
cy˛es
);

167 
	}
}

171 
	mfd
;

172 
	msize
;

173 
	mÀ·
;

174 *
	mbuf
;

175 
z_c⁄°
 *
	m√xt
;

176 *
	m«me
;

177 } 
	tfûe
;

180 
loˇl
 
	$ªadö
(
fûe
 *
ö
)

182 
Àn
;

184 
Àn
 = 
	`ªad
(
ö
->
fd
, in->
buf
, 1 << in->
size
);

185 i‡(
Àn
 =-1Ë
	`bye
("îr‹Ñódög ", 
ö
->
«me
);

186 
ö
->
À·
 = ()
Àn
;

187 
ö
->
√xt
 = in->
buf
;

188  
Àn
;

189 
	}
}

192 
loˇl
 
	$ªadm‹e
(
fûe
 *
ö
)

194 i‡(
	`ªadö
(
ö
Ë=0Ë
	`bye
("u√x≥˘edÉnd o‡", in->
«me
);

196 
	}
}

198 
	#ªad1
(
ö
Ë(ö->
À·
 =0 ? 
	`ªadm‹e
(in) : 0, \

199 
ö
->
À·
--, *(ö->
√xt
)++)

	)

202 
loˇl
 
	$skù
(
fûe
 *
ö
, 
n
)

204 
by∑ss
;

206 i‡(
n
 > 
ö
->
À·
) {

207 
n
 -
ö
->
À·
;

208 
by∑ss
 = 
n
 & ~((1U << 
ö
->
size
) - 1);

209 i‡(
by∑ss
) {

210 i‡(
	`l£ek
(
ö
->
fd
, (
off_t
)
by∑ss
, 
SEEK_CUR
) == -1)

211 
	`bye
("£ekög ", 
ö
->
«me
);

212 
n
 -
by∑ss
;

214 
	`ªadm‹e
(
ö
);

215 i‡(
n
 > 
ö
->
À·
)

216 
	`bye
("u√x≥˘edÉnd o‡", 
ö
->
«me
);

218 
ö
->
À·
 -
n
;

219 
ö
->
√xt
 +
n
;

220 
	}
}

223 
	$ªad4
(
fûe
 *
ö
)

225 
vÆ
;

227 
vÆ
 = 
	`ªad1
(
ö
);

228 
vÆ
 +()
	`ªad1
(
ö
) << 8;

229 
vÆ
 +()
	`ªad1
(
ö
) << 16;

230 
vÆ
 +()
	`ªad1
(
ö
) << 24;

231  
vÆ
;

232 
	}
}

235 
loˇl
 
	$gzhódî
(
fûe
 *
ö
)

237 
Êags
;

238 
n
;

240 i‡(
	`ªad1
(
ö
Ë!31 ||Ñód1(öË!139Ë
	`bye
(ö->
«me
, "Çotá gzip file");

241 i‡(
	`ªad1
(
ö
Ë!8Ë
	`bye
("unknow¿com¥essi⁄ mëhod in", in->
«me
);

242 
Êags
 = 
	`ªad1
(
ö
);

243 i‡(
Êags
 & 0xe0Ë
	`bye
("unknow¿hódî fœg†£àö", 
ö
->
«me
);

244 
	`skù
(
ö
, 6);

245 i‡(
Êags
 & 4) {

246 
n
 = 
	`ªad1
(
ö
);

247 
n
 +()(
	`ªad1
(
ö
)) << 8;

248 
	`skù
(
ö
, 
n
);

250 i‡(
Êags
 & 8Ë
	`ªad1
(
ö
) != 0) ;

251 i‡(
Êags
 & 16Ë
	`ªad1
(
ö
) != 0) ;

252 i‡(
Êags
 & 2Ë
	`skù
(
ö
, 2);

253 
	}
}

259 
loˇl
 
	$gzsˇn
(*
«me
, 
z_°ªam
 *
°rm
, 
Àvñ
)

261 
ªt
, 
œ°bô
, 
À·
, 
fuŒ
;

262 
have
;

263 
¸c
, 
tŸ
;

264 *
wödow
;

265 
off_t
 
œ°off
, 
íd
;

266 
fûe
 
gz
;

269 
gz
.
«me
 =Çame;

270 
gz
.
fd
 = 
	`›í
(
«me
, 
O_RDWR
, 0);

271 i‡(
gz
.
fd
 =-1Ë
	`bye
("ˇ¬Ÿ o≥¿", 
«me
);

272 
gz
.
buf
 = 
	`mÆloc
(
CHUNK
);

273 i‡(
gz
.
buf
 =
NULL
Ë
	`bye
("out of memory", "");

274 
gz
.
size
 = 
LGCHUNK
;

275 
gz
.
À·
 = 0;

278 
	`gzhódî
(&
gz
);

281 
wödow
 = 
	`mÆloc
(
DSIZE
);

282 i‡(
wödow
 =
NULL
Ë
	`bye
("out of memory", "");

283 
°rm
->
zÆloc
 = 
Z_NULL
;

284 
°rm
->
z‰ì
 = 
Z_NULL
;

285 
°rm
->
›aque
 = 
Z_NULL
;

286 
ªt
 = 
	`öÊ©eInô2
(
°rm
, -15);

287 i‡(
ªt
 !
Z_OK
Ë
	`bye
("out of memory", " orÜibrary mismatch");

290 
œ°bô
 = 0;

291 
œ°off
 = 
	`l£ek
(
gz
.
fd
, 0L, 
SEEK_CUR
Ë- gz.
À·
;

292 
À·
 = 0;

293 
°rm
->
avaû_ö
 = 
gz
.
À·
;

294 
°rm
->
√xt_ö
 = 
gz
.
√xt
;

295 
¸c
 = 
	`¸c32
(0L, 
Z_NULL
, 0);

296 
have
 = 
fuŒ
 = 0;

299 i‡(
°rm
->
avaû_ö
 == 0) {

300 
	`ªadm‹e
(&
gz
);

301 
°rm
->
avaû_ö
 = 
gz
.
À·
;

302 
°rm
->
√xt_ö
 = 
gz
.
√xt
;

306 
°rm
->
avaû_out
 = 
DSIZE
 - 
have
;

307 
°rm
->
√xt_out
 = 
wödow
 + 
have
;

310 
ªt
 = 
	`öÊ©e
(
°rm
, 
Z_BLOCK
);

311 i‡(
ªt
 =
Z_STREAM_ERROR
Ë
	`bye
("internal streamÉrror!", "");

312 i‡(
ªt
 =
Z_MEM_ERROR
Ë
	`bye
("out of memory", "");

313 i‡(
ªt
 =
Z_DATA_ERROR
)

314 
	`bye
("övÆid com¥es£d d©a--f‹m© viﬁ©ed in", 
«me
);

317 
¸c
 = 
	`¸c32
(¸c, 
wödow
 + 
have
, 
DSIZE
 - havê- 
°rm
->
avaû_out
);

318 i‡(
°rm
->
avaû_out
)

319 
have
 = 
DSIZE
 - 
°rm
->
avaû_out
;

321 
have
 = 0;

322 
fuŒ
 = 1;

326 i‡(
°rm
->
d©a_ty≥
 & 128) {

327 i‡(
°rm
->
d©a_ty≥
 & 64)

328 
À·
 = 
°rm
->
d©a_ty≥
 & 0x1f;

330 
œ°bô
 = 
°rm
->
d©a_ty≥
 & 0x1f;

331 
œ°off
 = 
	`l£ek
(
gz
.
fd
, 0L, 
SEEK_CUR
Ë- 
°rm
->
avaû_ö
;

334 } 
ªt
 !
Z_STREAM_END
);

335 
	`öÊ©eEnd
(
°rm
);

336 
gz
.
À·
 = 
°rm
->
avaû_ö
;

337 
gz
.
√xt
 = 
°rm
->
√xt_ö
;

340 
íd
 = 
	`l£ek
(
gz
.
fd
, 0L, 
SEEK_CUR
Ë- gz.
À·
;

343 i‡(
¸c
 !
	`ªad4
(&
gz
))

344 
	`bye
("övÆid com¥es£d d©a--¸¯mism©ch i¿", 
«me
);

345 
tŸ
 = 
°rm
->
tŸÆ_out
;

346 i‡((
tŸ
 & 0xffffffffULË!
	`ªad4
(&
gz
))

347 
	`bye
("övÆid com¥es£d d©a--Àngth mism©ch in", 
«me
);

350 i‡(
gz
.
À·
 || 
	`ªadö
(&gz))

351 
	`Ârötf
(
°dîr
,

355 
	`l£ek
(
gz
.
fd
, 
œ°off
 - (
œ°bô
 !0), 
SEEK_SET
);

356 i‡(
	`ªad
(
gz
.
fd
, gz.
buf
, 1Ë!1Ë
	`bye
("ªadögá·î sìk o¿", 
«me
);

357 *
gz
.
buf
 = ()(*gz.bu‡^ (1 << ((8 - 
œ°bô
) & 7)));

358 
	`l£ek
(
gz
.
fd
, -1L, 
SEEK_CUR
);

359 i‡(
	`wrôe
(
gz
.
fd
, gz.
buf
, 1Ë!1Ë
	`bye
("wrôögá·î sìkÅÿ", 
«me
);

362 i‡(
fuŒ
) {

363 
	`rŸ©e
(
wödow
, 
DSIZE
, 
have
);

364 
have
 = 
DSIZE
;

368 
ªt
 = 
	`deÊ©eInô2
(
°rm
, 
Àvñ
, 
Z_DEFLATED
, -15, 8, 
Z_DEFAULT_STRATEGY
);

369 i‡(
ªt
 !
Z_OK
Ë
	`bye
("out of memory", "");

370 
	`deÊ©eSëDi˘i⁄¨y
(
°rm
, 
wödow
, 
have
);

371 
°rm
->
adÀr
 = 
¸c
;

372 
°rm
->
tŸÆ_ö
 = 
tŸ
;

373 i‡(
À·
) {

374 
	`l£ek
(
gz
.
fd
, --
íd
, 
SEEK_SET
);

375 i‡(
	`ªad
(
gz
.
fd
, gz.
buf
, 1Ë!1Ë
	`bye
("ªadögá·î sìk o¿", 
«me
);

376 
	`deÊ©ePrime
(
°rm
, 8 - 
À·
, *
gz
.
buf
);

378 
	`l£ek
(
gz
.
fd
, 
íd
, 
SEEK_SET
);

381 
	`‰ì
(
wödow
);

382 
	`‰ì
(
gz
.
buf
);

383  
gz
.
fd
;

384 
	}
}

388 
loˇl
 
	$gzèck
(*
«me
, 
gd
, 
z_°ªam
 *
°rm
, 
œ°
)

390 
fd
, 
Àn
, 
ªt
;

391 
À·
;

392 *
ö
, *
out
;

395 
fd
 = 0;

396 i‡(
«me
 !
NULL
) {

397 
fd
 = 
	`›í
(
«me
, 
O_RDONLY
, 0);

398 i‡(
fd
 == -1)

399 
	`Ârötf
(
°dîr
, "gzappend warning: %sÇot found, skipping ...\n",

400 
«me
);

404 
ö
 = 
	`mÆloc
(
CHUNK
);

405 
out
 = 
	`mÆloc
(
CHUNK
);

406 i‡(
ö
 =
NULL
 || 
out
 =NULLË
	`bye
("out of memory", "");

411 
Àn
 = 
	`ªad
(
fd
, 
ö
, 
CHUNK
);

412 i‡(
Àn
 == -1) {

413 
	`Ârötf
(
°dîr
,

415 
«me
);

416 
Àn
 = 0;

418 
°rm
->
avaû_ö
 = ()
Àn
;

419 
°rm
->
√xt_ö
 = 
ö
;

420 i‡(
Àn
Ë
°rm
->
adÀr
 = 
	`¸c32
(°rm->adÀr, 
ö
, ()len);

424 
°rm
->
avaû_out
 = 
CHUNK
;

425 
°rm
->
√xt_out
 = 
out
;

426 
ªt
 = 
	`deÊ©e
(
°rm
, 
œ°
 && 
Àn
 =0 ? 
Z_FINISH
 : 
Z_NO_FLUSH
);

427 
À·
 = 
CHUNK
 - 
°rm
->
avaû_out
;

428 
À·
) {

429 
Àn
 = 
	`wrôe
(
gd
, 
out
 + 
CHUNK
 - 
°rm
->
avaû_out
 - 
À·
,Üeft);

430 i‡(
Àn
 =-1Ë
	`bye
("writing gzip file", "");

431 
À·
 -()
Àn
;

433 } 
°rm
->
avaû_out
 =0 && 
ªt
 !
Z_STREAM_END
);

434 } 
Àn
 != 0);

437 i‡(
œ°
) {

438 
	`deÊ©eEnd
(
°rm
);

439 
out
[0] = ()(
°rm
->
adÀr
);

440 
out
[1] = ()(
°rm
->
adÀr
 >> 8);

441 
out
[2] = ()(
°rm
->
adÀr
 >> 16);

442 
out
[3] = ()(
°rm
->
adÀr
 >> 24);

443 
out
[4] = ()(
°rm
->
tŸÆ_ö
);

444 
out
[5] = ()(
°rm
->
tŸÆ_ö
 >> 8);

445 
out
[6] = ()(
°rm
->
tŸÆ_ö
 >> 16);

446 
out
[7] = ()(
°rm
->
tŸÆ_ö
 >> 24);

447 
Àn
 = 8;

449 
ªt
 = 
	`wrôe
(
gd
, 
out
 + 8 - 
Àn
,Üen);

450 i‡(
ªt
 =-1Ë
	`bye
("writing gzip file", "");

451 
Àn
 -
ªt
;

452 } 
Àn
);

453 
	`˛o£
(
gd
);

457 
	`‰ì
(
out
);

458 
	`‰ì
(
ö
);

459 i‡(
fd
 > 0Ë
	`˛o£
(fd);

460 
	}
}

466 
	$maö
(
¨gc
, **
¨gv
)

468 
gd
, 
Àvñ
;

469 
z_°ªam
 
°rm
;

472 
¨gc
--; 
¨gv
++;

475 i‡(*
¨gv
 =
NULL
) {

476 
	`¥ötf
(

479 
	`¥ötf
(

485 
Àvñ
 = 
Z_DEFAULT_COMPRESSION
;

486 i‡(
¨gv
[0][0] == '-') {

487 i‡(
¨gv
[0][1] < '0' ||árgv[0][1] > '9' ||árgv[0][2] != 0)

488 
	`bye
("invalid compressionÜevel", "");

489 
Àvñ
 = 
¨gv
[0][1] - '0';

490 i‡(*++
¨gv
 =
NULL
Ë
	`bye
("no gzip fileÇameáfter options", "");

494 
gd
 = 
	`gzsˇn
(*
¨gv
++, &
°rm
, 
Àvñ
);

497 i‡(*
¨gv
 =
NULL
)

498 
	`gzèck
(
NULL
, 
gd
, &
°rm
, 1);

501 
	`gzèck
(*
¨gv
, 
gd
, &
°rm
,árgv[1] =
NULL
);

502 } *++
¨gv
 !
NULL
);

504 
	}
}

	@zlib-1.2.8/examples/gzjoin.c

56 
	~<°dio.h
>

57 
	~<°dlib.h
>

58 
	~<f˙é.h
>

59 
	~<uni°d.h
>

60 
	~"zlib.h
"

63 
	#loˇl
 

	)

66 
loˇl
 
	$baû
(*
why1
, *
why2
)

68 
	`Ârötf
(
°dîr
, "gzjoöÉº‹: %s%s, ouçuàöcom∂ëe\n", 
why1
, 
why2
);

69 
	`exô
(1);

71 
	}
}

75 
	#CHUNK
 32768

	)

79 *
	m«me
;

80 
	mfd
;

81 
	mÀ·
;

82 *
	m√xt
;

83 *
	mbuf
;

84 } 
	tbö
;

87 
loˇl
 
	$b˛o£
(
bö
 *
ö
)

89 i‡(
ö
 !
NULL
) {

90 i‡(
ö
->
fd
 != -1)

91 
	`˛o£
(
ö
->
fd
);

92 i‡(
ö
->
buf
 !
NULL
)

93 
	`‰ì
(
ö
->
buf
);

94 
	`‰ì
(
ö
);

96 
	}
}

100 
loˇl
 
bö
 *
	$b›í
(*
«me
)

102 
bö
 *
ö
;

104 
ö
 = 
	`mÆloc
((
bö
));

105 i‡(
ö
 =
NULL
)

106  
NULL
;

107 
ö
->
buf
 = 
	`mÆloc
(
CHUNK
);

108 
ö
->
fd
 = 
	`›í
(
«me
, 
O_RDONLY
, 0);

109 i‡(
ö
->
buf
 =
NULL
 || in->
fd
 == -1) {

110 
	`b˛o£
(
ö
);

111  
NULL
;

113 
ö
->
À·
 = 0;

114 
ö
->
√xt
 = in->
buf
;

115 
ö
->
«me
 =Çame;

116  
ö
;

117 
	}
}

121 
loˇl
 
	$blﬂd
(
bö
 *
ö
)

123 
Àn
;

125 i‡(
ö
 =
NULL
)

127 i‡(
ö
->
À·
 != 0)

129 
ö
->
√xt
 = in->
buf
;

131 
Àn
 = ()
	`ªad
(
ö
->
fd
, in->
buf
 + in->
À·
, 
CHUNK
 - in->left);

132 i‡(
Àn
 < 0)

134 
ö
->
À·
 +()
Àn
;

135 } 
Àn
 !0 && 
ö
->
À·
 < 
CHUNK
);

136  
Àn
 == 0 ? 1 : 0;

137 
	}
}

140 
	#bgë
(
ö
Ë(ö->
À·
 ? 0 : 
	`blﬂd
(in), \

141 
ö
->
À·
 ? (ö->À·--, *(ö->
√xt
)++) : \

142 
	`baû
("u√x≥˘edÉnd o‡fûê⁄ ", 
ö
->
«me
))

	)

145 
loˇl
 
	$bgë4
(
bö
 *
ö
)

147 
vÆ
;

149 
vÆ
 = 
	`bgë
(
ö
);

150 
vÆ
 +()(
	`bgë
(
ö
)) << 8;

151 
vÆ
 +()(
	`bgë
(
ö
)) << 16;

152 
vÆ
 +()(
	`bgë
(
ö
)) << 24;

153  
vÆ
;

154 
	}
}

157 
loˇl
 
	$bskù
(
bö
 *
ö
, 
skù
)

160 i‡(
ö
 =
NULL
)

164 i‡(
skù
 <
ö
->
À·
) {

165 
ö
->
À·
 -
skù
;

166 
ö
->
√xt
 +
skù
;

171 
skù
 -
ö
->
À·
;

172 
ö
->
À·
 = 0;

175 i‡(
skù
 > 
CHUNK
) {

176 
À·
;

178 
À·
 = 
skù
 & (
CHUNK
 - 1);

179 i‡(
À·
 == 0) {

182 
	`l£ek
(
ö
->
fd
, 
skù
 - 1, 
SEEK_CUR
);

183 i‡(
	`ªad
(
ö
->
fd
, in->
buf
, 1) != 1)

184 
	`baû
("u√x≥˘edÉnd o‡fûê⁄ ", 
ö
->
«me
);

189 
	`l£ek
(
ö
->
fd
, 
skù
 - 
À·
, 
SEEK_CUR
);

190 
skù
 = 
À·
;

194 
	`blﬂd
(
ö
);

195 i‡(
skù
 > 
ö
->
À·
)

196 
	`baû
("u√x≥˘edÉnd o‡fûê⁄ ", 
ö
->
«me
);

197 
ö
->
À·
 -
skù
;

198 
ö
->
√xt
 +
skù
;

199 
	}
}

204 
loˇl
 
	$gzhód
(
bö
 *
ö
)

206 
Êags
;

209 i‡(
	`bgë
(
ö
) != 0x1f || bget(in) != 0x8b || bget(in) != 8)

210 
	`baû
(
ö
->
«me
, " isÇotá valid gzip file");

213 
Êags
 = 
	`bgë
(
ö
);

214 i‡((
Êags
 & 0xe0) != 0)

215 
	`baû
("unknow¿ª£rved bô†£àö ", 
ö
->
«me
);

218 
	`bskù
(
ö
, 6);

221 i‡(
Êags
 & 4) {

222 
Àn
;

224 
Àn
 = 
	`bgë
(
ö
);

225 
Àn
 +()(
	`bgë
(
ö
)) << 8;

226 
	`bskù
(
ö
, 
Àn
);

230 i‡(
Êags
 & 8)

231 
	`bgë
(
ö
) != 0)

235 i‡(
Êags
 & 16)

236 
	`bgë
(
ö
) != 0)

240 i‡(
Êags
 & 2)

241 
	`bskù
(
ö
, 2);

242 
	}
}

245 
loˇl
 
	$put4
(
vÆ
, 
FILE
 *
out
)

247 
	`putc
(
vÆ
 & 0xff, 
out
);

248 
	`putc
((
vÆ
 >> 8Ë& 0xff, 
out
);

249 
	`putc
((
vÆ
 >> 16Ë& 0xff, 
out
);

250 
	`putc
((
vÆ
 >> 24Ë& 0xff, 
out
);

251 
	}
}

254 
loˇl
 
	$zpuŒ
(
z_°ªamp
 
°rm
, 
bö
 *
ö
)

256 i‡(
ö
->
À·
 == 0)

257 
	`blﬂd
(
ö
);

258 i‡(
ö
->
À·
 == 0)

259 
	`baû
("u√x≥˘edÉnd o‡fûê⁄ ", 
ö
->
«me
);

260 
°rm
->
avaû_ö
 = 
ö
->
À·
;

261 
°rm
->
√xt_ö
 = 
ö
->
√xt
;

262 
	}
}

265 
loˇl
 
	$gzöô
(*
¸c
, *
tŸ
, 
FILE
 *
out
)

267 
	`fwrôe
("\x1f\x8b\x08\0\0\0\0\0\0\xff", 1, 10, 
out
);

268 *
¸c
 = 
	`¸c32
(0L, 
Z_NULL
, 0);

269 *
tŸ
 = 0;

270 
	}
}

279 
loˇl
 
	$gzc›y
(*
«me
, 
˛r
, *
¸c
, *
tŸ
,

280 
FILE
 *
out
)

282 
ªt
;

283 
pos
;

284 
œ°
;

285 
bö
 *
ö
;

286 *
°¨t
;

287 *
junk
;

288 
z_off_t
 
Àn
;

289 
z_°ªam
 
°rm
;

292 
ö
 = 
	`b›í
(
«me
);

293 i‡(
ö
 =
NULL
)

294 
	`baû
("couldÇŸ o≥¿", 
«me
);

295 
	`gzhód
(
ö
);

299 
junk
 = 
	`mÆloc
(
CHUNK
);

300 
°rm
.
zÆloc
 = 
Z_NULL
;

301 
°rm
.
z‰ì
 = 
Z_NULL
;

302 
°rm
.
›aque
 = 
Z_NULL
;

303 
°rm
.
avaû_ö
 = 0;

304 
°rm
.
√xt_ö
 = 
Z_NULL
;

305 
ªt
 = 
	`öÊ©eInô2
(&
°rm
, -15);

306 i‡(
junk
 =
NULL
 || 
ªt
 !
Z_OK
)

307 
	`baû
("out of memory", "");

310 
Àn
 = 0;

311 
	`zpuŒ
(&
°rm
, 
ö
);

312 
°¨t
 = 
ö
->
√xt
;

313 
œ°
 = 
°¨t
[0] & 1;

314 i‡(
œ°
 && 
˛r
)

315 
°¨t
[0] &= ~1;

316 
°rm
.
avaû_out
 = 0;

319 i‡(
°rm
.
avaû_ö
 =0 && såm.
avaû_out
 != 0) {

320 
	`fwrôe
(
°¨t
, 1, 
°rm
.
√xt_ö
 - sèπ, 
out
);

321 
°¨t
 = 
ö
->
buf
;

322 
ö
->
À·
 = 0;

323 
	`zpuŒ
(&
°rm
, 
ö
);

327 
°rm
.
avaû_out
 = 
CHUNK
;

328 
°rm
.
√xt_out
 = 
junk
;

329 
ªt
 = 
	`öÊ©e
(&
°rm
, 
Z_BLOCK
);

330 
ªt
) {

331 
Z_MEM_ERROR
:

332 
	`baû
("out of memory", "");

333 
Z_DATA_ERROR
:

334 
	`baû
("övÆid com¥es£d d©®ö ", 
ö
->
«me
);

338 
Àn
 +
CHUNK
 - 
°rm
.
avaû_out
;

341 i‡(
°rm
.
d©a_ty≥
 & 128) {

343 i‡(
œ°
)

347 
pos
 = 
°rm
.
d©a_ty≥
 & 7;

350 i‡(
pos
 != 0) {

352 
pos
 = 0x100 >>Öos;

353 
œ°
 = 
°rm
.
√xt_ö
[-1] & 
pos
;

354 i‡(
œ°
 && 
˛r
)

355 
ö
->
buf
[
°rm
.
√xt_ö
 - in->bu‡- 1] &~
pos
;

359 i‡(
°rm
.
avaû_ö
 == 0) {

361 
	`fwrôe
(
°¨t
, 1, 
°rm
.
√xt_ö
 - sèπ, 
out
);

362 
°¨t
 = 
ö
->
buf
;

363 
ö
->
À·
 = 0;

364 
	`zpuŒ
(&
°rm
, 
ö
);

366 
œ°
 = 
°rm
.
√xt_ö
[0] & 1;

367 i‡(
œ°
 && 
˛r
)

368 
ö
->
buf
[
°rm
.
√xt_ö
 - in->buf] &= ~1;

374 
ö
->
À·
 = 
°rm
.
avaû_ö
;

375 
ö
->
√xt
 = in->
buf
 + (
°rm
.
√xt_ö
 - in->buf);

378 
pos
 = 
°rm
.
d©a_ty≥
 & 7;

379 
	`fwrôe
(
°¨t
, 1, 
ö
->
√xt
 - sèπ - 1, 
out
);

380 
œ°
 = 
ö
->
√xt
[-1];

381 i‡(
pos
 =0 || !
˛r
)

383 
	`putc
(
œ°
, 
out
);

386 
œ°
 &((0x100 >> 
pos
) - 1);

387 i‡(
pos
 & 1) {

389 
	`putc
(
œ°
, 
out
);

390 i‡(
pos
 == 1)

391 
	`putc
(0, 
out
);

392 
	`fwrôe
("\0\0\xff\xff", 1, 4, 
out
);

396 
pos
) {

398 
	`putc
(
œ°
 | 8, 
out
);

399 
œ°
 = 0;

401 
	`putc
(
œ°
 | 0x20, 
out
);

402 
œ°
 = 0;

404 
	`putc
(
œ°
 | 0x80, 
out
);

405 
	`putc
(0, 
out
);

411 *
¸c
 = 
	`¸c32_comböe
(*¸c, 
	`bgë4
(
ö
), 
Àn
);

412 *
tŸ
 +()
Àn
;

415 
	`öÊ©eEnd
(&
°rm
);

416 
	`‰ì
(
junk
);

417 
	`b˛o£
(
ö
);

420 i‡(!
˛r
) {

421 
	`put4
(*
¸c
, 
out
);

422 
	`put4
(*
tŸ
, 
out
);

424 
	}
}

427 
	$maö
(
¨gc
, **
¨gv
)

429 
¸c
, 
tŸ
;

432 
¨gc
--;

433 
¨gv
++;

436 i‡(
¨gc
 == 0) {

437 
	`Âuts
("gzjoin usage: gzjoin f1.gz [f2.gz [f3.gz ...]] > fjoin.gz\n",

438 
°dîr
);

443 
	`gzöô
(&
¸c
, &
tŸ
, 
°dout
);

444 
¨gc
--)

445 
	`gzc›y
(*
¨gv
++, 
¨gc
, &
¸c
, &
tŸ
, 
°dout
);

449 
	}
}

	@zlib-1.2.8/examples/gzlog.c

226 
	~<sys/ty≥s.h
>

227 
	~<°dio.h
>

228 
	~<°dlib.h
>

229 
	~<°rög.h
>

230 
	~<f˙é.h
>

231 
	~<uni°d.h
>

233 
	~<î∫o.h
>

234 
	~<time.h
>

235 
	~<sys/°©.h
>

236 
	~<sys/time.h
>

237 
	~"zlib.h
"

239 
	~"gzlog.h
"

241 
	#loˇl
 

	)

242 
	tuöt
;

243 
	tul⁄g
;

246 #ifde‡
DEBUG


247 
	~<£tjmp.h
>

248 
jmp_buf
 
	ggzlog_jump
;

249 
	ggzlog_baû
 = 0;

250 
	ggzlog_cou¡
 = -1;

251 
	#BAIL
(
n
Ëdÿ{ i‡“ =
gzlog_baû
 && 
gzlog_cou¡
-- == 0) \

252 
	`l⁄gjmp
(
gzlog_jump
, 
gzlog_baû
); } 0)

	)

254 
	#BAIL
(
n
)

	)

258 
	#PATIENCE
 300

	)

261 
	#MAX_STORE
 16

	)

266 
	#TRIGGER
 1024

	)

269 
	#DICT
 32768U

	)

272 
	#NO_OP
 0

	)

273 
	#APPEND_OP
 1

	)

274 
	#COMPRESS_OP
 2

	)

275 
	#REPLACE_OP
 3

	)

278 
	#PULL2
(
p
Ë(’)[0]+((
uöt
)(’)[1])<<8))

	)

279 
	#PULL4
(
p
Ë(
	`PULL2
’)+((
ul⁄g
)PULL2’+2)<<16))

	)

280 
	#PULL8
(
p
Ë(
	`PULL4
’)+((
off_t
)PULL4’+4)<<32))

	)

283 
	#PUT2
(
p
,
a
Ëdÿ{’)[0]˜;’)[1]=◊)>>8;} 0)

	)

284 
	#PUT4
(
p
,
a
Ëdÿ{
	`PUT2
’,a);PUT2’+2,a>>16);} 0)

	)

285 
	#PUT8
(
p
,
a
Ëdÿ{
	`PUT4
’,a);PUT4’+4,a>>32);} 0)

	)

288 
	#LOGID
 "\106\035\172"

	)

289 
	slog
 {

290 
	mid
[4];

291 
	mfd
;

292 *
	m∑th
;

293 *
	míd
;

294 
off_t
 
	mfú°
;

295 
	mback
;

296 
uöt
 
	m°‹ed
;

297 
off_t
 
	mœ°
;

298 
ul⁄g
 
	mc¸c
;

299 
ul⁄g
 
	m˛í
;

300 
ul⁄g
 
	mt¸c
;

301 
ul⁄g
 
	méí
;

302 
time_t
 
	mlock
;

306 
loˇl
 
	glog_gzhód
[] = {

316 
	#HEAD
 (
log_gzhód
Ë

	)

319 
loˇl
 
	glog_gzext
[] = {

328 
	#EXTRA
 (
log_gzext
Ë

	)

331 
loˇl
 
	glog_gzbody
[] = {

337 
	#BODY
 (
log_gzbody
)

	)

348 
loˇl
 
	$log_lock
(
log
 *log)

350 
fd
;

351 
°©
 
°
;

353 
	`°r˝y
(
log
->
íd
, ".lock");

354 (
fd
 = 
	`›í
(
log
->
∑th
, 
O_CREAT
 | 
O_EXCL
, 0644)) < 0) {

355 i‡(
î∫o
 !
EEXIST
)

357 i‡(
	`°©
(
log
->
∑th
, &
°
Ë=0 && 
	`time
(
NULL
Ë- st.
°_mtime
 > 
PATIENCE
) {

358 
	`u∆ök
(
log
->
∑th
);

361 
	`¶ìp
(2);

363 
	`˛o£
(
fd
);

364 i‡(
	`°©
(
log
->
∑th
, &
°
) == 0)

365 
log
->
lock
 = 
°
.
°_mtime
;

367 
	}
}

372 
loˇl
 
	$log_touch
(
log
 *log)

374 
°©
 
°
;

376 
	`°r˝y
(
log
->
íd
, ".lock");

377 
	`utimes
(
log
->
∑th
, 
NULL
);

378 i‡(
	`°©
(
log
->
∑th
, &
°
) == 0)

379 
log
->
lock
 = 
°
.
°_mtime
;

380 
	}
}

384 
loˇl
 
	$log_check
(
log
 *log)

386 
°©
 
°
;

388 
	`°r˝y
(
log
->
íd
, ".lock");

389 i‡(
	`°©
(
log
->
∑th
, &
°
Ë|| st.
°_mtime
 !log->
lock
)

391 
	`log_touch
(
log
);

393 
	}
}

396 
loˇl
 
	$log_u∆ock
(
log
 *log)

398 i‡(
	`log_check
(
log
))

400 
	`°r˝y
(
log
->
íd
, ".lock");

401 
	`u∆ök
(
log
->
∑th
);

402 
log
->
lock
 = 0;

403 
	}
}

410 
loˇl
 
	$log_hód
(
log
 *log)

412 
›
;

413 
buf
[
HEAD
 + 
EXTRA
];

415 i‡(
	`l£ek
(
log
->
fd
, 0, 
SEEK_SET
) < 0 ||

416 
	`ªad
(
log
->
fd
, 
buf
, 
HEAD
 + 
EXTRA
) != HEAD + EXTRA ||

417 
	`memcmp
(
buf
, 
log_gzhód
, 
HEAD
)) {

420 
log
->
fú°
 = 
	`PULL8
(
buf
 + 
HEAD
);

421 
log
->
œ°
 = 
	`PULL8
(
buf
 + 
HEAD
 + 8);

422 
log
->
c¸c
 = 
	`PULL4
(
buf
 + 
HEAD
 + 16);

423 
log
->
˛í
 = 
	`PULL4
(
buf
 + 
HEAD
 + 20);

424 
log
->
t¸c
 = 
	`PULL4
(
buf
 + 
HEAD
 + 24);

425 
log
->
éí
 = 
	`PULL4
(
buf
 + 
HEAD
 + 28);

426 
log
->
°‹ed
 = 
	`PULL2
(
buf
 + 
HEAD
 + 32);

427 
log
->
back
 = 3 + (
buf
[
HEAD
 + 34] & 7);

428 
›
 = (
buf
[
HEAD
 + 34] >> 3) & 3;

429  
›
;

430 
	}
}

437 
loˇl
 
	$log_m¨k
(
log
 *log, 
›
)

439 
ªt
;

440 
ext
[
EXTRA
];

442 
	`PUT8
(
ext
, 
log
->
fú°
);

443 
	`PUT8
(
ext
 + 8, 
log
->
œ°
);

444 
	`PUT4
(
ext
 + 16, 
log
->
c¸c
);

445 
	`PUT4
(
ext
 + 20, 
log
->
˛í
);

446 
	`PUT4
(
ext
 + 24, 
log
->
t¸c
);

447 
	`PUT4
(
ext
 + 28, 
log
->
éí
);

448 
	`PUT2
(
ext
 + 32, 
log
->
°‹ed
);

449 
ext
[34] = 
log
->
back
 - 3 + (
›
 << 3);

450 
	`fsync
(
log
->
fd
);

451 
ªt
 = 
	`l£ek
(
log
->
fd
, 
HEAD
, 
SEEK_SET
) < 0 ||

452 
	`wrôe
(
log
->
fd
, 
ext
, 
EXTRA
) != EXTRA ? -1 : 0;

453 
	`fsync
(
log
->
fd
);

454  
ªt
;

455 
	}
}

462 
loˇl
 
	$log_œ°
(
log
 *log, 
œ°
)

464 
back
, 
Àn
, 
mask
;

465 
buf
[6];

468 
back
 = 
log
->
œ°
 =log->
fú°
 ?Üog->back : 8;

469 
Àn
 = 
back
 > 8 ? 2 : 1;

470 
mask
 = 0x80 >> ((
back
 - 1) & 7);

475 
buf
[0] = 0;

476 i‡(
back
 !8 && (
	`l£ek
(
log
->
fd
,Üog->
œ°
 - 
Àn
, 
SEEK_SET
) < 0 ||

477 
	`ªad
(
log
->
fd
, 
buf
, 1) != 1))

484 
buf
[1] = 0;

485 
buf
[2 - 
Àn
] = (*bu‡& (
mask
 - 1)Ë+ (
œ°
 ? mask : 0);

489 
	`PUT2
(
buf
 + 2, 
log
->
°‹ed
);

490 
	`PUT2
(
buf
 + 4, 
log
->
°‹ed
 ^ 0xffff);

491  
	`l£ek
(
log
->
fd
,Üog->
œ°
 - 
Àn
, 
SEEK_SET
) < 0 ||

492 
	`wrôe
(
log
->
fd
, 
buf
 + 2 - 
Àn
,Üen + 4) !=Üen + 4 ||

493 
	`l£ek
(
log
->
fd
,Üog->
°‹ed
, 
SEEK_CUR
) < 0 ? -1 : 0;

494 
	}
}

501 
loˇl
 
	$log_≠≥nd
(
log
 *log, *
d©a
, 
size_t
 
Àn
)

503 
uöt
 
put
;

504 
off_t
 
íd
;

505 
buf
[8];

510 i‡(
	`log_œ°
(
log
, 1))

515 
Àn
) {

517 
put
 = (
MAX_STORE
 << 10Ë- 
log
->
°‹ed
;

518 i‡(
put
 > 
Àn
)

519 
put
 = (
uöt
)
Àn
;

520 i‡(
put
) {

521 i‡(
	`wrôe
(
log
->
fd
, 
d©a
, 
put
) !=Öut)

523 
	`BAIL
(1);

524 
log
->
t¸c
 = 
	`¸c32
÷og->t¸c, 
d©a
, 
put
);

525 
log
->
éí
 +
put
;

526 
log
->
°‹ed
 +
put
;

527 
d©a
 +
put
;

528 
Àn
 -
put
;

532 i‡(
Àn
) {

534 i‡(
	`log_œ°
(
log
, 0))

538 
log
->
œ°
 +4 +Üog->
°‹ed
 + 1;

539 
log
->
°‹ed
 = 0;

543 i‡(
	`log_œ°
(
log
, 1))

545 
	`BAIL
(2);

550 
	`PUT4
(
buf
, 
log
->
t¸c
);

551 
	`PUT4
(
buf
 + 4, 
log
->
éí
);

552 i‡(
	`wrôe
(
log
->
fd
, 
buf
, 8) != 8 ||

553 (
íd
 = 
	`l£ek
(
log
->
fd
, 0, 
SEEK_CUR
)Ë< 0 || 
	`·runˇã
(log->fd,Énd))

557 i‡(
	`log_m¨k
(
log
, 
NO_OP
))

559 
	`°r˝y
(
log
->
íd
, ".add");

560 
	`u∆ök
(
log
->
∑th
);

562 
	}
}

571 
loˇl
 
	$log_ª∂a˚
(
log
 *log)

573 
ªt
;

574 *
de°
;

577 
	`°r˝y
(
log
->
íd
, ".add");

578 
	`u∆ök
(
log
->
∑th
);

579 
	`BAIL
(3);

582 
	`°r˝y
(
log
->
íd
, ".dict");

583 
de°
 = 
	`mÆloc
(
	`°æí
(
log
->
∑th
) + 1);

584 i‡(
de°
 =
NULL
)

586 
	`°r˝y
(
de°
, 
log
->
∑th
);

587 
	`°r˝y
(
log
->
íd
, ".temp");

588 
ªt
 = 
	`ª«me
(
log
->
∑th
, 
de°
);

589 
	`‰ì
(
de°
);

590 i‡(
ªt
 && 
î∫o
 !
ENOENT
)

592 
	`BAIL
(4);

595  
	`log_m¨k
(
log
, 
NO_OP
);

596 
	}
}

608 
loˇl
 
	$log_com¥ess
(
log
 *log, *
d©a
, 
size_t
 
Àn
)

610 
fd
;

611 
uöt
 
gŸ
, 
max
;

612 
ssize_t
 
di˘
;

613 
off_t
 
íd
;

614 
z_°ªam
 
°rm
;

615 
buf
[
DICT
];

618 i‡(
Àn
) {

620 
°rm
.
zÆloc
 = 
Z_NULL
;

621 
°rm
.
z‰ì
 = 
Z_NULL
;

622 
°rm
.
›aque
 = 
Z_NULL
;

623 i‡(
	`deÊ©eInô2
(&
°rm
, 
Z_DEFAULT_COMPRESSION
, 
Z_DEFLATED
, -15, 8,

624 
Z_DEFAULT_STRATEGY
Ë!
Z_OK
)

628 
	`°r˝y
(
log
->
íd
, ".dict");

629 
fd
 = 
	`›í
(
log
->
∑th
, 
O_RDONLY
, 0);

630 i‡(
fd
 >= 0) {

631 
di˘
 = 
	`ªad
(
fd
, 
buf
, 
DICT
);

632 
	`˛o£
(
fd
);

633 i‡(
di˘
 < 0) {

634 
	`deÊ©eEnd
(&
°rm
);

637 i‡(
di˘
)

638 
	`deÊ©eSëDi˘i⁄¨y
(&
°rm
, 
buf
, (
uöt
)
di˘
);

640 
	`log_touch
(
log
);

644 i‡(
	`l£ek
(
log
->
fd
,Üog->
fú°
 - (log->
back
 > 8 ? 2 : 1),

645 
SEEK_SET
) < 0 ||

646 
	`ªad
(
log
->
fd
, 
buf
, 1Ë!1 || 
	`l£ek
÷og->fd, -1, 
SEEK_CUR
) < 0) {

647 
	`deÊ©eEnd
(&
°rm
);

650 
	`deÊ©ePrime
(&
°rm
, (8 - 
log
->
back
Ë& 7, *
buf
);

653 
°rm
.
√xt_ö
 = 
d©a
;

654 
max
 = (((
uöt
)0 - 1) >> 1) + 1;

656 
°rm
.
avaû_ö
 = 
Àn
 > 
max
 ? max : (
uöt
)len;

657 
Àn
 -
°rm
.
avaû_ö
;

659 
°rm
.
avaû_out
 = 
DICT
;

660 
°rm
.
√xt_out
 = 
buf
;

661 
	`deÊ©e
(&
°rm
, 
Àn
 ? 
Z_NO_FLUSH
 : 
Z_PARTIAL_FLUSH
);

662 
gŸ
 = 
DICT
 - 
°rm
.
avaû_out
;

663 i‡(
gŸ
 && 
	`wrôe
(
log
->
fd
, 
buf
, got) != got) {

664 
	`deÊ©eEnd
(&
°rm
);

667 
	`log_touch
(
log
);

668 } 
°rm
.
avaû_out
 == 0);

669 } 
Àn
);

670 
	`deÊ©eEnd
(&
°rm
);

671 
	`BAIL
(5);

677 i‡((
log
->
fú°
 = 
	`l£ek
÷og->
fd
, -1, 
SEEK_CUR
)) < 0 ||

678 
	`ªad
(
log
->
fd
, 
buf
, 1) != 1)

680 
log
->
fú°
++;

681 i‡(*
buf
) {

682 
log
->
back
 = 1;

683 (*
buf
 & ((
uöt
)1 << (8 - 
log
->
back
++))) == 0)

687 
log
->
back
 = 10;

690 
log
->
c¸c
 =Üog->
t¸c
;

691 
log
->
˛í
 =Üog->
éí
;

695 
log
->
t¸c
 =Üog->
c¸c
;

696 
log
->
éí
 =Üog->
˛í
;

700 
log
->
œ°
 =Üog->
fú°
;

701 
log
->
°‹ed
 = 0;

702 
	`PUT4
(
buf
, 
log
->
t¸c
);

703 
	`PUT4
(
buf
 + 4, 
log
->
éí
);

704 i‡(
	`log_œ°
(
log
, 1Ë|| 
	`wrôe
÷og->
fd
, 
buf
, 8) != 8 ||

705 (
íd
 = 
	`l£ek
(
log
->
fd
, 0, 
SEEK_CUR
)Ë< 0 || 
	`·runˇã
(log->fd,Énd))

707 
	`BAIL
(6);

710 i‡(
	`log_m¨k
(
log
, 
REPLACE_OP
))

714  
	`log_ª∂a˚
(
log
);

715 
	}
}

718 
loˇl
 
	$log_log
(
log
 *log, 
›
, *
ªc‹d
)

720 
time_t
 
now
;

721 
FILE
 *
ªc
;

723 
now
 = 
	`time
(
NULL
);

724 
	`°r˝y
(
log
->
íd
, ".repairs");

725 
ªc
 = 
	`f›í
(
log
->
∑th
, "a");

726 i‡(
ªc
 =
NULL
)

728 
	`Ârötf
(
ªc
, "%.24†%†ªcovîy: %s\n", 
	`˘ime
(&
now
), 
›
 =
APPEND_OP
 ?

729 "≠≥nd" : (
›
 =
COMPRESS_OP
 ? "com¥ess" : "ª∂a˚"), 
ªc‹d
);

730 
	`f˛o£
(
ªc
);

732 
	}
}

738 
loˇl
 
	$log_ªcovî
(
log
 *log, 
›
)

740 
fd
, 
ªt
 = 0;

741 *
d©a
 = 
NULL
;

742 
size_t
 
Àn
 = 0;

743 
°©
 
°
;

746 
	`log_log
(
log
, 
›
, "start");

749 i‡(
›
 =
APPEND_OP
 || o∞=
COMPRESS_OP
) {

750 
	`°r˝y
(
log
->
íd
, ".add");

751 i‡(
	`°©
(
log
->
∑th
, &
°
Ë=0 && st.
°_size
) {

752 
Àn
 = (
size_t
)(
°
.
°_size
);

753 i‡((
off_t
)
Àn
 !
°
.
°_size
 ||

754 (
d©a
 = 
	`mÆloc
(
°
.
°_size
)Ë=
NULL
) {

755 
	`log_log
(
log
, 
›
, "allocation failure");

758 i‡((
fd
 = 
	`›í
(
log
->
∑th
, 
O_RDONLY
, 0)) < 0) {

759 
	`log_log
(
log
, 
›
, ".add fileÑead failure");

762 
ªt
 = (
size_t
)
	`ªad
(
fd
, 
d©a
, 
Àn
) !=Üen;

763 
	`˛o£
(
fd
);

764 i‡(
ªt
) {

765 
	`log_log
(
log
, 
›
, ".add fileÑead failure");

768 
	`log_log
(
log
, 
›
, "loaded .add file");

771 
	`log_log
(
log
, 
›
, "missing .add file!");

775 
›
) {

776 
APPEND_OP
:

777 
ªt
 = 
	`log_≠≥nd
(
log
, 
d©a
, 
Àn
);

779 
COMPRESS_OP
:

780 
ªt
 = 
	`log_com¥ess
(
log
, 
d©a
, 
Àn
);

782 
REPLACE_OP
:

783 
ªt
 = 
	`log_ª∂a˚
(
log
);

787 
	`log_log
(
log
, 
›
, 
ªt
 ? "failure" : "complete");

790 i‡(
d©a
 !
NULL
)

791 
	`‰ì
(
d©a
);

792  
ªt
;

793 
	}
}

796 
loˇl
 
	$log_˛o£
(
log
 *log)

798 i‡(
log
->
fd
 >= 0)

799 
	`˛o£
(
log
->
fd
);

800 
log
->
fd
 = -1;

801 
	`log_u∆ock
(
log
);

802 
	}
}

813 
loˇl
 
	$log_›í
(
log
 *log)

815 
›
;

819 i‡(
log
->
fd
 >= 0)

820 
	`˛o£
(
log
->
fd
);

821 
log
->
fd
 = -1;

824 i‡(
	`log_lock
(
log
) < 0)

828 
	`°r˝y
(
log
->
íd
, ".gz");

829 
log
->
fd
 = 
	`›í
÷og->
∑th
, 
O_RDWR
 | 
O_CREAT
, 0644);

830 i‡(
log
->
fd
 < 0) {

831 
	`log_˛o£
(
log
);

836 i‡(
	`l£ek
(
log
->
fd
, 0, 
SEEK_END
) == 0) {

837 i‡(
	`wrôe
(
log
->
fd
, 
log_gzhód
, 
HEAD
) != HEAD ||

838 
	`wrôe
(
log
->
fd
, 
log_gzext
, 
EXTRA
) != EXTRA ||

839 
	`wrôe
(
log
->
fd
, 
log_gzbody
, 
BODY
) != BODY) {

840 
	`log_˛o£
(
log
);

843 
	`°r˝y
(
log
->
íd
, ".dict");

844 
	`u∆ök
(
log
->
∑th
);

848 i‡((
›
 = 
	`log_hód
(
log
)) < 0) {

849 
	`log_˛o£
(
log
);

854 i‡(
›
 !
NO_OP
 && 
	`log_ªcovî
(
log
, op)) {

855 
	`log_˛o£
(
log
);

860 
	`log_touch
(
log
);

862 
	}
}

865 
gzlog
 *
	$gzlog_›í
(*
∑th
)

867 
size_t
 
n
;

868 
log
 *log;

871 i‡(
∑th
 =
NULL
 || *path == 0)

872  
NULL
;

875 
log
 = 
	`mÆloc
((log));

876 i‡(
log
 =
NULL
)

877  
NULL
;

878 
	`°r˝y
(
log
->
id
, 
LOGID
);

879 
log
->
fd
 = -1;

882 
n
 = 
	`°æí
(
∑th
);

883 
log
->
∑th
 = 
	`mÆloc
(
n
 + 9);

884 i‡(
log
->
∑th
 =
NULL
) {

885 
	`‰ì
(
log
);

886  
NULL
;

888 
	`°r˝y
(
log
->
∑th
,Öath);

889 
log
->
íd
 =Üog->
∑th
 + 
n
;

893 i‡(
	`log_›í
(
log
)) {

894 
	`‰ì
(
log
->
∑th
);

895 
	`‰ì
(
log
);

896  
NULL
;

900  
log
;

901 
	}
}

908 
	$gzlog_com¥ess
(
gzlog
 *
logd
)

910 
fd
, 
ªt
;

911 
uöt
 
block
;

912 
size_t
 
Àn
, 
√xt
;

913 *
d©a
, 
buf
[5];

914 
log
 *log = 
logd
;

917 i‡(
log
 =
NULL
 || 
	`°rcmp
÷og->
id
, 
LOGID
))

923 i‡(
	`log_check
(
log
Ë&& 
	`log_›í
(log))

927 
Àn
 = ((
size_t
)(
log
->
œ°
 -Üog->
fú°
) & ~(((size_t)1 << 10) - 1)) +

928 
log
->
°‹ed
;

929 i‡((
d©a
 = 
	`mÆloc
(
Àn
)Ë=
NULL
)

935 i‡(
	`l£ek
(
log
->
fd
,Üog->
fú°
 - 1, 
SEEK_SET
) < 0)

937 
√xt
 = 0;

938 
√xt
 < 
Àn
) {

939 i‡(
	`ªad
(
log
->
fd
, 
buf
, 5) != 5)

941 
block
 = 
	`PULL2
(
buf
 + 1);

942 i‡(
√xt
 + 
block
 > 
Àn
 ||

943 
	`ªad
(
log
->
fd
, (*)
d©a
 + 
√xt
, 
block
) != block)

945 
√xt
 +
block
;

947 i‡(
	`l£ek
(
log
->
fd
, 0, 
SEEK_CUR
Ë!log->
œ°
 + 4 +Üog->
°‹ed
)

949 
	`log_touch
(
log
);

952 
	`°r˝y
(
log
->
íd
, ".add");

953 
fd
 = 
	`›í
(
log
->
∑th
, 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
, 0644);

954 i‡(
fd
 < 0)

956 
ªt
 = (
size_t
)
	`wrôe
(
fd
, 
d©a
, 
Àn
) !=Üen;

957 i‡(
ªt
 | 
	`˛o£
(
fd
))

959 
	`log_touch
(
log
);

962 
	`°r˝y
(
log
->
íd
, ".temp");

963 
fd
 = 
	`›í
(
log
->
∑th
, 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
, 0644);

964 i‡(
fd
 < 0)

966 
√xt
 = 
DICT
 > 
Àn
 ?Üen : DICT;

967 
ªt
 = (
size_t
)
	`wrôe
(
fd
, (*)
d©a
 + 
Àn
 - 
√xt
,Çext) !=Çext;

968 i‡(
ªt
 | 
	`˛o£
(
fd
))

970 
	`log_touch
(
log
);

973 
log
->
œ°
 =Üog->
fú°
;

974 
log
->
°‹ed
 = 0;

975 i‡(
	`log_m¨k
(
log
, 
COMPRESS_OP
))

977 
	`BAIL
(7);

980 
ªt
 = 
	`log_com¥ess
(
log
, 
d©a
, 
Àn
);

981 
	`‰ì
(
d©a
);

982  
ªt
;

986 
	`‰ì
(
d©a
);

988 
	}
}

995 
	$gzlog_wrôe
(
gzlog
 *
logd
, *
d©a
, 
size_t
 
Àn
)

997 
fd
, 
ªt
;

998 
log
 *log = 
logd
;

1001 i‡(
log
 =
NULL
 || 
	`°rcmp
÷og->
id
, 
LOGID
))

1003 i‡(
d©a
 =
NULL
 || 
Àn
 <= 0)

1009 i‡(
	`log_check
(
log
Ë&& 
	`log_›í
(log))

1013 
	`°r˝y
(
log
->
íd
, ".add");

1014 
fd
 = 
	`›í
(
log
->
∑th
, 
O_WRONLY
 | 
O_CREAT
 | 
O_TRUNC
, 0644);

1015 i‡(
fd
 < 0)

1017 
ªt
 = (
size_t
)
	`wrôe
(
fd
, 
d©a
, 
Àn
) !=Üen;

1018 i‡(
ªt
 | 
	`˛o£
(
fd
))

1020 
	`log_touch
(
log
);

1023 i‡(
	`log_m¨k
(
log
, 
APPEND_OP
))

1025 
	`BAIL
(8);

1028 i‡(
	`log_≠≥nd
(
log
, 
d©a
, 
Àn
))

1032 i‡(((
log
->
œ°
 -Üog->
fú°
Ë>> 10Ë+ (log->
°‹ed
 >> 10Ë< 
TRIGGER
)

1036  
	`gzlog_com¥ess
(
log
);

1037 
	}
}

1042 
	$gzlog_˛o£
(
gzlog
 *
logd
)

1044 
log
 *log = 
logd
;

1047 i‡(
log
 =
NULL
 || 
	`°rcmp
÷og->
id
, 
LOGID
))

1051 
	`log_˛o£
(
log
);

1054 i‡(
log
->
∑th
 !
NULL
)

1055 
	`‰ì
(
log
->
∑th
);

1056 
	`°r˝y
(
log
->
id
, "bad");

1057 
	`‰ì
(
log
);

1059 
	}
}

	@zlib-1.2.8/examples/gzlog.h

48 #i‚de‡
GZLOG_H


49 
	#GZLOG_H


	)

52 
	tgzlog
;

66 
gzlog
 *
gzlog_›í
(*
∑th
);

77 
gzlog_wrôe
(
gzlog
 *
log
, *
d©a
, 
size_t
 
Àn
);

85 
gzlog_com¥ess
(
gzlog
 *
log
);

89 
gzlog_˛o£
(
gzlog
 *
log
);

	@zlib-1.2.8/examples/zpipe.c

15 
	~<°dio.h
>

16 
	~<°rög.h
>

17 
	~<as£π.h
>

18 
	~"zlib.h
"

20 #i‡
deföed
(
MSDOS
Ë|| deföed(
OS2
Ë|| deföed(
WIN32
Ë|| deföed(
__CYGWIN__
)

21 
	~<f˙é.h
>

22 
	~<io.h
>

23 
	#SET_BINARY_MODE
(
fûe
Ë
	`£tmode
(
	`fûío
(fûe), 
O_BINARY
)

	)

25 
	#SET_BINARY_MODE
(
fûe
)

	)

28 
	#CHUNK
 16384

	)

36 
	$def
(
FILE
 *
sour˚
, FILE *
de°
, 
Àvñ
)

38 
ªt
, 
Êush
;

39 
have
;

40 
z_°ªam
 
°rm
;

41 
ö
[
CHUNK
];

42 
out
[
CHUNK
];

45 
°rm
.
zÆloc
 = 
Z_NULL
;

46 
°rm
.
z‰ì
 = 
Z_NULL
;

47 
°rm
.
›aque
 = 
Z_NULL
;

48 
ªt
 = 
	`deÊ©eInô
(&
°rm
, 
Àvñ
);

49 i‡(
ªt
 !
Z_OK
)

50  
ªt
;

54 
°rm
.
avaû_ö
 = 
	`‰ód
(
ö
, 1, 
CHUNK
, 
sour˚
);

55 i‡(
	`„º‹
(
sour˚
)) {

56 ()
	`deÊ©eEnd
(&
°rm
);

57  
Z_ERRNO
;

59 
Êush
 = 
	`„of
(
sour˚
Ë? 
Z_FINISH
 : 
Z_NO_FLUSH
;

60 
°rm
.
√xt_ö
 = 
ö
;

65 
°rm
.
avaû_out
 = 
CHUNK
;

66 
°rm
.
√xt_out
 = 
out
;

67 
ªt
 = 
	`deÊ©e
(&
°rm
, 
Êush
);

68 
	`as£π
(
ªt
 !
Z_STREAM_ERROR
);

69 
have
 = 
CHUNK
 - 
°rm
.
avaû_out
;

70 i‡(
	`fwrôe
(
out
, 1, 
have
, 
de°
Ë!havê|| 
	`„º‹
(dest)) {

71 ()
	`deÊ©eEnd
(&
°rm
);

72  
Z_ERRNO
;

74 } 
°rm
.
avaû_out
 == 0);

75 
	`as£π
(
°rm
.
avaû_ö
 == 0);

78 } 
Êush
 !
Z_FINISH
);

79 
	`as£π
(
ªt
 =
Z_STREAM_END
);

82 ()
	`deÊ©eEnd
(&
°rm
);

83  
Z_OK
;

84 
	}
}

92 
	$öf
(
FILE
 *
sour˚
, FILE *
de°
)

94 
ªt
;

95 
have
;

96 
z_°ªam
 
°rm
;

97 
ö
[
CHUNK
];

98 
out
[
CHUNK
];

101 
°rm
.
zÆloc
 = 
Z_NULL
;

102 
°rm
.
z‰ì
 = 
Z_NULL
;

103 
°rm
.
›aque
 = 
Z_NULL
;

104 
°rm
.
avaû_ö
 = 0;

105 
°rm
.
√xt_ö
 = 
Z_NULL
;

106 
ªt
 = 
	`öÊ©eInô
(&
°rm
);

107 i‡(
ªt
 !
Z_OK
)

108  
ªt
;

112 
°rm
.
avaû_ö
 = 
	`‰ód
(
ö
, 1, 
CHUNK
, 
sour˚
);

113 i‡(
	`„º‹
(
sour˚
)) {

114 ()
	`öÊ©eEnd
(&
°rm
);

115  
Z_ERRNO
;

117 i‡(
°rm
.
avaû_ö
 == 0)

119 
°rm
.
√xt_ö
 = 
ö
;

123 
°rm
.
avaû_out
 = 
CHUNK
;

124 
°rm
.
√xt_out
 = 
out
;

125 
ªt
 = 
	`öÊ©e
(&
°rm
, 
Z_NO_FLUSH
);

126 
	`as£π
(
ªt
 !
Z_STREAM_ERROR
);

127 
ªt
) {

128 
Z_NEED_DICT
:

129 
ªt
 = 
Z_DATA_ERROR
;

130 
Z_DATA_ERROR
:

131 
Z_MEM_ERROR
:

132 ()
	`öÊ©eEnd
(&
°rm
);

133  
ªt
;

135 
have
 = 
CHUNK
 - 
°rm
.
avaû_out
;

136 i‡(
	`fwrôe
(
out
, 1, 
have
, 
de°
Ë!havê|| 
	`„º‹
(dest)) {

137 ()
	`öÊ©eEnd
(&
°rm
);

138  
Z_ERRNO
;

140 } 
°rm
.
avaû_out
 == 0);

143 } 
ªt
 !
Z_STREAM_END
);

146 ()
	`öÊ©eEnd
(&
°rm
);

147  
ªt
 =
Z_STREAM_END
 ? 
Z_OK
 : 
Z_DATA_ERROR
;

148 
	}
}

151 
	$zîr
(
ªt
)

153 
	`Âuts
("zpùe: ", 
°dîr
);

154 
ªt
) {

155 
Z_ERRNO
:

156 i‡(
	`„º‹
(
°dö
))

157 
	`Âuts
("îr‹Ñódög stdö\n", 
°dîr
);

158 i‡(
	`„º‹
(
°dout
))

159 
	`Âuts
("îr‹ wrôög stdout\n", 
°dîr
);

161 
Z_STREAM_ERROR
:

162 
	`Âuts
("övÆid com¥essi⁄Üevñ\n", 
°dîr
);

164 
Z_DATA_ERROR
:

165 
	`Âuts
("övÆid o∏öcom∂ëêdeÊ©êd©a\n", 
°dîr
);

167 
Z_MEM_ERROR
:

168 
	`Âuts
("ouào‡mem‹y\n", 
°dîr
);

170 
Z_VERSION_ERROR
:

171 
	`Âuts
("zlib vîsi⁄ mism©ch!\n", 
°dîr
);

173 
	}
}

176 
	$maö
(
¨gc
, **
¨gv
)

178 
ªt
;

181 
	`SET_BINARY_MODE
(
°dö
);

182 
	`SET_BINARY_MODE
(
°dout
);

185 i‡(
¨gc
 == 1) {

186 
ªt
 = 
	`def
(
°dö
, 
°dout
, 
Z_DEFAULT_COMPRESSION
);

187 i‡(
ªt
 !
Z_OK
)

188 
	`zîr
(
ªt
);

189  
ªt
;

193 i‡(
¨gc
 =2 && 
	`°rcmp
(
¨gv
[1], "-d") == 0) {

194 
ªt
 = 
	`öf
(
°dö
, 
°dout
);

195 i‡(
ªt
 !
Z_OK
)

196 
	`zîr
(
ªt
);

197  
ªt
;

202 
	`Âuts
("zpùêußge: zpùê[-d] < sour˚ > de°\n", 
°dîr
);

205 
	}
}

	@zlib-1.2.8/examples/zran.c

55 
	~<°dio.h
>

56 
	~<°dlib.h
>

57 
	~<°rög.h
>

58 
	~"zlib.h
"

60 
	#loˇl
 

	)

62 
	#SPAN
 1048576L

	)

63 
	#WINSIZE
 32768U

	)

64 
	#CHUNK
 16384

	)

67 
	spoöt
 {

68 
off_t
 
	mout
;

69 
off_t
 
	mö
;

70 
	mbôs
;

71 
	mwödow
[
WINSIZE
];

75 
	sac˚ss
 {

76 
	mhave
;

77 
	msize
;

78 
poöt
 *
	mli°
;

82 
loˇl
 
	$‰ì_ödex
(
ac˚ss
 *
ödex
)

84 i‡(
ödex
 !
NULL
) {

85 
	`‰ì
(
ödex
->
li°
);

86 
	`‰ì
(
ödex
);

88 
	}
}

92 
loˇl
 
ac˚ss
 *
	$addpoöt
(
ac˚ss
 *
ödex
, 
bôs
,

93 
off_t
 
ö
, off_à
out
, 
À·
, *
wödow
)

95 
poöt
 *
√xt
;

98 i‡(
ödex
 =
NULL
) {

99 
ödex
 = 
	`mÆloc
((
ac˚ss
));

100 i‡(
ödex
 =
NULL
)  NULL;

101 
ödex
->
li°
 = 
	`mÆloc
((
poöt
) << 3);

102 i‡(
ödex
->
li°
 =
NULL
) {

103 
	`‰ì
(
ödex
);

104  
NULL
;

106 
ödex
->
size
 = 8;

107 
ödex
->
have
 = 0;

111 i‡(
ödex
->
have
 =ödex->
size
) {

112 
ödex
->
size
 <<= 1;

113 
√xt
 = 
	`ªÆloc
(
ödex
->
li°
, (
poöt
Ë* index->
size
);

114 i‡(
√xt
 =
NULL
) {

115 
	`‰ì_ödex
(
ödex
);

116  
NULL
;

118 
ödex
->
li°
 = 
√xt
;

122 
√xt
 = 
ödex
->
li°
 + index->
have
;

123 
√xt
->
bôs
 = bits;

124 
√xt
->
ö
 = in;

125 
√xt
->
out
 = out;

126 i‡(
À·
)

127 
	`mem˝y
(
√xt
->
wödow
, wödow + 
WINSIZE
 - 
À·
,Üeft);

128 i‡(
À·
 < 
WINSIZE
)

129 
	`mem˝y
(
√xt
->
wödow
 + 
À·
, wödow, 
WINSIZE
 -Üeft);

130 
ödex
->
have
++;

133  
ödex
;

134 
	}
}

144 
loˇl
 
	$buûd_ödex
(
FILE
 *
ö
, 
off_t
 
•™
, 
ac˚ss
 **
buût
)

146 
ªt
;

147 
off_t
 
tŸö
, 
tŸout
;

148 
off_t
 
œ°
;

149 
ac˚ss
 *
ödex
;

150 
z_°ªam
 
°rm
;

151 
öput
[
CHUNK
];

152 
wödow
[
WINSIZE
];

155 
°rm
.
zÆloc
 = 
Z_NULL
;

156 
°rm
.
z‰ì
 = 
Z_NULL
;

157 
°rm
.
›aque
 = 
Z_NULL
;

158 
°rm
.
avaû_ö
 = 0;

159 
°rm
.
√xt_ö
 = 
Z_NULL
;

160 
ªt
 = 
	`öÊ©eInô2
(&
°rm
, 47);

161 i‡(
ªt
 !
Z_OK
)

162  
ªt
;

167 
tŸö
 = 
tŸout
 = 
œ°
 = 0;

168 
ödex
 = 
NULL
;

169 
°rm
.
avaû_out
 = 0;

172 
°rm
.
avaû_ö
 = 
	`‰ód
(
öput
, 1, 
CHUNK
, 
ö
);

173 i‡(
	`„º‹
(
ö
)) {

174 
ªt
 = 
Z_ERRNO
;

175 
buûd_ödex_îr‹
;

177 i‡(
°rm
.
avaû_ö
 == 0) {

178 
ªt
 = 
Z_DATA_ERROR
;

179 
buûd_ödex_îr‹
;

181 
°rm
.
√xt_ö
 = 
öput
;

186 i‡(
°rm
.
avaû_out
 == 0) {

187 
°rm
.
avaû_out
 = 
WINSIZE
;

188 
°rm
.
√xt_out
 = 
wödow
;

193 
tŸö
 +
°rm
.
avaû_ö
;

194 
tŸout
 +
°rm
.
avaû_out
;

195 
ªt
 = 
	`öÊ©e
(&
°rm
, 
Z_BLOCK
);

196 
tŸö
 -
°rm
.
avaû_ö
;

197 
tŸout
 -
°rm
.
avaû_out
;

198 i‡(
ªt
 =
Z_NEED_DICT
)

199 
ªt
 = 
Z_DATA_ERROR
;

200 i‡(
ªt
 =
Z_MEM_ERROR
 ||Ñë =
Z_DATA_ERROR
)

201 
buûd_ödex_îr‹
;

202 i‡(
ªt
 =
Z_STREAM_END
)

214 i‡((
°rm
.
d©a_ty≥
 & 128) && !(strm.data_type & 64) &&

215 (
tŸout
 =0 ||ÅŸouà- 
œ°
 > 
•™
)) {

216 
ödex
 = 
	`addpoöt
(ödex, 
°rm
.
d©a_ty≥
 & 7, 
tŸö
,

217 
tŸout
, 
°rm
.
avaû_out
, 
wödow
);

218 i‡(
ödex
 =
NULL
) {

219 
ªt
 = 
Z_MEM_ERROR
;

220 
buûd_ödex_îr‹
;

222 
œ°
 = 
tŸout
;

224 } 
°rm
.
avaû_ö
 != 0);

225 } 
ªt
 !
Z_STREAM_END
);

228 ()
	`öÊ©eEnd
(&
°rm
);

229 
ödex
->
li°
 = 
	`ªÆloc
(ödex->li°, (
poöt
Ë* index->
have
);

230 
ödex
->
size
 = index->
have
;

231 *
buût
 = 
ödex
;

232  
ödex
->
size
;

235 
buûd_ödex_îr‹
:

236 ()
	`öÊ©eEnd
(&
°rm
);

237 i‡(
ödex
 !
NULL
)

238 
	`‰ì_ödex
(
ödex
);

239  
ªt
;

240 
	}
}

249 
loˇl
 
	$exåa˘
(
FILE
 *
ö
, 
ac˚ss
 *
ödex
, 
off_t
 
off£t
,

250 *
buf
, 
Àn
)

252 
ªt
, 
skù
;

253 
z_°ªam
 
°rm
;

254 
poöt
 *
hîe
;

255 
öput
[
CHUNK
];

256 
disˇrd
[
WINSIZE
];

259 i‡(
Àn
 < 0)

263 
hîe
 = 
ödex
->
li°
;

264 
ªt
 = 
ödex
->
have
;

265 --
ªt
 && 
hîe
[1].
out
 <
off£t
)

266 
hîe
++;

269 
°rm
.
zÆloc
 = 
Z_NULL
;

270 
°rm
.
z‰ì
 = 
Z_NULL
;

271 
°rm
.
›aque
 = 
Z_NULL
;

272 
°rm
.
avaû_ö
 = 0;

273 
°rm
.
√xt_ö
 = 
Z_NULL
;

274 
ªt
 = 
	`öÊ©eInô2
(&
°rm
, -15);

275 i‡(
ªt
 !
Z_OK
)

276  
ªt
;

277 
ªt
 = 
	`f£eko
(
ö
, 
hîe
->ö - (hîe->
bôs
 ? 1 : 0), 
SEEK_SET
);

278 i‡(
ªt
 == -1)

279 
exåa˘_ªt
;

280 i‡(
hîe
->
bôs
) {

281 
ªt
 = 
	`gëc
(
ö
);

282 i‡(
ªt
 == -1) {

283 
ªt
 = 
	`„º‹
(
ö
Ë? 
Z_ERRNO
 : 
Z_DATA_ERROR
;

284 
exåa˘_ªt
;

286 ()
	`öÊ©ePrime
(&
°rm
, 
hîe
->
bôs
, 
ªt
 >> (8 - here->bits));

288 ()
	`öÊ©eSëDi˘i⁄¨y
(&
°rm
, 
hîe
->
wödow
, 
WINSIZE
);

291 
off£t
 -
hîe
->
out
;

292 
°rm
.
avaû_ö
 = 0;

293 
skù
 = 1;

296 i‡(
off£t
 =0 && 
skù
) {

297 
°rm
.
avaû_out
 = 
Àn
;

298 
°rm
.
√xt_out
 = 
buf
;

299 
skù
 = 0;

301 i‡(
off£t
 > 
WINSIZE
) {

302 
°rm
.
avaû_out
 = 
WINSIZE
;

303 
°rm
.
√xt_out
 = 
disˇrd
;

304 
off£t
 -
WINSIZE
;

306 i‡(
off£t
 != 0) {

307 
°rm
.
avaû_out
 = ()
off£t
;

308 
°rm
.
√xt_out
 = 
disˇrd
;

309 
off£t
 = 0;

314 i‡(
°rm
.
avaû_ö
 == 0) {

315 
°rm
.
avaû_ö
 = 
	`‰ód
(
öput
, 1, 
CHUNK
, 
ö
);

316 i‡(
	`„º‹
(
ö
)) {

317 
ªt
 = 
Z_ERRNO
;

318 
exåa˘_ªt
;

320 i‡(
°rm
.
avaû_ö
 == 0) {

321 
ªt
 = 
Z_DATA_ERROR
;

322 
exåa˘_ªt
;

324 
°rm
.
√xt_ö
 = 
öput
;

326 
ªt
 = 
	`öÊ©e
(&
°rm
, 
Z_NO_FLUSH
);

327 i‡(
ªt
 =
Z_NEED_DICT
)

328 
ªt
 = 
Z_DATA_ERROR
;

329 i‡(
ªt
 =
Z_MEM_ERROR
 ||Ñë =
Z_DATA_ERROR
)

330 
exåa˘_ªt
;

331 i‡(
ªt
 =
Z_STREAM_END
)

333 } 
°rm
.
avaû_out
 != 0);

336 i‡(
ªt
 =
Z_STREAM_END
)

340 } 
skù
);

343 
ªt
 = 
skù
 ? 0 : 
Àn
 - 
°rm
.
avaû_out
;

346 
exåa˘_ªt
:

347 ()
	`öÊ©eEnd
(&
°rm
);

348  
ªt
;

349 
	}
}

354 
	$maö
(
¨gc
, **
¨gv
)

356 
Àn
;

357 
off_t
 
off£t
;

358 
FILE
 *
ö
;

359 
ac˚ss
 *
ödex
 = 
NULL
;

360 
buf
[
CHUNK
];

363 i‡(
¨gc
 != 2) {

364 
	`Ârötf
(
°dîr
, "usage: zran file.gz\n");

367 
ö
 = 
	`f›í
(
¨gv
[1], "rb");

368 i‡(
ö
 =
NULL
) {

369 
	`Ârötf
(
°dîr
, "zøn: couldÇŸ o≥¿%†f‹Ñódög\n", 
¨gv
[1]);

374 
Àn
 = 
	`buûd_ödex
(
ö
, 
SPAN
, &
ödex
);

375 i‡(
Àn
 < 0) {

376 
	`f˛o£
(
ö
);

377 
Àn
) {

378 
Z_MEM_ERROR
:

379 
	`Ârötf
(
°dîr
, "zran: out of memory\n");

381 
Z_DATA_ERROR
:

382 
	`Ârötf
(
°dîr
, "zøn: com¥es£d d©®îr‹ i¿%s\n", 
¨gv
[1]);

384 
Z_ERRNO
:

385 
	`Ârötf
(
°dîr
, "zøn:ÑódÉº‹ o¿%s\n", 
¨gv
[1]);

388 
	`Ârötf
(
°dîr
, "zøn:Éº‹ %d whûêbuûdög index\n", 
Àn
);

392 
	`Ârötf
(
°dîr
, "zøn: buûàödex wôh %dác˚s†poöts\n", 
Àn
);

395 
off£t
 = (
ödex
->
li°
[ödex->
have
 - 1].
out
 << 1) / 3;

396 
Àn
 = 
	`exåa˘
(
ö
, 
ödex
, 
off£t
, 
buf
, 
CHUNK
);

397 i‡(
Àn
 < 0)

398 
	`Ârötf
(
°dîr
, "zran:Éxtraction failed: %sÉrror\n",

399 
Àn
 =
Z_MEM_ERROR
 ? "out of memory" : "input corrupted");

401 
	`fwrôe
(
buf
, 1, 
Àn
, 
°dout
);

402 
	`Ârötf
(
°dîr
, "zøn:Éxåa˘ed %d byã†© %Œu\n", 
Àn
, 
off£t
);

406 
	`‰ì_ödex
(
ödex
);

407 
	`f˛o£
(
ö
);

409 
	}
}

	@zlib-1.2.8/gzclose.c

6 
	~"gzguts.h
"

11 
ZEXPORT
 
	$gz˛o£
(
fûe
)

12 
gzFûe
 
fûe
;

14 #i‚de‡
NO_GZCOMPRESS


15 
gz_°©ï
 
°©e
;

17 i‡(
fûe
 =
NULL
)

18  
Z_STREAM_ERROR
;

19 
°©e
 = (
gz_°©ï
)
fûe
;

21  
°©e
->
mode
 =
GZ_READ
 ? 
	`gz˛o£_r
(
fûe
Ë: 
	`gz˛o£_w
(file);

23  
	`gz˛o£_r
(
fûe
);

25 
	}
}

	@zlib-1.2.8/gzguts.h

6 #ifde‡
_LARGEFILE64_SOURCE


7 #i‚de‡
_LARGEFILE_SOURCE


8 
	#_LARGEFILE_SOURCE
 1

	)

10 #ifde‡
_FILE_OFFSET_BITS


11 #unde‡
_FILE_OFFSET_BITS


15 #ifde‡
HAVE_HIDDEN


16 
	#ZLIB_INTERNAL
 
	`__©åibuã__
((
	`visibûôy
 ("hiddí")))

	)

18 
	#ZLIB_INTERNAL


	)

21 
	~<°dio.h
>

22 
	~"zlib.h
"

23 #ifde‡
STDC


24 
	~<°rög.h
>

25 
	~<°dlib.h
>

26 
	~<limôs.h
>

28 
	~<f˙é.h
>

30 #ifde‡
_WIN32


31 
	~<°ddef.h
>

34 #i‡
deföed
(
__TURBOC__
Ë|| deföed(
_MSC_VER
Ë|| deföed(
_WIN32
)

35 
	~<io.h
>

38 #ifde‡
WINAPI_FAMILY


39 
	#›í
 
_›í


	)

40 
	#ªad
 
_ªad


	)

41 
	#wrôe
 
_wrôe


	)

42 
	#˛o£
 
_˛o£


	)

45 #ifde‡
NO_DEFLATE


46 
	#NO_GZCOMPRESS


	)

49 #i‡
deföed
(
STDC99
Ë|| (deföed(
__TURBOC__
) && __TURBOC__ >= 0x550)

50 #i‚de‡
HAVE_VSNPRINTF


51 
	#HAVE_VSNPRINTF


	)

55 #i‡
deföed
(
__CYGWIN__
)

56 #i‚de‡
HAVE_VSNPRINTF


57 
	#HAVE_VSNPRINTF


	)

61 #i‡
deföed
(
MSDOS
Ë&& deföed(
__BORLANDC__
Ë&& (
BORLANDC
 > 0x410)

62 #i‚de‡
HAVE_VSNPRINTF


63 
	#HAVE_VSNPRINTF


	)

67 #i‚de‡
HAVE_VSNPRINTF


68 #ifde‡
MSDOS


71 
	#NO_v¢¥ötf


	)

73 #ifde‡
__TURBOC__


74 
	#NO_v¢¥ötf


	)

76 #ifde‡
WIN32


78 #i‡!
deföed
(
v¢¥ötf
Ë&& !deföed(
NO_v¢¥ötf
)

79 #i‡!
deföed
(
_MSC_VER
) || ( defined(_MSC_VER) && _MSC_VER < 1500 )

80 
	#v¢¥ötf
 
_v¢¥ötf


	)

84 #ifde‡
__SASC


85 
	#NO_v¢¥ötf


	)

87 #ifde‡
VMS


88 
	#NO_v¢¥ötf


	)

90 #ifde‡
__OS400__


91 
	#NO_v¢¥ötf


	)

93 #ifde‡
__MVS__


94 
	#NO_v¢¥ötf


	)

102 #ifde‡
_MSC_VER


103 
	#¢¥ötf
 
_¢¥ötf


	)

106 #i‚de‡
loˇl


107 
	#loˇl
 

	)

112 #i‚de‡
STDC


113 
voidp
 
mÆloc
 
OF
((
uI¡
 
size
));

114 
‰ì
 
OF
((
voidpf
 
±r
));

118 #i‡
deföed
 
UNDER_CE


119 
	~<wödows.h
>

120 
	#z°ªº‹
(Ë
	`gz_°rwöîr‹
((
DWORD
)
	`GëLa°Eº‹
())

	)

122 #i‚de‡
NO_STRERROR


123 
	~<î∫o.h
>

124 
	#z°ªº‹
(Ë
	`°ªº‹
(
î∫o
)

	)

126 
	#z°ªº‹
(Ë"°diÿîr‹ (c⁄su…Éºno)"

	)

131 #i‡!
deföed
(
_LARGEFILE64_SOURCE
Ë|| 
_LFS64_LARGEFILE
-0 == 0

132 
ZEXTERN
 
gzFûe
 
ZEXPORT
 
gz›í64
 
OF
((const *, const *));

133 
ZEXTERN
 
z_off64_t
 
ZEXPORT
 
gz£ek64
 
OF
((
gzFûe
, z_off64_t, ));

134 
ZEXTERN
 
z_off64_t
 
ZEXPORT
 
gzãŒ64
 
OF
((
gzFûe
));

135 
ZEXTERN
 
z_off64_t
 
ZEXPORT
 
gzoff£t64
 
OF
((
gzFûe
));

139 #i‡
MAX_MEM_LEVEL
 >= 8

140 
	#DEF_MEM_LEVEL
 8

	)

142 
	#DEF_MEM_LEVEL
 
MAX_MEM_LEVEL


	)

147 
	#GZBUFSIZE
 8192

	)

150 
	#GZ_NONE
 0

	)

151 
	#GZ_READ
 7247

	)

152 
	#GZ_WRITE
 31153

	)

153 
	#GZ_APPEND
 1

	)

156 
	#LOOK
 0

	)

157 
	#COPY
 1

	)

158 
	#GZIP
 2

	)

163 
gzFûe_s
 
	mx
;

168 
	mmode
;

169 
	mfd
;

170 *
	m∑th
;

171 
	msize
;

172 
	mw™t
;

173 *
	mö
;

174 *
	mout
;

175 
	mdúe˘
;

177 
	mhow
;

178 
z_off64_t
 
	m°¨t
;

179 
	meof
;

180 
	m∑°
;

182 
	mÀvñ
;

183 
	m°øãgy
;

185 
z_off64_t
 
	mskù
;

186 
	m£ek
;

188 
	mîr
;

189 *
	mmsg
;

191 
z_°ªam
 
	m°rm
;

192 } 
	tgz_°©e
;

193 
gz_°©e
 
	tFAR
 *
	tgz_°©ï
;

196 
ZLIB_INTERNAL
 
gz_îr‹
 
OF
((
gz_°©ï
, , const *));

197 #i‡
deföed
 
UNDER_CE


198 
ZLIB_INTERNAL
 *
gz_°rwöîr‹
 
OF
((
DWORD
 
îr‹
));

204 #ifde‡
INT_MAX


205 
	#GT_OFF
(
x
Ë((Ë=(
z_off64_t
Ë&& (xË> 
INT_MAX
)

	)

207 
ZLIB_INTERNAL
 
gz_ötmax
 
OF
(());

208 
	#GT_OFF
(
x
Ë((Ë=(
z_off64_t
Ë&& (xË> 
	`gz_ötmax
())

	)

	@zlib-1.2.8/gzlib.c

6 
	~"gzguts.h
"

8 #i‡
deföed
(
_WIN32
Ë&& !deföed(
__BORLANDC__
)

9 
	#LSEEK
 
_l£eki64


	)

11 #i‡
deföed
(
_LARGEFILE64_SOURCE
Ë&& 
_LFS64_LARGEFILE
-0

12 
	#LSEEK
 
l£ek64


	)

14 
	#LSEEK
 
l£ek


	)

19 
loˇl
 
gz_ª£t
 
OF
((
gz_°©ï
));

20 
loˇl
 
gzFûe
 
gz_›í
 
OF
((const *, , const *));

22 #i‡
deföed
 
UNDER_CE


33 
ZLIB_INTERNAL
 *
	$gz_°rwöîr‹
 (
îr‹
)

34 
DWORD
 
îr‹
;

36 
buf
[1024];

38 
wch¨_t
 *
msgbuf
;

39 
DWORD
 
œ°îr
 = 
	`GëLa°Eº‹
();

40 
DWORD
 
ch¨s
 = 
	`F‹m©Mesßge
(
FORMAT_MESSAGE_FROM_SYSTEM


41 | 
FORMAT_MESSAGE_ALLOCATE_BUFFER
,

42 
NULL
,

43 
îr‹
,

45 (
LPVOID
)&
msgbuf
,

47 
NULL
);

48 i‡(
ch¨s
 != 0) {

50 i‡(
ch¨s
 >= 2

51 && 
msgbuf
[
ch¨s
 - 2] == '\r' && msgbuf[chars - 1] == '\n') {

52 
ch¨s
 -= 2;

53 
msgbuf
[
ch¨s
] = 0;

56 i‡(
ch¨s
 >  (
buf
) - 1) {

57 
ch¨s
 =  (
buf
) - 1;

58 
msgbuf
[
ch¨s
] = 0;

61 
	`wc°ombs
(
buf
, 
msgbuf
, 
ch¨s
 + 1);

62 
	`LoˇlFªe
(
msgbuf
);

65 
	`•rötf
(
buf
, "unknow¿wö32Éº‹ (%ld)", 
îr‹
);

68 
	`SëLa°Eº‹
(
œ°îr
);

69  
buf
;

70 
	}
}

75 
loˇl
 
	$gz_ª£t
(
°©e
)

76 
gz_°©ï
 
°©e
;

78 
°©e
->
x
.
have
 = 0;

79 i‡(
°©e
->
mode
 =
GZ_READ
) {

80 
°©e
->
eof
 = 0;

81 
°©e
->
∑°
 = 0;

82 
°©e
->
how
 = 
LOOK
;

84 
°©e
->
£ek
 = 0;

85 
	`gz_îr‹
(
°©e
, 
Z_OK
, 
NULL
);

86 
°©e
->
x
.
pos
 = 0;

87 
°©e
->
°rm
.
avaû_ö
 = 0;

88 
	}
}

91 
loˇl
 
gzFûe
 
	$gz_›í
(
∑th
, 
fd
, 
mode
)

92 c⁄° *
∑th
;

93 
fd
;

94 c⁄° *
mode
;

96 
gz_°©ï
 
°©e
;

97 
size_t
 
Àn
;

98 
oÊag
;

99 #ifde‡
O_CLOEXEC


100 
˛€xec
 = 0;

102 #ifde‡
O_EXCL


103 
ex˛usive
 = 0;

107 i‡(
∑th
 =
NULL
)

108  
NULL
;

111 
°©e
 = (
gz_°©ï
)
	`mÆloc
((
gz_°©e
));

112 i‡(
°©e
 =
NULL
)

113  
NULL
;

114 
°©e
->
size
 = 0;

115 
°©e
->
w™t
 = 
GZBUFSIZE
;

116 
°©e
->
msg
 = 
NULL
;

119 
°©e
->
mode
 = 
GZ_NONE
;

120 
°©e
->
Àvñ
 = 
Z_DEFAULT_COMPRESSION
;

121 
°©e
->
°øãgy
 = 
Z_DEFAULT_STRATEGY
;

122 
°©e
->
dúe˘
 = 0;

123 *
mode
) {

124 i‡(*
mode
 >= '0' && *mode <= '9')

125 
°©e
->
Àvñ
 = *
mode
 - '0';

127 *
mode
) {

129 
°©e
->
mode
 = 
GZ_READ
;

131 #i‚de‡
NO_GZCOMPRESS


133 
°©e
->
mode
 = 
GZ_WRITE
;

136 
°©e
->
mode
 = 
GZ_APPEND
;

140 
	`‰ì
(
°©e
);

141  
NULL
;

144 #ifde‡
O_CLOEXEC


146 
˛€xec
 = 1;

149 #ifde‡
O_EXCL


151 
ex˛usive
 = 1;

155 
°©e
->
°øãgy
 = 
Z_FILTERED
;

158 
°©e
->
°øãgy
 = 
Z_HUFFMAN_ONLY
;

161 
°©e
->
°øãgy
 = 
Z_RLE
;

164 
°©e
->
°øãgy
 = 
Z_FIXED
;

167 
°©e
->
dúe˘
 = 1;

172 
mode
++;

176 i‡(
°©e
->
mode
 =
GZ_NONE
) {

177 
	`‰ì
(
°©e
);

178  
NULL
;

182 i‡(
°©e
->
mode
 =
GZ_READ
) {

183 i‡(
°©e
->
dúe˘
) {

184 
	`‰ì
(
°©e
);

185  
NULL
;

187 
°©e
->
dúe˘
 = 1;

191 #ifde‡
_WIN32


192 i‡(
fd
 == -2) {

193 
Àn
 = 
	`wc°ombs
(
NULL
, 
∑th
, 0);

194 i‡(
Àn
 =(
size_t
)-1)

195 
Àn
 = 0;

199 
Àn
 = 
	`°æí
((c⁄° *)
∑th
);

200 
°©e
->
∑th
 = (*)
	`mÆloc
(
Àn
 + 1);

201 i‡(
°©e
->
∑th
 =
NULL
) {

202 
	`‰ì
(
°©e
);

203  
NULL
;

205 #ifde‡
_WIN32


206 i‡(
fd
 == -2)

207 i‡(
Àn
)

208 
	`wc°ombs
(
°©e
->
∑th
,Ö©h, 
Àn
 + 1);

210 *(
°©e
->
∑th
) = 0;

213 #i‡!
	`deföed
(
NO_¢¥ötf
Ë&& !deföed(
NO_v¢¥ötf
)

214 
	`¢¥ötf
(
°©e
->
∑th
, 
Àn
 + 1, "%s", (const *)path);

216 
	`°r˝y
(
°©e
->
∑th
,Öath);

220 
oÊag
 =

221 #ifde‡
O_LARGEFILE


222 
O_LARGEFILE
 |

224 #ifde‡
O_BINARY


225 
O_BINARY
 |

227 #ifde‡
O_CLOEXEC


228 (
˛€xec
 ? 
O_CLOEXEC
 : 0) |

230 (
°©e
->
mode
 =
GZ_READ
 ?

231 
O_RDONLY
 :

232 (
O_WRONLY
 | 
O_CREAT
 |

233 #ifde‡
O_EXCL


234 (
ex˛usive
 ? 
O_EXCL
 : 0) |

236 (
°©e
->
mode
 =
GZ_WRITE
 ?

237 
O_TRUNC
 :

238 
O_APPEND
)));

241 
°©e
->
fd
 = fd > -1 ? fd : (

242 #ifde‡
_WIN32


243 
fd
 =-2 ? 
	`_w›í
(
∑th
, 
oÊag
, 0666) :

245 
	`›í
((c⁄° *)
∑th
, 
oÊag
, 0666));

246 i‡(
°©e
->
fd
 == -1) {

247 
	`‰ì
(
°©e
->
∑th
);

248 
	`‰ì
(
°©e
);

249  
NULL
;

251 i‡(
°©e
->
mode
 =
GZ_APPEND
)

252 
°©e
->
mode
 = 
GZ_WRITE
;

255 i‡(
°©e
->
mode
 =
GZ_READ
) {

256 
°©e
->
°¨t
 = 
	`LSEEK
(°©e->
fd
, 0, 
SEEK_CUR
);

257 i‡(
°©e
->
°¨t
 == -1) state->start = 0;

261 
	`gz_ª£t
(
°©e
);

264  (
gzFûe
)
°©e
;

265 
	}
}

268 
gzFûe
 
ZEXPORT
 
	$gz›í
(
∑th
, 
mode
)

269 c⁄° *
∑th
;

270 c⁄° *
mode
;

272  
	`gz_›í
(
∑th
, -1, 
mode
);

273 
	}
}

276 
gzFûe
 
ZEXPORT
 
	$gz›í64
(
∑th
, 
mode
)

277 c⁄° *
∑th
;

278 c⁄° *
mode
;

280  
	`gz_›í
(
∑th
, -1, 
mode
);

281 
	}
}

284 
gzFûe
 
ZEXPORT
 
	$gzd›í
(
fd
, 
mode
)

285 
fd
;

286 c⁄° *
mode
;

288 *
∑th
;

289 
gzFûe
 
gz
;

291 i‡(
fd
 =-1 || (
∑th
 = (*)
	`mÆloc
(7 + 3 * ())Ë=
NULL
)

292  
NULL
;

293 #i‡!
	`deföed
(
NO_¢¥ötf
Ë&& !deföed(
NO_v¢¥ötf
)

294 
	`¢¥ötf
(
∑th
, 7 + 3 * (), "<fd:%d>", 
fd
);

296 
	`•rötf
(
∑th
, "<fd:%d>", 
fd
);

298 
gz
 = 
	`gz_›í
(
∑th
, 
fd
, 
mode
);

299 
	`‰ì
(
∑th
);

300  
gz
;

301 
	}
}

304 #ifde‡
_WIN32


305 
gzFûe
 
ZEXPORT
 
	$gz›í_w
(
∑th
, 
mode
)

306 c⁄° 
wch¨_t
 *
∑th
;

307 c⁄° *
mode
;

309  
	`gz_›í
(
∑th
, -2, 
mode
);

310 
	}
}

314 
ZEXPORT
 
	$gzbuf„r
(
fûe
, 
size
)

315 
gzFûe
 
fûe
;

316 
size
;

318 
gz_°©ï
 
°©e
;

321 i‡(
fûe
 =
NULL
)

323 
°©e
 = (
gz_°©ï
)
fûe
;

324 i‡(
°©e
->
mode
 !
GZ_READ
 && sèã->modê!
GZ_WRITE
)

328 i‡(
°©e
->
size
 != 0)

332 i‡(
size
 < 2)

333 
size
 = 2;

334 
°©e
->
w™t
 = 
size
;

336 
	}
}

339 
ZEXPORT
 
	$gzªwöd
(
fûe
)

340 
gzFûe
 
fûe
;

342 
gz_°©ï
 
°©e
;

345 i‡(
fûe
 =
NULL
)

347 
°©e
 = (
gz_°©ï
)
fûe
;

350 i‡(
°©e
->
mode
 !
GZ_READ
 ||

351 (
°©e
->
îr
 !
Z_OK
 && sèã->î∏!
Z_BUF_ERROR
))

355 i‡(
	`LSEEK
(
°©e
->
fd
, sèã->
°¨t
, 
SEEK_SET
) == -1)

357 
	`gz_ª£t
(
°©e
);

359 
	}
}

362 
z_off64_t
 
ZEXPORT
 
	$gz£ek64
(
fûe
, 
off£t
, 
whí˚
)

363 
gzFûe
 
fûe
;

364 
z_off64_t
 
off£t
;

365 
whí˚
;

367 
n
;

368 
z_off64_t
 
ªt
;

369 
gz_°©ï
 
°©e
;

372 i‡(
fûe
 =
NULL
)

374 
°©e
 = (
gz_°©ï
)
fûe
;

375 i‡(
°©e
->
mode
 !
GZ_READ
 && sèã->modê!
GZ_WRITE
)

379 i‡(
°©e
->
îr
 !
Z_OK
 && sèã->î∏!
Z_BUF_ERROR
)

383 i‡(
whí˚
 !
SEEK_SET
 && whí˚ !
SEEK_CUR
)

387 i‡(
whí˚
 =
SEEK_SET
)

388 
off£t
 -
°©e
->
x
.
pos
;

389 i‡(
°©e
->
£ek
)

390 
off£t
 +
°©e
->
skù
;

391 
°©e
->
£ek
 = 0;

394 i‡(
°©e
->
mode
 =
GZ_READ
 && sèã->
how
 =
COPY
 &&

395 
°©e
->
x
.
pos
 + 
off£t
 >= 0) {

396 
ªt
 = 
	`LSEEK
(
°©e
->
fd
, 
off£t
 - sèã->
x
.
have
, 
SEEK_CUR
);

397 i‡(
ªt
 == -1)

399 
°©e
->
x
.
have
 = 0;

400 
°©e
->
eof
 = 0;

401 
°©e
->
∑°
 = 0;

402 
°©e
->
£ek
 = 0;

403 
	`gz_îr‹
(
°©e
, 
Z_OK
, 
NULL
);

404 
°©e
->
°rm
.
avaû_ö
 = 0;

405 
°©e
->
x
.
pos
 +
off£t
;

406  
°©e
->
x
.
pos
;

410 i‡(
off£t
 < 0) {

411 i‡(
°©e
->
mode
 !
GZ_READ
)

413 
off£t
 +
°©e
->
x
.
pos
;

414 i‡(
off£t
 < 0)

416 i‡(
	`gzªwöd
(
fûe
) == -1)

421 i‡(
°©e
->
mode
 =
GZ_READ
) {

422 
n
 = 
	`GT_OFF
(
°©e
->
x
.
have
Ë|| (
z_off64_t
)°©e->x.havê> 
off£t
 ?

423 ()
off£t
 : 
°©e
->
x
.
have
;

424 
°©e
->
x
.
have
 -
n
;

425 
°©e
->
x
.
√xt
 +
n
;

426 
°©e
->
x
.
pos
 +
n
;

427 
off£t
 -
n
;

431 i‡(
off£t
) {

432 
°©e
->
£ek
 = 1;

433 
°©e
->
skù
 = 
off£t
;

435  
°©e
->
x
.
pos
 + 
off£t
;

436 
	}
}

439 
z_off_t
 
ZEXPORT
 
	$gz£ek
(
fûe
, 
off£t
, 
whí˚
)

440 
gzFûe
 
fûe
;

441 
z_off_t
 
off£t
;

442 
whí˚
;

444 
z_off64_t
 
ªt
;

446 
ªt
 = 
	`gz£ek64
(
fûe
, (
z_off64_t
)
off£t
, 
whí˚
);

447  
ªt
 =(
z_off_t
)ret ? (z_off_t)ret : -1;

448 
	}
}

451 
z_off64_t
 
ZEXPORT
 
	$gzãŒ64
(
fûe
)

452 
gzFûe
 
fûe
;

454 
gz_°©ï
 
°©e
;

457 i‡(
fûe
 =
NULL
)

459 
°©e
 = (
gz_°©ï
)
fûe
;

460 i‡(
°©e
->
mode
 !
GZ_READ
 && sèã->modê!
GZ_WRITE
)

464  
°©e
->
x
.
pos
 + (°©e->
£ek
 ? sèã->
skù
 : 0);

465 
	}
}

468 
z_off_t
 
ZEXPORT
 
	$gzãŒ
(
fûe
)

469 
gzFûe
 
fûe
;

471 
z_off64_t
 
ªt
;

473 
ªt
 = 
	`gzãŒ64
(
fûe
);

474  
ªt
 =(
z_off_t
)ret ? (z_off_t)ret : -1;

475 
	}
}

478 
z_off64_t
 
ZEXPORT
 
	$gzoff£t64
(
fûe
)

479 
gzFûe
 
fûe
;

481 
z_off64_t
 
off£t
;

482 
gz_°©ï
 
°©e
;

485 i‡(
fûe
 =
NULL
)

487 
°©e
 = (
gz_°©ï
)
fûe
;

488 i‡(
°©e
->
mode
 !
GZ_READ
 && sèã->modê!
GZ_WRITE
)

492 
off£t
 = 
	`LSEEK
(
°©e
->
fd
, 0, 
SEEK_CUR
);

493 i‡(
off£t
 == -1)

495 i‡(
°©e
->
mode
 =
GZ_READ
)

496 
off£t
 -
°©e
->
°rm
.
avaû_ö
;

497  
off£t
;

498 
	}
}

501 
z_off_t
 
ZEXPORT
 
	$gzoff£t
(
fûe
)

502 
gzFûe
 
fûe
;

504 
z_off64_t
 
ªt
;

506 
ªt
 = 
	`gzoff£t64
(
fûe
);

507  
ªt
 =(
z_off_t
)ret ? (z_off_t)ret : -1;

508 
	}
}

511 
ZEXPORT
 
	$gzeof
(
fûe
)

512 
gzFûe
 
fûe
;

514 
gz_°©ï
 
°©e
;

517 i‡(
fûe
 =
NULL
)

519 
°©e
 = (
gz_°©ï
)
fûe
;

520 i‡(
°©e
->
mode
 !
GZ_READ
 && sèã->modê!
GZ_WRITE
)

524  
°©e
->
mode
 =
GZ_READ
 ? sèã->
∑°
 : 0;

525 
	}
}

528 c⁄° * 
ZEXPORT
 
	$gzîr‹
(
fûe
, 
î∫um
)

529 
gzFûe
 
fûe
;

530 *
î∫um
;

532 
gz_°©ï
 
°©e
;

535 i‡(
fûe
 =
NULL
)

536  
NULL
;

537 
°©e
 = (
gz_°©ï
)
fûe
;

538 i‡(
°©e
->
mode
 !
GZ_READ
 && sèã->modê!
GZ_WRITE
)

539  
NULL
;

542 i‡(
î∫um
 !
NULL
)

543 *
î∫um
 = 
°©e
->
îr
;

544  
°©e
->
îr
 =
Z_MEM_ERROR
 ? "out of memory" :

545 (
°©e
->
msg
 =
NULL
 ? "" : state->msg);

546 
	}
}

549 
ZEXPORT
 
	$gz˛óªº
(
fûe
)

550 
gzFûe
 
fûe
;

552 
gz_°©ï
 
°©e
;

555 i‡(
fûe
 =
NULL
)

557 
°©e
 = (
gz_°©ï
)
fûe
;

558 i‡(
°©e
->
mode
 !
GZ_READ
 && sèã->modê!
GZ_WRITE
)

562 i‡(
°©e
->
mode
 =
GZ_READ
) {

563 
°©e
->
eof
 = 0;

564 
°©e
->
∑°
 = 0;

566 
	`gz_îr‹
(
°©e
, 
Z_OK
, 
NULL
);

567 
	}
}

575 
ZLIB_INTERNAL
 
	$gz_îr‹
(
°©e
, 
îr
, 
msg
)

576 
gz_°©ï
 
°©e
;

577 
îr
;

578 c⁄° *
msg
;

581 i‡(
°©e
->
msg
 !
NULL
) {

582 i‡(
°©e
->
îr
 !
Z_MEM_ERROR
)

583 
	`‰ì
(
°©e
->
msg
);

584 
°©e
->
msg
 = 
NULL
;

588 i‡(
îr
 !
Z_OK
 &&Éº !
Z_BUF_ERROR
)

589 
°©e
->
x
.
have
 = 0;

592 
°©e
->
îr
 =Érr;

593 i‡(
msg
 =
NULL
)

597 i‡(
îr
 =
Z_MEM_ERROR
)

601 i‡((
°©e
->
msg
 = (*)
	`mÆloc
(
	`°æí
(°©e->
∑th
) + strlen(msg) + 3)) ==

602 
NULL
) {

603 
°©e
->
îr
 = 
Z_MEM_ERROR
;

606 #i‡!
	`deföed
(
NO_¢¥ötf
Ë&& !deföed(
NO_v¢¥ötf
)

607 
	`¢¥ötf
(
°©e
->
msg
, 
	`°æí
(°©e->
∑th
) + strlen(msg) + 3,

608 "%s%s%s", 
°©e
->
∑th
, ": ", 
msg
);

610 
	`°r˝y
(
°©e
->
msg
, sèã->
∑th
);

611 
	`°rˇt
(
°©e
->
msg
, ": ");

612 
	`°rˇt
(
°©e
->
msg
, msg);

615 
	}
}

617 #i‚de‡
INT_MAX


622 
ZLIB_INTERNAL
 
	$gz_ötmax
()

624 
p
, 
q
;

626 
p
 = 1;

628 
q
 = 
p
;

629 
p
 <<= 1;

630 
p
++;

631 } 
p
 > 
q
);

632  
q
 >> 1;

633 
	}
}

	@zlib-1.2.8/gzread.c

6 
	~"gzguts.h
"

9 
loˇl
 
gz_lﬂd
 
OF
((
gz_°©ï
, *, , *));

10 
loˇl
 
gz_avaû
 
OF
((
gz_°©ï
));

11 
loˇl
 
gz_look
 
OF
((
gz_°©ï
));

12 
loˇl
 
gz_decomp
 
OF
((
gz_°©ï
));

13 
loˇl
 
gz_„tch
 
OF
((
gz_°©ï
));

14 
loˇl
 
gz_skù
 
OF
((
gz_°©ï
, 
z_off64_t
));

20 
loˇl
 
	$gz_lﬂd
(
°©e
, 
buf
, 
Àn
, 
have
)

21 
gz_°©ï
 
°©e
;

22 *
buf
;

23 
Àn
;

24 *
have
;

26 
ªt
;

28 *
have
 = 0;

30 
ªt
 = 
	`ªad
(
°©e
->
fd
, 
buf
 + *
have
, 
Àn
 - *have);

31 i‡(
ªt
 <= 0)

33 *
have
 +
ªt
;

34 } *
have
 < 
Àn
);

35 i‡(
ªt
 < 0) {

36 
	`gz_îr‹
(
°©e
, 
Z_ERRNO
, 
	`z°ªº‹
());

39 i‡(
ªt
 == 0)

40 
°©e
->
eof
 = 1;

42 
	}
}

51 
loˇl
 
	$gz_avaû
(
°©e
)

52 
gz_°©ï
 
°©e
;

54 
gŸ
;

55 
z_°ªamp
 
°rm
 = &(
°©e
->strm);

57 i‡(
°©e
->
îr
 !
Z_OK
 && sèã->î∏!
Z_BUF_ERROR
)

59 i‡(
°©e
->
eof
 == 0) {

60 i‡(
°rm
->
avaû_ö
) {

61 *
p
 = 
°©e
->
ö
;

62 c⁄° *
q
 = 
°rm
->
√xt_ö
;

63 
n
 = 
°rm
->
avaû_ö
;

65 *
p
++ = *
q
++;

66 } --
n
);

68 i‡(
	`gz_lﬂd
(
°©e
, sèã->
ö
 + 
°rm
->
avaû_ö
,

69 
°©e
->
size
 - 
°rm
->
avaû_ö
, &
gŸ
) == -1)

71 
°rm
->
avaû_ö
 +
gŸ
;

72 
°rm
->
√xt_ö
 = 
°©e
->
ö
;

75 
	}
}

86 
loˇl
 
	$gz_look
(
°©e
)

87 
gz_°©ï
 
°©e
;

89 
z_°ªamp
 
°rm
 = &(
°©e
->strm);

92 i‡(
°©e
->
size
 == 0) {

94 
°©e
->
ö
 = (*)
	`mÆloc
(°©e->
w™t
);

95 
°©e
->
out
 = (*)
	`mÆloc
(°©e->
w™t
 << 1);

96 i‡(
°©e
->
ö
 =
NULL
 || sèã->
out
 == NULL) {

97 i‡(
°©e
->
out
 !
NULL
)

98 
	`‰ì
(
°©e
->
out
);

99 i‡(
°©e
->
ö
 !
NULL
)

100 
	`‰ì
(
°©e
->
ö
);

101 
	`gz_îr‹
(
°©e
, 
Z_MEM_ERROR
, "out of memory");

104 
°©e
->
size
 = sèã->
w™t
;

107 
°©e
->
°rm
.
zÆloc
 = 
Z_NULL
;

108 
°©e
->
°rm
.
z‰ì
 = 
Z_NULL
;

109 
°©e
->
°rm
.
›aque
 = 
Z_NULL
;

110 
°©e
->
°rm
.
avaû_ö
 = 0;

111 
°©e
->
°rm
.
√xt_ö
 = 
Z_NULL
;

112 i‡(
	`öÊ©eInô2
(&(
°©e
->
°rm
), 15 + 16Ë!
Z_OK
) {

113 
	`‰ì
(
°©e
->
out
);

114 
	`‰ì
(
°©e
->
ö
);

115 
°©e
->
size
 = 0;

116 
	`gz_îr‹
(
°©e
, 
Z_MEM_ERROR
, "out of memory");

122 i‡(
°rm
->
avaû_ö
 < 2) {

123 i‡(
	`gz_avaû
(
°©e
) == -1)

125 i‡(
°rm
->
avaû_ö
 == 0)

136 i‡(
°rm
->
avaû_ö
 > 1 &&

137 
°rm
->
√xt_ö
[0] == 31 && strm->next_in[1] == 139) {

138 
	`öÊ©eRe£t
(
°rm
);

139 
°©e
->
how
 = 
GZIP
;

140 
°©e
->
dúe˘
 = 0;

146 i‡(
°©e
->
dúe˘
 == 0) {

147 
°rm
->
avaû_ö
 = 0;

148 
°©e
->
eof
 = 1;

149 
°©e
->
x
.
have
 = 0;

156 
°©e
->
x
.
√xt
 = sèã->
out
;

157 i‡(
°rm
->
avaû_ö
) {

158 
	`mem˝y
(
°©e
->
x
.
√xt
, 
°rm
->
√xt_ö
, såm->
avaû_ö
);

159 
°©e
->
x
.
have
 = 
°rm
->
avaû_ö
;

160 
°rm
->
avaû_ö
 = 0;

162 
°©e
->
how
 = 
COPY
;

163 
°©e
->
dúe˘
 = 1;

165 
	}
}

172 
loˇl
 
	$gz_decomp
(
°©e
)

173 
gz_°©ï
 
°©e
;

175 
ªt
 = 
Z_OK
;

176 
had
;

177 
z_°ªamp
 
°rm
 = &(
°©e
->strm);

180 
had
 = 
°rm
->
avaû_out
;

183 i‡(
°rm
->
avaû_ö
 =0 && 
	`gz_avaû
(
°©e
) == -1)

185 i‡(
°rm
->
avaû_ö
 == 0) {

186 
	`gz_îr‹
(
°©e
, 
Z_BUF_ERROR
, "unexpectedÉnd of file");

191 
ªt
 = 
	`öÊ©e
(
°rm
, 
Z_NO_FLUSH
);

192 i‡(
ªt
 =
Z_STREAM_ERROR
 ||Ñë =
Z_NEED_DICT
) {

193 
	`gz_îr‹
(
°©e
, 
Z_STREAM_ERROR
,

197 i‡(
ªt
 =
Z_MEM_ERROR
) {

198 
	`gz_îr‹
(
°©e
, 
Z_MEM_ERROR
, "out of memory");

201 i‡(
ªt
 =
Z_DATA_ERROR
) {

202 
	`gz_îr‹
(
°©e
, 
Z_DATA_ERROR
,

203 
°rm
->
msg
 =
NULL
 ? "compressed dataÉrror" : strm->msg);

206 } 
°rm
->
avaû_out
 && 
ªt
 !
Z_STREAM_END
);

209 
°©e
->
x
.
have
 = 
had
 - 
°rm
->
avaû_out
;

210 
°©e
->
x
.
√xt
 = 
°rm
->
√xt_out
 - sèã->x.
have
;

213 i‡(
ªt
 =
Z_STREAM_END
)

214 
°©e
->
how
 = 
LOOK
;

218 
	}
}

226 
loˇl
 
	$gz_„tch
(
°©e
)

227 
gz_°©ï
 
°©e
;

229 
z_°ªamp
 
°rm
 = &(
°©e
->strm);

232 
°©e
->
how
) {

233 
LOOK
:

234 i‡(
	`gz_look
(
°©e
) == -1)

236 i‡(
°©e
->
how
 =
LOOK
)

239 
COPY
:

240 i‡(
	`gz_lﬂd
(
°©e
, sèã->
out
, sèã->
size
 << 1, &(°©e->
x
.
have
))

243 
°©e
->
x
.
√xt
 = sèã->
out
;

245 
GZIP
:

246 
°rm
->
avaû_out
 = 
°©e
->
size
 << 1;

247 
°rm
->
√xt_out
 = 
°©e
->
out
;

248 i‡(
	`gz_decomp
(
°©e
) == -1)

251 } 
°©e
->
x
.
have
 =0 && (!°©e->
eof
 || 
°rm
->
avaû_ö
));

253 
	}
}

256 
loˇl
 
	$gz_skù
(
°©e
, 
Àn
)

257 
gz_°©ï
 
°©e
;

258 
z_off64_t
 
Àn
;

260 
n
;

263 
Àn
)

265 i‡(
°©e
->
x
.
have
) {

266 
n
 = 
	`GT_OFF
(
°©e
->
x
.
have
Ë|| (
z_off64_t
)°©e->x.havê> 
Àn
 ?

267 ()
Àn
 : 
°©e
->
x
.
have
;

268 
°©e
->
x
.
have
 -
n
;

269 
°©e
->
x
.
√xt
 +
n
;

270 
°©e
->
x
.
pos
 +
n
;

271 
Àn
 -
n
;

275 i‡(
°©e
->
eof
 && sèã->
°rm
.
avaû_ö
 == 0)

281 i‡(
	`gz_„tch
(
°©e
) == -1)

285 
	}
}

288 
ZEXPORT
 
	$gzªad
(
fûe
, 
buf
, 
Àn
)

289 
gzFûe
 
fûe
;

290 
voidp
 
buf
;

291 
Àn
;

293 
gŸ
, 
n
;

294 
gz_°©ï
 
°©e
;

295 
z_°ªamp
 
°rm
;

298 i‡(
fûe
 =
NULL
)

300 
°©e
 = (
gz_°©ï
)
fûe
;

301 
°rm
 = &(
°©e
->strm);

304 i‡(
°©e
->
mode
 !
GZ_READ
 ||

305 (
°©e
->
îr
 !
Z_OK
 && sèã->î∏!
Z_BUF_ERROR
))

310 i‡(()
Àn
 < 0) {

311 
	`gz_îr‹
(
°©e
, 
Z_DATA_ERROR
, "requestedÜength doesÇot fit in int");

316 i‡(
Àn
 == 0)

320 i‡(
°©e
->
£ek
) {

321 
°©e
->
£ek
 = 0;

322 i‡(
	`gz_skù
(
°©e
, sèã->
skù
) == -1)

327 
gŸ
 = 0;

330 i‡(
°©e
->
x
.
have
) {

331 
n
 = 
°©e
->
x
.
have
 > 
Àn
 ?Üen : state->x.have;

332 
	`mem˝y
(
buf
, 
°©e
->
x
.
√xt
, 
n
);

333 
°©e
->
x
.
√xt
 +
n
;

334 
°©e
->
x
.
have
 -
n
;

338 i‡(
°©e
->
eof
 && 
°rm
->
avaû_ö
 == 0) {

339 
°©e
->
∑°
 = 1;

345 i‡(
°©e
->
how
 =
LOOK
 || 
Àn
 < (°©e->
size
 << 1)) {

347 i‡(
	`gz_„tch
(
°©e
) == -1)

355 i‡(
°©e
->
how
 =
COPY
) {

356 i‡(
	`gz_lﬂd
(
°©e
, (*)
buf
, 
Àn
, &
n
) == -1)

362 
°rm
->
avaû_out
 = 
Àn
;

363 
°rm
->
√xt_out
 = (*)
buf
;

364 i‡(
	`gz_decomp
(
°©e
) == -1)

366 
n
 = 
°©e
->
x
.
have
;

367 
°©e
->
x
.
have
 = 0;

371 
Àn
 -
n
;

372 
buf
 = (*)bu‡+ 
n
;

373 
gŸ
 +
n
;

374 
°©e
->
x
.
pos
 +
n
;

375 } 
Àn
);

378  ()
gŸ
;

379 
	}
}

382 #ifde‡
Z_PREFIX_SET


383 #unde‡
z_gzgëc


385 #unde‡
gzgëc


387 
ZEXPORT
 
	$gzgëc
(
fûe
)

388 
gzFûe
 
fûe
;

390 
ªt
;

391 
buf
[1];

392 
gz_°©ï
 
°©e
;

395 i‡(
fûe
 =
NULL
)

397 
°©e
 = (
gz_°©ï
)
fûe
;

400 i‡(
°©e
->
mode
 !
GZ_READ
 ||

401 (
°©e
->
îr
 !
Z_OK
 && sèã->î∏!
Z_BUF_ERROR
))

405 i‡(
°©e
->
x
.
have
) {

406 
°©e
->
x
.
have
--;

407 
°©e
->
x
.
pos
++;

408  *(
°©e
->
x
.
√xt
)++;

412 
ªt
 = 
	`gzªad
(
fûe
, 
buf
, 1);

413  
ªt
 < 1 ? -1 : 
buf
[0];

414 
	}
}

416 
ZEXPORT
 
	$gzgëc_
(
fûe
)

417 
gzFûe
 
fûe
;

419  
	`gzgëc
(
fûe
);

420 
	}
}

423 
ZEXPORT
 
	$gzungëc
(
c
, 
fûe
)

424 
c
;

425 
gzFûe
 
fûe
;

427 
gz_°©ï
 
°©e
;

430 i‡(
fûe
 =
NULL
)

432 
°©e
 = (
gz_°©ï
)
fûe
;

435 i‡(
°©e
->
mode
 !
GZ_READ
 ||

436 (
°©e
->
îr
 !
Z_OK
 && sèã->î∏!
Z_BUF_ERROR
))

440 i‡(
°©e
->
£ek
) {

441 
°©e
->
£ek
 = 0;

442 i‡(
	`gz_skù
(
°©e
, sèã->
skù
) == -1)

447 i‡(
c
 < 0)

451 i‡(
°©e
->
x
.
have
 == 0) {

452 
°©e
->
x
.
have
 = 1;

453 
°©e
->
x
.
√xt
 = sèã->
out
 + (°©e->
size
 << 1) - 1;

454 
°©e
->
x
.
√xt
[0] = 
c
;

455 
°©e
->
x
.
pos
--;

456 
°©e
->
∑°
 = 0;

457  
c
;

461 i‡(
°©e
->
x
.
have
 =(°©e->
size
 << 1)) {

462 
	`gz_îr‹
(
°©e
, 
Z_DATA_ERROR
, "out ofÑoomÅoÖush characters");

467 i‡(
°©e
->
x
.
√xt
 =°©e->
out
) {

468 *
§c
 = 
°©e
->
out
 + sèã->
x
.
have
;

469 *
de°
 = 
°©e
->
out
 + (°©e->
size
 << 1);

470 
§c
 > 
°©e
->
out
)

471 *--
de°
 = *--
§c
;

472 
°©e
->
x
.
√xt
 = 
de°
;

474 
°©e
->
x
.
have
++;

475 
°©e
->
x
.
√xt
--;

476 
°©e
->
x
.
√xt
[0] = 
c
;

477 
°©e
->
x
.
pos
--;

478 
°©e
->
∑°
 = 0;

479  
c
;

480 
	}
}

483 * 
ZEXPORT
 
	$gzgës
(
fûe
, 
buf
, 
Àn
)

484 
gzFûe
 
fûe
;

485 *
buf
;

486 
Àn
;

488 
À·
, 
n
;

489 *
°r
;

490 *
eﬁ
;

491 
gz_°©ï
 
°©e
;

494 i‡(
fûe
 =
NULL
 || 
buf
 =NULL || 
Àn
 < 1)

495  
NULL
;

496 
°©e
 = (
gz_°©ï
)
fûe
;

499 i‡(
°©e
->
mode
 !
GZ_READ
 ||

500 (
°©e
->
îr
 !
Z_OK
 && sèã->î∏!
Z_BUF_ERROR
))

501  
NULL
;

504 i‡(
°©e
->
£ek
) {

505 
°©e
->
£ek
 = 0;

506 i‡(
	`gz_skù
(
°©e
, sèã->
skù
) == -1)

507  
NULL
;

513 
°r
 = 
buf
;

514 
À·
 = ()
Àn
 - 1;

515 i‡(
À·
) do {

517 i‡(
°©e
->
x
.
have
 =0 && 
	`gz_„tch
(state) == -1)

518  
NULL
;

519 i‡(
°©e
->
x
.
have
 == 0) {

520 
°©e
->
∑°
 = 1;

525 
n
 = 
°©e
->
x
.
have
 > 
À·
 ?Üeft : state->x.have;

526 
eﬁ
 = (*)
	`memchr
(
°©e
->
x
.
√xt
, '\n', 
n
);

527 i‡(
eﬁ
 !
NULL
)

528 
n
 = ()(
eﬁ
 - 
°©e
->
x
.
√xt
) + 1;

531 
	`mem˝y
(
buf
, 
°©e
->
x
.
√xt
, 
n
);

532 
°©e
->
x
.
have
 -
n
;

533 
°©e
->
x
.
√xt
 +
n
;

534 
°©e
->
x
.
pos
 +
n
;

535 
À·
 -
n
;

536 
buf
 +
n
;

537 } 
À·
 && 
eﬁ
 =
NULL
);

540 i‡(
buf
 =
°r
)

541  
NULL
;

542 
buf
[0] = 0;

543  
°r
;

544 
	}
}

547 
ZEXPORT
 
	$gzdúe˘
(
fûe
)

548 
gzFûe
 
fûe
;

550 
gz_°©ï
 
°©e
;

553 i‡(
fûe
 =
NULL
)

555 
°©e
 = (
gz_°©ï
)
fûe
;

559 i‡(
°©e
->
mode
 =
GZ_READ
 && sèã->
how
 =
LOOK
 && sèã->
x
.
have
 == 0)

560 ()
	`gz_look
(
°©e
);

563  
°©e
->
dúe˘
;

564 
	}
}

567 
ZEXPORT
 
	$gz˛o£_r
(
fûe
)

568 
gzFûe
 
fûe
;

570 
ªt
, 
îr
;

571 
gz_°©ï
 
°©e
;

574 i‡(
fûe
 =
NULL
)

575  
Z_STREAM_ERROR
;

576 
°©e
 = (
gz_°©ï
)
fûe
;

579 i‡(
°©e
->
mode
 !
GZ_READ
)

580  
Z_STREAM_ERROR
;

583 i‡(
°©e
->
size
) {

584 
	`öÊ©eEnd
(&(
°©e
->
°rm
));

585 
	`‰ì
(
°©e
->
out
);

586 
	`‰ì
(
°©e
->
ö
);

588 
îr
 = 
°©e
->î∏=
Z_BUF_ERROR
 ? Z_BUF_ERROR : 
Z_OK
;

589 
	`gz_îr‹
(
°©e
, 
Z_OK
, 
NULL
);

590 
	`‰ì
(
°©e
->
∑th
);

591 
ªt
 = 
	`˛o£
(
°©e
->
fd
);

592 
	`‰ì
(
°©e
);

593  
ªt
 ? 
Z_ERRNO
 : 
îr
;

594 
	}
}

	@zlib-1.2.8/gzwrite.c

6 
	~"gzguts.h
"

9 
loˇl
 
gz_öô
 
OF
((
gz_°©ï
));

10 
loˇl
 
gz_comp
 
OF
((
gz_°©ï
, ));

11 
loˇl
 
gz_zîo
 
OF
((
gz_°©ï
, 
z_off64_t
));

15 
loˇl
 
	$gz_öô
(
°©e
)

16 
gz_°©ï
 
°©e
;

18 
ªt
;

19 
z_°ªamp
 
°rm
 = &(
°©e
->strm);

22 
°©e
->
ö
 = (*)
	`mÆloc
(°©e->
w™t
);

23 i‡(
°©e
->
ö
 =
NULL
) {

24 
	`gz_îr‹
(
°©e
, 
Z_MEM_ERROR
, "out of memory");

29 i‡(!
°©e
->
dúe˘
) {

31 
°©e
->
out
 = (*)
	`mÆloc
(°©e->
w™t
);

32 i‡(
°©e
->
out
 =
NULL
) {

33 
	`‰ì
(
°©e
->
ö
);

34 
	`gz_îr‹
(
°©e
, 
Z_MEM_ERROR
, "out of memory");

39 
°rm
->
zÆloc
 = 
Z_NULL
;

40 
°rm
->
z‰ì
 = 
Z_NULL
;

41 
°rm
->
›aque
 = 
Z_NULL
;

42 
ªt
 = 
	`deÊ©eInô2
(
°rm
, 
°©e
->
Àvñ
, 
Z_DEFLATED
,

43 
MAX_WBITS
 + 16, 
DEF_MEM_LEVEL
, 
°©e
->
°øãgy
);

44 i‡(
ªt
 !
Z_OK
) {

45 
	`‰ì
(
°©e
->
out
);

46 
	`‰ì
(
°©e
->
ö
);

47 
	`gz_îr‹
(
°©e
, 
Z_MEM_ERROR
, "out of memory");

53 
°©e
->
size
 = sèã->
w™t
;

56 i‡(!
°©e
->
dúe˘
) {

57 
°rm
->
avaû_out
 = 
°©e
->
size
;

58 
°rm
->
√xt_out
 = 
°©e
->
out
;

59 
°©e
->
x
.
√xt
 = 
°rm
->
√xt_out
;

62 
	}
}

70 
loˇl
 
	$gz_comp
(
°©e
, 
Êush
)

71 
gz_°©ï
 
°©e
;

72 
Êush
;

74 
ªt
, 
gŸ
;

75 
have
;

76 
z_°ªamp
 
°rm
 = &(
°©e
->strm);

79 i‡(
°©e
->
size
 =0 && 
	`gz_öô
(state) == -1)

83 i‡(
°©e
->
dúe˘
) {

84 
gŸ
 = 
	`wrôe
(
°©e
->
fd
, 
°rm
->
√xt_ö
, såm->
avaû_ö
);

85 i‡(
gŸ
 < 0 || ()gŸ !
°rm
->
avaû_ö
) {

86 
	`gz_îr‹
(
°©e
, 
Z_ERRNO
, 
	`z°ªº‹
());

89 
°rm
->
avaû_ö
 = 0;

94 
ªt
 = 
Z_OK
;

98 i‡(
°rm
->
avaû_out
 =0 || (
Êush
 !
Z_NO_FLUSH
 &&

99 (
Êush
 !
Z_FINISH
 || 
ªt
 =
Z_STREAM_END
))) {

100 
have
 = ()(
°rm
->
√xt_out
 - 
°©e
->
x
.
√xt
);

101 i‡(
have
 && ((
gŸ
 = 
	`wrôe
(
°©e
->
fd
, sèã->
x
.
√xt
, have)) < 0 ||

102 ()
gŸ
 !
have
)) {

103 
	`gz_îr‹
(
°©e
, 
Z_ERRNO
, 
	`z°ªº‹
());

106 i‡(
°rm
->
avaû_out
 == 0) {

107 
°rm
->
avaû_out
 = 
°©e
->
size
;

108 
°rm
->
√xt_out
 = 
°©e
->
out
;

110 
°©e
->
x
.
√xt
 = 
°rm
->
√xt_out
;

114 
have
 = 
°rm
->
avaû_out
;

115 
ªt
 = 
	`deÊ©e
(
°rm
, 
Êush
);

116 i‡(
ªt
 =
Z_STREAM_ERROR
) {

117 
	`gz_îr‹
(
°©e
, 
Z_STREAM_ERROR
,

121 
have
 -
°rm
->
avaû_out
;

122 } 
have
);

125 i‡(
Êush
 =
Z_FINISH
)

126 
	`deÊ©eRe£t
(
°rm
);

130 
	}
}

133 
loˇl
 
	$gz_zîo
(
°©e
, 
Àn
)

134 
gz_°©ï
 
°©e
;

135 
z_off64_t
 
Àn
;

137 
fú°
;

138 
n
;

139 
z_°ªamp
 
°rm
 = &(
°©e
->strm);

142 i‡(
°rm
->
avaû_ö
 && 
	`gz_comp
(
°©e
, 
Z_NO_FLUSH
) == -1)

146 
fú°
 = 1;

147 
Àn
) {

148 
n
 = 
	`GT_OFF
(
°©e
->
size
Ë|| (
z_off64_t
)°©e->sizê> 
Àn
 ?

149 ()
Àn
 : 
°©e
->
size
;

150 i‡(
fú°
) {

151 
	`mem£t
(
°©e
->
ö
, 0, 
n
);

152 
fú°
 = 0;

154 
°rm
->
avaû_ö
 = 
n
;

155 
°rm
->
√xt_ö
 = 
°©e
->
ö
;

156 
°©e
->
x
.
pos
 +
n
;

157 i‡(
	`gz_comp
(
°©e
, 
Z_NO_FLUSH
) == -1)

159 
Àn
 -
n
;

162 
	}
}

165 
ZEXPORT
 
	$gzwrôe
(
fûe
, 
buf
, 
Àn
)

166 
gzFûe
 
fûe
;

167 
voidpc
 
buf
;

168 
Àn
;

170 
put
 = 
Àn
;

171 
gz_°©ï
 
°©e
;

172 
z_°ªamp
 
°rm
;

175 i‡(
fûe
 =
NULL
)

177 
°©e
 = (
gz_°©ï
)
fûe
;

178 
°rm
 = &(
°©e
->strm);

181 i‡(
°©e
->
mode
 !
GZ_WRITE
 || sèã->
îr
 !
Z_OK
)

186 i‡(()
Àn
 < 0) {

187 
	`gz_îr‹
(
°©e
, 
Z_DATA_ERROR
, "requestedÜength doesÇot fit in int");

192 i‡(
Àn
 == 0)

196 i‡(
°©e
->
size
 =0 && 
	`gz_öô
(state) == -1)

200 i‡(
°©e
->
£ek
) {

201 
°©e
->
£ek
 = 0;

202 i‡(
	`gz_zîo
(
°©e
, sèã->
skù
) == -1)

207 i‡(
Àn
 < 
°©e
->
size
) {

210 
have
, 
c›y
;

212 i‡(
°rm
->
avaû_ö
 == 0)

213 
°rm
->
√xt_ö
 = 
°©e
->
ö
;

214 
have
 = ()((
°rm
->
√xt_ö
 + såm->
avaû_ö
Ë- 
°©e
->
ö
);

215 
c›y
 = 
°©e
->
size
 - 
have
;

216 i‡(
c›y
 > 
Àn
)

217 
c›y
 = 
Àn
;

218 
	`mem˝y
(
°©e
->
ö
 + 
have
, 
buf
, 
c›y
);

219 
°rm
->
avaû_ö
 +
c›y
;

220 
°©e
->
x
.
pos
 +
c›y
;

221 
buf
 = (c⁄° *)bu‡+ 
c›y
;

222 
Àn
 -
c›y
;

223 i‡(
Àn
 && 
	`gz_comp
(
°©e
, 
Z_NO_FLUSH
) == -1)

225 } 
Àn
);

229 i‡(
°rm
->
avaû_ö
 && 
	`gz_comp
(
°©e
, 
Z_NO_FLUSH
) == -1)

233 
°rm
->
avaû_ö
 = 
Àn
;

234 
°rm
->
√xt_ö
 = (
z_c⁄°
 
Byãf
 *)
buf
;

235 
°©e
->
x
.
pos
 +
Àn
;

236 i‡(
	`gz_comp
(
°©e
, 
Z_NO_FLUSH
) == -1)

241  ()
put
;

242 
	}
}

245 
ZEXPORT
 
	$gzputc
(
fûe
, 
c
)

246 
gzFûe
 
fûe
;

247 
c
;

249 
have
;

250 
buf
[1];

251 
gz_°©ï
 
°©e
;

252 
z_°ªamp
 
°rm
;

255 i‡(
fûe
 =
NULL
)

257 
°©e
 = (
gz_°©ï
)
fûe
;

258 
°rm
 = &(
°©e
->strm);

261 i‡(
°©e
->
mode
 !
GZ_WRITE
 || sèã->
îr
 !
Z_OK
)

265 i‡(
°©e
->
£ek
) {

266 
°©e
->
£ek
 = 0;

267 i‡(
	`gz_zîo
(
°©e
, sèã->
skù
) == -1)

273 i‡(
°©e
->
size
) {

274 i‡(
°rm
->
avaû_ö
 == 0)

275 
°rm
->
√xt_ö
 = 
°©e
->
ö
;

276 
have
 = ()((
°rm
->
√xt_ö
 + såm->
avaû_ö
Ë- 
°©e
->
ö
);

277 i‡(
have
 < 
°©e
->
size
) {

278 
°©e
->
ö
[
have
] = 
c
;

279 
°rm
->
avaû_ö
++;

280 
°©e
->
x
.
pos
++;

281  
c
 & 0xff;

286 
buf
[0] = 
c
;

287 i‡(
	`gzwrôe
(
fûe
, 
buf
, 1) != 1)

289  
c
 & 0xff;

290 
	}
}

293 
ZEXPORT
 
	$gzputs
(
fûe
, 
°r
)

294 
gzFûe
 
fûe
;

295 c⁄° *
°r
;

297 
ªt
;

298 
Àn
;

301 
Àn
 = ()
	`°æí
(
°r
);

302 
ªt
 = 
	`gzwrôe
(
fûe
, 
°r
, 
Àn
);

303  
ªt
 =0 && 
Àn
 != 0 ? -1 :Ñet;

304 
	}
}

306 #i‡
deföed
(
STDC
Ë|| deföed(
Z_HAVE_STDARG_H
)

307 
	~<°d¨g.h
>

310 
ZEXPORTVA
 
	$gzv¥ötf
(
gzFûe
 
fûe
, c⁄° *
f‹m©
, 
va_li°
 
va
)

312 
size
, 
Àn
;

313 
gz_°©ï
 
°©e
;

314 
z_°ªamp
 
°rm
;

317 i‡(
fûe
 =
NULL
)

319 
°©e
 = (
gz_°©ï
)
fûe
;

320 
°rm
 = &(
°©e
->strm);

323 i‡(
°©e
->
mode
 !
GZ_WRITE
 || sèã->
îr
 !
Z_OK
)

327 i‡(
°©e
->
size
 =0 && 
	`gz_öô
(state) == -1)

331 i‡(
°©e
->
£ek
) {

332 
°©e
->
£ek
 = 0;

333 i‡(
	`gz_zîo
(
°©e
, sèã->
skù
) == -1)

338 i‡(
°rm
->
avaû_ö
 && 
	`gz_comp
(
°©e
, 
Z_NO_FLUSH
) == -1)

342 
size
 = ()(
°©e
->size);

343 
°©e
->
ö
[
size
 - 1] = 0;

344 #ifde‡
NO_v¢¥ötf


345 #ifde‡
HAS_v•rötf_void


346 ()
	`v•rötf
((*)(
°©e
->
ö
), 
f‹m©
, 
va
);

347 
Àn
 = 0;Üí < 
size
;Üen++)

348 i‡(
°©e
->
ö
[
Àn
] == 0) ;

350 
Àn
 = 
	`v•rötf
((*)(
°©e
->
ö
), 
f‹m©
, 
va
);

353 #ifde‡
HAS_v¢¥ötf_void


354 ()
	`v¢¥ötf
((*)(
°©e
->
ö
), 
size
, 
f‹m©
, 
va
);

355 
Àn
 = 
	`°æí
((*)(
°©e
->
ö
));

357 
Àn
 = 
	`v¢¥ötf
((*)(
°©e
->
ö
), 
size
, 
f‹m©
, 
va
);

362 i‡(
Àn
 <0 ||Üí >()
size
 || 
°©e
->
ö
[size - 1] != 0)

366 
°rm
->
avaû_ö
 = ()
Àn
;

367 
°rm
->
√xt_ö
 = 
°©e
->
ö
;

368 
°©e
->
x
.
pos
 +
Àn
;

369  
Àn
;

370 
	}
}

372 
ZEXPORTVA
 
	$gz¥ötf
(
gzFûe
 
fûe
, c⁄° *
f‹m©
, ...)

374 
va_li°
 
va
;

375 
ªt
;

377 
	`va_°¨t
(
va
, 
f‹m©
);

378 
ªt
 = 
	`gzv¥ötf
(
fûe
, 
f‹m©
, 
va
);

379 
	`va_íd
(
va
);

380  
ªt
;

381 
	}
}

386 
ZEXPORTVA
 
	$gz¥ötf
 (
fûe
, 
f‹m©
, 
a1
, 
a2
, 
a3
, 
a4
, 
a5
, 
a6
, 
a7
, 
a8
, 
a9
, 
a10
,

387 
a11
, 
a12
, 
a13
, 
a14
, 
a15
, 
a16
, 
a17
, 
a18
, 
a19
, 
a20
)

388 
gzFûe
 
fûe
;

389 c⁄° *
f‹m©
;

390 
a1
, 
a2
, 
a3
, 
a4
, 
a5
, 
a6
, 
a7
, 
a8
, 
a9
, 
a10
,

391 
a11
, 
a12
, 
a13
, 
a14
, 
a15
, 
a16
, 
a17
, 
a18
, 
a19
, 
a20
;

393 
size
, 
Àn
;

394 
gz_°©ï
 
°©e
;

395 
z_°ªamp
 
°rm
;

398 i‡(
fûe
 =
NULL
)

400 
°©e
 = (
gz_°©ï
)
fûe
;

401 
°rm
 = &(
°©e
->strm);

408 i‡(
°©e
->
mode
 !
GZ_WRITE
 || sèã->
îr
 !
Z_OK
)

412 i‡(
°©e
->
size
 =0 && 
	`gz_öô
(state) == -1)

416 i‡(
°©e
->
£ek
) {

417 
°©e
->
£ek
 = 0;

418 i‡(
	`gz_zîo
(
°©e
, sèã->
skù
) == -1)

423 i‡(
°rm
->
avaû_ö
 && 
	`gz_comp
(
°©e
, 
Z_NO_FLUSH
) == -1)

427 
size
 = ()(
°©e
->size);

428 
°©e
->
ö
[
size
 - 1] = 0;

429 #ifde‡
NO_¢¥ötf


430 #ifde‡
HAS_•rötf_void


431 
	`•rötf
((*)(
°©e
->
ö
), 
f‹m©
, 
a1
, 
a2
, 
a3
, 
a4
, 
a5
, 
a6
, 
a7
, 
a8
,

432 
a9
, 
a10
, 
a11
, 
a12
, 
a13
, 
a14
, 
a15
, 
a16
, 
a17
, 
a18
, 
a19
, 
a20
);

433 
Àn
 = 0;Üí < 
size
;Üen++)

434 i‡(
°©e
->
ö
[
Àn
] == 0) ;

436 
Àn
 = 
	`•rötf
((*)(
°©e
->
ö
), 
f‹m©
, 
a1
, 
a2
, 
a3
, 
a4
, 
a5
, 
a6
, 
a7
, 
a8
,

437 
a9
, 
a10
, 
a11
, 
a12
, 
a13
, 
a14
, 
a15
, 
a16
, 
a17
, 
a18
, 
a19
, 
a20
);

440 #ifde‡
HAS_¢¥ötf_void


441 
	`¢¥ötf
((*)(
°©e
->
ö
), 
size
, 
f‹m©
, 
a1
, 
a2
, 
a3
, 
a4
, 
a5
, 
a6
, 
a7
, 
a8
,

442 
a9
, 
a10
, 
a11
, 
a12
, 
a13
, 
a14
, 
a15
, 
a16
, 
a17
, 
a18
, 
a19
, 
a20
);

443 
Àn
 = 
	`°æí
((*)(
°©e
->
ö
));

445 
Àn
 = 
	`¢¥ötf
((*)(
°©e
->
ö
), 
size
, 
f‹m©
, 
a1
, 
a2
, 
a3
, 
a4
, 
a5
, 
a6
,

446 
a7
, 
a8
, 
a9
, 
a10
, 
a11
, 
a12
, 
a13
, 
a14
, 
a15
, 
a16
, 
a17
, 
a18
,

447 
a19
, 
a20
);

452 i‡(
Àn
 <0 ||Üí >()
size
 || 
°©e
->
ö
[size - 1] != 0)

456 
°rm
->
avaû_ö
 = ()
Àn
;

457 
°rm
->
√xt_ö
 = 
°©e
->
ö
;

458 
°©e
->
x
.
pos
 +
Àn
;

459  
Àn
;

460 
	}
}

465 
ZEXPORT
 
	$gzÊush
(
fûe
, 
Êush
)

466 
gzFûe
 
fûe
;

467 
Êush
;

469 
gz_°©ï
 
°©e
;

472 i‡(
fûe
 =
NULL
)

474 
°©e
 = (
gz_°©ï
)
fûe
;

477 i‡(
°©e
->
mode
 !
GZ_WRITE
 || sèã->
îr
 !
Z_OK
)

478  
Z_STREAM_ERROR
;

481 i‡(
Êush
 < 0 || flush > 
Z_FINISH
)

482  
Z_STREAM_ERROR
;

485 i‡(
°©e
->
£ek
) {

486 
°©e
->
£ek
 = 0;

487 i‡(
	`gz_zîo
(
°©e
, sèã->
skù
) == -1)

492 
	`gz_comp
(
°©e
, 
Êush
);

493  
°©e
->
îr
;

494 
	}
}

497 
ZEXPORT
 
	$gz£ç¨ams
(
fûe
, 
Àvñ
, 
°øãgy
)

498 
gzFûe
 
fûe
;

499 
Àvñ
;

500 
°øãgy
;

502 
gz_°©ï
 
°©e
;

503 
z_°ªamp
 
°rm
;

506 i‡(
fûe
 =
NULL
)

507  
Z_STREAM_ERROR
;

508 
°©e
 = (
gz_°©ï
)
fûe
;

509 
°rm
 = &(
°©e
->strm);

512 i‡(
°©e
->
mode
 !
GZ_WRITE
 || sèã->
îr
 !
Z_OK
)

513  
Z_STREAM_ERROR
;

516 i‡(
Àvñ
 =
°©e
->Àvñ && 
°øãgy
 == state->strategy)

517  
Z_OK
;

520 i‡(
°©e
->
£ek
) {

521 
°©e
->
£ek
 = 0;

522 i‡(
	`gz_zîo
(
°©e
, sèã->
skù
) == -1)

527 i‡(
°©e
->
size
) {

529 i‡(
°rm
->
avaû_ö
 && 
	`gz_comp
(
°©e
, 
Z_PARTIAL_FLUSH
) == -1)

530  
°©e
->
îr
;

531 
	`deÊ©eP¨ams
(
°rm
, 
Àvñ
, 
°øãgy
);

533 
°©e
->
Àvñ
 =Üevel;

534 
°©e
->
°øãgy
 = strategy;

535  
Z_OK
;

536 
	}
}

539 
ZEXPORT
 
	$gz˛o£_w
(
fûe
)

540 
gzFûe
 
fûe
;

542 
ªt
 = 
Z_OK
;

543 
gz_°©ï
 
°©e
;

546 i‡(
fûe
 =
NULL
)

547  
Z_STREAM_ERROR
;

548 
°©e
 = (
gz_°©ï
)
fûe
;

551 i‡(
°©e
->
mode
 !
GZ_WRITE
)

552  
Z_STREAM_ERROR
;

555 i‡(
°©e
->
£ek
) {

556 
°©e
->
£ek
 = 0;

557 i‡(
	`gz_zîo
(
°©e
, sèã->
skù
) == -1)

558 
ªt
 = 
°©e
->
îr
;

562 i‡(
	`gz_comp
(
°©e
, 
Z_FINISH
) == -1)

563 
ªt
 = 
°©e
->
îr
;

564 i‡(
°©e
->
size
) {

565 i‡(!
°©e
->
dúe˘
) {

566 ()
	`deÊ©eEnd
(&(
°©e
->
°rm
));

567 
	`‰ì
(
°©e
->
out
);

569 
	`‰ì
(
°©e
->
ö
);

571 
	`gz_îr‹
(
°©e
, 
Z_OK
, 
NULL
);

572 
	`‰ì
(
°©e
->
∑th
);

573 i‡(
	`˛o£
(
°©e
->
fd
) == -1)

574 
ªt
 = 
Z_ERRNO
;

575 
	`‰ì
(
°©e
);

576  
ªt
;

577 
	}
}

	@zlib-1.2.8/infback.c

13 
	~"zutû.h
"

14 
	~"ö·ªes.h
"

15 
	~"öÊ©e.h
"

16 
	~"öfÁ°.h
"

19 
loˇl
 
fixedèbÀs
 
OF
((
öÊ©e_°©e
 
FAR
 *
°©e
));

28 
ZEXPORT
 
	$öÊ©eBackInô_
(
°rm
, 
wödowBôs
, 
wödow
, 
vîsi⁄
, 
°ªam_size
)

29 
z_°ªamp
 
°rm
;

30 
wödowBôs
;

31 
FAR
 *
wödow
;

32 c⁄° *
vîsi⁄
;

33 
°ªam_size
;

35 
öÊ©e_°©e
 
FAR
 *
°©e
;

37 i‡(
vîsi⁄
 =
Z_NULL
 || vîsi⁄[0] !
ZLIB_VERSION
[0] ||

38 
°ªam_size
 !()((
z_°ªam
)))

39  
Z_VERSION_ERROR
;

40 i‡(
°rm
 =
Z_NULL
 || 
wödow
 == Z_NULL ||

41 
wödowBôs
 < 8 || windowBits > 15)

42  
Z_STREAM_ERROR
;

43 
°rm
->
msg
 = 
Z_NULL
;

44 i‡(
°rm
->
zÆloc
 =(
Æloc_func
)0) {

45 #ifde‡
Z_SOLO


46  
Z_STREAM_ERROR
;

48 
°rm
->
zÆloc
 = 
zˇŒoc
;

49 
°rm
->
›aque
 = (
voidpf
)0;

52 i‡(
°rm
->
z‰ì
 =(
‰ì_func
)0)

53 #ifde‡
Z_SOLO


54  
Z_STREAM_ERROR
;

56 
°rm
->
z‰ì
 = 
zc‰ì
;

58 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
	`ZALLOC
(
°rm
, 1,

59 (
öÊ©e_°©e
));

60 i‡(
°©e
 =
Z_NULL
Ë 
Z_MEM_ERROR
;

61 
	`Tø˚v
((
°dîr
, "inflate:állocated\n"));

62 
°rm
->
°©e
 = (
öã∫Æ_°©e
 
FAR
 *)state;

63 
°©e
->
dmax
 = 32768U;

64 
°©e
->
wbôs
 = 
wödowBôs
;

65 
°©e
->
wsize
 = 1U << 
wödowBôs
;

66 
°©e
->
wödow
 = window;

67 
°©e
->
w√xt
 = 0;

68 
°©e
->
whave
 = 0;

69  
Z_OK
;

70 
	}
}

82 
loˇl
 
	$fixedèbÀs
(
°©e
)

83 
öÊ©e_°©e
 
FAR
 *
°©e
;

85 #ifde‡
BUILDFIXED


86 
vúgö
 = 1;

87 
code
 *
Ànfix
, *
di°fix
;

88 
code
 
fixed
[544];

91 i‡(
vúgö
) {

92 
sym
, 
bôs
;

93 
code
 *
√xt
;

96 
sym
 = 0;

97 
sym
 < 144Ë
°©e
->
Àns
[sym++] = 8;

98 
sym
 < 256Ë
°©e
->
Àns
[sym++] = 9;

99 
sym
 < 280Ë
°©e
->
Àns
[sym++] = 7;

100 
sym
 < 288Ë
°©e
->
Àns
[sym++] = 8;

101 
√xt
 = 
fixed
;

102 
Ànfix
 = 
√xt
;

103 
bôs
 = 9;

104 
	`öÊ©e_èbÀ
(
LENS
, 
°©e
->
Àns
, 288, &(
√xt
), &(
bôs
), sèã->
w‹k
);

107 
sym
 = 0;

108 
sym
 < 32Ë
°©e
->
Àns
[sym++] = 5;

109 
di°fix
 = 
√xt
;

110 
bôs
 = 5;

111 
	`öÊ©e_èbÀ
(
DISTS
, 
°©e
->
Àns
, 32, &(
√xt
), &(
bôs
), sèã->
w‹k
);

114 
vúgö
 = 0;

117 
	~"öffixed.h
"

119 
°©e
->
Àncode
 = 
Ànfix
;

120 
°©e
->
Ànbôs
 = 9;

121 
°©e
->
di°code
 = 
di°fix
;

122 
°©e
->
di°bôs
 = 5;

123 
	}
}

128 
	#LOAD
() \

130 
put
 = 
°rm
->
√xt_out
; \

131 
À·
 = 
°rm
->
avaû_out
; \

132 
√xt
 = 
°rm
->
√xt_ö
; \

133 
have
 = 
°rm
->
avaû_ö
; \

134 
hﬁd
 = 
°©e
->hold; \

135 
bôs
 = 
°©e
->bits; \

136 } 0)

	)

139 
	#RESTORE
() \

141 
°rm
->
√xt_out
 = 
put
; \

142 
°rm
->
avaû_out
 = 
À·
; \

143 
°rm
->
√xt_ö
 = 
√xt
; \

144 
°rm
->
avaû_ö
 = 
have
; \

145 
°©e
->
hﬁd
 = hold; \

146 
°©e
->
bôs
 = bits; \

147 } 0)

	)

150 
	#INITBITS
() \

152 
hﬁd
 = 0; \

153 
bôs
 = 0; \

154 } 0)

	)

158 
	#PULL
() \

160 i‡(
have
 == 0) { \

161 
have
 = 
	`ö
(
ö_desc
, &
√xt
); \

162 i‡(
have
 == 0) { \

163 
√xt
 = 
Z_NULL
; \

164 
ªt
 = 
Z_BUF_ERROR
; \

165 
öf_Àave
; \

168 } 0)

	)

172 
	#PULLBYTE
() \

174 
	`PULL
(); \

175 
have
--; \

176 
hﬁd
 +()(*
√xt
++Ë<< 
bôs
; \

177 
bôs
 += 8; \

178 } 0)

	)

183 
	#NEEDBITS
(
n
) \

185 
bôs
 < ()(
n
)) \

186 
	`PULLBYTE
(); \

187 } 0)

	)

190 
	#BITS
(
n
) \

191 (()
hﬁd
 & ((1U << (
n
)Ë- 1))

	)

194 
	#DROPBITS
(
n
) \

196 
hﬁd
 >>(
n
); \

197 
bôs
 -()(
n
); \

198 } 0)

	)

201 
	#BYTEBITS
() \

203 
hﬁd
 >>
bôs
 & 7; \

204 
bôs
 -= bits & 7; \

205 } 0)

	)

210 
	#ROOM
() \

212 i‡(
À·
 == 0) { \

213 
put
 = 
°©e
->
wödow
; \

214 
À·
 = 
°©e
->
wsize
; \

215 
°©e
->
whave
 = 
À·
; \

216 i‡(
	`out
(
out_desc
, 
put
, 
À·
)) { \

217 
ªt
 = 
Z_BUF_ERROR
; \

218 
öf_Àave
; \

221 } 0)

	)

250 
ZEXPORT
 
	$öÊ©eBack
(
°rm
, 
ö
, 
ö_desc
, 
out
, 
out_desc
)

251 
z_°ªamp
 
°rm
;

252 
ö_func
 
ö
;

253 
FAR
 *
ö_desc
;

254 
out_func
 
out
;

255 
FAR
 *
out_desc
;

257 
öÊ©e_°©e
 
FAR
 *
°©e
;

258 
z_c⁄°
 
FAR
 *
√xt
;

259 
FAR
 *
put
;

260 
have
, 
À·
;

261 
hﬁd
;

262 
bôs
;

263 
c›y
;

264 
FAR
 *
‰om
;

265 
code
 
hîe
;

266 
code
 
œ°
;

267 
Àn
;

268 
ªt
;

269 c⁄° 
‹dî
[19] =

273 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 == Z_NULL)

274  
Z_STREAM_ERROR
;

275 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
°rm
->state;

278 
°rm
->
msg
 = 
Z_NULL
;

279 
°©e
->
mode
 = 
TYPE
;

280 
°©e
->
œ°
 = 0;

281 
°©e
->
whave
 = 0;

282 
√xt
 = 
°rm
->
√xt_ö
;

283 
have
 = 
√xt
 !
Z_NULL
 ? 
°rm
->
avaû_ö
 : 0;

284 
hﬁd
 = 0;

285 
bôs
 = 0;

286 
put
 = 
°©e
->
wödow
;

287 
À·
 = 
°©e
->
wsize
;

291 
°©e
->
mode
) {

292 
TYPE
:

294 i‡(
°©e
->
œ°
) {

295 
	`BYTEBITS
();

296 
°©e
->
mode
 = 
DONE
;

299 
	`NEEDBITS
(3);

300 
°©e
->
œ°
 = 
	`BITS
(1);

301 
	`DROPBITS
(1);

302 
	`BITS
(2)) {

304 
	`Tø˚v
((
°dîr
, "inflate: stored block%s\n",

305 
°©e
->
œ°
 ? " (last)" : ""));

306 
°©e
->
mode
 = 
STORED
;

309 
	`fixedèbÀs
(
°©e
);

310 
	`Tø˚v
((
°dîr
, "inflate: fixed codes block%s\n",

311 
°©e
->
œ°
 ? " (last)" : ""));

312 
°©e
->
mode
 = 
LEN
;

315 
	`Tø˚v
((
°dîr
, "inflate: dynamic codes block%s\n",

316 
°©e
->
œ°
 ? " (last)" : ""));

317 
°©e
->
mode
 = 
TABLE
;

320 
°rm
->
msg
 = (*)"invalid blockÅype";

321 
°©e
->
mode
 = 
BAD
;

323 
	`DROPBITS
(2);

326 
STORED
:

328 
	`BYTEBITS
();

329 
	`NEEDBITS
(32);

330 i‡((
hﬁd
 & 0xffff) != ((hold >> 16) ^ 0xffff)) {

331 
°rm
->
msg
 = (*)"invalid stored blockÜengths";

332 
°©e
->
mode
 = 
BAD
;

335 
°©e
->
Àngth
 = ()
hﬁd
 & 0xffff;

336 
	`Tø˚v
((
°dîr
, "inflate: storedÜength %u\n",

337 
°©e
->
Àngth
));

338 
	`INITBITS
();

341 
°©e
->
Àngth
 != 0) {

342 
c›y
 = 
°©e
->
Àngth
;

343 
	`PULL
();

344 
	`ROOM
();

345 i‡(
c›y
 > 
have
) copy = have;

346 i‡(
c›y
 > 
À·
) copy =Üeft;

347 
	`zmem˝y
(
put
, 
√xt
, 
c›y
);

348 
have
 -
c›y
;

349 
√xt
 +
c›y
;

350 
À·
 -
c›y
;

351 
put
 +
c›y
;

352 
°©e
->
Àngth
 -
c›y
;

354 
	`Tø˚v
((
°dîr
, "inflate: storedÉnd\n"));

355 
°©e
->
mode
 = 
TYPE
;

358 
TABLE
:

360 
	`NEEDBITS
(14);

361 
°©e
->
∆í
 = 
	`BITS
(5) + 257;

362 
	`DROPBITS
(5);

363 
°©e
->
ndi°
 = 
	`BITS
(5) + 1;

364 
	`DROPBITS
(5);

365 
°©e
->
ncode
 = 
	`BITS
(4) + 4;

366 
	`DROPBITS
(4);

367 #i‚de‡
PKZIP_BUG_WORKAROUND


368 i‡(
°©e
->
∆í
 > 286 || sèã->
ndi°
 > 30) {

369 
°rm
->
msg
 = (*)"too manyÜength or distance symbols";

370 
°©e
->
mode
 = 
BAD
;

374 
	`Tø˚v
((
°dîr
, "inflate:Åable sizes ok\n"));

377 
°©e
->
have
 = 0;

378 
°©e
->
have
 < sèã->
ncode
) {

379 
	`NEEDBITS
(3);

380 
°©e
->
Àns
[
‹dî
[°©e->
have
++]] = ()
	`BITS
(3);

381 
	`DROPBITS
(3);

383 
°©e
->
have
 < 19)

384 
°©e
->
Àns
[
‹dî
[°©e->
have
++]] = 0;

385 
°©e
->
√xt
 = sèã->
codes
;

386 
°©e
->
Àncode
 = (
code
 c⁄° 
FAR
 *)(°©e->
√xt
);

387 
°©e
->
Ànbôs
 = 7;

388 
ªt
 = 
	`öÊ©e_èbÀ
(
CODES
, 
°©e
->
Àns
, 19, &(°©e->
√xt
),

389 &(
°©e
->
Ànbôs
), sèã->
w‹k
);

390 i‡(
ªt
) {

391 
°rm
->
msg
 = (*)"invalid codeÜengths set";

392 
°©e
->
mode
 = 
BAD
;

395 
	`Tø˚v
((
°dîr
, "inflate: codeÜengths ok\n"));

398 
°©e
->
have
 = 0;

399 
°©e
->
have
 < sèã->
∆í
 + sèã->
ndi°
) {

401 
hîe
 = 
°©e
->
Àncode
[
	`BITS
(°©e->
Ànbôs
)];

402 i‡(()(
hîe
.
bôs
) <= bits) ;

403 
	`PULLBYTE
();

405 i‡(
hîe
.
vÆ
 < 16) {

406 
	`DROPBITS
(
hîe
.
bôs
);

407 
°©e
->
Àns
[°©e->
have
++] = 
hîe
.
vÆ
;

410 i‡(
hîe
.
vÆ
 == 16) {

411 
	`NEEDBITS
(
hîe
.
bôs
 + 2);

412 
	`DROPBITS
(
hîe
.
bôs
);

413 i‡(
°©e
->
have
 == 0) {

414 
°rm
->
msg
 = (*)"invalid bitÜengthÑepeat";

415 
°©e
->
mode
 = 
BAD
;

418 
Àn
 = ()(
°©e
->
Àns
[°©e->
have
 - 1]);

419 
c›y
 = 3 + 
	`BITS
(2);

420 
	`DROPBITS
(2);

422 i‡(
hîe
.
vÆ
 == 17) {

423 
	`NEEDBITS
(
hîe
.
bôs
 + 3);

424 
	`DROPBITS
(
hîe
.
bôs
);

425 
Àn
 = 0;

426 
c›y
 = 3 + 
	`BITS
(3);

427 
	`DROPBITS
(3);

430 
	`NEEDBITS
(
hîe
.
bôs
 + 7);

431 
	`DROPBITS
(
hîe
.
bôs
);

432 
Àn
 = 0;

433 
c›y
 = 11 + 
	`BITS
(7);

434 
	`DROPBITS
(7);

436 i‡(
°©e
->
have
 + 
c›y
 > sèã->
∆í
 + sèã->
ndi°
) {

437 
°rm
->
msg
 = (*)"invalid bitÜengthÑepeat";

438 
°©e
->
mode
 = 
BAD
;

441 
c›y
--)

442 
°©e
->
Àns
[°©e->
have
++] = ()
Àn
;

447 i‡(
°©e
->
mode
 =
BAD
) ;

450 i‡(
°©e
->
Àns
[256] == 0) {

451 
°rm
->
msg
 = (*)"invalid code -- missingÉnd-of-block";

452 
°©e
->
mode
 = 
BAD
;

459 
°©e
->
√xt
 = sèã->
codes
;

460 
°©e
->
Àncode
 = (
code
 c⁄° 
FAR
 *)(°©e->
√xt
);

461 
°©e
->
Ànbôs
 = 9;

462 
ªt
 = 
	`öÊ©e_èbÀ
(
LENS
, 
°©e
->
Àns
, sèã->
∆í
, &(°©e->
√xt
),

463 &(
°©e
->
Ànbôs
), sèã->
w‹k
);

464 i‡(
ªt
) {

465 
°rm
->
msg
 = (*)"invalidÜiteral/lengths set";

466 
°©e
->
mode
 = 
BAD
;

469 
°©e
->
di°code
 = (
code
 c⁄° 
FAR
 *)(°©e->
√xt
);

470 
°©e
->
di°bôs
 = 6;

471 
ªt
 = 
	`öÊ©e_èbÀ
(
DISTS
, 
°©e
->
Àns
 + sèã->
∆í
, sèã->
ndi°
,

472 &(
°©e
->
√xt
), &(°©e->
di°bôs
), sèã->
w‹k
);

473 i‡(
ªt
) {

474 
°rm
->
msg
 = (*)"invalid distances set";

475 
°©e
->
mode
 = 
BAD
;

478 
	`Tø˚v
((
°dîr
, "inflate: codes ok\n"));

479 
°©e
->
mode
 = 
LEN
;

481 
LEN
:

483 i‡(
have
 >6 && 
À·
 >= 258) {

484 
	`RESTORE
();

485 i‡(
°©e
->
whave
 < sèã->
wsize
)

486 
°©e
->
whave
 = sèã->
wsize
 - 
À·
;

487 
	`öÊ©e_Á°
(
°rm
, 
°©e
->
wsize
);

488 
	`LOAD
();

494 
hîe
 = 
°©e
->
Àncode
[
	`BITS
(°©e->
Ànbôs
)];

495 i‡(()(
hîe
.
bôs
) <= bits) ;

496 
	`PULLBYTE
();

498 i‡(
hîe
.
›
 && (here.op & 0xf0) == 0) {

499 
œ°
 = 
hîe
;

501 
hîe
 = 
°©e
->
Àncode
[
œ°
.
vÆ
 +

502 (
	`BITS
(
œ°
.
bôs
 +Üa°.
›
) >>Üast.bits)];

503 i‡(()(
œ°
.
bôs
 + 
hîe
.bits) <= bits) ;

504 
	`PULLBYTE
();

506 
	`DROPBITS
(
œ°
.
bôs
);

508 
	`DROPBITS
(
hîe
.
bôs
);

509 
°©e
->
Àngth
 = ()
hîe
.
vÆ
;

512 i‡(
hîe
.
›
 == 0) {

513 
	`Tø˚vv
((
°dîr
, 
hîe
.
vÆ
 >= 0x20 && here.val < 0x7f ?

515 "öÊ©e:ÜôîÆ 0x%02x\n", 
hîe
.
vÆ
));

516 
	`ROOM
();

517 *
put
++ = ()(
°©e
->
Àngth
);

518 
À·
--;

519 
°©e
->
mode
 = 
LEN
;

524 i‡(
hîe
.
›
 & 32) {

525 
	`Tø˚vv
((
°dîr
, "inflate:Énd of block\n"));

526 
°©e
->
mode
 = 
TYPE
;

531 i‡(
hîe
.
›
 & 64) {

532 
°rm
->
msg
 = (*)"invalidÜiteral/length code";

533 
°©e
->
mode
 = 
BAD
;

538 
°©e
->
exåa
 = ()(
hîe
.
›
) & 15;

539 i‡(
°©e
->
exåa
 != 0) {

540 
	`NEEDBITS
(
°©e
->
exåa
);

541 
°©e
->
Àngth
 +
	`BITS
(°©e->
exåa
);

542 
	`DROPBITS
(
°©e
->
exåa
);

544 
	`Tø˚vv
((
°dîr
, "öÊ©e:Üígth %u\n", 
°©e
->
Àngth
));

548 
hîe
 = 
°©e
->
di°code
[
	`BITS
(°©e->
di°bôs
)];

549 i‡(()(
hîe
.
bôs
) <= bits) ;

550 
	`PULLBYTE
();

552 i‡((
hîe
.
›
 & 0xf0) == 0) {

553 
œ°
 = 
hîe
;

555 
hîe
 = 
°©e
->
di°code
[
œ°
.
vÆ
 +

556 (
	`BITS
(
œ°
.
bôs
 +Üa°.
›
) >>Üast.bits)];

557 i‡(()(
œ°
.
bôs
 + 
hîe
.bits) <= bits) ;

558 
	`PULLBYTE
();

560 
	`DROPBITS
(
œ°
.
bôs
);

562 
	`DROPBITS
(
hîe
.
bôs
);

563 i‡(
hîe
.
›
 & 64) {

564 
°rm
->
msg
 = (*)"invalid distance code";

565 
°©e
->
mode
 = 
BAD
;

568 
°©e
->
off£t
 = ()
hîe
.
vÆ
;

571 
°©e
->
exåa
 = ()(
hîe
.
›
) & 15;

572 i‡(
°©e
->
exåa
 != 0) {

573 
	`NEEDBITS
(
°©e
->
exåa
);

574 
°©e
->
off£t
 +
	`BITS
(°©e->
exåa
);

575 
	`DROPBITS
(
°©e
->
exåa
);

577 i‡(
°©e
->
off£t
 > sèã->
wsize
 - (°©e->
whave
 < state->wsize ?

578 
À·
 : 0)) {

579 
°rm
->
msg
 = (*)"invalid distanceÅoo far back";

580 
°©e
->
mode
 = 
BAD
;

583 
	`Tø˚vv
((
°dîr
, "öÊ©e: di°™˚ %u\n", 
°©e
->
off£t
));

587 
	`ROOM
();

588 
c›y
 = 
°©e
->
wsize
 - sèã->
off£t
;

589 i‡(
c›y
 < 
À·
) {

590 
‰om
 = 
put
 + 
c›y
;

591 
c›y
 = 
À·
 - copy;

594 
‰om
 = 
put
 - 
°©e
->
off£t
;

595 
c›y
 = 
À·
;

597 i‡(
c›y
 > 
°©e
->
Àngth
) copy = state->length;

598 
°©e
->
Àngth
 -
c›y
;

599 
À·
 -
c›y
;

601 *
put
++ = *
‰om
++;

602 } --
c›y
);

603 } 
°©e
->
Àngth
 != 0);

606 
DONE
:

608 
ªt
 = 
Z_STREAM_END
;

609 i‡(
À·
 < 
°©e
->
wsize
) {

610 i‡(
	`out
(
out_desc
, 
°©e
->
wödow
, sèã->
wsize
 - 
À·
))

611 
ªt
 = 
Z_BUF_ERROR
;

613 
öf_Àave
;

615 
BAD
:

616 
ªt
 = 
Z_DATA_ERROR
;

617 
öf_Àave
;

620 
ªt
 = 
Z_STREAM_ERROR
;

621 
öf_Àave
;

625 
öf_Àave
:

626 
°rm
->
√xt_ö
 = 
√xt
;

627 
°rm
->
avaû_ö
 = 
have
;

628  
ªt
;

629 
	}
}

631 
ZEXPORT
 
	$öÊ©eBackEnd
(
°rm
)

632 
z_°ªamp
 
°rm
;

634 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 =Z_NULL || såm->
z‰ì
 =(
‰ì_func
)0)

635  
Z_STREAM_ERROR
;

636 
	`ZFREE
(
°rm
, såm->
°©e
);

637 
°rm
->
°©e
 = 
Z_NULL
;

638 
	`Tø˚v
((
°dîr
, "inflate:Énd\n"));

639  
Z_OK
;

640 
	}
}

	@zlib-1.2.8/inffast.c

6 
	~"zutû.h
"

7 
	~"ö·ªes.h
"

8 
	~"öÊ©e.h
"

9 
	~"öfÁ°.h
"

11 #i‚de‡
ASMINF


24 #ifde‡
POSTINC


25 
	#OFF
 0

	)

26 
	#PUP
(
a
Ë*◊)++

	)

28 
	#OFF
 1

	)

29 
	#PUP
(
a
Ë*++◊)

	)

67 
ZLIB_INTERNAL
 
	$öÊ©e_Á°
(
°rm
, 
°¨t
)

68 
z_°ªamp
 
°rm
;

69 
°¨t
;

71 
öÊ©e_°©e
 
FAR
 *
°©e
;

72 
z_c⁄°
 
FAR
 *
ö
;

73 
z_c⁄°
 
FAR
 *
œ°
;

74 
FAR
 *
out
;

75 
FAR
 *
beg
;

76 
FAR
 *
íd
;

77 #ifde‡
INFLATE_STRICT


78 
dmax
;

80 
wsize
;

81 
whave
;

82 
w√xt
;

83 
FAR
 *
wödow
;

84 
hﬁd
;

85 
bôs
;

86 
code
 c⁄° 
FAR
 *
lcode
;

87 
code
 c⁄° 
FAR
 *
dcode
;

88 
lmask
;

89 
dmask
;

90 
code
 
hîe
;

91 
›
;

93 
Àn
;

94 
di°
;

95 
FAR
 *
‰om
;

98 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
°rm
->state;

99 
ö
 = 
°rm
->
√xt_ö
 - 
OFF
;

100 
œ°
 = 
ö
 + (
°rm
->
avaû_ö
 - 5);

101 
out
 = 
°rm
->
√xt_out
 - 
OFF
;

102 
beg
 = 
out
 - (
°¨t
 - 
°rm
->
avaû_out
);

103 
íd
 = 
out
 + (
°rm
->
avaû_out
 - 257);

104 #ifde‡
INFLATE_STRICT


105 
dmax
 = 
°©e
->dmax;

107 
wsize
 = 
°©e
->wsize;

108 
whave
 = 
°©e
->whave;

109 
w√xt
 = 
°©e
->wnext;

110 
wödow
 = 
°©e
->window;

111 
hﬁd
 = 
°©e
->hold;

112 
bôs
 = 
°©e
->bits;

113 
lcode
 = 
°©e
->
Àncode
;

114 
dcode
 = 
°©e
->
di°code
;

115 
lmask
 = (1U << 
°©e
->
Ànbôs
) - 1;

116 
dmask
 = (1U << 
°©e
->
di°bôs
) - 1;

121 i‡(
bôs
 < 15) {

122 
hﬁd
 +()(
	`PUP
(
ö
)Ë<< 
bôs
;

123 
bôs
 += 8;

124 
hﬁd
 +()(
	`PUP
(
ö
)Ë<< 
bôs
;

125 
bôs
 += 8;

127 
hîe
 = 
lcode
[
hﬁd
 & 
lmask
];

128 
dﬁí
:

129 
›
 = ()(
hîe
.
bôs
);

130 
hﬁd
 >>
›
;

131 
bôs
 -
›
;

132 
›
 = ()(
hîe
.op);

133 i‡(
›
 == 0) {

134 
	`Tø˚vv
((
°dîr
, 
hîe
.
vÆ
 >= 0x20 && here.val < 0x7f ?

136 "öÊ©e:ÜôîÆ 0x%02x\n", 
hîe
.
vÆ
));

137 
	`PUP
(
out
Ë()(
hîe
.
vÆ
);

139 i‡(
›
 & 16) {

140 
Àn
 = ()(
hîe
.
vÆ
);

141 
›
 &= 15;

142 i‡(
›
) {

143 i‡(
bôs
 < 
›
) {

144 
hﬁd
 +()(
	`PUP
(
ö
)Ë<< 
bôs
;

145 
bôs
 += 8;

147 
Àn
 +()
hﬁd
 & ((1U << 
›
) - 1);

148 
hﬁd
 >>
›
;

149 
bôs
 -
›
;

151 
	`Tø˚vv
((
°dîr
, "öÊ©e:Üígth %u\n", 
Àn
));

152 i‡(
bôs
 < 15) {

153 
hﬁd
 +()(
	`PUP
(
ö
)Ë<< 
bôs
;

154 
bôs
 += 8;

155 
hﬁd
 +()(
	`PUP
(
ö
)Ë<< 
bôs
;

156 
bôs
 += 8;

158 
hîe
 = 
dcode
[
hﬁd
 & 
dmask
];

159 
dodi°
:

160 
›
 = ()(
hîe
.
bôs
);

161 
hﬁd
 >>
›
;

162 
bôs
 -
›
;

163 
›
 = ()(
hîe
.op);

164 i‡(
›
 & 16) {

165 
di°
 = ()(
hîe
.
vÆ
);

166 
›
 &= 15;

167 i‡(
bôs
 < 
›
) {

168 
hﬁd
 +()(
	`PUP
(
ö
)Ë<< 
bôs
;

169 
bôs
 += 8;

170 i‡(
bôs
 < 
›
) {

171 
hﬁd
 +()(
	`PUP
(
ö
)Ë<< 
bôs
;

172 
bôs
 += 8;

175 
di°
 +()
hﬁd
 & ((1U << 
›
) - 1);

176 #ifde‡
INFLATE_STRICT


177 i‡(
di°
 > 
dmax
) {

178 
°rm
->
msg
 = (*)"invalid distanceÅoo far back";

179 
°©e
->
mode
 = 
BAD
;

183 
hﬁd
 >>
›
;

184 
bôs
 -
›
;

185 
	`Tø˚vv
((
°dîr
, "öÊ©e: di°™˚ %u\n", 
di°
));

186 
›
 = ()(
out
 - 
beg
);

187 i‡(
di°
 > 
›
) {

188 
›
 = 
di°
 - op;

189 i‡(
›
 > 
whave
) {

190 i‡(
°©e
->
ß√
) {

191 
°rm
->
msg
 =

193 
°©e
->
mode
 = 
BAD
;

196 #ifde‡
INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR


197 i‡(
Àn
 <
›
 - 
whave
) {

199 
	`PUP
(
out
) = 0;

200 } --
Àn
);

203 
Àn
 -
›
 - 
whave
;

205 
	`PUP
(
out
) = 0;

206 } --
›
 > 
whave
);

207 i‡(
›
 == 0) {

208 
‰om
 = 
out
 - 
di°
;

210 
	`PUP
(
out
ËPUP(
‰om
);

211 } --
Àn
);

216 
‰om
 = 
wödow
 - 
OFF
;

217 i‡(
w√xt
 == 0) {

218 
‰om
 +
wsize
 - 
›
;

219 i‡(
›
 < 
Àn
) {

220 
Àn
 -
›
;

222 
	`PUP
(
out
ËPUP(
‰om
);

223 } --
›
);

224 
‰om
 = 
out
 - 
di°
;

227 i‡(
w√xt
 < 
›
) {

228 
‰om
 +
wsize
 + 
w√xt
 - 
›
;

229 
›
 -
w√xt
;

230 i‡(
›
 < 
Àn
) {

231 
Àn
 -
›
;

233 
	`PUP
(
out
ËPUP(
‰om
);

234 } --
›
);

235 
‰om
 = 
wödow
 - 
OFF
;

236 i‡(
w√xt
 < 
Àn
) {

237 
›
 = 
w√xt
;

238 
Àn
 -
›
;

240 
	`PUP
(
out
ËPUP(
‰om
);

241 } --
›
);

242 
‰om
 = 
out
 - 
di°
;

247 
‰om
 +
w√xt
 - 
›
;

248 i‡(
›
 < 
Àn
) {

249 
Àn
 -
›
;

251 
	`PUP
(
out
ËPUP(
‰om
);

252 } --
›
);

253 
‰om
 = 
out
 - 
di°
;

256 
Àn
 > 2) {

257 
	`PUP
(
out
ËPUP(
‰om
);

258 
	`PUP
(
out
ËPUP(
‰om
);

259 
	`PUP
(
out
ËPUP(
‰om
);

260 
Àn
 -= 3;

262 i‡(
Àn
) {

263 
	`PUP
(
out
ËPUP(
‰om
);

264 i‡(
Àn
 > 1)

265 
	`PUP
(
out
ËPUP(
‰om
);

269 
‰om
 = 
out
 - 
di°
;

271 
	`PUP
(
out
ËPUP(
‰om
);

272 
	`PUP
(
out
ËPUP(
‰om
);

273 
	`PUP
(
out
ËPUP(
‰om
);

274 
Àn
 -= 3;

275 } 
Àn
 > 2);

276 i‡(
Àn
) {

277 
	`PUP
(
out
ËPUP(
‰om
);

278 i‡(
Àn
 > 1)

279 
	`PUP
(
out
ËPUP(
‰om
);

283 i‡((
›
 & 64) == 0) {

284 
hîe
 = 
dcode
[hîe.
vÆ
 + (
hﬁd
 & ((1U << 
›
) - 1))];

285 
dodi°
;

288 
°rm
->
msg
 = (*)"invalid distance code";

289 
°©e
->
mode
 = 
BAD
;

293 i‡((
›
 & 64) == 0) {

294 
hîe
 = 
lcode
[hîe.
vÆ
 + (
hﬁd
 & ((1U << 
›
) - 1))];

295 
dﬁí
;

297 i‡(
›
 & 32) {

298 
	`Tø˚vv
((
°dîr
, "inflate:Énd of block\n"));

299 
°©e
->
mode
 = 
TYPE
;

303 
°rm
->
msg
 = (*)"invalidÜiteral/length code";

304 
°©e
->
mode
 = 
BAD
;

307 } 
ö
 < 
œ°
 && 
out
 < 
íd
);

310 
Àn
 = 
bôs
 >> 3;

311 
ö
 -
Àn
;

312 
bôs
 -
Àn
 << 3;

313 
hﬁd
 &(1U << 
bôs
) - 1;

316 
°rm
->
√xt_ö
 = 
ö
 + 
OFF
;

317 
°rm
->
√xt_out
 = 
out
 + 
OFF
;

318 
°rm
->
avaû_ö
 = ()(
ö
 < 
œ°
 ? 5 + (last - in) : 5 - (in -Üast));

319 
°rm
->
avaû_out
 = ()(
out
 < 
íd
 ?

320 257 + (
íd
 - 
out
) : 257 - (out -Énd));

321 
°©e
->
hﬁd
 = hold;

322 
°©e
->
bôs
 = bits;

324 
	}
}

	@zlib-1.2.8/inffast.h

11 
ZLIB_INTERNAL
 
öÊ©e_Á°
 
OF
((
z_°ªamp
 
°rm
, 
°¨t
));

	@zlib-1.2.8/inffixed.h

10 c⁄° 
code
 
	gÀnfix
[512] = {

87 c⁄° 
code
 
	gdi°fix
[32] = {

	@zlib-1.2.8/inflate.c

83 
	~"zutû.h
"

84 
	~"ö·ªes.h
"

85 
	~"öÊ©e.h
"

86 
	~"öfÁ°.h
"

88 #ifde‡
MAKEFIXED


89 #i‚de‡
BUILDFIXED


90 
	#BUILDFIXED


	)

95 
loˇl
 
fixedèbÀs
 
OF
((
öÊ©e_°©e
 
FAR
 *
°©e
));

96 
loˇl
 
upd©ewödow
 
OF
((
z_°ªamp
 
°rm
, c⁄° 
FAR
 *
íd
,

97 
c›y
));

98 #ifde‡
BUILDFIXED


99 
makefixed
 
OF
(());

101 
loˇl
 
sync£¨ch
 
OF
((
FAR
 *
have
, c⁄° FAR *
buf
,

102 
Àn
));

104 
ZEXPORT
 
	$öÊ©eRe£tKìp
(
°rm
)

105 
z_°ªamp
 
°rm
;

107 
öÊ©e_°©e
 
FAR
 *
°©e
;

109 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 =Z_NULLË 
Z_STREAM_ERROR
;

110 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
°rm
->state;

111 
°rm
->
tŸÆ_ö
 = såm->
tŸÆ_out
 = 
°©e
->
tŸÆ
 = 0;

112 
°rm
->
msg
 = 
Z_NULL
;

113 i‡(
°©e
->
wøp
)

114 
°rm
->
adÀr
 = 
°©e
->
wøp
 & 1;

115 
°©e
->
mode
 = 
HEAD
;

116 
°©e
->
œ°
 = 0;

117 
°©e
->
havedi˘
 = 0;

118 
°©e
->
dmax
 = 32768U;

119 
°©e
->
hód
 = 
Z_NULL
;

120 
°©e
->
hﬁd
 = 0;

121 
°©e
->
bôs
 = 0;

122 
°©e
->
Àncode
 = sèã->
di°code
 = sèã->
√xt
 = sèã->
codes
;

123 
°©e
->
ß√
 = 1;

124 
°©e
->
back
 = -1;

125 
	`Tø˚v
((
°dîr
, "inflate:Ñeset\n"));

126  
Z_OK
;

127 
	}
}

129 
ZEXPORT
 
	$öÊ©eRe£t
(
°rm
)

130 
z_°ªamp
 
°rm
;

132 
öÊ©e_°©e
 
FAR
 *
°©e
;

134 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 =Z_NULLË 
Z_STREAM_ERROR
;

135 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
°rm
->state;

136 
°©e
->
wsize
 = 0;

137 
°©e
->
whave
 = 0;

138 
°©e
->
w√xt
 = 0;

139  
	`öÊ©eRe£tKìp
(
°rm
);

140 
	}
}

142 
ZEXPORT
 
	$öÊ©eRe£t2
(
°rm
, 
wödowBôs
)

143 
z_°ªamp
 
°rm
;

144 
wödowBôs
;

146 
wøp
;

147 
öÊ©e_°©e
 
FAR
 *
°©e
;

150 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 =Z_NULLË 
Z_STREAM_ERROR
;

151 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
°rm
->state;

154 i‡(
wödowBôs
 < 0) {

155 
wøp
 = 0;

156 
wödowBôs
 = -windowBits;

159 
wøp
 = (
wödowBôs
 >> 4) + 1;

160 #ifde‡
GUNZIP


161 i‡(
wödowBôs
 < 48)

162 
wödowBôs
 &= 15;

167 i‡(
wödowBôs
 && (windowBits < 8 || windowBits > 15))

168  
Z_STREAM_ERROR
;

169 i‡(
°©e
->
wödow
 !
Z_NULL
 && sèã->
wbôs
 !()
wödowBôs
) {

170 
	`ZFREE
(
°rm
, 
°©e
->
wödow
);

171 
°©e
->
wödow
 = 
Z_NULL
;

175 
°©e
->
wøp
 = wrap;

176 
°©e
->
wbôs
 = ()
wödowBôs
;

177  
	`öÊ©eRe£t
(
°rm
);

178 
	}
}

180 
ZEXPORT
 
	$öÊ©eInô2_
(
°rm
, 
wödowBôs
, 
vîsi⁄
, 
°ªam_size
)

181 
z_°ªamp
 
°rm
;

182 
wödowBôs
;

183 c⁄° *
vîsi⁄
;

184 
°ªam_size
;

186 
ªt
;

187 
öÊ©e_°©e
 
FAR
 *
°©e
;

189 i‡(
vîsi⁄
 =
Z_NULL
 || vîsi⁄[0] !
ZLIB_VERSION
[0] ||

190 
°ªam_size
 !()((
z_°ªam
)))

191  
Z_VERSION_ERROR
;

192 i‡(
°rm
 =
Z_NULL
Ë 
Z_STREAM_ERROR
;

193 
°rm
->
msg
 = 
Z_NULL
;

194 i‡(
°rm
->
zÆloc
 =(
Æloc_func
)0) {

195 #ifde‡
Z_SOLO


196  
Z_STREAM_ERROR
;

198 
°rm
->
zÆloc
 = 
zˇŒoc
;

199 
°rm
->
›aque
 = (
voidpf
)0;

202 i‡(
°rm
->
z‰ì
 =(
‰ì_func
)0)

203 #ifde‡
Z_SOLO


204  
Z_STREAM_ERROR
;

206 
°rm
->
z‰ì
 = 
zc‰ì
;

208 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)

209 
	`ZALLOC
(
°rm
, 1, (
öÊ©e_°©e
));

210 i‡(
°©e
 =
Z_NULL
Ë 
Z_MEM_ERROR
;

211 
	`Tø˚v
((
°dîr
, "inflate:állocated\n"));

212 
°rm
->
°©e
 = (
öã∫Æ_°©e
 
FAR
 *)state;

213 
°©e
->
wödow
 = 
Z_NULL
;

214 
ªt
 = 
	`öÊ©eRe£t2
(
°rm
, 
wödowBôs
);

215 i‡(
ªt
 !
Z_OK
) {

216 
	`ZFREE
(
°rm
, 
°©e
);

217 
°rm
->
°©e
 = 
Z_NULL
;

219  
ªt
;

220 
	}
}

222 
ZEXPORT
 
	$öÊ©eInô_
(
°rm
, 
vîsi⁄
, 
°ªam_size
)

223 
z_°ªamp
 
°rm
;

224 c⁄° *
vîsi⁄
;

225 
°ªam_size
;

227  
	`öÊ©eInô2_
(
°rm
, 
DEF_WBITS
, 
vîsi⁄
, 
°ªam_size
);

228 
	}
}

230 
ZEXPORT
 
	$öÊ©ePrime
(
°rm
, 
bôs
, 
vÆue
)

231 
z_°ªamp
 
°rm
;

232 
bôs
;

233 
vÆue
;

235 
öÊ©e_°©e
 
FAR
 *
°©e
;

237 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 =Z_NULLË 
Z_STREAM_ERROR
;

238 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
°rm
->state;

239 i‡(
bôs
 < 0) {

240 
°©e
->
hﬁd
 = 0;

241 
°©e
->
bôs
 = 0;

242  
Z_OK
;

244 i‡(
bôs
 > 16 || 
°©e
->bô†+ bô†> 32Ë 
Z_STREAM_ERROR
;

245 
vÆue
 &(1L << 
bôs
) - 1;

246 
°©e
->
hﬁd
 +
vÆue
 << sèã->
bôs
;

247 
°©e
->
bôs
 += bits;

248  
Z_OK
;

249 
	}
}

261 
loˇl
 
	$fixedèbÀs
(
°©e
)

262 
öÊ©e_°©e
 
FAR
 *
°©e
;

264 #ifde‡
BUILDFIXED


265 
vúgö
 = 1;

266 
code
 *
Ànfix
, *
di°fix
;

267 
code
 
fixed
[544];

270 i‡(
vúgö
) {

271 
sym
, 
bôs
;

272 
code
 *
√xt
;

275 
sym
 = 0;

276 
sym
 < 144Ë
°©e
->
Àns
[sym++] = 8;

277 
sym
 < 256Ë
°©e
->
Àns
[sym++] = 9;

278 
sym
 < 280Ë
°©e
->
Àns
[sym++] = 7;

279 
sym
 < 288Ë
°©e
->
Àns
[sym++] = 8;

280 
√xt
 = 
fixed
;

281 
Ànfix
 = 
√xt
;

282 
bôs
 = 9;

283 
	`öÊ©e_èbÀ
(
LENS
, 
°©e
->
Àns
, 288, &(
√xt
), &(
bôs
), sèã->
w‹k
);

286 
sym
 = 0;

287 
sym
 < 32Ë
°©e
->
Àns
[sym++] = 5;

288 
di°fix
 = 
√xt
;

289 
bôs
 = 5;

290 
	`öÊ©e_èbÀ
(
DISTS
, 
°©e
->
Àns
, 32, &(
√xt
), &(
bôs
), sèã->
w‹k
);

293 
vúgö
 = 0;

296 
	~"öffixed.h
"

298 
°©e
->
Àncode
 = 
Ànfix
;

299 
°©e
->
Ànbôs
 = 9;

300 
°©e
->
di°code
 = 
di°fix
;

301 
°©e
->
di°bôs
 = 5;

302 
	}
}

304 #ifde‡
MAKEFIXED


305 
	~<°dio.h
>

325 
	$makefixed
()

327 
low
, 
size
;

328 
öÊ©e_°©e
 
°©e
;

330 
	`fixedèbÀs
(&
°©e
);

331 
	`puts
(" /* inffixed.h --Åable for decoding fixed codes");

332 
	`puts
(" * Generatedáutomatically by makefixed().");

333 
	`puts
(" */");

334 
	`puts
("");

335 
	`puts
(" /* WARNING:Åhis file should *not* be used byápplications.");

336 
	`puts
(" It isÖart ofÅhe implementation ofÅhisÜibraryánd is");

337 
	`puts
(" subjectÅo change. Applications should only use zlib.h.");

338 
	`puts
(" */");

339 
	`puts
("");

340 
size
 = 1U << 9;

341 
	`¥ötf
(" sèti¯c⁄° codêÀnfix[%u] = {", 
size
);

342 
low
 = 0;

344 i‡((
low
 % 7Ë=0Ë
	`¥ötf
("\n ");

345 
	`¥ötf
("{%u,%u,%d}", (
low
 & 127Ë=99 ? 64 : 
°©e
.
Àncode
[low].
›
,

346 
°©e
.
Àncode
[
low
].
bôs
, sèã.Àncode[low].
vÆ
);

347 i‡(++
low
 =
size
) ;

348 
	`putch¨
(',');

350 
	`puts
("\n };");

351 
size
 = 1U << 5;

352 
	`¥ötf
("\¿ sèti¯c⁄° codêdi°fix[%u] = {", 
size
);

353 
low
 = 0;

355 i‡((
low
 % 6Ë=0Ë
	`¥ötf
("\n ");

356 
	`¥ötf
("{%u,%u,%d}", 
°©e
.
di°code
[
low
].
›
, sèã.di°code[low].
bôs
,

357 
°©e
.
di°code
[
low
].
vÆ
);

358 i‡(++
low
 =
size
) ;

359 
	`putch¨
(',');

361 
	`puts
("\n };");

362 
	}
}

379 
loˇl
 
	$upd©ewödow
(
°rm
, 
íd
, 
c›y
)

380 
z_°ªamp
 
°rm
;

381 c⁄° 
Byãf
 *
íd
;

382 
c›y
;

384 
öÊ©e_°©e
 
FAR
 *
°©e
;

385 
di°
;

387 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
°rm
->state;

390 i‡(
°©e
->
wödow
 =
Z_NULL
) {

391 
°©e
->
wödow
 = (
FAR
 *)

392 
	`ZALLOC
(
°rm
, 1U << 
°©e
->
wbôs
,

394 i‡(
°©e
->
wödow
 =
Z_NULL
)  1;

398 i‡(
°©e
->
wsize
 == 0) {

399 
°©e
->
wsize
 = 1U << sèã->
wbôs
;

400 
°©e
->
w√xt
 = 0;

401 
°©e
->
whave
 = 0;

405 i‡(
c›y
 >
°©e
->
wsize
) {

406 
	`zmem˝y
(
°©e
->
wödow
, 
íd
 - sèã->
wsize
, state->wsize);

407 
°©e
->
w√xt
 = 0;

408 
°©e
->
whave
 = sèã->
wsize
;

411 
di°
 = 
°©e
->
wsize
 - sèã->
w√xt
;

412 i‡(
di°
 > 
c›y
) dist = copy;

413 
	`zmem˝y
(
°©e
->
wödow
 + sèã->
w√xt
, 
íd
 - 
c›y
, 
di°
);

414 
c›y
 -
di°
;

415 i‡(
c›y
) {

416 
	`zmem˝y
(
°©e
->
wödow
, 
íd
 - 
c›y
, copy);

417 
°©e
->
w√xt
 = 
c›y
;

418 
°©e
->
whave
 = sèã->
wsize
;

421 
°©e
->
w√xt
 +
di°
;

422 i‡(
°©e
->
w√xt
 =°©e->
wsize
) state->wnext = 0;

423 i‡(
°©e
->
whave
 < sèã->
wsize
Ë°©e->whavê+
di°
;

427 
	}
}

432 #ifde‡
GUNZIP


433 
	#UPDATE
(
check
, 
buf
, 
Àn
) \

434 (
°©e
->
Êags
 ? 
	`¸c32
(
check
, 
buf
, 
Àn
Ë: 
	`adÀr32
(check, buf,Üí))

	)

436 
	#UPDATE
(
check
, 
buf
, 
Àn
Ë
	`adÀr32
(check, buf,Üí)

	)

440 #ifde‡
GUNZIP


441 
	#CRC2
(
check
, 
w‹d
) \

443 
hbuf
[0] = ()(
w‹d
); \

444 
hbuf
[1] = ()((
w‹d
) >> 8); \

445 
check
 = 
	`¸c32
(check, 
hbuf
, 2); \

446 } 0)

	)

448 
	#CRC4
(
check
, 
w‹d
) \

450 
hbuf
[0] = ()(
w‹d
); \

451 
hbuf
[1] = ()((
w‹d
) >> 8); \

452 
hbuf
[2] = ()((
w‹d
) >> 16); \

453 
hbuf
[3] = ()((
w‹d
) >> 24); \

454 
check
 = 
	`¸c32
(check, 
hbuf
, 4); \

455 } 0)

	)

459 
	#LOAD
() \

461 
put
 = 
°rm
->
√xt_out
; \

462 
À·
 = 
°rm
->
avaû_out
; \

463 
√xt
 = 
°rm
->
√xt_ö
; \

464 
have
 = 
°rm
->
avaû_ö
; \

465 
hﬁd
 = 
°©e
->hold; \

466 
bôs
 = 
°©e
->bits; \

467 } 0)

	)

470 
	#RESTORE
() \

472 
°rm
->
√xt_out
 = 
put
; \

473 
°rm
->
avaû_out
 = 
À·
; \

474 
°rm
->
√xt_ö
 = 
√xt
; \

475 
°rm
->
avaû_ö
 = 
have
; \

476 
°©e
->
hﬁd
 = hold; \

477 
°©e
->
bôs
 = bits; \

478 } 0)

	)

481 
	#INITBITS
() \

483 
hﬁd
 = 0; \

484 
bôs
 = 0; \

485 } 0)

	)

489 
	#PULLBYTE
() \

491 i‡(
have
 =0Ë
öf_Àave
; \

492 
have
--; \

493 
hﬁd
 +()(*
√xt
++Ë<< 
bôs
; \

494 
bôs
 += 8; \

495 } 0)

	)

499 
	#NEEDBITS
(
n
) \

501 
bôs
 < ()(
n
)) \

502 
	`PULLBYTE
(); \

503 } 0)

	)

506 
	#BITS
(
n
) \

507 (()
hﬁd
 & ((1U << (
n
)Ë- 1))

	)

510 
	#DROPBITS
(
n
) \

512 
hﬁd
 >>(
n
); \

513 
bôs
 -()(
n
); \

514 } 0)

	)

517 
	#BYTEBITS
() \

519 
hﬁd
 >>
bôs
 & 7; \

520 
bôs
 -= bits & 7; \

521 } 0)

	)

605 
ZEXPORT
 
	$öÊ©e
(
°rm
, 
Êush
)

606 
z_°ªamp
 
°rm
;

607 
Êush
;

609 
öÊ©e_°©e
 
FAR
 *
°©e
;

610 
z_c⁄°
 
FAR
 *
√xt
;

611 
FAR
 *
put
;

612 
have
, 
À·
;

613 
hﬁd
;

614 
bôs
;

615 
ö
, 
out
;

616 
c›y
;

617 
FAR
 *
‰om
;

618 
code
 
hîe
;

619 
code
 
œ°
;

620 
Àn
;

621 
ªt
;

622 #ifde‡
GUNZIP


623 
hbuf
[4];

625 c⁄° 
‹dî
[19] =

628 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 =Z_NULL || såm->
√xt_out
 == Z_NULL ||

629 (
°rm
->
√xt_ö
 =
Z_NULL
 && såm->
avaû_ö
 != 0))

630  
Z_STREAM_ERROR
;

632 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
°rm
->state;

633 i‡(
°©e
->
mode
 =
TYPE
Ë°©e->modê
TYPEDO
;

634 
	`LOAD
();

635 
ö
 = 
have
;

636 
out
 = 
À·
;

637 
ªt
 = 
Z_OK
;

639 
°©e
->
mode
) {

640 
HEAD
:

641 i‡(
°©e
->
wøp
 == 0) {

642 
°©e
->
mode
 = 
TYPEDO
;

645 
	`NEEDBITS
(16);

646 #ifde‡
GUNZIP


647 i‡((
°©e
->
wøp
 & 2Ë&& 
hﬁd
 == 0x8b1f) {

648 
°©e
->
check
 = 
	`¸c32
(0L, 
Z_NULL
, 0);

649 
	`CRC2
(
°©e
->
check
, 
hﬁd
);

650 
	`INITBITS
();

651 
°©e
->
mode
 = 
FLAGS
;

654 
°©e
->
Êags
 = 0;

655 i‡(
°©e
->
hód
 !
Z_NULL
)

656 
°©e
->
hód
->
d⁄e
 = -1;

657 i‡(!(
°©e
->
wøp
 & 1) ||

661 ((
	`BITS
(8Ë<< 8Ë+ (
hﬁd
 >> 8)) % 31) {

662 
°rm
->
msg
 = (*)"incorrect header check";

663 
°©e
->
mode
 = 
BAD
;

666 i‡(
	`BITS
(4Ë!
Z_DEFLATED
) {

667 
°rm
->
msg
 = (*)"unknown compression method";

668 
°©e
->
mode
 = 
BAD
;

671 
	`DROPBITS
(4);

672 
Àn
 = 
	`BITS
(4) + 8;

673 i‡(
°©e
->
wbôs
 == 0)

674 
°©e
->
wbôs
 = 
Àn
;

675 i‡(
Àn
 > 
°©e
->
wbôs
) {

676 
°rm
->
msg
 = (*)"invalid window size";

677 
°©e
->
mode
 = 
BAD
;

680 
°©e
->
dmax
 = 1U << 
Àn
;

681 
	`Tø˚v
((
°dîr
, "inflate: zlib header ok\n"));

682 
°rm
->
adÀr
 = 
°©e
->
check
 = 
	`adÀr32
(0L, 
Z_NULL
, 0);

683 
°©e
->
mode
 = 
hﬁd
 & 0x200 ? 
DICTID
 : 
TYPE
;

684 
	`INITBITS
();

686 #ifde‡
GUNZIP


687 
FLAGS
:

688 
	`NEEDBITS
(16);

689 
°©e
->
Êags
 = ()(
hﬁd
);

690 i‡((
°©e
->
Êags
 & 0xffË!
Z_DEFLATED
) {

691 
°rm
->
msg
 = (*)"unknown compression method";

692 
°©e
->
mode
 = 
BAD
;

695 i‡(
°©e
->
Êags
 & 0xe000) {

696 
°rm
->
msg
 = (*)"unknown header flags set";

697 
°©e
->
mode
 = 
BAD
;

700 i‡(
°©e
->
hód
 !
Z_NULL
)

701 
°©e
->
hód
->
ãxt
 = ()((
hﬁd
 >> 8) & 1);

702 i‡(
°©e
->
Êags
 & 0x0200Ë
	`CRC2
(°©e->
check
, 
hﬁd
);

703 
	`INITBITS
();

704 
°©e
->
mode
 = 
TIME
;

705 
TIME
:

706 
	`NEEDBITS
(32);

707 i‡(
°©e
->
hód
 !
Z_NULL
)

708 
°©e
->
hód
->
time
 = 
hﬁd
;

709 i‡(
°©e
->
Êags
 & 0x0200Ë
	`CRC4
(°©e->
check
, 
hﬁd
);

710 
	`INITBITS
();

711 
°©e
->
mode
 = 
OS
;

712 
OS
:

713 
	`NEEDBITS
(16);

714 i‡(
°©e
->
hód
 !
Z_NULL
) {

715 
°©e
->
hód
->
xÊags
 = ()(
hﬁd
 & 0xff);

716 
°©e
->
hód
->
os
 = ()(
hﬁd
 >> 8);

718 i‡(
°©e
->
Êags
 & 0x0200Ë
	`CRC2
(°©e->
check
, 
hﬁd
);

719 
	`INITBITS
();

720 
°©e
->
mode
 = 
EXLEN
;

721 
EXLEN
:

722 i‡(
°©e
->
Êags
 & 0x0400) {

723 
	`NEEDBITS
(16);

724 
°©e
->
Àngth
 = ()(
hﬁd
);

725 i‡(
°©e
->
hód
 !
Z_NULL
)

726 
°©e
->
hód
->
exåa_Àn
 = ()
hﬁd
;

727 i‡(
°©e
->
Êags
 & 0x0200Ë
	`CRC2
(°©e->
check
, 
hﬁd
);

728 
	`INITBITS
();

730 i‡(
°©e
->
hód
 !
Z_NULL
)

731 
°©e
->
hód
->
exåa
 = 
Z_NULL
;

732 
°©e
->
mode
 = 
EXTRA
;

733 
EXTRA
:

734 i‡(
°©e
->
Êags
 & 0x0400) {

735 
c›y
 = 
°©e
->
Àngth
;

736 i‡(
c›y
 > 
have
) copy = have;

737 i‡(
c›y
) {

738 i‡(
°©e
->
hód
 !
Z_NULL
 &&

739 
°©e
->
hód
->
exåa
 !
Z_NULL
) {

740 
Àn
 = 
°©e
->
hód
->
exåa_Àn
 - sèã->
Àngth
;

741 
	`zmem˝y
(
°©e
->
hód
->
exåa
 + 
Àn
, 
√xt
,

742 
Àn
 + 
c›y
 > 
°©e
->
hód
->
exåa_max
 ?

743 
°©e
->
hód
->
exåa_max
 - 
Àn
 : 
c›y
);

745 i‡(
°©e
->
Êags
 & 0x0200)

746 
°©e
->
check
 = 
	`¸c32
(°©e->check, 
√xt
, 
c›y
);

747 
have
 -
c›y
;

748 
√xt
 +
c›y
;

749 
°©e
->
Àngth
 -
c›y
;

751 i‡(
°©e
->
Àngth
Ë
öf_Àave
;

753 
°©e
->
Àngth
 = 0;

754 
°©e
->
mode
 = 
NAME
;

755 
NAME
:

756 i‡(
°©e
->
Êags
 & 0x0800) {

757 i‡(
have
 =0Ë
öf_Àave
;

758 
c›y
 = 0;

760 
Àn
 = ()(
√xt
[
c›y
++]);

761 i‡(
°©e
->
hód
 !
Z_NULL
 &&

762 
°©e
->
hód
->
«me
 !
Z_NULL
 &&

763 
°©e
->
Àngth
 < sèã->
hód
->
«me_max
)

764 
°©e
->
hód
->
«me
[°©e->
Àngth
++] = 
Àn
;

765 } 
Àn
 && 
c›y
 < 
have
);

766 i‡(
°©e
->
Êags
 & 0x0200)

767 
°©e
->
check
 = 
	`¸c32
(°©e->check, 
√xt
, 
c›y
);

768 
have
 -
c›y
;

769 
√xt
 +
c›y
;

770 i‡(
Àn
Ë
öf_Àave
;

772 i‡(
°©e
->
hód
 !
Z_NULL
)

773 
°©e
->
hód
->
«me
 = 
Z_NULL
;

774 
°©e
->
Àngth
 = 0;

775 
°©e
->
mode
 = 
COMMENT
;

776 
COMMENT
:

777 i‡(
°©e
->
Êags
 & 0x1000) {

778 i‡(
have
 =0Ë
öf_Àave
;

779 
c›y
 = 0;

781 
Àn
 = ()(
√xt
[
c›y
++]);

782 i‡(
°©e
->
hód
 !
Z_NULL
 &&

783 
°©e
->
hód
->
commít
 !
Z_NULL
 &&

784 
°©e
->
Àngth
 < sèã->
hód
->
comm_max
)

785 
°©e
->
hód
->
commít
[°©e->
Àngth
++] = 
Àn
;

786 } 
Àn
 && 
c›y
 < 
have
);

787 i‡(
°©e
->
Êags
 & 0x0200)

788 
°©e
->
check
 = 
	`¸c32
(°©e->check, 
√xt
, 
c›y
);

789 
have
 -
c›y
;

790 
√xt
 +
c›y
;

791 i‡(
Àn
Ë
öf_Àave
;

793 i‡(
°©e
->
hód
 !
Z_NULL
)

794 
°©e
->
hód
->
commít
 = 
Z_NULL
;

795 
°©e
->
mode
 = 
HCRC
;

796 
HCRC
:

797 i‡(
°©e
->
Êags
 & 0x0200) {

798 
	`NEEDBITS
(16);

799 i‡(
hﬁd
 !(
°©e
->
check
 & 0xffff)) {

800 
°rm
->
msg
 = (*)"header crc mismatch";

801 
°©e
->
mode
 = 
BAD
;

804 
	`INITBITS
();

806 i‡(
°©e
->
hód
 !
Z_NULL
) {

807 
°©e
->
hód
->
h¸c
 = ()((°©e->
Êags
 >> 9) & 1);

808 
°©e
->
hód
->
d⁄e
 = 1;

810 
°rm
->
adÀr
 = 
°©e
->
check
 = 
	`¸c32
(0L, 
Z_NULL
, 0);

811 
°©e
->
mode
 = 
TYPE
;

814 
DICTID
:

815 
	`NEEDBITS
(32);

816 
°rm
->
adÀr
 = 
°©e
->
check
 = 
	`ZSWAP32
(
hﬁd
);

817 
	`INITBITS
();

818 
°©e
->
mode
 = 
DICT
;

819 
DICT
:

820 i‡(
°©e
->
havedi˘
 == 0) {

821 
	`RESTORE
();

822  
Z_NEED_DICT
;

824 
°rm
->
adÀr
 = 
°©e
->
check
 = 
	`adÀr32
(0L, 
Z_NULL
, 0);

825 
°©e
->
mode
 = 
TYPE
;

826 
TYPE
:

827 i‡(
Êush
 =
Z_BLOCK
 || flush =
Z_TREES
Ë
öf_Àave
;

828 
TYPEDO
:

829 i‡(
°©e
->
œ°
) {

830 
	`BYTEBITS
();

831 
°©e
->
mode
 = 
CHECK
;

834 
	`NEEDBITS
(3);

835 
°©e
->
œ°
 = 
	`BITS
(1);

836 
	`DROPBITS
(1);

837 
	`BITS
(2)) {

839 
	`Tø˚v
((
°dîr
, "inflate: stored block%s\n",

840 
°©e
->
œ°
 ? " (last)" : ""));

841 
°©e
->
mode
 = 
STORED
;

844 
	`fixedèbÀs
(
°©e
);

845 
	`Tø˚v
((
°dîr
, "inflate: fixed codes block%s\n",

846 
°©e
->
œ°
 ? " (last)" : ""));

847 
°©e
->
mode
 = 
LEN_
;

848 i‡(
Êush
 =
Z_TREES
) {

849 
	`DROPBITS
(2);

850 
öf_Àave
;

854 
	`Tø˚v
((
°dîr
, "inflate: dynamic codes block%s\n",

855 
°©e
->
œ°
 ? " (last)" : ""));

856 
°©e
->
mode
 = 
TABLE
;

859 
°rm
->
msg
 = (*)"invalid blockÅype";

860 
°©e
->
mode
 = 
BAD
;

862 
	`DROPBITS
(2);

864 
STORED
:

865 
	`BYTEBITS
();

866 
	`NEEDBITS
(32);

867 i‡((
hﬁd
 & 0xffff) != ((hold >> 16) ^ 0xffff)) {

868 
°rm
->
msg
 = (*)"invalid stored blockÜengths";

869 
°©e
->
mode
 = 
BAD
;

872 
°©e
->
Àngth
 = ()
hﬁd
 & 0xffff;

873 
	`Tø˚v
((
°dîr
, "inflate: storedÜength %u\n",

874 
°©e
->
Àngth
));

875 
	`INITBITS
();

876 
°©e
->
mode
 = 
COPY_
;

877 i‡(
Êush
 =
Z_TREES
Ë
öf_Àave
;

878 
COPY_
:

879 
°©e
->
mode
 = 
COPY
;

880 
COPY
:

881 
c›y
 = 
°©e
->
Àngth
;

882 i‡(
c›y
) {

883 i‡(
c›y
 > 
have
) copy = have;

884 i‡(
c›y
 > 
À·
) copy =Üeft;

885 i‡(
c›y
 =0Ë
öf_Àave
;

886 
	`zmem˝y
(
put
, 
√xt
, 
c›y
);

887 
have
 -
c›y
;

888 
√xt
 +
c›y
;

889 
À·
 -
c›y
;

890 
put
 +
c›y
;

891 
°©e
->
Àngth
 -
c›y
;

894 
	`Tø˚v
((
°dîr
, "inflate: storedÉnd\n"));

895 
°©e
->
mode
 = 
TYPE
;

897 
TABLE
:

898 
	`NEEDBITS
(14);

899 
°©e
->
∆í
 = 
	`BITS
(5) + 257;

900 
	`DROPBITS
(5);

901 
°©e
->
ndi°
 = 
	`BITS
(5) + 1;

902 
	`DROPBITS
(5);

903 
°©e
->
ncode
 = 
	`BITS
(4) + 4;

904 
	`DROPBITS
(4);

905 #i‚de‡
PKZIP_BUG_WORKAROUND


906 i‡(
°©e
->
∆í
 > 286 || sèã->
ndi°
 > 30) {

907 
°rm
->
msg
 = (*)"too manyÜength or distance symbols";

908 
°©e
->
mode
 = 
BAD
;

912 
	`Tø˚v
((
°dîr
, "inflate:Åable sizes ok\n"));

913 
°©e
->
have
 = 0;

914 
°©e
->
mode
 = 
LENLENS
;

915 
LENLENS
:

916 
°©e
->
have
 < sèã->
ncode
) {

917 
	`NEEDBITS
(3);

918 
°©e
->
Àns
[
‹dî
[°©e->
have
++]] = ()
	`BITS
(3);

919 
	`DROPBITS
(3);

921 
°©e
->
have
 < 19)

922 
°©e
->
Àns
[
‹dî
[°©e->
have
++]] = 0;

923 
°©e
->
√xt
 = sèã->
codes
;

924 
°©e
->
Àncode
 = (c⁄° 
code
 
FAR
 *)(°©e->
√xt
);

925 
°©e
->
Ànbôs
 = 7;

926 
ªt
 = 
	`öÊ©e_èbÀ
(
CODES
, 
°©e
->
Àns
, 19, &(°©e->
√xt
),

927 &(
°©e
->
Ànbôs
), sèã->
w‹k
);

928 i‡(
ªt
) {

929 
°rm
->
msg
 = (*)"invalid codeÜengths set";

930 
°©e
->
mode
 = 
BAD
;

933 
	`Tø˚v
((
°dîr
, "inflate: codeÜengths ok\n"));

934 
°©e
->
have
 = 0;

935 
°©e
->
mode
 = 
CODELENS
;

936 
CODELENS
:

937 
°©e
->
have
 < sèã->
∆í
 + sèã->
ndi°
) {

939 
hîe
 = 
°©e
->
Àncode
[
	`BITS
(°©e->
Ànbôs
)];

940 i‡(()(
hîe
.
bôs
) <= bits) ;

941 
	`PULLBYTE
();

943 i‡(
hîe
.
vÆ
 < 16) {

944 
	`DROPBITS
(
hîe
.
bôs
);

945 
°©e
->
Àns
[°©e->
have
++] = 
hîe
.
vÆ
;

948 i‡(
hîe
.
vÆ
 == 16) {

949 
	`NEEDBITS
(
hîe
.
bôs
 + 2);

950 
	`DROPBITS
(
hîe
.
bôs
);

951 i‡(
°©e
->
have
 == 0) {

952 
°rm
->
msg
 = (*)"invalid bitÜengthÑepeat";

953 
°©e
->
mode
 = 
BAD
;

956 
Àn
 = 
°©e
->
Àns
[°©e->
have
 - 1];

957 
c›y
 = 3 + 
	`BITS
(2);

958 
	`DROPBITS
(2);

960 i‡(
hîe
.
vÆ
 == 17) {

961 
	`NEEDBITS
(
hîe
.
bôs
 + 3);

962 
	`DROPBITS
(
hîe
.
bôs
);

963 
Àn
 = 0;

964 
c›y
 = 3 + 
	`BITS
(3);

965 
	`DROPBITS
(3);

968 
	`NEEDBITS
(
hîe
.
bôs
 + 7);

969 
	`DROPBITS
(
hîe
.
bôs
);

970 
Àn
 = 0;

971 
c›y
 = 11 + 
	`BITS
(7);

972 
	`DROPBITS
(7);

974 i‡(
°©e
->
have
 + 
c›y
 > sèã->
∆í
 + sèã->
ndi°
) {

975 
°rm
->
msg
 = (*)"invalid bitÜengthÑepeat";

976 
°©e
->
mode
 = 
BAD
;

979 
c›y
--)

980 
°©e
->
Àns
[°©e->
have
++] = ()
Àn
;

985 i‡(
°©e
->
mode
 =
BAD
) ;

988 i‡(
°©e
->
Àns
[256] == 0) {

989 
°rm
->
msg
 = (*)"invalid code -- missingÉnd-of-block";

990 
°©e
->
mode
 = 
BAD
;

997 
°©e
->
√xt
 = sèã->
codes
;

998 
°©e
->
Àncode
 = (c⁄° 
code
 
FAR
 *)(°©e->
√xt
);

999 
°©e
->
Ànbôs
 = 9;

1000 
ªt
 = 
	`öÊ©e_èbÀ
(
LENS
, 
°©e
->
Àns
, sèã->
∆í
, &(°©e->
√xt
),

1001 &(
°©e
->
Ànbôs
), sèã->
w‹k
);

1002 i‡(
ªt
) {

1003 
°rm
->
msg
 = (*)"invalidÜiteral/lengths set";

1004 
°©e
->
mode
 = 
BAD
;

1007 
°©e
->
di°code
 = (c⁄° 
code
 
FAR
 *)(°©e->
√xt
);

1008 
°©e
->
di°bôs
 = 6;

1009 
ªt
 = 
	`öÊ©e_èbÀ
(
DISTS
, 
°©e
->
Àns
 + sèã->
∆í
, sèã->
ndi°
,

1010 &(
°©e
->
√xt
), &(°©e->
di°bôs
), sèã->
w‹k
);

1011 i‡(
ªt
) {

1012 
°rm
->
msg
 = (*)"invalid distances set";

1013 
°©e
->
mode
 = 
BAD
;

1016 
	`Tø˚v
((
°dîr
, "inflate: codes ok\n"));

1017 
°©e
->
mode
 = 
LEN_
;

1018 i‡(
Êush
 =
Z_TREES
Ë
öf_Àave
;

1019 
LEN_
:

1020 
°©e
->
mode
 = 
LEN
;

1021 
LEN
:

1022 i‡(
have
 >6 && 
À·
 >= 258) {

1023 
	`RESTORE
();

1024 
	`öÊ©e_Á°
(
°rm
, 
out
);

1025 
	`LOAD
();

1026 i‡(
°©e
->
mode
 =
TYPE
)

1027 
°©e
->
back
 = -1;

1030 
°©e
->
back
 = 0;

1032 
hîe
 = 
°©e
->
Àncode
[
	`BITS
(°©e->
Ànbôs
)];

1033 i‡(()(
hîe
.
bôs
) <= bits) ;

1034 
	`PULLBYTE
();

1036 i‡(
hîe
.
›
 && (here.op & 0xf0) == 0) {

1037 
œ°
 = 
hîe
;

1039 
hîe
 = 
°©e
->
Àncode
[
œ°
.
vÆ
 +

1040 (
	`BITS
(
œ°
.
bôs
 +Üa°.
›
) >>Üast.bits)];

1041 i‡(()(
œ°
.
bôs
 + 
hîe
.bits) <= bits) ;

1042 
	`PULLBYTE
();

1044 
	`DROPBITS
(
œ°
.
bôs
);

1045 
°©e
->
back
 +
œ°
.
bôs
;

1047 
	`DROPBITS
(
hîe
.
bôs
);

1048 
°©e
->
back
 +
hîe
.
bôs
;

1049 
°©e
->
Àngth
 = ()
hîe
.
vÆ
;

1050 i‡(()(
hîe
.
›
) == 0) {

1051 
	`Tø˚vv
((
°dîr
, 
hîe
.
vÆ
 >= 0x20 && here.val < 0x7f ?

1053 "öÊ©e:ÜôîÆ 0x%02x\n", 
hîe
.
vÆ
));

1054 
°©e
->
mode
 = 
LIT
;

1057 i‡(
hîe
.
›
 & 32) {

1058 
	`Tø˚vv
((
°dîr
, "inflate:Énd of block\n"));

1059 
°©e
->
back
 = -1;

1060 
°©e
->
mode
 = 
TYPE
;

1063 i‡(
hîe
.
›
 & 64) {

1064 
°rm
->
msg
 = (*)"invalidÜiteral/length code";

1065 
°©e
->
mode
 = 
BAD
;

1068 
°©e
->
exåa
 = ()(
hîe
.
›
) & 15;

1069 
°©e
->
mode
 = 
LENEXT
;

1070 
LENEXT
:

1071 i‡(
°©e
->
exåa
) {

1072 
	`NEEDBITS
(
°©e
->
exåa
);

1073 
°©e
->
Àngth
 +
	`BITS
(°©e->
exåa
);

1074 
	`DROPBITS
(
°©e
->
exåa
);

1075 
°©e
->
back
 +°©e->
exåa
;

1077 
	`Tø˚vv
((
°dîr
, "öÊ©e:Üígth %u\n", 
°©e
->
Àngth
));

1078 
°©e
->
was
 = sèã->
Àngth
;

1079 
°©e
->
mode
 = 
DIST
;

1080 
DIST
:

1082 
hîe
 = 
°©e
->
di°code
[
	`BITS
(°©e->
di°bôs
)];

1083 i‡(()(
hîe
.
bôs
) <= bits) ;

1084 
	`PULLBYTE
();

1086 i‡((
hîe
.
›
 & 0xf0) == 0) {

1087 
œ°
 = 
hîe
;

1089 
hîe
 = 
°©e
->
di°code
[
œ°
.
vÆ
 +

1090 (
	`BITS
(
œ°
.
bôs
 +Üa°.
›
) >>Üast.bits)];

1091 i‡(()(
œ°
.
bôs
 + 
hîe
.bits) <= bits) ;

1092 
	`PULLBYTE
();

1094 
	`DROPBITS
(
œ°
.
bôs
);

1095 
°©e
->
back
 +
œ°
.
bôs
;

1097 
	`DROPBITS
(
hîe
.
bôs
);

1098 
°©e
->
back
 +
hîe
.
bôs
;

1099 i‡(
hîe
.
›
 & 64) {

1100 
°rm
->
msg
 = (*)"invalid distance code";

1101 
°©e
->
mode
 = 
BAD
;

1104 
°©e
->
off£t
 = ()
hîe
.
vÆ
;

1105 
°©e
->
exåa
 = ()(
hîe
.
›
) & 15;

1106 
°©e
->
mode
 = 
DISTEXT
;

1107 
DISTEXT
:

1108 i‡(
°©e
->
exåa
) {

1109 
	`NEEDBITS
(
°©e
->
exåa
);

1110 
°©e
->
off£t
 +
	`BITS
(°©e->
exåa
);

1111 
	`DROPBITS
(
°©e
->
exåa
);

1112 
°©e
->
back
 +°©e->
exåa
;

1114 #ifde‡
INFLATE_STRICT


1115 i‡(
°©e
->
off£t
 > sèã->
dmax
) {

1116 
°rm
->
msg
 = (*)"invalid distanceÅoo far back";

1117 
°©e
->
mode
 = 
BAD
;

1121 
	`Tø˚vv
((
°dîr
, "öÊ©e: di°™˚ %u\n", 
°©e
->
off£t
));

1122 
°©e
->
mode
 = 
MATCH
;

1123 
MATCH
:

1124 i‡(
À·
 =0Ë
öf_Àave
;

1125 
c›y
 = 
out
 - 
À·
;

1126 i‡(
°©e
->
off£t
 > 
c›y
) {

1127 
c›y
 = 
°©e
->
off£t
 - copy;

1128 i‡(
c›y
 > 
°©e
->
whave
) {

1129 i‡(
°©e
->
ß√
) {

1130 
°rm
->
msg
 = (*)"invalid distanceÅoo far back";

1131 
°©e
->
mode
 = 
BAD
;

1134 #ifde‡
INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR


1135 
	`Tø˚
((
°dîr
, "inflate.cÅoo far\n"));

1136 
c›y
 -
°©e
->
whave
;

1137 i‡(
c›y
 > 
°©e
->
Àngth
) copy = state->length;

1138 i‡(
c›y
 > 
À·
) copy =Üeft;

1139 
À·
 -
c›y
;

1140 
°©e
->
Àngth
 -
c›y
;

1142 *
put
++ = 0;

1143 } --
c›y
);

1144 i‡(
°©e
->
Àngth
 =0Ë°©e->
mode
 = 
LEN
;

1148 i‡(
c›y
 > 
°©e
->
w√xt
) {

1149 
c›y
 -
°©e
->
w√xt
;

1150 
‰om
 = 
°©e
->
wödow
 + (°©e->
wsize
 - 
c›y
);

1153 
‰om
 = 
°©e
->
wödow
 + (°©e->
w√xt
 - 
c›y
);

1154 i‡(
c›y
 > 
°©e
->
Àngth
) copy = state->length;

1157 
‰om
 = 
put
 - 
°©e
->
off£t
;

1158 
c›y
 = 
°©e
->
Àngth
;

1160 i‡(
c›y
 > 
À·
) copy =Üeft;

1161 
À·
 -
c›y
;

1162 
°©e
->
Àngth
 -
c›y
;

1164 *
put
++ = *
‰om
++;

1165 } --
c›y
);

1166 i‡(
°©e
->
Àngth
 =0Ë°©e->
mode
 = 
LEN
;

1168 
LIT
:

1169 i‡(
À·
 =0Ë
öf_Àave
;

1170 *
put
++ = ()(
°©e
->
Àngth
);

1171 
À·
--;

1172 
°©e
->
mode
 = 
LEN
;

1174 
CHECK
:

1175 i‡(
°©e
->
wøp
) {

1176 
	`NEEDBITS
(32);

1177 
out
 -
À·
;

1178 
°rm
->
tŸÆ_out
 +
out
;

1179 
°©e
->
tŸÆ
 +
out
;

1180 i‡(
out
)

1181 
°rm
->
adÀr
 = 
°©e
->
check
 =

1182 
	`UPDATE
(
°©e
->
check
, 
put
 - 
out
, out);

1183 
out
 = 
À·
;

1185 #ifde‡
GUNZIP


1186 
°©e
->
Êags
 ? 
hﬁd
 :

1188 
	`ZSWAP32
(
hﬁd
)Ë!
°©e
->
check
) {

1189 
°rm
->
msg
 = (*)"incorrect data check";

1190 
°©e
->
mode
 = 
BAD
;

1193 
	`INITBITS
();

1194 
	`Tø˚v
((
°dîr
, "inflate: check matchesÅrailer\n"));

1196 #ifde‡
GUNZIP


1197 
°©e
->
mode
 = 
LENGTH
;

1198 
LENGTH
:

1199 i‡(
°©e
->
wøp
 && sèã->
Êags
) {

1200 
	`NEEDBITS
(32);

1201 i‡(
hﬁd
 !(
°©e
->
tŸÆ
 & 0xffffffffUL)) {

1202 
°rm
->
msg
 = (*)"incorrectÜength check";

1203 
°©e
->
mode
 = 
BAD
;

1206 
	`INITBITS
();

1207 
	`Tø˚v
((
°dîr
, "inflate:Üength matchesÅrailer\n"));

1210 
°©e
->
mode
 = 
DONE
;

1211 
DONE
:

1212 
ªt
 = 
Z_STREAM_END
;

1213 
öf_Àave
;

1214 
BAD
:

1215 
ªt
 = 
Z_DATA_ERROR
;

1216 
öf_Àave
;

1217 
MEM
:

1218  
Z_MEM_ERROR
;

1219 
SYNC
:

1221  
Z_STREAM_ERROR
;

1230 
öf_Àave
:

1231 
	`RESTORE
();

1232 i‡(
°©e
->
wsize
 || (
out
 !
°rm
->
avaû_out
 && sèã->
mode
 < 
BAD
 &&

1233 (
°©e
->
mode
 < 
CHECK
 || 
Êush
 !
Z_FINISH
)))

1234 i‡(
	`upd©ewödow
(
°rm
, såm->
√xt_out
, 
out
 - såm->
avaû_out
)) {

1235 
°©e
->
mode
 = 
MEM
;

1236  
Z_MEM_ERROR
;

1238 
ö
 -
°rm
->
avaû_ö
;

1239 
out
 -
°rm
->
avaû_out
;

1240 
°rm
->
tŸÆ_ö
 +
ö
;

1241 
°rm
->
tŸÆ_out
 +
out
;

1242 
°©e
->
tŸÆ
 +
out
;

1243 i‡(
°©e
->
wøp
 && 
out
)

1244 
°rm
->
adÀr
 = 
°©e
->
check
 =

1245 
	`UPDATE
(
°©e
->
check
, 
°rm
->
√xt_out
 - 
out
, out);

1246 
°rm
->
d©a_ty≥
 = 
°©e
->
bôs
 + (°©e->
œ°
 ? 64 : 0) +

1247 (
°©e
->
mode
 =
TYPE
 ? 128 : 0) +

1248 (
°©e
->
mode
 =
LEN_
 || sèã->modê=
COPY_
 ? 256 : 0);

1249 i‡(((
ö
 =0 && 
out
 =0Ë|| 
Êush
 =
Z_FINISH
Ë&& 
ªt
 =
Z_OK
)

1250 
ªt
 = 
Z_BUF_ERROR
;

1251  
ªt
;

1252 
	}
}

1254 
ZEXPORT
 
	$öÊ©eEnd
(
°rm
)

1255 
z_°ªamp
 
°rm
;

1257 
öÊ©e_°©e
 
FAR
 *
°©e
;

1258 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 =Z_NULL || såm->
z‰ì
 =(
‰ì_func
)0)

1259  
Z_STREAM_ERROR
;

1260 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
°rm
->state;

1261 i‡(
°©e
->
wödow
 !
Z_NULL
Ë
	`ZFREE
(
°rm
, state->window);

1262 
	`ZFREE
(
°rm
, såm->
°©e
);

1263 
°rm
->
°©e
 = 
Z_NULL
;

1264 
	`Tø˚v
((
°dîr
, "inflate:Énd\n"));

1265  
Z_OK
;

1266 
	}
}

1268 
ZEXPORT
 
	$öÊ©eGëDi˘i⁄¨y
(
°rm
, 
di˘i⁄¨y
, 
di˘Lígth
)

1269 
z_°ªamp
 
°rm
;

1270 
Byãf
 *
di˘i⁄¨y
;

1271 
uI¡
 *
di˘Lígth
;

1273 
öÊ©e_°©e
 
FAR
 *
°©e
;

1276 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 =Z_NULLË 
Z_STREAM_ERROR
;

1277 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
°rm
->state;

1280 i‡(
°©e
->
whave
 && 
di˘i⁄¨y
 !
Z_NULL
) {

1281 
	`zmem˝y
(
di˘i⁄¨y
, 
°©e
->
wödow
 + sèã->
w√xt
,

1282 
°©e
->
whave
 - sèã->
w√xt
);

1283 
	`zmem˝y
(
di˘i⁄¨y
 + 
°©e
->
whave
 - sèã->
w√xt
,

1284 
°©e
->
wödow
, sèã->
w√xt
);

1286 i‡(
di˘Lígth
 !
Z_NULL
)

1287 *
di˘Lígth
 = 
°©e
->
whave
;

1288  
Z_OK
;

1289 
	}
}

1291 
ZEXPORT
 
	$öÊ©eSëDi˘i⁄¨y
(
°rm
, 
di˘i⁄¨y
, 
di˘Lígth
)

1292 
z_°ªamp
 
°rm
;

1293 c⁄° 
Byãf
 *
di˘i⁄¨y
;

1294 
uI¡
 
di˘Lígth
;

1296 
öÊ©e_°©e
 
FAR
 *
°©e
;

1297 
di˘id
;

1298 
ªt
;

1301 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 =Z_NULLË 
Z_STREAM_ERROR
;

1302 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
°rm
->state;

1303 i‡(
°©e
->
wøp
 !0 && sèã->
mode
 !
DICT
)

1304  
Z_STREAM_ERROR
;

1307 i‡(
°©e
->
mode
 =
DICT
) {

1308 
di˘id
 = 
	`adÀr32
(0L, 
Z_NULL
, 0);

1309 
di˘id
 = 
	`adÀr32
(di˘id, 
di˘i⁄¨y
, 
di˘Lígth
);

1310 i‡(
di˘id
 !
°©e
->
check
)

1311  
Z_DATA_ERROR
;

1316 
ªt
 = 
	`upd©ewödow
(
°rm
, 
di˘i⁄¨y
 + 
di˘Lígth
, dictLength);

1317 i‡(
ªt
) {

1318 
°©e
->
mode
 = 
MEM
;

1319  
Z_MEM_ERROR
;

1321 
°©e
->
havedi˘
 = 1;

1322 
	`Tø˚v
((
°dîr
, "inflate: dictionary set\n"));

1323  
Z_OK
;

1324 
	}
}

1326 
ZEXPORT
 
	$öÊ©eGëHódî
(
°rm
, 
hód
)

1327 
z_°ªamp
 
°rm
;

1328 
gz_hódîp
 
hód
;

1330 
öÊ©e_°©e
 
FAR
 *
°©e
;

1333 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 =Z_NULLË 
Z_STREAM_ERROR
;

1334 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
°rm
->state;

1335 i‡((
°©e
->
wøp
 & 2Ë=0Ë 
Z_STREAM_ERROR
;

1338 
°©e
->
hód
 = head;

1339 
hód
->
d⁄e
 = 0;

1340  
Z_OK
;

1341 
	}
}

1354 
loˇl
 
	$sync£¨ch
(
have
, 
buf
, 
Àn
)

1355 
FAR
 *
have
;

1356 c⁄° 
FAR
 *
buf
;

1357 
Àn
;

1359 
gŸ
;

1360 
√xt
;

1362 
gŸ
 = *
have
;

1363 
√xt
 = 0;

1364 
√xt
 < 
Àn
 && 
gŸ
 < 4) {

1365 i‡(()(
buf
[
√xt
]Ë=(
gŸ
 < 2 ? 0 : 0xff))

1366 
gŸ
++;

1367 i‡(
buf
[
√xt
])

1368 
gŸ
 = 0;

1370 
gŸ
 = 4 - got;

1371 
√xt
++;

1373 *
have
 = 
gŸ
;

1374  
√xt
;

1375 
	}
}

1377 
ZEXPORT
 
	$öÊ©eSync
(
°rm
)

1378 
z_°ªamp
 
°rm
;

1380 
Àn
;

1381 
ö
, 
out
;

1382 
buf
[4];

1383 
öÊ©e_°©e
 
FAR
 *
°©e
;

1386 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 =Z_NULLË 
Z_STREAM_ERROR
;

1387 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
°rm
->state;

1388 i‡(
°rm
->
avaû_ö
 =0 && 
°©e
->
bôs
 < 8Ë 
Z_BUF_ERROR
;

1391 i‡(
°©e
->
mode
 !
SYNC
) {

1392 
°©e
->
mode
 = 
SYNC
;

1393 
°©e
->
hﬁd
 <<°©e->
bôs
 & 7;

1394 
°©e
->
bôs
 -= state->bits & 7;

1395 
Àn
 = 0;

1396 
°©e
->
bôs
 >= 8) {

1397 
buf
[
Àn
++] = ()(
°©e
->
hﬁd
);

1398 
°©e
->
hﬁd
 >>= 8;

1399 
°©e
->
bôs
 -= 8;

1401 
°©e
->
have
 = 0;

1402 
	`sync£¨ch
(&(
°©e
->
have
), 
buf
, 
Àn
);

1406 
Àn
 = 
	`sync£¨ch
(&(
°©e
->
have
), 
°rm
->
√xt_ö
, såm->
avaû_ö
);

1407 
°rm
->
avaû_ö
 -
Àn
;

1408 
°rm
->
√xt_ö
 +
Àn
;

1409 
°rm
->
tŸÆ_ö
 +
Àn
;

1412 i‡(
°©e
->
have
 !4Ë 
Z_DATA_ERROR
;

1413 
ö
 = 
°rm
->
tŸÆ_ö
; 
out
 = såm->
tŸÆ_out
;

1414 
	`öÊ©eRe£t
(
°rm
);

1415 
°rm
->
tŸÆ_ö
 = 
ö
; såm->
tŸÆ_out
 = 
out
;

1416 
°©e
->
mode
 = 
TYPE
;

1417  
Z_OK
;

1418 
	}
}

1428 
ZEXPORT
 
	$öÊ©eSyncPoöt
(
°rm
)

1429 
z_°ªamp
 
°rm
;

1431 
öÊ©e_°©e
 
FAR
 *
°©e
;

1433 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 =Z_NULLË 
Z_STREAM_ERROR
;

1434 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
°rm
->state;

1435  
°©e
->
mode
 =
STORED
 && sèã->
bôs
 == 0;

1436 
	}
}

1438 
ZEXPORT
 
	$öÊ©eC›y
(
de°
, 
sour˚
)

1439 
z_°ªamp
 
de°
;

1440 
z_°ªamp
 
sour˚
;

1442 
öÊ©e_°©e
 
FAR
 *
°©e
;

1443 
öÊ©e_°©e
 
FAR
 *
c›y
;

1444 
FAR
 *
wödow
;

1445 
wsize
;

1448 i‡(
de°
 =
Z_NULL
 || 
sour˚
 =Z_NULL || sour˚->
°©e
 == Z_NULL ||

1449 
sour˚
->
zÆloc
 =(
Æloc_func
)0 || sour˚->
z‰ì
 =(
‰ì_func
)0)

1450  
Z_STREAM_ERROR
;

1451 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
sour˚
->state;

1454 
c›y
 = (
öÊ©e_°©e
 
FAR
 *)

1455 
	`ZALLOC
(
sour˚
, 1, (
öÊ©e_°©e
));

1456 i‡(
c›y
 =
Z_NULL
Ë 
Z_MEM_ERROR
;

1457 
wödow
 = 
Z_NULL
;

1458 i‡(
°©e
->
wödow
 !
Z_NULL
) {

1459 
wödow
 = (
FAR
 *)

1460 
	`ZALLOC
(
sour˚
, 1U << 
°©e
->
wbôs
, ());

1461 i‡(
wödow
 =
Z_NULL
) {

1462 
	`ZFREE
(
sour˚
, 
c›y
);

1463  
Z_MEM_ERROR
;

1468 
	`zmem˝y
((
voidpf
)
de°
, (voidpf)
sour˚
, (
z_°ªam
));

1469 
	`zmem˝y
((
voidpf
)
c›y
, (voidpf)
°©e
, (
öÊ©e_°©e
));

1470 i‡(
°©e
->
Àncode
 >°©e->
codes
 &&

1471 
°©e
->
Àncode
 <°©e->
codes
 + 
ENOUGH
 - 1) {

1472 
c›y
->
Àncode
 = c›y->
codes
 + (
°©e
->lencode - state->codes);

1473 
c›y
->
di°code
 = c›y->
codes
 + (
°©e
->distcode - state->codes);

1475 
c›y
->
√xt
 = c›y->
codes
 + (
°©e
->next - state->codes);

1476 i‡(
wödow
 !
Z_NULL
) {

1477 
wsize
 = 1U << 
°©e
->
wbôs
;

1478 
	`zmem˝y
(
wödow
, 
°©e
->wödow, 
wsize
);

1480 
c›y
->
wödow
 = window;

1481 
de°
->
°©e
 = (
öã∫Æ_°©e
 
FAR
 *)
c›y
;

1482  
Z_OK
;

1483 
	}
}

1485 
ZEXPORT
 
	$öÊ©eUndîmöe
(
°rm
, 
subvît
)

1486 
z_°ªamp
 
°rm
;

1487 
subvît
;

1489 
öÊ©e_°©e
 
FAR
 *
°©e
;

1491 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 =Z_NULLË 
Z_STREAM_ERROR
;

1492 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
°rm
->state;

1493 
°©e
->
ß√
 = !
subvît
;

1494 #ifde‡
INFLATE_ALLOW_INVALID_DISTANCE_TOOFAR_ARRR


1495  
Z_OK
;

1497 
°©e
->
ß√
 = 1;

1498  
Z_DATA_ERROR
;

1500 
	}
}

1502 
ZEXPORT
 
	$öÊ©eM¨k
(
°rm
)

1503 
z_°ªamp
 
°rm
;

1505 
öÊ©e_°©e
 
FAR
 *
°©e
;

1507 i‡(
°rm
 =
Z_NULL
 || såm->
°©e
 == Z_NULL)  -1L << 16;

1508 
°©e
 = (
öÊ©e_°©e
 
FAR
 *)
°rm
->state;

1509  (()(
°©e
->
back
) << 16) +

1510 (
°©e
->
mode
 =
COPY
 ? sèã->
Àngth
 :

1511 (
°©e
->
mode
 =
MATCH
 ? sèã->
was
 - sèã->
Àngth
 : 0));

1512 
	}
}

	@zlib-1.2.8/inflate.h

15 #i‚de‡
NO_GZIP


16 
	#GUNZIP


	)

21 
	mHEAD
,

22 
	mFLAGS
,

23 
	mTIME
,

24 
	mOS
,

25 
	mEXLEN
,

26 
	mEXTRA
,

27 
	mNAME
,

28 
	mCOMMENT
,

29 
	mHCRC
,

30 
	mDICTID
,

31 
	mDICT
,

32 
	mTYPE
,

33 
	mTYPEDO
,

34 
	mSTORED
,

35 
	mCOPY_
,

36 
	mCOPY
,

37 
	mTABLE
,

38 
	mLENLENS
,

39 
	mCODELENS
,

40 
	mLEN_
,

41 
	mLEN
,

42 
	mLENEXT
,

43 
	mDIST
,

44 
	mDISTEXT
,

45 
	mMATCH
,

46 
	mLIT
,

47 
	mCHECK
,

48 
	mLENGTH
,

49 
	mDONE
,

50 
	mBAD
,

51 
	mMEM
,

52 
	mSYNC


53 } 
	töÊ©e_mode
;

81 
	söÊ©e_°©e
 {

82 
öÊ©e_mode
 
	mmode
;

83 
	mœ°
;

84 
	mwøp
;

85 
	mhavedi˘
;

86 
	mÊags
;

87 
	mdmax
;

88 
	mcheck
;

89 
	mtŸÆ
;

90 
gz_hódîp
 
	mhód
;

92 
	mwbôs
;

93 
	mwsize
;

94 
	mwhave
;

95 
	mw√xt
;

96 
FAR
 *
	mwödow
;

98 
	mhﬁd
;

99 
	mbôs
;

101 
	mÀngth
;

102 
	moff£t
;

104 
	mexåa
;

106 
code
 c⁄° 
FAR
 *
	mÀncode
;

107 
code
 c⁄° 
FAR
 *
	mdi°code
;

108 
	mÀnbôs
;

109 
	mdi°bôs
;

111 
	mncode
;

112 
	m∆í
;

113 
	mndi°
;

114 
	mhave
;

115 
code
 
FAR
 *
	m√xt
;

116 
	mÀns
[320];

117 
	mw‹k
[288];

118 
code
 
	mcodes
[
ENOUGH
];

119 
	mß√
;

120 
	mback
;

121 
	mwas
;

	@zlib-1.2.8/inftrees.c

6 
	~"zutû.h
"

7 
	~"ö·ªes.h
"

9 
	#MAXBITS
 15

	)

11 c⁄° 
	göÊ©e_c›yright
[] =

32 
ZLIB_INTERNAL
 
	$öÊ©e_èbÀ
(
ty≥
, 
Àns
, 
codes
, 
èbÀ
, 
bôs
, 
w‹k
)

33 
codëy≥
 
ty≥
;

34 
FAR
 *
Àns
;

35 
codes
;

36 
code
 
FAR
 * FAR *
èbÀ
;

37 
FAR
 *
bôs
;

38 
FAR
 *
w‹k
;

40 
Àn
;

41 
sym
;

42 
mö
, 
max
;

43 
roŸ
;

44 
cuº
;

45 
dr›
;

46 
À·
;

47 
u£d
;

48 
huff
;

49 
ö¸
;

50 
fûl
;

51 
low
;

52 
mask
;

53 
code
 
hîe
;

54 
code
 
FAR
 *
√xt
;

55 c⁄° 
FAR
 *
ba£
;

56 c⁄° 
FAR
 *
exåa
;

57 
íd
;

58 
cou¡
[
MAXBITS
+1];

59 
offs
[
MAXBITS
+1];

60 c⁄° 
lba£
[31] = {

63 c⁄° 
Àxt
[31] = {

66 c⁄° 
dba£
[32] = {

70 c⁄° 
dext
[32] = {

107 
Àn
 = 0;Üí <
MAXBITS
;Üen++)

108 
cou¡
[
Àn
] = 0;

109 
sym
 = 0; sym < 
codes
; sym++)

110 
cou¡
[
Àns
[
sym
]]++;

113 
roŸ
 = *
bôs
;

114 
max
 = 
MAXBITS
; max >= 1; max--)

115 i‡(
cou¡
[
max
] != 0) ;

116 i‡(
roŸ
 > 
max
)Ñoot = max;

117 i‡(
max
 == 0) {

118 
hîe
.
›
 = ()64;

119 
hîe
.
bôs
 = ()1;

120 
hîe
.
vÆ
 = ()0;

121 *(*
èbÀ
)++ = 
hîe
;

122 *(*
èbÀ
)++ = 
hîe
;

123 *
bôs
 = 1;

126 
mö
 = 1; mö < 
max
; min++)

127 i‡(
cou¡
[
mö
] != 0) ;

128 i‡(
roŸ
 < 
mö
)Ñoot = min;

131 
À·
 = 1;

132 
Àn
 = 1;Üí <
MAXBITS
;Üen++) {

133 
À·
 <<= 1;

134 
À·
 -
cou¡
[
Àn
];

135 i‡(
À·
 < 0)  -1;

137 i‡(
À·
 > 0 && (
ty≥
 =
CODES
 || 
max
 != 1))

141 
offs
[1] = 0;

142 
Àn
 = 1;Üí < 
MAXBITS
;Üen++)

143 
offs
[
Àn
 + 1] = offs[Àn] + 
cou¡
[len];

146 
sym
 = 0; sym < 
codes
; sym++)

147 i‡(
Àns
[
sym
] !0Ë
w‹k
[
offs
[lens[sym]]++] = ()sym;

181 
ty≥
) {

182 
CODES
:

183 
ba£
 = 
exåa
 = 
w‹k
;

184 
íd
 = 19;

186 
LENS
:

187 
ba£
 = 
lba£
;

188 
ba£
 -= 257;

189 
exåa
 = 
Àxt
;

190 
exåa
 -= 257;

191 
íd
 = 256;

194 
ba£
 = 
dba£
;

195 
exåa
 = 
dext
;

196 
íd
 = -1;

200 
huff
 = 0;

201 
sym
 = 0;

202 
Àn
 = 
mö
;

203 
√xt
 = *
èbÀ
;

204 
cuº
 = 
roŸ
;

205 
dr›
 = 0;

206 
low
 = ()(-1);

207 
u£d
 = 1U << 
roŸ
;

208 
mask
 = 
u£d
 - 1;

211 i‡((
ty≥
 =
LENS
 && 
u£d
 > 
ENOUGH_LENS
) ||

212 (
ty≥
 =
DISTS
 && 
u£d
 > 
ENOUGH_DISTS
))

218 
hîe
.
bôs
 = ()(
Àn
 - 
dr›
);

219 i‡(()(
w‹k
[
sym
]Ë< 
íd
) {

220 
hîe
.
›
 = ()0;

221 
hîe
.
vÆ
 = 
w‹k
[
sym
];

223 i‡(()(
w‹k
[
sym
]Ë> 
íd
) {

224 
hîe
.
›
 = ()(
exåa
[
w‹k
[
sym
]]);

225 
hîe
.
vÆ
 = 
ba£
[
w‹k
[
sym
]];

228 
hîe
.
›
 = ()(32 + 64);

229 
hîe
.
vÆ
 = 0;

233 
ö¸
 = 1U << (
Àn
 - 
dr›
);

234 
fûl
 = 1U << 
cuº
;

235 
mö
 = 
fûl
;

237 
fûl
 -
ö¸
;

238 
√xt
[(
huff
 >> 
dr›
Ë+ 
fûl
] = 
hîe
;

239 } 
fûl
 != 0);

242 
ö¸
 = 1U << (
Àn
 - 1);

243 
huff
 & 
ö¸
)

244 
ö¸
 >>= 1;

245 i‡(
ö¸
 != 0) {

246 
huff
 &
ö¸
 - 1;

247 
huff
 +
ö¸
;

250 
huff
 = 0;

253 
sym
++;

254 i‡(--(
cou¡
[
Àn
]) == 0) {

255 i‡(
Àn
 =
max
) ;

256 
Àn
 = 
Àns
[
w‹k
[
sym
]];

260 i‡(
Àn
 > 
roŸ
 && (
huff
 & 
mask
Ë!
low
) {

262 i‡(
dr›
 == 0)

263 
dr›
 = 
roŸ
;

266 
√xt
 +
mö
;

269 
cuº
 = 
Àn
 - 
dr›
;

270 
À·
 = ()(1 << 
cuº
);

271 
cuº
 + 
dr›
 < 
max
) {

272 
À·
 -
cou¡
[
cuº
 + 
dr›
];

273 i‡(
À·
 <= 0) ;

274 
cuº
++;

275 
À·
 <<= 1;

279 
u£d
 +1U << 
cuº
;

280 i‡((
ty≥
 =
LENS
 && 
u£d
 > 
ENOUGH_LENS
) ||

281 (
ty≥
 =
DISTS
 && 
u£d
 > 
ENOUGH_DISTS
))

285 
low
 = 
huff
 & 
mask
;

286 (*
èbÀ
)[
low
].
›
 = ()
cuº
;

287 (*
èbÀ
)[
low
].
bôs
 = ()
roŸ
;

288 (*
èbÀ
)[
low
].
vÆ
 = ()(
√xt
 - *table);

295 i‡(
huff
 != 0) {

296 
hîe
.
›
 = ()64;

297 
hîe
.
bôs
 = ()(
Àn
 - 
dr›
);

298 
hîe
.
vÆ
 = ()0;

299 
√xt
[
huff
] = 
hîe
;

303 *
èbÀ
 +
u£d
;

304 *
bôs
 = 
roŸ
;

306 
	}
}

	@zlib-1.2.8/inftrees.h

25 
	m›
;

26 
	mbôs
;

27 
	mvÆ
;

28 } 
	tcode
;

49 
	#ENOUGH_LENS
 852

	)

50 
	#ENOUGH_DISTS
 592

	)

51 
	#ENOUGH
 (
ENOUGH_LENS
+
ENOUGH_DISTS
)

	)

55 
	mCODES
,

56 
	mLENS
,

57 
	mDISTS


58 } 
	tcodëy≥
;

60 
ZLIB_INTERNAL
 
öÊ©e_èbÀ
 
OF
((
codëy≥
 
ty≥
, 
FAR
 *
Àns
,

61 
codes
, 
code
 
FAR
 * FAR *
èbÀ
,

62 
FAR
 *
bôs
, FAR *
w‹k
));

	@zlib-1.2.8/test/example.c

8 
	~"zlib.h
"

9 
	~<°dio.h
>

11 #ifde‡
STDC


12 
	~<°rög.h
>

13 
	~<°dlib.h
>

16 #i‡
deföed
(
VMS
Ë|| deföed(
RISCOS
)

17 
	#TESTFILE
 "foo-gz"

	)

19 
	#TESTFILE
 "foo.gz"

	)

22 
	#CHECK_ERR
(
îr
, 
msg
) { \

23 i‡(
îr
 !
Z_OK
) { \

24 
	`Ârötf
(
°dîr
, "%†îr‹: %d\n", 
msg
, 
îr
); \

25 
	`exô
(1); \

27 }

	)

29 
z_c⁄°
 
	ghñlo
[] = "hello, hello!";

34 c⁄° 
	gdi˘i⁄¨y
[] = "hello";

35 
uL⁄g
 
	gdi˘Id
;

37 
ã°_deÊ©e
 
OF
((
Byã
 *
com¥
, 
uL⁄g
 
com¥Lí
));

38 
ã°_öÊ©e
 
OF
((
Byã
 *
com¥
, 
uL⁄g
 
com¥Lí
,

39 
Byã
 *
uncom¥
, 
uL⁄g
 
uncom¥Lí
));

40 
ã°_œrge_deÊ©e
 
OF
((
Byã
 *
com¥
, 
uL⁄g
 
com¥Lí
,

41 
Byã
 *
uncom¥
, 
uL⁄g
 
uncom¥Lí
));

42 
ã°_œrge_öÊ©e
 
OF
((
Byã
 *
com¥
, 
uL⁄g
 
com¥Lí
,

43 
Byã
 *
uncom¥
, 
uL⁄g
 
uncom¥Lí
));

44 
ã°_Êush
 
OF
((
Byã
 *
com¥
, 
uL⁄g
 *
com¥Lí
));

45 
ã°_sync
 
OF
((
Byã
 *
com¥
, 
uL⁄g
 
com¥Lí
,

46 
Byã
 *
uncom¥
, 
uL⁄g
 
uncom¥Lí
));

47 
ã°_di˘_deÊ©e
 
OF
((
Byã
 *
com¥
, 
uL⁄g
 
com¥Lí
));

48 
ã°_di˘_öÊ©e
 
OF
((
Byã
 *
com¥
, 
uL⁄g
 
com¥Lí
,

49 
Byã
 *
uncom¥
, 
uL⁄g
 
uncom¥Lí
));

50 
maö
 
OF
((
¨gc
, *
¨gv
[]));

53 #ifde‡
Z_SOLO


55 *
myÆloc
 
OF
((*, , ));

56 
my‰ì
 
OF
((*, *));

58 *
	$myÆloc
(
q
, 
n
, 
m
)

59 *
q
;

60 
n
, 
m
;

62 
q
 = 
Z_NULL
;

63  
	`ˇŒoc
(
n
, 
m
);

64 
	}
}

66 
	$my‰ì
(*
q
, *
p
)

68 
q
 = 
Z_NULL
;

69 
	`‰ì
(
p
);

70 
	}
}

72 
Æloc_func
 
	gzÆloc
 = 
myÆloc
;

73 
‰ì_func
 
	gz‰ì
 = 
my‰ì
;

77 
Æloc_func
 
	gzÆloc
 = (alloc_func)0;

78 
‰ì_func
 
	gz‰ì
 = (free_func)0;

80 
ã°_com¥ess
 
OF
((
Byã
 *
com¥
, 
uL⁄g
 
com¥Lí
,

81 
Byã
 *
uncom¥
, 
uL⁄g
 
uncom¥Lí
));

82 
ã°_gzio
 
OF
((c⁄° *
‚ame
,

83 
Byã
 *
uncom¥
, 
uL⁄g
 
uncom¥Lí
));

88 
	$ã°_com¥ess
(
com¥
, 
com¥Lí
, 
uncom¥
, 
uncom¥Lí
)

89 
Byã
 *
com¥
, *
uncom¥
;

90 
uL⁄g
 
com¥Lí
, 
uncom¥Lí
;

92 
îr
;

93 
uL⁄g
 
Àn
 = (uL⁄g)
	`°æí
(
hñlo
)+1;

95 
îr
 = 
	`com¥ess
(
com¥
, &
com¥Lí
, (c⁄° 
Byãf
*)
hñlo
, 
Àn
);

96 
	`CHECK_ERR
(
îr
, "compress");

98 
	`°r˝y
((*)
uncom¥
, "garbage");

100 
îr
 = 
	`uncom¥ess
(
uncom¥
, &
uncom¥Lí
, 
com¥
, 
com¥Lí
);

101 
	`CHECK_ERR
(
îr
, "uncompress");

103 i‡(
	`°rcmp
((*)
uncom¥
, 
hñlo
)) {

104 
	`Ârötf
(
°dîr
, "bad uncompress\n");

105 
	`exô
(1);

107 
	`¥ötf
("uncom¥ess(): %s\n", (*)
uncom¥
);

109 
	}
}

114 
	$ã°_gzio
(
‚ame
, 
uncom¥
, 
uncom¥Lí
)

115 c⁄° *
‚ame
;

116 
Byã
 *
uncom¥
;

117 
uL⁄g
 
uncom¥Lí
;

119 #ifde‡
NO_GZCOMPRESS


120 
	`Ârötf
(
°dîr
, "NO_GZCOMPRESS -- gz* functions cannot compress\n");

122 
îr
;

123 
Àn
 = ()
	`°æí
(
hñlo
)+1;

124 
gzFûe
 
fûe
;

125 
z_off_t
 
pos
;

127 
fûe
 = 
	`gz›í
(
‚ame
, "wb");

128 i‡(
fûe
 =
NULL
) {

129 
	`Ârötf
(
°dîr
, "gzopenÉrror\n");

130 
	`exô
(1);

132 
	`gzputc
(
fûe
, 'h');

133 i‡(
	`gzputs
(
fûe
, "ello") != 4) {

134 
	`Ârötf
(
°dîr
, "gzput†îr: %s\n", 
	`gzîr‹
(
fûe
, &
îr
));

135 
	`exô
(1);

137 i‡(
	`gz¥ötf
(
fûe
, ", %s!", "hello") != 8) {

138 
	`Ârötf
(
°dîr
, "gz¥öt‡îr: %s\n", 
	`gzîr‹
(
fûe
, &
îr
));

139 
	`exô
(1);

141 
	`gz£ek
(
fûe
, 1L, 
SEEK_CUR
);

142 
	`gz˛o£
(
fûe
);

144 
fûe
 = 
	`gz›í
(
‚ame
, "rb");

145 i‡(
fûe
 =
NULL
) {

146 
	`Ârötf
(
°dîr
, "gzopenÉrror\n");

147 
	`exô
(1);

149 
	`°r˝y
((*)
uncom¥
, "garbage");

151 i‡(
	`gzªad
(
fûe
, 
uncom¥
, ()
uncom¥Lí
Ë!
Àn
) {

152 
	`Ârötf
(
°dîr
, "gzªadÉº: %s\n", 
	`gzîr‹
(
fûe
, &
îr
));

153 
	`exô
(1);

155 i‡(
	`°rcmp
((*)
uncom¥
, 
hñlo
)) {

156 
	`Ârötf
(
°dîr
, "bad gzªad: %s\n", (*)
uncom¥
);

157 
	`exô
(1);

159 
	`¥ötf
("gzªad(): %s\n", (*)
uncom¥
);

162 
pos
 = 
	`gz£ek
(
fûe
, -8L, 
SEEK_CUR
);

163 i‡(
pos
 !6 || 
	`gzãŒ
(
fûe
) !=Öos) {

164 
	`Ârötf
(
°dîr
, "gzseekÉrror,Öos=%ld, gztell=%ld\n",

165 ()
pos
, ()
	`gzãŒ
(
fûe
));

166 
	`exô
(1);

169 i‡(
	`gzgëc
(
fûe
) != ' ') {

170 
	`Ârötf
(
°dîr
, "gzgetcÉrror\n");

171 
	`exô
(1);

174 i‡(
	`gzungëc
(' ', 
fûe
) != ' ') {

175 
	`Ârötf
(
°dîr
, "gzungetcÉrror\n");

176 
	`exô
(1);

179 
	`gzgës
(
fûe
, (*)
uncom¥
, ()
uncom¥Lí
);

180 i‡(
	`°æí
((*)
uncom¥
) != 7) {

181 
	`Ârötf
(
°dîr
, "gzgë†î∏a·î gz£ek: %s\n", 
	`gzîr‹
(
fûe
, &
îr
));

182 
	`exô
(1);

184 i‡(
	`°rcmp
((*)
uncom¥
, 
hñlo
 + 6)) {

185 
	`Ârötf
(
°dîr
, "bad gzgetsáfter gzseek\n");

186 
	`exô
(1);

188 
	`¥ötf
("gzgës(Ëa·î gz£ek: %s\n", (*)
uncom¥
);

191 
	`gz˛o£
(
fûe
);

193 
	}
}

200 
	$ã°_deÊ©e
(
com¥
, 
com¥Lí
)

201 
Byã
 *
com¥
;

202 
uL⁄g
 
com¥Lí
;

204 
z_°ªam
 
c_°ªam
;

205 
îr
;

206 
uL⁄g
 
Àn
 = (uL⁄g)
	`°æí
(
hñlo
)+1;

208 
c_°ªam
.
zÆloc
 = zalloc;

209 
c_°ªam
.
z‰ì
 = zfree;

210 
c_°ªam
.
›aque
 = (
voidpf
)0;

212 
îr
 = 
	`deÊ©eInô
(&
c_°ªam
, 
Z_DEFAULT_COMPRESSION
);

213 
	`CHECK_ERR
(
îr
, "deflateInit");

215 
c_°ªam
.
√xt_ö
 = (
z_c⁄°
 *)
hñlo
;

216 
c_°ªam
.
√xt_out
 = 
com¥
;

218 
c_°ªam
.
tŸÆ_ö
 !
Àn
 && c_°ªam.
tŸÆ_out
 < 
com¥Lí
) {

219 
c_°ªam
.
avaû_ö
 = c_°ªam.
avaû_out
 = 1;

220 
îr
 = 
	`deÊ©e
(&
c_°ªam
, 
Z_NO_FLUSH
);

221 
	`CHECK_ERR
(
îr
, "deflate");

225 
c_°ªam
.
avaû_out
 = 1;

226 
îr
 = 
	`deÊ©e
(&
c_°ªam
, 
Z_FINISH
);

227 i‡(
îr
 =
Z_STREAM_END
) ;

228 
	`CHECK_ERR
(
îr
, "deflate");

231 
îr
 = 
	`deÊ©eEnd
(&
c_°ªam
);

232 
	`CHECK_ERR
(
îr
, "deflateEnd");

233 
	}
}

238 
	$ã°_öÊ©e
(
com¥
, 
com¥Lí
, 
uncom¥
, 
uncom¥Lí
)

239 
Byã
 *
com¥
, *
uncom¥
;

240 
uL⁄g
 
com¥Lí
, 
uncom¥Lí
;

242 
îr
;

243 
z_°ªam
 
d_°ªam
;

245 
	`°r˝y
((*)
uncom¥
, "garbage");

247 
d_°ªam
.
zÆloc
 = zalloc;

248 
d_°ªam
.
z‰ì
 = zfree;

249 
d_°ªam
.
›aque
 = (
voidpf
)0;

251 
d_°ªam
.
√xt_ö
 = 
com¥
;

252 
d_°ªam
.
avaû_ö
 = 0;

253 
d_°ªam
.
√xt_out
 = 
uncom¥
;

255 
îr
 = 
	`öÊ©eInô
(&
d_°ªam
);

256 
	`CHECK_ERR
(
îr
, "inflateInit");

258 
d_°ªam
.
tŸÆ_out
 < 
uncom¥Lí
 && d_°ªam.
tŸÆ_ö
 < 
com¥Lí
) {

259 
d_°ªam
.
avaû_ö
 = d_°ªam.
avaû_out
 = 1;

260 
îr
 = 
	`öÊ©e
(&
d_°ªam
, 
Z_NO_FLUSH
);

261 i‡(
îr
 =
Z_STREAM_END
) ;

262 
	`CHECK_ERR
(
îr
, "inflate");

265 
îr
 = 
	`öÊ©eEnd
(&
d_°ªam
);

266 
	`CHECK_ERR
(
îr
, "inflateEnd");

268 i‡(
	`°rcmp
((*)
uncom¥
, 
hñlo
)) {

269 
	`Ârötf
(
°dîr
, "bad inflate\n");

270 
	`exô
(1);

272 
	`¥ötf
("öÊ©e(): %s\n", (*)
uncom¥
);

274 
	}
}

279 
	$ã°_œrge_deÊ©e
(
com¥
, 
com¥Lí
, 
uncom¥
, 
uncom¥Lí
)

280 
Byã
 *
com¥
, *
uncom¥
;

281 
uL⁄g
 
com¥Lí
, 
uncom¥Lí
;

283 
z_°ªam
 
c_°ªam
;

284 
îr
;

286 
c_°ªam
.
zÆloc
 = zalloc;

287 
c_°ªam
.
z‰ì
 = zfree;

288 
c_°ªam
.
›aque
 = (
voidpf
)0;

290 
îr
 = 
	`deÊ©eInô
(&
c_°ªam
, 
Z_BEST_SPEED
);

291 
	`CHECK_ERR
(
îr
, "deflateInit");

293 
c_°ªam
.
√xt_out
 = 
com¥
;

294 
c_°ªam
.
avaû_out
 = (
uI¡
)
com¥Lí
;

299 
c_°ªam
.
√xt_ö
 = 
uncom¥
;

300 
c_°ªam
.
avaû_ö
 = (
uI¡
)
uncom¥Lí
;

301 
îr
 = 
	`deÊ©e
(&
c_°ªam
, 
Z_NO_FLUSH
);

302 
	`CHECK_ERR
(
îr
, "deflate");

303 i‡(
c_°ªam
.
avaû_ö
 != 0) {

304 
	`Ârötf
(
°dîr
, "deflateÇot greedy\n");

305 
	`exô
(1);

309 
	`deÊ©eP¨ams
(&
c_°ªam
, 
Z_NO_COMPRESSION
, 
Z_DEFAULT_STRATEGY
);

310 
c_°ªam
.
√xt_ö
 = 
com¥
;

311 
c_°ªam
.
avaû_ö
 = (
uI¡
)
com¥Lí
/2;

312 
îr
 = 
	`deÊ©e
(&
c_°ªam
, 
Z_NO_FLUSH
);

313 
	`CHECK_ERR
(
îr
, "deflate");

316 
	`deÊ©eP¨ams
(&
c_°ªam
, 
Z_BEST_COMPRESSION
, 
Z_FILTERED
);

317 
c_°ªam
.
√xt_ö
 = 
uncom¥
;

318 
c_°ªam
.
avaû_ö
 = (
uI¡
)
uncom¥Lí
;

319 
îr
 = 
	`deÊ©e
(&
c_°ªam
, 
Z_NO_FLUSH
);

320 
	`CHECK_ERR
(
îr
, "deflate");

322 
îr
 = 
	`deÊ©e
(&
c_°ªam
, 
Z_FINISH
);

323 i‡(
îr
 !
Z_STREAM_END
) {

324 
	`Ârötf
(
°dîr
, "deflate shouldÑeport Z_STREAM_END\n");

325 
	`exô
(1);

327 
îr
 = 
	`deÊ©eEnd
(&
c_°ªam
);

328 
	`CHECK_ERR
(
îr
, "deflateEnd");

329 
	}
}

334 
	$ã°_œrge_öÊ©e
(
com¥
, 
com¥Lí
, 
uncom¥
, 
uncom¥Lí
)

335 
Byã
 *
com¥
, *
uncom¥
;

336 
uL⁄g
 
com¥Lí
, 
uncom¥Lí
;

338 
îr
;

339 
z_°ªam
 
d_°ªam
;

341 
	`°r˝y
((*)
uncom¥
, "garbage");

343 
d_°ªam
.
zÆloc
 = zalloc;

344 
d_°ªam
.
z‰ì
 = zfree;

345 
d_°ªam
.
›aque
 = (
voidpf
)0;

347 
d_°ªam
.
√xt_ö
 = 
com¥
;

348 
d_°ªam
.
avaû_ö
 = (
uI¡
)
com¥Lí
;

350 
îr
 = 
	`öÊ©eInô
(&
d_°ªam
);

351 
	`CHECK_ERR
(
îr
, "inflateInit");

354 
d_°ªam
.
√xt_out
 = 
uncom¥
;

355 
d_°ªam
.
avaû_out
 = (
uI¡
)
uncom¥Lí
;

356 
îr
 = 
	`öÊ©e
(&
d_°ªam
, 
Z_NO_FLUSH
);

357 i‡(
îr
 =
Z_STREAM_END
) ;

358 
	`CHECK_ERR
(
îr
, "large inflate");

361 
îr
 = 
	`öÊ©eEnd
(&
d_°ªam
);

362 
	`CHECK_ERR
(
îr
, "inflateEnd");

364 i‡(
d_°ªam
.
tŸÆ_out
 !2*
uncom¥Lí
 + 
com¥Lí
/2) {

365 
	`Ârötf
(
°dîr
, "badÜ¨gêöÊ©e: %ld\n", 
d_°ªam
.
tŸÆ_out
);

366 
	`exô
(1);

368 
	`¥ötf
("large_inflate(): OK\n");

370 
	}
}

375 
	$ã°_Êush
(
com¥
, 
com¥Lí
)

376 
Byã
 *
com¥
;

377 
uL⁄g
 *
com¥Lí
;

379 
z_°ªam
 
c_°ªam
;

380 
îr
;

381 
uI¡
 
Àn
 = (uI¡)
	`°æí
(
hñlo
)+1;

383 
c_°ªam
.
zÆloc
 = zalloc;

384 
c_°ªam
.
z‰ì
 = zfree;

385 
c_°ªam
.
›aque
 = (
voidpf
)0;

387 
îr
 = 
	`deÊ©eInô
(&
c_°ªam
, 
Z_DEFAULT_COMPRESSION
);

388 
	`CHECK_ERR
(
îr
, "deflateInit");

390 
c_°ªam
.
√xt_ö
 = (
z_c⁄°
 *)
hñlo
;

391 
c_°ªam
.
√xt_out
 = 
com¥
;

392 
c_°ªam
.
avaû_ö
 = 3;

393 
c_°ªam
.
avaû_out
 = (
uI¡
)*
com¥Lí
;

394 
îr
 = 
	`deÊ©e
(&
c_°ªam
, 
Z_FULL_FLUSH
);

395 
	`CHECK_ERR
(
îr
, "deflate");

397 
com¥
[3]++;

398 
c_°ªam
.
avaû_ö
 = 
Àn
 - 3;

400 
îr
 = 
	`deÊ©e
(&
c_°ªam
, 
Z_FINISH
);

401 i‡(
îr
 !
Z_STREAM_END
) {

402 
	`CHECK_ERR
(
îr
, "deflate");

404 
îr
 = 
	`deÊ©eEnd
(&
c_°ªam
);

405 
	`CHECK_ERR
(
îr
, "deflateEnd");

407 *
com¥Lí
 = 
c_°ªam
.
tŸÆ_out
;

408 
	}
}

413 
	$ã°_sync
(
com¥
, 
com¥Lí
, 
uncom¥
, 
uncom¥Lí
)

414 
Byã
 *
com¥
, *
uncom¥
;

415 
uL⁄g
 
com¥Lí
, 
uncom¥Lí
;

417 
îr
;

418 
z_°ªam
 
d_°ªam
;

420 
	`°r˝y
((*)
uncom¥
, "garbage");

422 
d_°ªam
.
zÆloc
 = zalloc;

423 
d_°ªam
.
z‰ì
 = zfree;

424 
d_°ªam
.
›aque
 = (
voidpf
)0;

426 
d_°ªam
.
√xt_ö
 = 
com¥
;

427 
d_°ªam
.
avaû_ö
 = 2;

429 
îr
 = 
	`öÊ©eInô
(&
d_°ªam
);

430 
	`CHECK_ERR
(
îr
, "inflateInit");

432 
d_°ªam
.
√xt_out
 = 
uncom¥
;

433 
d_°ªam
.
avaû_out
 = (
uI¡
)
uncom¥Lí
;

435 
	`öÊ©e
(&
d_°ªam
, 
Z_NO_FLUSH
);

436 
	`CHECK_ERR
(
îr
, "inflate");

438 
d_°ªam
.
avaû_ö
 = (
uI¡
)
com¥Lí
-2;

439 
îr
 = 
	`öÊ©eSync
(&
d_°ªam
);

440 
	`CHECK_ERR
(
îr
, "inflateSync");

442 
îr
 = 
	`öÊ©e
(&
d_°ªam
, 
Z_FINISH
);

443 i‡(
îr
 !
Z_DATA_ERROR
) {

444 
	`Ârötf
(
°dîr
, "inflate shouldÑeport DATA_ERROR\n");

446 
	`exô
(1);

448 
îr
 = 
	`öÊ©eEnd
(&
d_°ªam
);

449 
	`CHECK_ERR
(
îr
, "inflateEnd");

451 
	`¥ötf
("a·î inÊ©eSync(): hñ%s\n", (*)
uncom¥
);

452 
	}
}

457 
	$ã°_di˘_deÊ©e
(
com¥
, 
com¥Lí
)

458 
Byã
 *
com¥
;

459 
uL⁄g
 
com¥Lí
;

461 
z_°ªam
 
c_°ªam
;

462 
îr
;

464 
c_°ªam
.
zÆloc
 = zalloc;

465 
c_°ªam
.
z‰ì
 = zfree;

466 
c_°ªam
.
›aque
 = (
voidpf
)0;

468 
îr
 = 
	`deÊ©eInô
(&
c_°ªam
, 
Z_BEST_COMPRESSION
);

469 
	`CHECK_ERR
(
îr
, "deflateInit");

471 
îr
 = 
	`deÊ©eSëDi˘i⁄¨y
(&
c_°ªam
,

472 (c⁄° 
Byãf
*)
di˘i⁄¨y
, ()(dictionary));

473 
	`CHECK_ERR
(
îr
, "deflateSetDictionary");

475 
di˘Id
 = 
c_°ªam
.
adÀr
;

476 
c_°ªam
.
√xt_out
 = 
com¥
;

477 
c_°ªam
.
avaû_out
 = (
uI¡
)
com¥Lí
;

479 
c_°ªam
.
√xt_ö
 = (
z_c⁄°
 *)
hñlo
;

480 
c_°ªam
.
avaû_ö
 = (
uI¡
)
	`°æí
(
hñlo
)+1;

482 
îr
 = 
	`deÊ©e
(&
c_°ªam
, 
Z_FINISH
);

483 i‡(
îr
 !
Z_STREAM_END
) {

484 
	`Ârötf
(
°dîr
, "deflate shouldÑeport Z_STREAM_END\n");

485 
	`exô
(1);

487 
îr
 = 
	`deÊ©eEnd
(&
c_°ªam
);

488 
	`CHECK_ERR
(
îr
, "deflateEnd");

489 
	}
}

494 
	$ã°_di˘_öÊ©e
(
com¥
, 
com¥Lí
, 
uncom¥
, 
uncom¥Lí
)

495 
Byã
 *
com¥
, *
uncom¥
;

496 
uL⁄g
 
com¥Lí
, 
uncom¥Lí
;

498 
îr
;

499 
z_°ªam
 
d_°ªam
;

501 
	`°r˝y
((*)
uncom¥
, "garbage");

503 
d_°ªam
.
zÆloc
 = zalloc;

504 
d_°ªam
.
z‰ì
 = zfree;

505 
d_°ªam
.
›aque
 = (
voidpf
)0;

507 
d_°ªam
.
√xt_ö
 = 
com¥
;

508 
d_°ªam
.
avaû_ö
 = (
uI¡
)
com¥Lí
;

510 
îr
 = 
	`öÊ©eInô
(&
d_°ªam
);

511 
	`CHECK_ERR
(
îr
, "inflateInit");

513 
d_°ªam
.
√xt_out
 = 
uncom¥
;

514 
d_°ªam
.
avaû_out
 = (
uI¡
)
uncom¥Lí
;

517 
îr
 = 
	`öÊ©e
(&
d_°ªam
, 
Z_NO_FLUSH
);

518 i‡(
îr
 =
Z_STREAM_END
) ;

519 i‡(
îr
 =
Z_NEED_DICT
) {

520 i‡(
d_°ªam
.
adÀr
 !
di˘Id
) {

521 
	`Ârötf
(
°dîr
, "unexpected dictionary");

522 
	`exô
(1);

524 
îr
 = 
	`öÊ©eSëDi˘i⁄¨y
(&
d_°ªam
, (c⁄° 
Byãf
*)
di˘i⁄¨y
,

525 ()(
di˘i⁄¨y
));

527 
	`CHECK_ERR
(
îr
, "inflate with dict");

530 
îr
 = 
	`öÊ©eEnd
(&
d_°ªam
);

531 
	`CHECK_ERR
(
îr
, "inflateEnd");

533 i‡(
	`°rcmp
((*)
uncom¥
, 
hñlo
)) {

534 
	`Ârötf
(
°dîr
, "bad inflate with dict\n");

535 
	`exô
(1);

537 
	`¥ötf
("öÊ©êwôh di˘i⁄¨y: %s\n", (*)
uncom¥
);

539 
	}
}

545 
	$maö
(
¨gc
, 
¨gv
)

546 
¨gc
;

547 *
¨gv
[];

549 
Byã
 *
com¥
, *
uncom¥
;

550 
uL⁄g
 
com¥Lí
 = 10000*();

551 
uL⁄g
 
uncom¥Lí
 = 
com¥Lí
;

552 c⁄° * 
myVîsi⁄
 = 
ZLIB_VERSION
;

554 i‡(
	`zlibVîsi⁄
()[0] !
myVîsi⁄
[0]) {

555 
	`Ârötf
(
°dîr
, "incompatible zlib version\n");

556 
	`exô
(1);

558 } i‡(
	`°rcmp
(
	`zlibVîsi⁄
(), 
ZLIB_VERSION
) != 0) {

559 
	`Ârötf
(
°dîr
, "warning: different zlib version\n");

562 
	`¥ötf
("zlib version %s = 0x%04x, compile flags = 0x%lx\n",

563 
ZLIB_VERSION
, 
ZLIB_VERNUM
, 
	`zlibCompûeFœgs
());

565 
com¥
 = (
Byã
*)
	`ˇŒoc
((
uI¡
)
com¥Lí
, 1);

566 
uncom¥
 = (
Byã
*)
	`ˇŒoc
((
uI¡
)
uncom¥Lí
, 1);

570 i‡(
com¥
 =
Z_NULL
 || 
uncom¥
 == Z_NULL) {

571 
	`¥ötf
("out of memory\n");

572 
	`exô
(1);

575 #ifde‡
Z_SOLO


576 
¨gc
 = 
	`°æí
(
¨gv
[0]);

578 
	`ã°_com¥ess
(
com¥
, 
com¥Lí
, 
uncom¥
, 
uncom¥Lí
);

580 
	`ã°_gzio
((
¨gc
 > 1 ? 
¨gv
[1] : 
TESTFILE
),

581 
uncom¥
, 
uncom¥Lí
);

584 
	`ã°_deÊ©e
(
com¥
, 
com¥Lí
);

585 
	`ã°_öÊ©e
(
com¥
, 
com¥Lí
, 
uncom¥
, 
uncom¥Lí
);

587 
	`ã°_œrge_deÊ©e
(
com¥
, 
com¥Lí
, 
uncom¥
, 
uncom¥Lí
);

588 
	`ã°_œrge_öÊ©e
(
com¥
, 
com¥Lí
, 
uncom¥
, 
uncom¥Lí
);

590 
	`ã°_Êush
(
com¥
, &
com¥Lí
);

591 
	`ã°_sync
(
com¥
, 
com¥Lí
, 
uncom¥
, 
uncom¥Lí
);

592 
com¥Lí
 = 
uncom¥Lí
;

594 
	`ã°_di˘_deÊ©e
(
com¥
, 
com¥Lí
);

595 
	`ã°_di˘_öÊ©e
(
com¥
, 
com¥Lí
, 
uncom¥
, 
uncom¥Lí
);

597 
	`‰ì
(
com¥
);

598 
	`‰ì
(
uncom¥
);

601 
	}
}

	@zlib-1.2.8/test/infcover.c

8 
	~<°dio.h
>

9 
	~<°dlib.h
>

10 
	~<°rög.h
>

11 
	~<as£π.h
>

12 
	~"zlib.h
"

16 
	#ZLIB_INTERNAL


	)

17 
	~"ö·ªes.h
"

18 
	~"öÊ©e.h
"

20 
	#loˇl
 

	)

56 
	smem_ôem
 {

57 *
	m±r
;

58 
size_t
 
	msize
;

59 
mem_ôem
 *
	m√xt
;

63 
	smem_z⁄e
 {

64 
mem_ôem
 *
	mfú°
;

65 
size_t
 
	mtŸÆ
, 
	mhighw©î
;

66 
size_t
 
	mlimô
;

67 
	mnŸlifo
, 
	mrogue
;

71 
loˇl
 *
	$mem_Æloc
(*
mem
, 
cou¡
, 
size
)

73 *
±r
;

74 
mem_ôem
 *
ôem
;

75 
mem_z⁄e
 *
z⁄e
 = 
mem
;

76 
size_t
 
Àn
 = 
cou¡
 * (size_t)
size
;

79 i‡(
z⁄e
 =
NULL
 || (z⁄e->
limô
 && z⁄e->
tŸÆ
 + 
Àn
 > zone->limit))

80  
NULL
;

84 
±r
 = 
	`mÆloc
(
Àn
);

85 i‡(
±r
 =
NULL
)

86  
NULL
;

87 
	`mem£t
(
±r
, 0xa5, 
Àn
);

90 
ôem
 = 
	`mÆloc
((
mem_ôem
));

91 i‡(
ôem
 =
NULL
) {

92 
	`‰ì
(
±r
);

93  
NULL
;

95 
ôem
->
±r
 =Ötr;

96 
ôem
->
size
 = 
Àn
;

99 
ôem
->
√xt
 = 
z⁄e
->
fú°
;

100 
z⁄e
->
fú°
 = 
ôem
;

103 
z⁄e
->
tŸÆ
 +
ôem
->
size
;

104 i‡(
z⁄e
->
tŸÆ
 > z⁄e->
highw©î
)

105 
z⁄e
->
highw©î
 = z⁄e->
tŸÆ
;

108  
±r
;

109 
	}
}

112 
loˇl
 
	$mem_‰ì
(*
mem
, *
±r
)

114 
mem_ôem
 *
ôem
, *
√xt
;

115 
mem_z⁄e
 *
z⁄e
 = 
mem
;

118 i‡(
z⁄e
 =
NULL
) {

119 
	`‰ì
(
±r
);

125 
√xt
 = 
z⁄e
->
fú°
;

126 i‡(
√xt
) {

127 i‡(
√xt
->
±r
 ==Ötr)

128 
z⁄e
->
fú°
 = 
√xt
->next;

131 
ôem
 = 
√xt
;

132 
√xt
 = 
ôem
->next;

133 } 
√xt
 !
NULL
 &&Çext->
±r
 !=Ötr);

134 i‡(
√xt
) {

135 
ôem
->
√xt
 =Çext->next;

136 
z⁄e
->
nŸlifo
++;

143 i‡(
√xt
) {

144 
z⁄e
->
tŸÆ
 -
√xt
->
size
;

145 
	`‰ì
(
√xt
);

150 
z⁄e
->
rogue
++;

153 
	`‰ì
(
±r
);

154 
	}
}

158 
loˇl
 
	$mem_£tup
(
z_°ªam
 *
°rm
)

160 
mem_z⁄e
 *
z⁄e
;

162 
z⁄e
 = 
	`mÆloc
((
mem_z⁄e
));

163 
	`as£π
(
z⁄e
 !
NULL
);

164 
z⁄e
->
fú°
 = 
NULL
;

165 
z⁄e
->
tŸÆ
 = 0;

166 
z⁄e
->
highw©î
 = 0;

167 
z⁄e
->
limô
 = 0;

168 
z⁄e
->
nŸlifo
 = 0;

169 
z⁄e
->
rogue
 = 0;

170 
°rm
->
›aque
 = 
z⁄e
;

171 
°rm
->
zÆloc
 = 
mem_Æloc
;

172 
°rm
->
z‰ì
 = 
mem_‰ì
;

173 
	}
}

176 
loˇl
 
	$mem_limô
(
z_°ªam
 *
°rm
, 
size_t
 
limô
)

178 
mem_z⁄e
 *
z⁄e
 = 
°rm
->
›aque
;

180 
z⁄e
->
limô
 =Üimit;

181 
	}
}

184 
loˇl
 
	$mem_u£d
(
z_°ªam
 *
°rm
, *
¥efix
)

186 
mem_z⁄e
 *
z⁄e
 = 
°rm
->
›aque
;

188 
	`Ârötf
(
°dîr
, "%s: %luáŒoˇãd\n", 
¥efix
, 
z⁄e
->
tŸÆ
);

189 
	}
}

192 
loˇl
 
	$mem_high
(
z_°ªam
 *
°rm
, *
¥efix
)

194 
mem_z⁄e
 *
z⁄e
 = 
°rm
->
›aque
;

196 
	`Ârötf
(
°dîr
, "%s: %lu high w©î m¨k\n", 
¥efix
, 
z⁄e
->
highw©î
);

197 
	}
}

200 
loˇl
 
	$mem_d⁄e
(
z_°ªam
 *
°rm
, *
¥efix
)

202 
cou¡
 = 0;

203 
mem_ôem
 *
ôem
, *
√xt
;

204 
mem_z⁄e
 *
z⁄e
 = 
°rm
->
›aque
;

207 
	`mem_high
(
°rm
, 
¥efix
);

210 
ôem
 = 
z⁄e
->
fú°
;

211 
ôem
 !
NULL
) {

212 
	`‰ì
(
ôem
->
±r
);

213 
√xt
 = 
ôem
->next;

214 
	`‰ì
(
ôem
);

215 
ôem
 = 
√xt
;

216 
cou¡
++;

220 i‡(
cou¡
 || 
z⁄e
->
tŸÆ
)

221 
	`Ârötf
(
°dîr
, "** %s: %lu bytes in %d blocksÇot freed\n",

222 
¥efix
, 
z⁄e
->
tŸÆ
, 
cou¡
);

223 i‡(
z⁄e
->
nŸlifo
)

224 
	`Ârötf
(
°dîr
, "** %s: %d fªe†nŸ LIFO\n", 
¥efix
, 
z⁄e
->
nŸlifo
);

225 i‡(
z⁄e
->
rogue
)

226 
	`Ârötf
(
°dîr
, "** %s: %d freesÇotÑecognized\n",

227 
¥efix
, 
z⁄e
->
rogue
);

230 
	`‰ì
(
z⁄e
);

231 
°rm
->
›aque
 = 
Z_NULL
;

232 
°rm
->
zÆloc
 = 
Z_NULL
;

233 
°rm
->
z‰ì
 = 
Z_NULL
;

234 
	}
}

245 
loˇl
 *
	$h2b
(c⁄° *
hex
, *
Àn
)

247 *
ö
;

248 
√xt
, 
vÆ
;

250 
ö
 = 
	`mÆloc
((
	`°æí
(
hex
) + 1) >> 1);

251 i‡(
ö
 =
NULL
)

252  
NULL
;

253 
√xt
 = 0;

254 
vÆ
 = 1;

256 i‡(*
hex
 >= '0' && *hex <= '9')

257 
vÆ
 = (vÆ << 4Ë+ *
hex
 - '0';

258 i‡(*
hex
 >= 'A' && *hex <= 'F')

259 
vÆ
 = (vÆ << 4Ë+ *
hex
 - 'A' + 10;

260 i‡(*
hex
 >= 'a' && *hex <= 'f')

261 
vÆ
 = (vÆ << 4Ë+ *
hex
 - 'a' + 10;

262 i‡(
vÆ
 != 1 && val < 32)

263 
vÆ
 += 240;

264 i‡(
vÆ
 > 255) {

265 
ö
[
√xt
++] = 
vÆ
 & 0xff;

266 
vÆ
 = 1;

268 } *
hex
++);

269 i‡(
Àn
 !
NULL
)

270 *
Àn
 = 
√xt
;

271 
ö
 = 
	`ªÆlocf
(ö, 
√xt
);

272  
ö
;

273 
	}
}

284 
loˇl
 
	$öf
(*
hex
, *
wh©
, 
°ï
, 
wö
, 
Àn
,

285 
îr
)

287 
ªt
;

288 
have
;

289 *
ö
, *
out
;

290 
z_°ªam
 
°rm
, 
c›y
;

291 
gz_hódî
 
hód
;

293 
	`mem_£tup
(&
°rm
);

294 
°rm
.
avaû_ö
 = 0;

295 
°rm
.
√xt_ö
 = 
Z_NULL
;

296 
ªt
 = 
	`öÊ©eInô2
(&
°rm
, 
wö
);

297 i‡(
ªt
 !
Z_OK
) {

298 
	`mem_d⁄e
(&
°rm
, 
wh©
);

301 
out
 = 
	`mÆloc
(
Àn
); 
	`as£π
(ouà!
NULL
);

302 i‡(
wö
 == 47) {

303 
hód
.
exåa
 = 
out
;

304 
hód
.
exåa_max
 = 
Àn
;

305 
hód
.
«me
 = 
out
;

306 
hód
.
«me_max
 = 
Àn
;

307 
hód
.
commít
 = 
out
;

308 
hód
.
comm_max
 = 
Àn
;

309 
ªt
 = 
	`öÊ©eGëHódî
(&
°rm
, &
hód
); 
	`as£π
‘ë =
Z_OK
);

311 
ö
 = 
	`h2b
(
hex
, &
have
); 
	`as£π
(ö !
NULL
);

312 i‡(
°ï
 =0 || sã∞> 
have
)

313 
°ï
 = 
have
;

314 
°rm
.
avaû_ö
 = 
°ï
;

315 
have
 -
°ï
;

316 
°rm
.
√xt_ö
 = 
ö
;

318 
°rm
.
avaû_out
 = 
Àn
;

319 
°rm
.
√xt_out
 = 
out
;

320 
ªt
 = 
	`öÊ©e
(&
°rm
, 
Z_NO_FLUSH
); 
	`as£π
(
îr
 == 9 ||Ñet ==Érr);

321 i‡(
ªt
 !
Z_OK
 &&Ñë !
Z_BUF_ERROR
 &&Ñë !
Z_NEED_DICT
)

323 i‡(
ªt
 =
Z_NEED_DICT
) {

324 
ªt
 = 
	`öÊ©eSëDi˘i⁄¨y
(&
°rm
, 
ö
, 1);

325 
	`as£π
(
ªt
 =
Z_DATA_ERROR
);

326 
	`mem_limô
(&
°rm
, 1);

327 
ªt
 = 
	`öÊ©eSëDi˘i⁄¨y
(&
°rm
, 
out
, 0);

328 
	`as£π
(
ªt
 =
Z_MEM_ERROR
);

329 
	`mem_limô
(&
°rm
, 0);

330 ((
öÊ©e_°©e
 *)
°rm
.
°©e
)->
mode
 = 
DICT
;

331 
ªt
 = 
	`öÊ©eSëDi˘i⁄¨y
(&
°rm
, 
out
, 0);

332 
	`as£π
(
ªt
 =
Z_OK
);

333 
ªt
 = 
	`öÊ©e
(&
°rm
, 
Z_NO_FLUSH
); 
	`as£π
‘ë =
Z_BUF_ERROR
);

335 
ªt
 = 
	`öÊ©eC›y
(&
c›y
, &
°rm
); 
	`as£π
‘ë =
Z_OK
);

336 
ªt
 = 
	`öÊ©eEnd
(&
c›y
); 
	`as£π
‘ë =
Z_OK
);

337 
îr
 = 9;

338 
have
 +
°rm
.
avaû_ö
;

339 
°rm
.
avaû_ö
 = 
°ï
 > 
have
 ? have : step;

340 
have
 -
°rm
.
avaû_ö
;

341 } 
°rm
.
avaû_ö
);

342 
	`‰ì
(
ö
);

343 
	`‰ì
(
out
);

344 
ªt
 = 
	`öÊ©eRe£t2
(&
°rm
, -8); 
	`as£π
‘ë =
Z_OK
);

345 
ªt
 = 
	`öÊ©eEnd
(&
°rm
); 
	`as£π
‘ë =
Z_OK
);

346 
	`mem_d⁄e
(&
°rm
, 
wh©
);

347 
	}
}

350 
loˇl
 
	$covî_suµ‹t
()

352 
ªt
;

353 
z_°ªam
 
°rm
;

355 
	`mem_£tup
(&
°rm
);

356 
°rm
.
avaû_ö
 = 0;

357 
°rm
.
√xt_ö
 = 
Z_NULL
;

358 
ªt
 = 
	`öÊ©eInô
(&
°rm
); 
	`as£π
‘ë =
Z_OK
);

359 
	`mem_u£d
(&
°rm
, "inflate init");

360 
ªt
 = 
	`öÊ©ePrime
(&
°rm
, 5, 31); 
	`as£π
‘ë =
Z_OK
);

361 
ªt
 = 
	`öÊ©ePrime
(&
°rm
, -1, 0); 
	`as£π
‘ë =
Z_OK
);

362 
ªt
 = 
	`öÊ©eSëDi˘i⁄¨y
(&
°rm
, 
Z_NULL
, 0);

363 
	`as£π
(
ªt
 =
Z_STREAM_ERROR
);

364 
ªt
 = 
	`öÊ©eEnd
(&
°rm
); 
	`as£π
‘ë =
Z_OK
);

365 
	`mem_d⁄e
(&
°rm
, "prime");

367 
	`öf
("63 0", "f‹˚ wödowáŒoˇti⁄", 0, -15, 1, 
Z_OK
);

368 
	`öf
("63 18 5", "f‹˚ wödowÑïœ˚mít", 0, -8, 259, 
Z_OK
);

369 
	`öf
("63 18 68 30 d0 0 0", "f‹˚ s∂ô wödow upd©e", 4, -8, 259, 
Z_OK
);

370 
	`öf
("3 0", "u£ fixed blocks", 0, -15, 1, 
Z_STREAM_END
);

371 
	`öf
("", "bad wödow size", 0, 1, 0, 
Z_STREAM_ERROR
);

373 
	`mem_£tup
(&
°rm
);

374 
°rm
.
avaû_ö
 = 0;

375 
°rm
.
√xt_ö
 = 
Z_NULL
;

376 
ªt
 = 
	`öÊ©eInô_
(&
°rm
, 
ZLIB_VERSION
 - 1, ()(
z_°ªam
));

377 
	`as£π
(
ªt
 =
Z_VERSION_ERROR
);

378 
	`mem_d⁄e
(&
°rm
, "wrong version");

380 
°rm
.
avaû_ö
 = 0;

381 
°rm
.
√xt_ö
 = 
Z_NULL
;

382 
ªt
 = 
	`öÊ©eInô
(&
°rm
); 
	`as£π
‘ë =
Z_OK
);

383 
ªt
 = 
	`öÊ©eEnd
(&
°rm
); 
	`as£π
‘ë =
Z_OK
);

384 
	`Âuts
("öÊ©êbuût-ö mem‹yÑoutöes\n", 
°dîr
);

385 
	}
}

388 
loˇl
 
	$covî_wøp
()

390 
ªt
;

391 
z_°ªam
 
°rm
, 
c›y
;

392 
di˘
[257];

394 
ªt
 = 
	`öÊ©e
(
Z_NULL
, 0); 
	`as£π
‘ë =
Z_STREAM_ERROR
);

395 
ªt
 = 
	`öÊ©eEnd
(
Z_NULL
); 
	`as£π
‘ë =
Z_STREAM_ERROR
);

396 
ªt
 = 
	`öÊ©eC›y
(
Z_NULL
, Z_NULL); 
	`as£π
‘ë =
Z_STREAM_ERROR
);

397 
	`Âuts
("öÊ©êbadÖ¨amëîs\n", 
°dîr
);

399 
	`öf
("1‡8b 0 0", "bad gzù mëhod", 0, 31, 0, 
Z_DATA_ERROR
);

400 
	`öf
("1‡8b 8 80", "bad gzù fœgs", 0, 31, 0, 
Z_DATA_ERROR
);

401 
	`öf
("77 85", "bad zlib mëhod", 0, 15, 0, 
Z_DATA_ERROR
);

402 
	`öf
("8 99", "£àwödow sizê‰om hódî", 0, 0, 0, 
Z_OK
);

403 
	`öf
("78 9c", "bad zlib wödow size", 0, 8, 0, 
Z_DATA_ERROR
);

404 
	`öf
("78 9¯63 0 0 0 1 0 1", "checkádÀr32", 0, 15, 1, 
Z_STREAM_END
);

405 
	`öf
("1f 8b 8 1e 0 0 0 0 0 0 1 0 0 0 0 0 0", "bad header crc", 0, 47, 1,

406 
Z_DATA_ERROR
);

407 
	`öf
("1f 8b 8 2 0 0 0 0 0 0 1d 26 3 0 0 0 0 0 0 0 0 0", "check gzipÜength",

408 0, 47, 0, 
Z_STREAM_END
);

409 
	`öf
("78 90", "bad zlib hódî check", 0, 47, 0, 
Z_DATA_ERROR
);

410 
	`öf
("8 b8 0 0 0 1", "√ed di˘i⁄¨y", 0, 8, 0, 
Z_NEED_DICT
);

411 
	`öf
("78 9¯63 0", "compuãádÀr32", 0, 15, 1, 
Z_OK
);

413 
	`mem_£tup
(&
°rm
);

414 
°rm
.
avaû_ö
 = 0;

415 
°rm
.
√xt_ö
 = 
Z_NULL
;

416 
ªt
 = 
	`öÊ©eInô2
(&
°rm
, -8);

417 
°rm
.
avaû_ö
 = 2;

418 
°rm
.
√xt_ö
 = (*)"\x63";

419 
°rm
.
avaû_out
 = 1;

420 
°rm
.
√xt_out
 = (*)&
ªt
;

421 
	`mem_limô
(&
°rm
, 1);

422 
ªt
 = 
	`öÊ©e
(&
°rm
, 
Z_NO_FLUSH
); 
	`as£π
‘ë =
Z_MEM_ERROR
);

423 
ªt
 = 
	`öÊ©e
(&
°rm
, 
Z_NO_FLUSH
); 
	`as£π
‘ë =
Z_MEM_ERROR
);

424 
	`mem_limô
(&
°rm
, 0);

425 
	`mem£t
(
di˘
, 0, 257);

426 
ªt
 = 
	`öÊ©eSëDi˘i⁄¨y
(&
°rm
, 
di˘
, 257);

427 
	`as£π
(
ªt
 =
Z_OK
);

428 
	`mem_limô
(&
°rm
, ((
öÊ©e_°©e
) << 1) + 256);

429 
ªt
 = 
	`öÊ©ePrime
(&
°rm
, 16, 0); 
	`as£π
‘ë =
Z_OK
);

430 
°rm
.
avaû_ö
 = 2;

431 
°rm
.
√xt_ö
 = (*)"\x80";

432 
ªt
 = 
	`öÊ©eSync
(&
°rm
); 
	`as£π
‘ë =
Z_DATA_ERROR
);

433 
ªt
 = 
	`öÊ©e
(&
°rm
, 
Z_NO_FLUSH
); 
	`as£π
‘ë =
Z_STREAM_ERROR
);

434 
°rm
.
avaû_ö
 = 4;

435 
°rm
.
√xt_ö
 = (*)"\0\0\xff\xff";

436 
ªt
 = 
	`öÊ©eSync
(&
°rm
); 
	`as£π
‘ë =
Z_OK
);

437 ()
	`öÊ©eSyncPoöt
(&
°rm
);

438 
ªt
 = 
	`öÊ©eC›y
(&
c›y
, &
°rm
); 
	`as£π
‘ë =
Z_MEM_ERROR
);

439 
	`mem_limô
(&
°rm
, 0);

440 
ªt
 = 
	`öÊ©eUndîmöe
(&
°rm
, 1); 
	`as£π
‘ë =
Z_DATA_ERROR
);

441 ()
	`öÊ©eM¨k
(&
°rm
);

442 
ªt
 = 
	`öÊ©eEnd
(&
°rm
); 
	`as£π
‘ë =
Z_OK
);

443 
	`mem_d⁄e
(&
°rm
, "miscellaneous, force memoryÉrrors");

444 
	}
}

447 
loˇl
 
	$puŒ
(*
desc
, **
buf
)

449 
√xt
 = 0;

450 
d©
[] = {0x63, 0, 2, 0};

451 
öÊ©e_°©e
 *
°©e
;

453 i‡(
desc
 =
Z_NULL
) {

454 
√xt
 = 0;

457 
°©e
 = (*)((
z_°ªam
 *)
desc
)->state;

458 i‡(
°©e
 !
Z_NULL
)

459 
°©e
->
mode
 = 
SYNC
;

460  
√xt
 < (
d©
Ë? (*
buf
 = dat +Çext++, 1) : 0;

461 
	}
}

463 
loˇl
 
	$push
(*
desc
, *
buf
, 
Àn
)

465 
buf
 +
Àn
;

466  
desc
 !
Z_NULL
;

467 
	}
}

470 
loˇl
 
	$covî_back
()

472 
ªt
;

473 
z_°ªam
 
°rm
;

474 
wö
[32768];

476 
ªt
 = 
	`öÊ©eBackInô_
(
Z_NULL
, 0, 
wö
, 0, 0);

477 
	`as£π
(
ªt
 =
Z_VERSION_ERROR
);

478 
ªt
 = 
	`öÊ©eBackInô
(
Z_NULL
, 0, 
wö
); 
	`as£π
‘ë =
Z_STREAM_ERROR
);

479 
ªt
 = 
	`öÊ©eBack
(
Z_NULL
, Z_NULL, Z_NULL, Z_NULL, Z_NULL);

480 
	`as£π
(
ªt
 =
Z_STREAM_ERROR
);

481 
ªt
 = 
	`öÊ©eBackEnd
(
Z_NULL
); 
	`as£π
‘ë =
Z_STREAM_ERROR
);

482 
	`Âuts
("öÊ©eBack badÖ¨amëîs\n", 
°dîr
);

484 
	`mem_£tup
(&
°rm
);

485 
ªt
 = 
	`öÊ©eBackInô
(&
°rm
, 15, 
wö
); 
	`as£π
‘ë =
Z_OK
);

486 
°rm
.
avaû_ö
 = 2;

487 
°rm
.
√xt_ö
 = (*)"\x03";

488 
ªt
 = 
	`öÊ©eBack
(&
°rm
, 
puŒ
, 
Z_NULL
, 
push
, Z_NULL);

489 
	`as£π
(
ªt
 =
Z_STREAM_END
);

491 
°rm
.
avaû_ö
 = 3;

492 
°rm
.
√xt_ö
 = (*)"\x63\x00";

493 
ªt
 = 
	`öÊ©eBack
(&
°rm
, 
puŒ
, 
Z_NULL
, 
push
, &strm);

494 
	`as£π
(
ªt
 =
Z_BUF_ERROR
);

496 
ªt
 = 
	`öÊ©eBack
(&
°rm
, 
puŒ
, &°rm, 
push
, 
Z_NULL
);

497 
	`as£π
(
ªt
 =
Z_STREAM_ERROR
);

498 
ªt
 = 
	`öÊ©eBackEnd
(&
°rm
); 
	`as£π
‘ë =
Z_OK
);

499 
	`mem_d⁄e
(&
°rm
, "inflateBack bad state");

501 
ªt
 = 
	`öÊ©eBackInô
(&
°rm
, 15, 
wö
); 
	`as£π
‘ë =
Z_OK
);

502 
ªt
 = 
	`öÊ©eBackEnd
(&
°rm
); 
	`as£π
‘ë =
Z_OK
);

503 
	`Âuts
("öÊ©eBack buût-ö mem‹yÑoutöes\n", 
°dîr
);

504 
	}
}

507 
loˇl
 
	$åy
(*
hex
, *
id
, 
îr
)

509 
ªt
;

510 
Àn
, 
size
;

511 *
ö
, *
out
, *
wö
;

512 *
¥efix
;

513 
z_°ªam
 
°rm
;

516 
ö
 = 
	`h2b
(
hex
, &
Àn
);

517 
	`as£π
(
ö
 !
NULL
);

520 
size
 = 
Àn
 << 3;

521 
out
 = 
	`mÆloc
(
size
);

522 
	`as£π
(
out
 !
NULL
);

523 
wö
 = 
	`mÆloc
(32768);

524 
	`as£π
(
wö
 !
NULL
);

525 
¥efix
 = 
	`mÆloc
(
	`°æí
(
id
) + 6);

526 
	`as£π
(
¥efix
 !
NULL
);

529 
	`°r˝y
(
¥efix
, 
id
);

530 
	`°rˇt
(
¥efix
, "-late");

531 
	`mem_£tup
(&
°rm
);

532 
°rm
.
avaû_ö
 = 0;

533 
°rm
.
√xt_ö
 = 
Z_NULL
;

534 
ªt
 = 
	`öÊ©eInô2
(&
°rm
, 
îr
 < 0 ? 47 : -15);

535 
	`as£π
(
ªt
 =
Z_OK
);

536 
°rm
.
avaû_ö
 = 
Àn
;

537 
°rm
.
√xt_ö
 = 
ö
;

539 
°rm
.
avaû_out
 = 
size
;

540 
°rm
.
√xt_out
 = 
out
;

541 
ªt
 = 
	`öÊ©e
(&
°rm
, 
Z_TREES
);

542 
	`as£π
(
ªt
 !
Z_STREAM_ERROR
 &&Ñë !
Z_MEM_ERROR
);

543 i‡(
ªt
 =
Z_DATA_ERROR
 ||Ñë =
Z_NEED_DICT
)

545 } 
°rm
.
avaû_ö
 || såm.
avaû_out
 == 0);

546 i‡(
îr
) {

547 
	`as£π
(
ªt
 =
Z_DATA_ERROR
);

548 
	`as£π
(
	`°rcmp
(
id
, 
°rm
.
msg
) == 0);

550 
	`öÊ©eEnd
(&
°rm
);

551 
	`mem_d⁄e
(&
°rm
, 
¥efix
);

554 i‡(
îr
 >= 0) {

555 
	`°r˝y
(
¥efix
, 
id
);

556 
	`°rˇt
(
¥efix
, "-back");

557 
	`mem_£tup
(&
°rm
);

558 
ªt
 = 
	`öÊ©eBackInô
(&
°rm
, 15, 
wö
);

559 
	`as£π
(
ªt
 =
Z_OK
);

560 
°rm
.
avaû_ö
 = 
Àn
;

561 
°rm
.
√xt_ö
 = 
ö
;

562 
ªt
 = 
	`öÊ©eBack
(&
°rm
, 
puŒ
, 
Z_NULL
, 
push
, Z_NULL);

563 
	`as£π
(
ªt
 !
Z_STREAM_ERROR
);

564 i‡(
îr
) {

565 
	`as£π
(
ªt
 =
Z_DATA_ERROR
);

566 
	`as£π
(
	`°rcmp
(
id
, 
°rm
.
msg
) == 0);

568 
	`öÊ©eBackEnd
(&
°rm
);

569 
	`mem_d⁄e
(&
°rm
, 
¥efix
);

573 
	`‰ì
(
¥efix
);

574 
	`‰ì
(
wö
);

575 
	`‰ì
(
out
);

576 
	`‰ì
(
ö
);

577  
ªt
;

578 
	}
}

581 
loˇl
 
	$covî_öÊ©e
()

583 
	`åy
("0 0 0 0 0", "invalid stored blockÜengths", 1);

584 
	`åy
("3 0", "fixed", 0);

585 
	`åy
("6", "invalid blockÅype", 1);

586 
	`åy
("1 1 0 fe ff 0", "stored", 0);

587 
	`åy
("fc 0 0", "too manyÜength or distance symbols", 1);

588 
	`åy
("4 0 fe ff", "invalid codeÜengths set", 1);

589 
	`åy
("4 0 24 49 0", "invalid bitÜengthÑepeat", 1);

590 
	`åy
("4 0 24É9 ff ff", "invalid bitÜengthÑepeat", 1);

591 
	`åy
("4 0 24É9 ff 6d", "invalid code -- missingÉnd-of-block", 1);

592 
	`åy
("4 80 49 92 24 49 92 24 71 ff ff 93 11 0",

594 
	`åy
("4 80 49 92 24 49 92 24 f b4 ff ff c3 84", "invalid distances set", 1);

595 
	`åy
("4 c0 81 8 0 0 0 0 20 7fÉb b 0 0", "invalidÜiteral/length code", 1);

596 
	`åy
("2 7e ff ff", "invalid distance code", 1);

597 
	`åy
("c c0 81 0 0 0 0 0 90 ff 6b 4 0", "invalid distanceÅoo far back", 1);

600 
	`åy
("1f 8b 8 0 0 0 0 0 0 0 3 0 0 0 0 1", "incorrect data check", -1);

601 
	`åy
("1f 8b 8 0 0 0 0 0 0 0 3 0 0 0 0 0 0 0 0 1",

603 
	`åy
("5 c0 21 d 0 0 0 80 b0 fe 6d 2f 91 6c", "pull 17", 0);

604 
	`åy
("5É0 81 91 24 cb b2 2c 49É2 f 2e 8b 9a 47 56 9f fb feÉc d2 ff 1f",

606 
	`åy
("ed c0 1 1 0 0 0 40 20 ff 57 1b 42 2c 4f", "lengthÉxtra", 0);

607 
	`åy
("ed cf c1 b1 2c 47 10 c4 30 fa 6f 35 1d 1 82 59 3d fb be 2e 2a fc f c",

609 
	`åy
("ed c0 81 0 0 0 0 80á0 fdá9 17á9 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 "

611 
	`öf
("2 8 20 80 0 3 0", "inflate_fast TYPEÑeturn", 0, -15, 258,

612 
Z_STREAM_END
);

613 
	`öf
("63 18 5 40 c 0", "wödow wøp", 3, -8, 300, 
Z_OK
);

614 
	}
}

617 
loˇl
 
	$covî_åìs
()

619 
ªt
;

620 
bôs
;

621 
Àns
[16], 
w‹k
[16];

622 
code
 *
√xt
, 
èbÀ
[
ENOUGH_DISTS
];

626 
bôs
 = 0; bits < 15; bits++)

627 
Àns
[
bôs
] = ()(bits + 1);

628 
Àns
[15] = 15;

629 
√xt
 = 
èbÀ
;

630 
bôs
 = 15;

631 
ªt
 = 
	`öÊ©e_èbÀ
(
DISTS
, 
Àns
, 16, &
√xt
, &
bôs
, 
w‹k
);

632 
	`as£π
(
ªt
 == 1);

633 
√xt
 = 
èbÀ
;

634 
bôs
 = 1;

635 
ªt
 = 
	`öÊ©e_èbÀ
(
DISTS
, 
Àns
, 16, &
√xt
, &
bôs
, 
w‹k
);

636 
	`as£π
(
ªt
 == 1);

637 
	`Âuts
("öÊ©e_èbÀÇŸÉnoughÉº‹s\n", 
°dîr
);

638 
	}
}

641 
loˇl
 
	$covî_Á°
()

643 
	`öf
("e5É0 81ád 6d cb b2 2c c9 01 1e 59 63áe 7dÉe fb 4d fd b5 35 41 68"

644 " f‡7‡0‡0 0 0", "Á°ÜígthÉxå®bôs", 0, -8, 258, 
Z_DATA_ERROR
);

645 
	`öf
("25 fd 81 b5 6d 59 b6 6a 49Éaáf 35 6 34Éb 8c b9 f6 b9 1eÉf 67 49"

647 
Z_DATA_ERROR
);

648 
	`öf
("3 7e 0 0 0 0 0", "fast invalid distance code", 0, -8, 258,

649 
Z_DATA_ERROR
);

650 
	`öf
("1b 7 0 0 0 0 0", "fast invalidÜiteral/length code", 0, -8, 258,

651 
Z_DATA_ERROR
);

652 
	`öf
("d c7 1áeÉb 38 c 4 41á0 87 72 de df fb 1f b8 36 b1 38 5d ff ff 0",

653 "Á° 2ndÜevñ code†™dÅoÿÁ∏back", 0, -8, 258, 
Z_DATA_ERROR
);

654 
	`öf
("63 18 5 8¯10 8 0 0 0 0", "vîy comm⁄ ca£", 0, -8, 259, 
Z_OK
);

655 
	`öf
("63 60 60 18 c9 0 8 18 18 18 26 c0 28 0 29 0 0 0",

656 "c⁄tiguou†™d wø∞¨ound wödow", 6, -8, 259, 
Z_OK
);

657 
	`öf
("63 0 3 0 0 0 0 0", "copy direct from output", 0, -8, 259,

658 
Z_STREAM_END
);

659 
	}
}

661 
	$maö
()

663 
	`Ârötf
(
°dîr
, "%s\n", 
	`zlibVîsi⁄
());

664 
	`covî_suµ‹t
();

665 
	`covî_wøp
();

666 
	`covî_back
();

667 
	`covî_öÊ©e
();

668 
	`covî_åìs
();

669 
	`covî_Á°
();

671 
	}
}

	@zlib-1.2.8/test/minigzip.c

18 
	~"zlib.h
"

19 
	~<°dio.h
>

21 #ifde‡
STDC


22 
	~<°rög.h
>

23 
	~<°dlib.h
>

26 #ifde‡
USE_MMAP


27 
	~<sys/ty≥s.h
>

28 
	~<sys/mm™.h
>

29 
	~<sys/°©.h
>

32 #i‡
deföed
(
MSDOS
Ë|| deföed(
OS2
Ë|| deföed(
WIN32
Ë|| deföed(
__CYGWIN__
)

33 
	~<f˙é.h
>

34 
	~<io.h
>

35 #ifde‡
UNDER_CE


36 
	~<°dlib.h
>

38 
	#SET_BINARY_MODE
(
fûe
Ë
	`£tmode
(
	`fûío
(fûe), 
O_BINARY
)

	)

40 
	#SET_BINARY_MODE
(
fûe
)

	)

43 #ifde‡
_MSC_VER


44 
	#¢¥ötf
 
_¢¥ötf


	)

47 #ifde‡
VMS


48 
	#u∆ök
 
dñëe


	)

49 
	#GZ_SUFFIX
 "-gz"

	)

51 #ifde‡
RISCOS


52 
	#u∆ök
 
ªmove


	)

53 
	#GZ_SUFFIX
 "-gz"

	)

54 
	#fûío
(
fûe
Ëfûe->
__fûe


	)

56 #i‡
deföed
(
__MWERKS__
Ë&& 
__de°_os
 !
__be_os
 && __de°_o†!
__wö32_os


57 
	~<unix.h
>

60 #i‡!
deföed
(
Z_HAVE_UNISTD_H
Ë&& !deföed(
_LARGEFILE64_SOURCE
)

61 #i‚de‡
WIN32


62 
u∆ök
 
OF
((const *));

66 #i‡
deföed
(
UNDER_CE
)

67 
	~<wödows.h
>

68 
	#≥º‹
(
s
Ë
	`pwöîr‹
(s)

	)

80 *
	$°rwöîr‹
 (
îr‹
)

81 
DWORD
 
îr‹
;

83 
buf
[1024];

85 
wch¨_t
 *
msgbuf
;

86 
DWORD
 
œ°îr
 = 
	`GëLa°Eº‹
();

87 
DWORD
 
ch¨s
 = 
	`F‹m©Mesßge
(
FORMAT_MESSAGE_FROM_SYSTEM


88 | 
FORMAT_MESSAGE_ALLOCATE_BUFFER
,

89 
NULL
,

90 
îr‹
,

92 (
LPVOID
)&
msgbuf
,

94 
NULL
);

95 i‡(
ch¨s
 != 0) {

97 i‡(
ch¨s
 >= 2

98 && 
msgbuf
[
ch¨s
 - 2] == '\r' && msgbuf[chars - 1] == '\n') {

99 
ch¨s
 -= 2;

100 
msgbuf
[
ch¨s
] = 0;

103 i‡(
ch¨s
 >  (
buf
) - 1) {

104 
ch¨s
 =  (
buf
) - 1;

105 
msgbuf
[
ch¨s
] = 0;

108 
	`wc°ombs
(
buf
, 
msgbuf
, 
ch¨s
 + 1);

109 
	`LoˇlFªe
(
msgbuf
);

112 
	`•rötf
(
buf
, "unknow¿wö32Éº‹ (%ld)", 
îr‹
);

115 
	`SëLa°Eº‹
(
œ°îr
);

116  
buf
;

117 
	}
}

119 
	$pwöîr‹
 (
s
)

120 c⁄° *
s
;

122 i‡(
s
 && *s)

123 
	`Ârötf
(
°dîr
, "%s: %s\n", 
s
, 
	`°rwöîr‹
(
	`GëLa°Eº‹
 ()));

125 
	`Ârötf
(
°dîr
, "%s\n", 
	`°rwöîr‹
(
	`GëLa°Eº‹
 ()));

126 
	}
}

130 #i‚de‡
GZ_SUFFIX


131 
	#GZ_SUFFIX
 ".gz"

	)

133 
	#SUFFIX_LEN
 ((
GZ_SUFFIX
)-1)

	)

135 
	#BUFLEN
 16384

	)

136 
	#MAX_NAME_LEN
 1024

	)

138 #ifde‡
MAXSEG_64K


139 
	#loˇl
 

	)

142 
	#loˇl


	)

145 #ifde‡
Z_SOLO


148 #i‡
deföed
(
Z_HAVE_UNISTD_H
Ë|| deföed(
Z_LARGE
)

149 
	~<uni°d.h
>

152 *
myÆloc
 
OF
((*, , ));

153 
my‰ì
 
OF
((*, *));

155 *
	$myÆloc
(
q
, 
n
, 
m
)

156 *
q
;

157 
n
, 
m
;

159 
q
 = 
Z_NULL
;

160  
	`ˇŒoc
(
n
, 
m
);

161 
	}
}

163 
	$my‰ì
(
q
, 
p
)

164 *
q
, *
p
;

166 
q
 = 
Z_NULL
;

167 
	`‰ì
(
p
);

168 
	}
}

170 
	sgzFûe_s
 {

171 
FILE
 *
	mfûe
;

172 
	mwrôe
;

173 
	mîr
;

174 *
	mmsg
;

175 
z_°ªam
 
	m°rm
;

176 } *
	tgzFûe
;

178 
gzFûe
 
gz›í
 
OF
((const *, const *));

179 
gzFûe
 
gzd›í
 
OF
((, const *));

180 
gzFûe
 
gz_›í
 
OF
((const *, , const *));

182 
gzFûe
 
	$gz›í
(
∑th
, 
mode
)

183 c⁄° *
∑th
;

184 c⁄° *
mode
;

186  
	`gz_›í
(
∑th
, -1, 
mode
);

187 
	}
}

189 
gzFûe
 
	$gzd›í
(
fd
, 
mode
)

190 
fd
;

191 c⁄° *
mode
;

193  
	`gz_›í
(
NULL
, 
fd
, 
mode
);

194 
	}
}

196 
gzFûe
 
	$gz_›í
(
∑th
, 
fd
, 
mode
)

197 c⁄° *
∑th
;

198 
fd
;

199 c⁄° *
mode
;

201 
gzFûe
 
gz
;

202 
ªt
;

204 
gz
 = 
	`mÆloc
((
gzFûe_s
));

205 i‡(
gz
 =
NULL
)

206  
NULL
;

207 
gz
->
wrôe
 = 
	`°rchr
(
mode
, 'w'Ë!
NULL
;

208 
gz
->
°rm
.
zÆloc
 = 
myÆloc
;

209 
gz
->
°rm
.
z‰ì
 = 
my‰ì
;

210 
gz
->
°rm
.
›aque
 = 
Z_NULL
;

211 i‡(
gz
->
wrôe
)

212 
ªt
 = 
	`deÊ©eInô2
(&(
gz
->
°rm
), -1, 8, 15 + 16, 8, 0);

214 
gz
->
°rm
.
√xt_ö
 = 0;

215 
gz
->
°rm
.
avaû_ö
 = 
Z_NULL
;

216 
ªt
 = 
	`öÊ©eInô2
(&(
gz
->
°rm
), 15 + 16);

218 i‡(
ªt
 !
Z_OK
) {

219 
	`‰ì
(
gz
);

220  
NULL
;

222 
gz
->
fûe
 = 
∑th
 =
NULL
 ? 
	`fd›í
(
fd
, gz->
wrôe
 ? "wb" : "rb") :

223 
	`f›í
(
∑th
, 
gz
->
wrôe
 ? "wb" : "rb");

224 i‡(
gz
->
fûe
 =
NULL
) {

225 
gz
->
wrôe
 ? 
	`deÊ©eEnd
(&(gz->
°rm
)Ë: 
	`öÊ©eEnd
(&(gz->strm));

226 
	`‰ì
(
gz
);

227  
NULL
;

229 
gz
->
îr
 = 0;

230 
gz
->
msg
 = "";

231  
gz
;

232 
	}
}

234 
gzwrôe
 
OF
((
gzFûe
, const *, ));

236 
	$gzwrôe
(
gz
, 
buf
, 
Àn
)

237 
gzFûe
 
gz
;

238 c⁄° *
buf
;

239 
Àn
;

241 
z_°ªam
 *
°rm
;

242 
out
[
BUFLEN
];

244 i‡(
gz
 =
NULL
 || !gz->
wrôe
)

246 
°rm
 = &(
gz
->strm);

247 
°rm
->
√xt_ö
 = (*)
buf
;

248 
°rm
->
avaû_ö
 = 
Àn
;

250 
°rm
->
√xt_out
 = 
out
;

251 
°rm
->
avaû_out
 = 
BUFLEN
;

252 ()
	`deÊ©e
(
°rm
, 
Z_NO_FLUSH
);

253 
	`fwrôe
(
out
, 1, 
BUFLEN
 - 
°rm
->
avaû_out
, 
gz
->
fûe
);

254 } 
°rm
->
avaû_out
 == 0);

255  
Àn
;

256 
	}
}

258 
gzªad
 
OF
((
gzFûe
, *, ));

260 
	$gzªad
(
gz
, 
buf
, 
Àn
)

261 
gzFûe
 
gz
;

262 *
buf
;

263 
Àn
;

265 
ªt
;

266 
gŸ
;

267 
ö
[1];

268 
z_°ªam
 *
°rm
;

270 i‡(
gz
 =
NULL
 || gz->
wrôe
)

272 i‡(
gz
->
îr
)

274 
°rm
 = &(
gz
->strm);

275 
°rm
->
√xt_out
 = (*)
buf
;

276 
°rm
->
avaû_out
 = 
Àn
;

278 
gŸ
 = 
	`‰ód
(
ö
, 1, 1, 
gz
->
fûe
);

279 i‡(
gŸ
 == 0)

281 
°rm
->
√xt_ö
 = 
ö
;

282 
°rm
->
avaû_ö
 = 1;

283 
ªt
 = 
	`öÊ©e
(
°rm
, 
Z_NO_FLUSH
);

284 i‡(
ªt
 =
Z_DATA_ERROR
) {

285 
gz
->
îr
 = 
Z_DATA_ERROR
;

286 
gz
->
msg
 = 
°rm
->msg;

289 i‡(
ªt
 =
Z_STREAM_END
)

290 
	`öÊ©eRe£t
(
°rm
);

291 } 
°rm
->
avaû_out
);

292  
Àn
 - 
°rm
->
avaû_out
;

293 
	}
}

295 
gz˛o£
 
OF
((
gzFûe
));

297 
	$gz˛o£
(
gz
)

298 
gzFûe
 
gz
;

300 
z_°ªam
 *
°rm
;

301 
out
[
BUFLEN
];

303 i‡(
gz
 =
NULL
)

304  
Z_STREAM_ERROR
;

305 
°rm
 = &(
gz
->strm);

306 i‡(
gz
->
wrôe
) {

307 
°rm
->
√xt_ö
 = 
Z_NULL
;

308 
°rm
->
avaû_ö
 = 0;

310 
°rm
->
√xt_out
 = 
out
;

311 
°rm
->
avaû_out
 = 
BUFLEN
;

312 ()
	`deÊ©e
(
°rm
, 
Z_FINISH
);

313 
	`fwrôe
(
out
, 1, 
BUFLEN
 - 
°rm
->
avaû_out
, 
gz
->
fûe
);

314 } 
°rm
->
avaû_out
 == 0);

315 
	`deÊ©eEnd
(
°rm
);

318 
	`öÊ©eEnd
(
°rm
);

319 
	`f˛o£
(
gz
->
fûe
);

320 
	`‰ì
(
gz
);

321  
Z_OK
;

322 
	}
}

324 c⁄° *
gzîr‹
 
OF
((
gzFûe
, *));

326 c⁄° *
	$gzîr‹
(
gz
, 
îr
)

327 
gzFûe
 
gz
;

328 *
îr
;

330 *
îr
 = 
gz
->err;

331  
gz
->
msg
;

332 
	}
}

336 *
	g¥og
;

338 
îr‹
 
OF
((c⁄° *
msg
));

339 
gz_com¥ess
 
OF
((
FILE
 *
ö
, 
gzFûe
 
out
));

340 #ifde‡
USE_MMAP


341 
gz_com¥ess_mm≠
 
OF
((
FILE
 *
ö
, 
gzFûe
 
out
));

343 
gz_uncom¥ess
 
OF
((
gzFûe
 
ö
, 
FILE
 *
out
));

344 
fûe_com¥ess
 
OF
((*
fûe
, *
mode
));

345 
fûe_uncom¥ess
 
OF
((*
fûe
));

346 
maö
 
OF
((
¨gc
, *
¨gv
[]));

351 
	$îr‹
(
msg
)

352 c⁄° *
msg
;

354 
	`Ârötf
(
°dîr
, "%s: %s\n", 
¥og
, 
msg
);

355 
	`exô
(1);

356 
	}
}

362 
	$gz_com¥ess
(
ö
, 
out
)

363 
FILE
 *
ö
;

364 
gzFûe
 
out
;

366 
loˇl
 
buf
[
BUFLEN
];

367 
Àn
;

368 
îr
;

370 #ifde‡
USE_MMAP


374 i‡(
	`gz_com¥ess_mm≠
(
ö
, 
out
Ë=
Z_OK
) ;

377 
Àn
 = ()
	`‰ód
(
buf
, 1, (buf), 
ö
);

378 i‡(
	`„º‹
(
ö
)) {

379 
	`≥º‹
("fread");

380 
	`exô
(1);

382 i‡(
Àn
 == 0) ;

384 i‡(
	`gzwrôe
(
out
, 
buf
, ()
Àn
Ë!ÀnË
	`îr‹
(
	`gzîr‹
(out, &
îr
));

386 
	`f˛o£
(
ö
);

387 i‡(
	`gz˛o£
(
out
Ë!
Z_OK
Ë
	`îr‹
("failed gzclose");

388 
	}
}

390 #ifde‡
USE_MMAP


395 
	$gz_com¥ess_mm≠
(
ö
, 
out
)

396 
FILE
 *
ö
;

397 
gzFûe
 
out
;

399 
Àn
;

400 
îr
;

401 
ifd
 = 
	`fûío
(
ö
);

402 
ˇddr_t
 
buf
;

403 
off_t
 
buf_Àn
;

404 
°©
 
sb
;

407 i‡(
	`f°©
(
ifd
, &
sb
Ë< 0Ë 
Z_ERRNO
;

408 
buf_Àn
 = 
sb
.
°_size
;

409 i‡(
buf_Àn
 <0Ë 
Z_ERRNO
;

412 
buf
 = 
	`mm≠
((
ˇddr_t
Ë0, 
buf_Àn
, 
PROT_READ
, 
MAP_SHARED
, 
ifd
, (
off_t
)0);

413 i‡(
buf
 =(
ˇddr_t
)(-1)Ë 
Z_ERRNO
;

416 
Àn
 = 
	`gzwrôe
(
out
, (*)
buf
, ()
buf_Àn
);

418 i‡(
Àn
 !()
buf_Àn
Ë
	`îr‹
(
	`gzîr‹
(
out
, &
îr
));

420 
	`munm≠
(
buf
, 
buf_Àn
);

421 
	`f˛o£
(
ö
);

422 i‡(
	`gz˛o£
(
out
Ë!
Z_OK
Ë
	`îr‹
("failed gzclose");

423  
Z_OK
;

424 
	}
}

430 
	$gz_uncom¥ess
(
ö
, 
out
)

431 
gzFûe
 
ö
;

432 
FILE
 *
out
;

434 
loˇl
 
buf
[
BUFLEN
];

435 
Àn
;

436 
îr
;

439 
Àn
 = 
	`gzªad
(
ö
, 
buf
, (buf));

440 i‡(
Àn
 < 0Ë
	`îr‹
 (
	`gzîr‹
(
ö
, &
îr
));

441 i‡(
Àn
 == 0) ;

443 i‡(()
	`fwrôe
(
buf
, 1, ()
Àn
, 
out
) !=Üen) {

444 
	`îr‹
("failed fwrite");

447 i‡(
	`f˛o£
(
out
)Ë
	`îr‹
("failed fclose");

449 i‡(
	`gz˛o£
(
ö
Ë!
Z_OK
Ë
	`îr‹
("failed gzclose");

450 
	}
}

457 
	$fûe_com¥ess
(
fûe
, 
mode
)

458 *
fûe
;

459 *
mode
;

461 
loˇl
 
outfûe
[
MAX_NAME_LEN
];

462 
FILE
 *
ö
;

463 
gzFûe
 
out
;

465 i‡(
	`°æí
(
fûe
Ë+ såÀn(
GZ_SUFFIX
Ë>(
outfûe
)) {

466 
	`Ârötf
(
°dîr
, "%s: fûíamêtoÿl⁄g\n", 
¥og
);

467 
	`exô
(1);

470 #i‡!
	`deföed
(
NO_¢¥ötf
Ë&& !deföed(
NO_v¢¥ötf
)

471 
	`¢¥ötf
(
outfûe
, (outfûe), "%s%s", 
fûe
, 
GZ_SUFFIX
);

473 
	`°r˝y
(
outfûe
, 
fûe
);

474 
	`°rˇt
(
outfûe
, 
GZ_SUFFIX
);

477 
ö
 = 
	`f›í
(
fûe
, "rb");

478 i‡(
ö
 =
NULL
) {

479 
	`≥º‹
(
fûe
);

480 
	`exô
(1);

482 
out
 = 
	`gz›í
(
outfûe
, 
mode
);

483 i‡(
out
 =
NULL
) {

484 
	`Ârötf
(
°dîr
, "%s: c™'àgz›í %s\n", 
¥og
, 
outfûe
);

485 
	`exô
(1);

487 
	`gz_com¥ess
(
ö
, 
out
);

489 
	`u∆ök
(
fûe
);

490 
	}
}

496 
	$fûe_uncom¥ess
(
fûe
)

497 *
fûe
;

499 
loˇl
 
buf
[
MAX_NAME_LEN
];

500 *
öfûe
, *
outfûe
;

501 
FILE
 *
out
;

502 
gzFûe
 
ö
;

503 
size_t
 
Àn
 = 
	`°æí
(
fûe
);

505 i‡(
Àn
 + 
	`°æí
(
GZ_SUFFIX
Ë>(
buf
)) {

506 
	`Ârötf
(
°dîr
, "%s: fûíamêtoÿl⁄g\n", 
¥og
);

507 
	`exô
(1);

510 #i‡!
	`deföed
(
NO_¢¥ötf
Ë&& !deföed(
NO_v¢¥ötf
)

511 
	`¢¥ötf
(
buf
, (buf), "%s", 
fûe
);

513 
	`°r˝y
(
buf
, 
fûe
);

516 i‡(
Àn
 > 
SUFFIX_LEN
 && 
	`°rcmp
(
fûe
+Àn-SUFFIX_LEN, 
GZ_SUFFIX
) == 0) {

517 
öfûe
 = 
fûe
;

518 
outfûe
 = 
buf
;

519 
outfûe
[
Àn
-3] = '\0';

521 
outfûe
 = 
fûe
;

522 
öfûe
 = 
buf
;

523 #i‡!
	`deföed
(
NO_¢¥ötf
Ë&& !deföed(
NO_v¢¥ötf
)

524 
	`¢¥ötf
(
buf
 + 
Àn
, (bufË-Üí, "%s", 
GZ_SUFFIX
);

526 
	`°rˇt
(
öfûe
, 
GZ_SUFFIX
);

529 
ö
 = 
	`gz›í
(
öfûe
, "rb");

530 i‡(
ö
 =
NULL
) {

531 
	`Ârötf
(
°dîr
, "%s: c™'àgz›í %s\n", 
¥og
, 
öfûe
);

532 
	`exô
(1);

534 
out
 = 
	`f›í
(
outfûe
, "wb");

535 i‡(
out
 =
NULL
) {

536 
	`≥º‹
(
fûe
);

537 
	`exô
(1);

540 
	`gz_uncom¥ess
(
ö
, 
out
);

542 
	`u∆ök
(
öfûe
);

543 
	}
}

556 
	$maö
(
¨gc
, 
¨gv
)

557 
¨gc
;

558 *
¨gv
[];

560 
c›yout
 = 0;

561 
uncom¥
 = 0;

562 
gzFûe
 
fûe
;

563 *
b«me
, 
outmode
[20];

565 #i‡!
	`deföed
(
NO_¢¥ötf
Ë&& !deföed(
NO_v¢¥ötf
)

566 
	`¢¥ötf
(
outmode
, (outmode), "%s", "wb6 ");

568 
	`°r˝y
(
outmode
, "wb6 ");

571 
¥og
 = 
¨gv
[0];

572 
b«me
 = 
	`°ºchr
(
¨gv
[0], '/');

573 i‡(
b«me
)

574 
b«me
++;

576 
b«me
 = 
¨gv
[0];

577 
¨gc
--, 
¨gv
++;

579 i‡(!
	`°rcmp
(
b«me
, "gunzip"))

580 
uncom¥
 = 1;

581 i‡(!
	`°rcmp
(
b«me
, "zcat"))

582 
c›yout
 = 
uncom¥
 = 1;

584 
¨gc
 > 0) {

585 i‡(
	`°rcmp
(*
¨gv
, "-c") == 0)

586 
c›yout
 = 1;

587 i‡(
	`°rcmp
(*
¨gv
, "-d") == 0)

588 
uncom¥
 = 1;

589 i‡(
	`°rcmp
(*
¨gv
, "-f") == 0)

590 
outmode
[3] = 'f';

591 i‡(
	`°rcmp
(*
¨gv
, "-h") == 0)

592 
outmode
[3] = 'h';

593 i‡(
	`°rcmp
(*
¨gv
, "-r") == 0)

594 
outmode
[3] = 'R';

595 i‡((*
¨gv
)[0] == '-' && (*argv)[1] >= '1' && (*argv)[1] <= '9' &&

596 (*
¨gv
)[2] == 0)

597 
outmode
[2] = (*
¨gv
)[1];

600 
¨gc
--, 
¨gv
++;

602 i‡(
outmode
[3] == ' ')

603 
outmode
[3] = 0;

604 i‡(
¨gc
 == 0) {

605 
	`SET_BINARY_MODE
(
°dö
);

606 
	`SET_BINARY_MODE
(
°dout
);

607 i‡(
uncom¥
) {

608 
fûe
 = 
	`gzd›í
(
	`fûío
(
°dö
), "rb");

609 i‡(
fûe
 =
NULL
Ë
	`îr‹
("can't gzdopen stdin");

610 
	`gz_uncom¥ess
(
fûe
, 
°dout
);

612 
fûe
 = 
	`gzd›í
(
	`fûío
(
°dout
), 
outmode
);

613 i‡(
fûe
 =
NULL
Ë
	`îr‹
("can't gzdopen stdout");

614 
	`gz_com¥ess
(
°dö
, 
fûe
);

617 i‡(
c›yout
) {

618 
	`SET_BINARY_MODE
(
°dout
);

621 i‡(
uncom¥
) {

622 i‡(
c›yout
) {

623 
fûe
 = 
	`gz›í
(*
¨gv
, "rb");

624 i‡(
fûe
 =
NULL
)

625 
	`Ârötf
(
°dîr
, "%s: c™'àgz›í %s\n", 
¥og
, *
¨gv
);

627 
	`gz_uncom¥ess
(
fûe
, 
°dout
);

629 
	`fûe_uncom¥ess
(*
¨gv
);

632 i‡(
c›yout
) {

633 
FILE
 * 
ö
 = 
	`f›í
(*
¨gv
, "rb");

635 i‡(
ö
 =
NULL
) {

636 
	`≥º‹
(*
¨gv
);

638 
fûe
 = 
	`gzd›í
(
	`fûío
(
°dout
), 
outmode
);

639 i‡(
fûe
 =
NULL
Ë
	`îr‹
("can't gzdopen stdout");

641 
	`gz_com¥ess
(
ö
, 
fûe
);

645 
	`fûe_com¥ess
(*
¨gv
, 
outmode
);

648 } 
¨gv
++, --
¨gc
);

651 
	}
}

	@zlib-1.2.8/trees.c

37 
	~"deÊ©e.h
"

39 #ifde‡
DEBUG


40 
	~<˘y≥.h
>

47 
	#MAX_BL_BITS
 7

	)

50 
	#END_BLOCK
 256

	)

53 
	#REP_3_6
 16

	)

56 
	#REPZ_3_10
 17

	)

59 
	#REPZ_11_138
 18

	)

62 
loˇl
 c⁄° 
	gexåa_lbôs
[
LENGTH_CODES
]

65 
loˇl
 c⁄° 
	gexåa_dbôs
[
D_CODES
]

68 
loˇl
 c⁄° 
	gexåa_blbôs
[
BL_CODES
]

71 
loˇl
 c⁄° 
uch
 
	gbl_‹dî
[
BL_CODES
]

81 
	#DIST_CODE_LEN
 512

	)

83 #i‡
deföed
(
GEN_TREES_H
Ë|| !deföed(
STDC
)

86 
loˇl
 
˘_d©a
 
	g°©ic_…ªe
[
L_CODES
+2];

93 
loˇl
 
˘_d©a
 
	g°©ic_dåì
[
D_CODES
];

98 
uch
 
	g_di°_code
[
DIST_CODE_LEN
];

104 
uch
 
	g_Àngth_code
[
MAX_MATCH
-
MIN_MATCH
+1];

107 
loˇl
 
	gba£_Àngth
[
LENGTH_CODES
];

110 
loˇl
 
	gba£_di°
[
D_CODES
];

114 
	~"åìs.h
"

117 
	s°©ic_åì_desc_s
 {

118 c⁄° 
˘_d©a
 *
	m°©ic_åì
;

119 c⁄° 
ötf
 *
	mexåa_bôs
;

120 
	mexåa_ba£
;

121 
	mñems
;

122 
	mmax_Àngth
;

125 
loˇl
 
°©ic_åì_desc
 
	g°©ic_l_desc
 =

126 {
°©ic_…ªe
, 
exåa_lbôs
, 
LITERALS
+1, 
L_CODES
, 
MAX_BITS
};

128 
loˇl
 
°©ic_åì_desc
 
	g°©ic_d_desc
 =

129 {
°©ic_dåì
, 
exåa_dbôs
, 0, 
D_CODES
, 
MAX_BITS
};

131 
loˇl
 
°©ic_åì_desc
 
	g°©ic_bl_desc
 =

132 {(c⁄° 
˘_d©a
 *)0, 
exåa_blbôs
, 0, 
BL_CODES
, 
MAX_BL_BITS
};

138 
loˇl
 
å_°©ic_öô
 
OF
(());

139 
loˇl
 
öô_block
 
OF
((
deÊ©e_°©e
 *
s
));

140 
loˇl
 
pqdownhóp
 
OF
((
deÊ©e_°©e
 *
s
, 
˘_d©a
 *
åì
, 
k
));

141 
loˇl
 
gí_bôÀn
 
OF
((
deÊ©e_°©e
 *
s
, 
åì_desc
 *
desc
));

142 
loˇl
 
gí_codes
 
OF
((
˘_d©a
 *
åì
, 
max_code
, 
ushf
 *
bl_cou¡
));

143 
loˇl
 
buûd_åì
 
OF
((
deÊ©e_°©e
 *
s
, 
åì_desc
 *
desc
));

144 
loˇl
 
sˇn_åì
 
OF
((
deÊ©e_°©e
 *
s
, 
˘_d©a
 *
åì
, 
max_code
));

145 
loˇl
 
£nd_åì
 
OF
((
deÊ©e_°©e
 *
s
, 
˘_d©a
 *
åì
, 
max_code
));

146 
loˇl
 
buûd_bl_åì
 
OF
((
deÊ©e_°©e
 *
s
));

147 
loˇl
 
£nd_Æl_åìs
 
OF
((
deÊ©e_°©e
 *
s
, 
lcodes
, 
dcodes
,

148 
blcodes
));

149 
loˇl
 
com¥ess_block
 
OF
((
deÊ©e_°©e
 *
s
, c⁄° 
˘_d©a
 *
…ªe
,

150 c⁄° 
˘_d©a
 *
dåì
));

151 
loˇl
 
dëe˘_d©a_ty≥
 
OF
((
deÊ©e_°©e
 *
s
));

152 
loˇl
 
bi_ªvî£
 
OF
((
vÆue
, 
Àngth
));

153 
loˇl
 
bi_wödup
 
OF
((
deÊ©e_°©e
 *
s
));

154 
loˇl
 
bi_Êush
 
OF
((
deÊ©e_°©e
 *
s
));

155 
loˇl
 
c›y_block
 
OF
((
deÊ©e_°©e
 *
s
, 
ch¨f
 *
buf
, 
Àn
,

156 
hódî
));

158 #ifde‡
GEN_TREES_H


159 
loˇl
 
gí_åìs_hódî
 
OF
(());

162 #i‚de‡
DEBUG


163 
	#£nd_code
(
s
, 
c
, 
åì
Ë
	`£nd_bôs
(s,Åªe[c].
Code
,Åªe[c].
Lí
)

	)

167 
	#£nd_code
(
s
, 
c
, 
åì
) \

168 { i‡(
z_vîbo£
>2Ë
	`Ârötf
(
°dîr
,"\ncd %3d ",(
c
)); \

169 
	`£nd_bôs
(
s
, 
åì
[
c
].
Code
,Åªe[c].
Lí
); }

	)

176 
	#put_sh‹t
(
s
, 
w
) { \

177 
	`put_byã
(
s
, (
uch
)((
w
) & 0xff)); \

178 
	`put_byã
(
s
, (
uch
)((
ush
)(
w
) >> 8)); \

179 }

	)

185 #ifde‡
DEBUG


186 
loˇl
 
£nd_bôs
 
OF
((
deÊ©e_°©e
 *
s
, 
vÆue
, 
Àngth
));

188 
loˇl
 
	$£nd_bôs
(
s
, 
vÆue
, 
Àngth
)

189 
deÊ©e_°©e
 *
s
;

190 
vÆue
;

191 
Àngth
;

193 
	`Tø˚vv
((
°dîr
,"Ü %2d v %4x ", 
Àngth
, 
vÆue
));

194 
	`As£π
(
Àngth
 > 0 &&Üength <= 15, "invalidÜength");

195 
s
->
bôs_£¡
 +(
ulg
)
Àngth
;

201 i‡(
s
->
bi_vÆid
 > ()
Buf_size
 - 
Àngth
) {

202 
s
->
bi_buf
 |(
ush
)
vÆue
 << s->
bi_vÆid
;

203 
	`put_sh‹t
(
s
, s->
bi_buf
);

204 
s
->
bi_buf
 = (
ush
)
vÆue
 >> (
Buf_size
 - s->
bi_vÆid
);

205 
s
->
bi_vÆid
 +
Àngth
 - 
Buf_size
;

207 
s
->
bi_buf
 |(
ush
)
vÆue
 << s->
bi_vÆid
;

208 
s
->
bi_vÆid
 +
Àngth
;

210 
	}
}

213 
	#£nd_bôs
(
s
, 
vÆue
, 
Àngth
) \

214 { 
Àn
 = 
Àngth
;\

215 i‡(
s
->
bi_vÆid
 > ()
Buf_size
 - 
Àn
) {\

216 
vÆ
 = 
vÆue
;\

217 
s
->
bi_buf
 |(
ush
)
vÆ
 << s->
bi_vÆid
;\

218 
	`put_sh‹t
(
s
, s->
bi_buf
);\

219 
s
->
bi_buf
 = (
ush
)
vÆ
 >> (
Buf_size
 - s->
bi_vÆid
);\

220 
s
->
bi_vÆid
 +
Àn
 - 
Buf_size
;\

222 
s
->
bi_buf
 |(
ush
)(
vÆue
Ë<< s->
bi_vÆid
;\

223 
s
->
bi_vÆid
 +
Àn
;\

225 }

	)

234 
loˇl
 
	$å_°©ic_öô
()

236 #i‡
	`deföed
(
GEN_TREES_H
Ë|| !deföed(
STDC
)

237 
°©ic_öô_d⁄e
 = 0;

238 
n
;

239 
bôs
;

240 
Àngth
;

241 
code
;

242 
di°
;

243 
ush
 
bl_cou¡
[
MAX_BITS
+1];

246 i‡(
°©ic_öô_d⁄e
) ;

249 #ifde‡
NO_INIT_GLOBAL_POINTERS


250 
°©ic_l_desc
.
°©ic_åì
 = 
°©ic_…ªe
;

251 
°©ic_l_desc
.
exåa_bôs
 = 
exåa_lbôs
;

252 
°©ic_d_desc
.
°©ic_åì
 = 
°©ic_dåì
;

253 
°©ic_d_desc
.
exåa_bôs
 = 
exåa_dbôs
;

254 
°©ic_bl_desc
.
exåa_bôs
 = 
exåa_blbôs
;

258 
Àngth
 = 0;

259 
code
 = 0; codê< 
LENGTH_CODES
-1; code++) {

260 
ba£_Àngth
[
code
] = 
Àngth
;

261 
n
 = 0;Ç < (1<<
exåa_lbôs
[
code
]);Ç++) {

262 
_Àngth_code
[
Àngth
++] = (
uch
)
code
;

265 
	`As£π
 (
Àngth
 == 256, "tr_static_init:Üength != 256");

270 
_Àngth_code
[
Àngth
-1] = (
uch
)
code
;

273 
di°
 = 0;

274 
code
 = 0 ; code < 16; code++) {

275 
ba£_di°
[
code
] = 
di°
;

276 
n
 = 0;Ç < (1<<
exåa_dbôs
[
code
]);Ç++) {

277 
_di°_code
[
di°
++] = (
uch
)
code
;

280 
	`As£π
 (
di°
 == 256, "tr_static_init: dist != 256");

281 
di°
 >>= 7;

282  ; 
code
 < 
D_CODES
; code++) {

283 
ba£_di°
[
code
] = 
di°
 << 7;

284 
n
 = 0;Ç < (1<<(
exåa_dbôs
[
code
]-7));Ç++) {

285 
_di°_code
[256 + 
di°
++] = (
uch
)
code
;

288 
	`As£π
 (
di°
 == 256, "tr_static_init: 256+dist != 512");

291 
bôs
 = 0; bô†<
MAX_BITS
; bôs++Ë
bl_cou¡
[bits] = 0;

292 
n
 = 0;

293 
n
 <143Ë
°©ic_…ªe
[n++].
Lí
 = 8, 
bl_cou¡
[8]++;

294 
n
 <255Ë
°©ic_…ªe
[n++].
Lí
 = 9, 
bl_cou¡
[9]++;

295 
n
 <279Ë
°©ic_…ªe
[n++].
Lí
 = 7, 
bl_cou¡
[7]++;

296 
n
 <287Ë
°©ic_…ªe
[n++].
Lí
 = 8, 
bl_cou¡
[8]++;

301 
	`gí_codes
((
˘_d©a
 *)
°©ic_…ªe
, 
L_CODES
+1, 
bl_cou¡
);

304 
n
 = 0;Ç < 
D_CODES
;Ç++) {

305 
°©ic_dåì
[
n
].
Lí
 = 5;

306 
°©ic_dåì
[
n
].
Code
 = 
	`bi_ªvî£
(()n, 5);

308 
°©ic_öô_d⁄e
 = 1;

310 #ifde‡
GEN_TREES_H


311 
	`gí_åìs_hódî
();

314 
	}
}

319 #ifde‡
GEN_TREES_H


320 #i‚de‡
DEBUG


321 
	~<°dio.h
>

324 
	#SEPARATOR
(
i
, 
œ°
, 
width
) \

325 ((
i
Ë=(
œ°
)? "\n};\n\n" : \

326 ((
i
Ë% (
width
Ë=(width)-1 ? ",\n" : ", "))

	)

328 
	$gí_åìs_hódî
()

330 
FILE
 *
hódî
 = 
	`f›í
("trees.h", "w");

331 
i
;

333 
	`As£π
 (
hódî
 !
NULL
, "Can't openÅrees.h");

334 
	`Ârötf
(
hódî
,

337 
	`Ârötf
(
hódî
, "local const ct_data static_ltree[L_CODES+2] = {\n");

338 
i
 = 0; i < 
L_CODES
+2; i++) {

339 
	`Ârötf
(
hódî
, "{{%3u},{%3u}}%s", 
°©ic_…ªe
[
i
].
Code
,

340 
°©ic_…ªe
[
i
].
Lí
, 
	`SEPARATOR
(i, 
L_CODES
+1, 5));

343 
	`Ârötf
(
hódî
, "local const ct_data static_dtree[D_CODES] = {\n");

344 
i
 = 0; i < 
D_CODES
; i++) {

345 
	`Ârötf
(
hódî
, "{{%2u},{%2u}}%s", 
°©ic_dåì
[
i
].
Code
,

346 
°©ic_dåì
[
i
].
Lí
, 
	`SEPARATOR
(i, 
D_CODES
-1, 5));

349 
	`Ârötf
(
hódî
, "const uch ZLIB_INTERNAL _dist_code[DIST_CODE_LEN] = {\n");

350 
i
 = 0; i < 
DIST_CODE_LEN
; i++) {

351 
	`Ârötf
(
hódî
, "%2u%s", 
_di°_code
[
i
],

352 
	`SEPARATOR
(
i
, 
DIST_CODE_LEN
-1, 20));

355 
	`Ârötf
(
hódî
,

357 
i
 = 0; i < 
MAX_MATCH
-
MIN_MATCH
+1; i++) {

358 
	`Ârötf
(
hódî
, "%2u%s", 
_Àngth_code
[
i
],

359 
	`SEPARATOR
(
i
, 
MAX_MATCH
-
MIN_MATCH
, 20));

362 
	`Ârötf
(
hódî
, "local const int base_length[LENGTH_CODES] = {\n");

363 
i
 = 0; i < 
LENGTH_CODES
; i++) {

364 
	`Ârötf
(
hódî
, "%1u%s", 
ba£_Àngth
[
i
],

365 
	`SEPARATOR
(
i
, 
LENGTH_CODES
-1, 20));

368 
	`Ârötf
(
hódî
, "local const int base_dist[D_CODES] = {\n");

369 
i
 = 0; i < 
D_CODES
; i++) {

370 
	`Ârötf
(
hódî
, "%5u%s", 
ba£_di°
[
i
],

371 
	`SEPARATOR
(
i
, 
D_CODES
-1, 10));

374 
	`f˛o£
(
hódî
);

375 
	}
}

381 
ZLIB_INTERNAL
 
	$_å_öô
(
s
)

382 
deÊ©e_°©e
 *
s
;

384 
	`å_°©ic_öô
();

386 
s
->
l_desc
.
dyn_åì
 = s->
dyn_…ªe
;

387 
s
->
l_desc
.
°©_desc
 = &
°©ic_l_desc
;

389 
s
->
d_desc
.
dyn_åì
 = s->
dyn_dåì
;

390 
s
->
d_desc
.
°©_desc
 = &
°©ic_d_desc
;

392 
s
->
bl_desc
.
dyn_åì
 = s->
bl_åì
;

393 
s
->
bl_desc
.
°©_desc
 = &
°©ic_bl_desc
;

395 
s
->
bi_buf
 = 0;

396 
s
->
bi_vÆid
 = 0;

397 #ifde‡
DEBUG


398 
s
->
com¥es£d_Àn
 = 0L;

399 
s
->
bôs_£¡
 = 0L;

403 
	`öô_block
(
s
);

404 
	}
}

409 
loˇl
 
	$öô_block
(
s
)

410 
deÊ©e_°©e
 *
s
;

412 
n
;

415 
n
 = 0;Ç < 
L_CODES
;Ç++Ë
s
->
dyn_…ªe
[n].
Fªq
 = 0;

416 
n
 = 0;Ç < 
D_CODES
;Ç++Ë
s
->
dyn_dåì
[n].
Fªq
 = 0;

417 
n
 = 0;Ç < 
BL_CODES
;Ç++Ë
s
->
bl_åì
[n].
Fªq
 = 0;

419 
s
->
dyn_…ªe
[
END_BLOCK
].
Fªq
 = 1;

420 
s
->
›t_Àn
 = s->
°©ic_Àn
 = 0L;

421 
s
->
œ°_lô
 = s->
m©ches
 = 0;

422 
	}
}

424 
	#SMALLEST
 1

	)

432 
	#pqªmove
(
s
, 
åì
, 
t›
) \

434 
t›
 = 
s
->
hóp
[
SMALLEST
]; \

435 
s
->
hóp
[
SMALLEST
] = s->hóp[s->
hóp_Àn
--]; \

436 
	`pqdownhóp
(
s
, 
åì
, 
SMALLEST
); \

437 }

	)

443 
	#smÆÀr
(
åì
, 
n
, 
m
, 
dïth
) \

444 (
åì
[
n
].
Fªq
 <Åªe[
m
].Freq || \

445 (
åì
[
n
].
Fªq
 =åì[
m
].Fªq && 
dïth
[n] <dïth[m]))

	)

453 
loˇl
 
	$pqdownhóp
(
s
, 
åì
, 
k
)

454 
deÊ©e_°©e
 *
s
;

455 
˘_d©a
 *
åì
;

456 
k
;

458 
v
 = 
s
->
hóp
[
k
];

459 
j
 = 
k
 << 1;

460 
j
 <
s
->
hóp_Àn
) {

462 i‡(
j
 < 
s
->
hóp_Àn
 &&

463 
	`smÆÀr
(
åì
, 
s
->
hóp
[
j
+1], s->hóp[j], s->
dïth
)) {

464 
j
++;

467 i‡(
	`smÆÀr
(
åì
, 
v
, 
s
->
hóp
[
j
], s->
dïth
)) ;

470 
s
->
hóp
[
k
] = s->hóp[
j
]; k = j;

473 
j
 <<= 1;

475 
s
->
hóp
[
k
] = 
v
;

476 
	}
}

488 
loˇl
 
	$gí_bôÀn
(
s
, 
desc
)

489 
deÊ©e_°©e
 *
s
;

490 
åì_desc
 *
desc
;

492 
˘_d©a
 *
åì
 = 
desc
->
dyn_åì
;

493 
max_code
 = 
desc
->max_code;

494 c⁄° 
˘_d©a
 *
°ªe
 = 
desc
->
°©_desc
->
°©ic_åì
;

495 c⁄° 
ötf
 *
exåa
 = 
desc
->
°©_desc
->
exåa_bôs
;

496 
ba£
 = 
desc
->
°©_desc
->
exåa_ba£
;

497 
max_Àngth
 = 
desc
->
°©_desc
->max_length;

498 
h
;

499 
n
, 
m
;

500 
bôs
;

501 
xbôs
;

502 
ush
 
f
;

503 
ovîÊow
 = 0;

505 
bôs
 = 0; bô†<
MAX_BITS
; bôs++Ë
s
->
bl_cou¡
[bits] = 0;

510 
åì
[
s
->
hóp
[s->
hóp_max
]].
Lí
 = 0;

512 
h
 = 
s
->
hóp_max
+1; h < 
HEAP_SIZE
; h++) {

513 
n
 = 
s
->
hóp
[
h
];

514 
bôs
 = 
åì
[åì[
n
].
Dad
].
Lí
 + 1;

515 i‡(
bôs
 > 
max_Àngth
Ëbô†max_Àngth, 
ovîÊow
++;

516 
åì
[
n
].
Lí
 = (
ush
)
bôs
;

519 i‡(
n
 > 
max_code
) ;

521 
s
->
bl_cou¡
[
bôs
]++;

522 
xbôs
 = 0;

523 i‡(
n
 >
ba£
Ë
xbôs
 = 
exåa
[n-base];

524 
f
 = 
åì
[
n
].
Fªq
;

525 
s
->
›t_Àn
 +(
ulg
)
f
 * (
bôs
 + 
xbôs
);

526 i‡(
°ªe
Ë
s
->
°©ic_Àn
 +(
ulg
)
f
 * (°ªe[
n
].
Lí
 + 
xbôs
);

528 i‡(
ovîÊow
 == 0) ;

530 
	`Tø˚
((
°dîr
,"\nbitÜength overflow\n"));

535 
bôs
 = 
max_Àngth
-1;

536 
s
->
bl_cou¡
[
bôs
] == 0) bits--;

537 
s
->
bl_cou¡
[
bôs
]--;

538 
s
->
bl_cou¡
[
bôs
+1] += 2;

539 
s
->
bl_cou¡
[
max_Àngth
]--;

543 
ovîÊow
 -= 2;

544 } 
ovîÊow
 > 0);

551 
bôs
 = 
max_Àngth
; bits != 0; bits--) {

552 
n
 = 
s
->
bl_cou¡
[
bôs
];

553 
n
 != 0) {

554 
m
 = 
s
->
hóp
[--
h
];

555 i‡(
m
 > 
max_code
) ;

556 i‡((Ë
åì
[
m
].
Lí
 !(Ë
bôs
) {

557 
	`Tø˚
((
°dîr
,"codê%d bô†%d->%d\n", 
m
, 
åì
[m].
Lí
, 
bôs
));

558 
s
->
›t_Àn
 +(()
bôs
 - ()
åì
[
m
].
Lí
)

559 *()
åì
[
m
].
Fªq
;

560 
åì
[
m
].
Lí
 = (
ush
)
bôs
;

562 
n
--;

565 
	}
}

575 
loˇl
 
	$gí_codes
 (
åì
, 
max_code
, 
bl_cou¡
)

576 
˘_d©a
 *
åì
;

577 
max_code
;

578 
ushf
 *
bl_cou¡
;

580 
ush
 
√xt_code
[
MAX_BITS
+1];

581 
ush
 
code
 = 0;

582 
bôs
;

583 
n
;

588 
bôs
 = 1; bô†<
MAX_BITS
; bits++) {

589 
√xt_code
[
bôs
] = 
code
 = (codê+ 
bl_cou¡
[bits-1]) << 1;

594 
	`As£π
 (
code
 + 
bl_cou¡
[
MAX_BITS
]-1 == (1<<MAX_BITS)-1,

596 
	`Tø˚v
((
°dîr
,"\ngí_codes: max_codê%d ", 
max_code
));

598 
n
 = 0;Ç <
max_code
;Ç++) {

599 
Àn
 = 
åì
[
n
].
Lí
;

600 i‡(
Àn
 == 0) ;

602 
åì
[
n
].
Code
 = 
	`bi_ªvî£
(
√xt_code
[
Àn
]++,Üen);

604 
	`Tø˚cv
(
åì
 !
°©ic_…ªe
, (
°dîr
,"\nn %3d %cÜ %2d c %4x (%x) ",

605 
n
, (
	`isgøph
“Ë?Ç : ' '), 
Àn
, 
åì
[n].
Code
, 
√xt_code
[len]-1));

607 
	}
}

617 
loˇl
 
	$buûd_åì
(
s
, 
desc
)

618 
deÊ©e_°©e
 *
s
;

619 
åì_desc
 *
desc
;

621 
˘_d©a
 *
åì
 = 
desc
->
dyn_åì
;

622 c⁄° 
˘_d©a
 *
°ªe
 = 
desc
->
°©_desc
->
°©ic_åì
;

623 
ñems
 = 
desc
->
°©_desc
->elems;

624 
n
, 
m
;

625 
max_code
 = -1;

626 
node
;

632 
s
->
hóp_Àn
 = 0, s->
hóp_max
 = 
HEAP_SIZE
;

634 
n
 = 0;Ç < 
ñems
;Ç++) {

635 i‡(
åì
[
n
].
Fªq
 != 0) {

636 
s
->
hóp
[++(s->
hóp_Àn
)] = 
max_code
 = 
n
;

637 
s
->
dïth
[
n
] = 0;

639 
åì
[
n
].
Lí
 = 0;

648 
s
->
hóp_Àn
 < 2) {

649 
node
 = 
s
->
hóp
[++(s->
hóp_Àn
)] = (
max_code
 < 2 ? ++max_code : 0);

650 
åì
[
node
].
Fªq
 = 1;

651 
s
->
dïth
[
node
] = 0;

652 
s
->
›t_Àn
--; i‡(
°ªe
Ës->
°©ic_Àn
 -°ªe[
node
].
Lí
;

655 
desc
->
max_code
 = max_code;

660 
n
 = 
s
->
hóp_Àn
/2;Ç >1;Ç--Ë
	`pqdownhóp
(s, 
åì
,Ç);

665 
node
 = 
ñems
;

667 
	`pqªmove
(
s
, 
åì
, 
n
);

668 
m
 = 
s
->
hóp
[
SMALLEST
];

670 
s
->
hóp
[--(s->
hóp_max
)] = 
n
;

671 
s
->
hóp
[--(s->
hóp_max
)] = 
m
;

674 
åì
[
node
].
Fªq
 =Åªe[
n
].Fªq +Åªe[
m
].Freq;

675 
s
->
dïth
[
node
] = (
uch
)((s->dïth[
n
] >s->dïth[
m
] ?

676 
s
->
dïth
[
n
] : s->dïth[
m
]) + 1);

677 
åì
[
n
].
Dad
 =Åªe[
m
].Dad = (
ush
)
node
;

678 #ifde‡
DUMP_BL_TREE


679 i‡(
åì
 =
s
->
bl_åì
) {

680 
	`Ârötf
(
°dîr
,"\nnode %d(%d), sons %d(%d) %d(%d)",

681 
node
, 
åì
[node].
Fªq
, 
n
,Åªe[n].Fªq, 
m
,Åree[m].Freq);

685 
s
->
hóp
[
SMALLEST
] = 
node
++;

686 
	`pqdownhóp
(
s
, 
åì
, 
SMALLEST
);

688 } 
s
->
hóp_Àn
 >= 2);

690 
s
->
hóp
[--(s->
hóp_max
)] = s->hóp[
SMALLEST
];

695 
	`gí_bôÀn
(
s
, (
åì_desc
 *)
desc
);

698 
	`gí_codes
 ((
˘_d©a
 *)
åì
, 
max_code
, 
s
->
bl_cou¡
);

699 
	}
}

705 
loˇl
 
	$sˇn_åì
 (
s
, 
åì
, 
max_code
)

706 
deÊ©e_°©e
 *
s
;

707 
˘_d©a
 *
åì
;

708 
max_code
;

710 
n
;

711 
¥evÀn
 = -1;

712 
cuæí
;

713 
√xéí
 = 
åì
[0].
Lí
;

714 
cou¡
 = 0;

715 
max_cou¡
 = 7;

716 
mö_cou¡
 = 4;

718 i‡(
√xéí
 =0Ë
max_cou¡
 = 138, 
mö_cou¡
 = 3;

719 
åì
[
max_code
+1].
Lí
 = (
ush
)0xffff;

721 
n
 = 0;Ç <
max_code
;Ç++) {

722 
cuæí
 = 
√xéí
;Çexéí = 
åì
[
n
+1].
Lí
;

723 i‡(++
cou¡
 < 
max_cou¡
 && 
cuæí
 =
√xéí
) {

725 } i‡(
cou¡
 < 
mö_cou¡
) {

726 
s
->
bl_åì
[
cuæí
].
Fªq
 +
cou¡
;

727 } i‡(
cuæí
 != 0) {

728 i‡(
cuæí
 !
¥evÀn
Ë
s
->
bl_åì
[cuæí].
Fªq
++;

729 
s
->
bl_åì
[
REP_3_6
].
Fªq
++;

730 } i‡(
cou¡
 <= 10) {

731 
s
->
bl_åì
[
REPZ_3_10
].
Fªq
++;

733 
s
->
bl_åì
[
REPZ_11_138
].
Fªq
++;

735 
cou¡
 = 0; 
¥evÀn
 = 
cuæí
;

736 i‡(
√xéí
 == 0) {

737 
max_cou¡
 = 138, 
mö_cou¡
 = 3;

738 } i‡(
cuæí
 =
√xéí
) {

739 
max_cou¡
 = 6, 
mö_cou¡
 = 3;

741 
max_cou¡
 = 7, 
mö_cou¡
 = 4;

744 
	}
}

750 
loˇl
 
	$£nd_åì
 (
s
, 
åì
, 
max_code
)

751 
deÊ©e_°©e
 *
s
;

752 
˘_d©a
 *
åì
;

753 
max_code
;

755 
n
;

756 
¥evÀn
 = -1;

757 
cuæí
;

758 
√xéí
 = 
åì
[0].
Lí
;

759 
cou¡
 = 0;

760 
max_cou¡
 = 7;

761 
mö_cou¡
 = 4;

764 i‡(
√xéí
 =0Ë
max_cou¡
 = 138, 
mö_cou¡
 = 3;

766 
n
 = 0;Ç <
max_code
;Ç++) {

767 
cuæí
 = 
√xéí
;Çexéí = 
åì
[
n
+1].
Lí
;

768 i‡(++
cou¡
 < 
max_cou¡
 && 
cuæí
 =
√xéí
) {

770 } i‡(
cou¡
 < 
mö_cou¡
) {

771 dÿ{ 
	`£nd_code
(
s
, 
cuæí
, s->
bl_åì
); } --
cou¡
 != 0);

773 } i‡(
cuæí
 != 0) {

774 i‡(
cuæí
 !
¥evÀn
) {

775 
	`£nd_code
(
s
, 
cuæí
, s->
bl_åì
); 
cou¡
--;

777 
	`As£π
(
cou¡
 >= 3 && count <= 6, " 3_6?");

778 
	`£nd_code
(
s
, 
REP_3_6
, s->
bl_åì
); 
	`£nd_bôs
(s, 
cou¡
-3, 2);

780 } i‡(
cou¡
 <= 10) {

781 
	`£nd_code
(
s
, 
REPZ_3_10
, s->
bl_åì
); 
	`£nd_bôs
(s, 
cou¡
-3, 3);

784 
	`£nd_code
(
s
, 
REPZ_11_138
, s->
bl_åì
); 
	`£nd_bôs
(s, 
cou¡
-11, 7);

786 
cou¡
 = 0; 
¥evÀn
 = 
cuæí
;

787 i‡(
√xéí
 == 0) {

788 
max_cou¡
 = 138, 
mö_cou¡
 = 3;

789 } i‡(
cuæí
 =
√xéí
) {

790 
max_cou¡
 = 6, 
mö_cou¡
 = 3;

792 
max_cou¡
 = 7, 
mö_cou¡
 = 4;

795 
	}
}

801 
loˇl
 
	$buûd_bl_åì
(
s
)

802 
deÊ©e_°©e
 *
s
;

804 
max_blödex
;

807 
	`sˇn_åì
(
s
, (
˘_d©a
 *)s->
dyn_…ªe
, s->
l_desc
.
max_code
);

808 
	`sˇn_åì
(
s
, (
˘_d©a
 *)s->
dyn_dåì
, s->
d_desc
.
max_code
);

811 
	`buûd_åì
(
s
, (
åì_desc
 *)(&(s->
bl_desc
)));

820 
max_blödex
 = 
BL_CODES
-1; max_blindex >= 3; max_blindex--) {

821 i‡(
s
->
bl_åì
[
bl_‹dî
[
max_blödex
]].
Lí
 != 0) ;

824 
s
->
›t_Àn
 +3*(
max_blödex
+1) + 5+5+4;

825 
	`Tø˚v
((
°dîr
, "\ndynÅrees: dyn %ld, stat %ld",

826 
s
->
›t_Àn
, s->
°©ic_Àn
));

828  
max_blödex
;

829 
	}
}

836 
loˇl
 
	$£nd_Æl_åìs
(
s
, 
lcodes
, 
dcodes
, 
blcodes
)

837 
deÊ©e_°©e
 *
s
;

838 
lcodes
, 
dcodes
, 
blcodes
;

840 
ønk
;

842 
	`As£π
 (
lcodes
 >257 && 
dcodes
 >1 && 
blcodes
 >= 4, "notÉnough codes");

843 
	`As£π
 (
lcodes
 <
L_CODES
 && 
dcodes
 <
D_CODES
 && 
blcodes
 <
BL_CODES
,

845 
	`Tø˚v
((
°dîr
, "\nbl counts: "));

846 
	`£nd_bôs
(
s
, 
lcodes
-257, 5);

847 
	`£nd_bôs
(
s
, 
dcodes
-1, 5);

848 
	`£nd_bôs
(
s
, 
blcodes
-4, 4);

849 
ønk
 = 0;Ñ™k < 
blcodes
;Ñank++) {

850 
	`Tø˚v
((
°dîr
, "\nb»codê%2d ", 
bl_‹dî
[
ønk
]));

851 
	`£nd_bôs
(
s
, s->
bl_åì
[
bl_‹dî
[
ønk
]].
Lí
, 3);

853 
	`Tø˚v
((
°dîr
, "\nb»åì: síà%ld", 
s
->
bôs_£¡
));

855 
	`£nd_åì
(
s
, (
˘_d©a
 *)s->
dyn_…ªe
, 
lcodes
-1);

856 
	`Tø˚v
((
°dîr
, "\∆ôÅªe: síà%ld", 
s
->
bôs_£¡
));

858 
	`£nd_åì
(
s
, (
˘_d©a
 *)s->
dyn_dåì
, 
dcodes
-1);

859 
	`Tø˚v
((
°dîr
, "\ndi°Åªe: síà%ld", 
s
->
bôs_£¡
));

860 
	}
}

865 
ZLIB_INTERNAL
 
	$_å_°‹ed_block
(
s
, 
buf
, 
°‹ed_Àn
, 
œ°
)

866 
deÊ©e_°©e
 *
s
;

867 
ch¨f
 *
buf
;

868 
ulg
 
°‹ed_Àn
;

869 
œ°
;

871 
	`£nd_bôs
(
s
, (
STORED_BLOCK
<<1)+
œ°
, 3);

872 #ifde‡
DEBUG


873 
s
->
com¥es£d_Àn
 = (s->com¥es£d_À¿+ 3 + 7Ë& (
ulg
)~7L;

874 
s
->
com¥es£d_Àn
 +(
°‹ed_Àn
 + 4) << 3;

876 
	`c›y_block
(
s
, 
buf
, ()
°‹ed_Àn
, 1);

877 
	}
}

882 
ZLIB_INTERNAL
 
	$_å_Êush_bôs
(
s
)

883 
deÊ©e_°©e
 *
s
;

885 
	`bi_Êush
(
s
);

886 
	}
}

892 
ZLIB_INTERNAL
 
	$_å_Æign
(
s
)

893 
deÊ©e_°©e
 *
s
;

895 
	`£nd_bôs
(
s
, 
STATIC_TREES
<<1, 3);

896 
	`£nd_code
(
s
, 
END_BLOCK
, 
°©ic_…ªe
);

897 #ifde‡
DEBUG


898 
s
->
com¥es£d_Àn
 += 10L;

900 
	`bi_Êush
(
s
);

901 
	}
}

907 
ZLIB_INTERNAL
 
	$_å_Êush_block
(
s
, 
buf
, 
°‹ed_Àn
, 
œ°
)

908 
deÊ©e_°©e
 *
s
;

909 
ch¨f
 *
buf
;

910 
ulg
 
°‹ed_Àn
;

911 
œ°
;

913 
ulg
 
›t_Ànb
, 
°©ic_Ànb
;

914 
max_blödex
 = 0;

917 i‡(
s
->
Àvñ
 > 0) {

920 i‡(
s
->
°rm
->
d©a_ty≥
 =
Z_UNKNOWN
)

921 
s
->
°rm
->
d©a_ty≥
 = 
	`dëe˘_d©a_ty≥
(s);

924 
	`buûd_åì
(
s
, (
åì_desc
 *)(&(s->
l_desc
)));

925 
	`Tø˚v
((
°dîr
, "\∆ô d©a: dy¿%ld, sèà%ld", 
s
->
›t_Àn
,

926 
s
->
°©ic_Àn
));

928 
	`buûd_åì
(
s
, (
åì_desc
 *)(&(s->
d_desc
)));

929 
	`Tø˚v
((
°dîr
, "\ndi° d©a: dy¿%ld, sèà%ld", 
s
->
›t_Àn
,

930 
s
->
°©ic_Àn
));

938 
max_blödex
 = 
	`buûd_bl_åì
(
s
);

941 
›t_Ànb
 = (
s
->
›t_Àn
+3+7)>>3;

942 
°©ic_Ànb
 = (
s
->
°©ic_Àn
+3+7)>>3;

944 
	`Tø˚v
((
°dîr
, "\nopt %lu(%lu) stat %lu(%lu) stored %luÜit %u ",

945 
›t_Ànb
, 
s
->
›t_Àn
, 
°©ic_Ànb
, s->
°©ic_Àn
, 
°‹ed_Àn
,

946 
s
->
œ°_lô
));

948 i‡(
°©ic_Ànb
 <
›t_Ànb
) opt_lenb = static_lenb;

951 
	`As£π
(
buf
 != (*)0, "lost buf");

952 
›t_Ànb
 = 
°©ic_Ànb
 = 
°‹ed_Àn
 + 5;

955 #ifde‡
FORCE_STORED


956 i‡(
buf
 != (*)0) {

958 i‡(
°‹ed_Àn
+4 <
›t_Ànb
 && 
buf
 != (*)0) {

967 
	`_å_°‹ed_block
(
s
, 
buf
, 
°‹ed_Àn
, 
œ°
);

969 #ifde‡
FORCE_STATIC


970 } i‡(
°©ic_Ànb
 >= 0) {

972 } i‡(
s
->
°øãgy
 =
Z_FIXED
 || 
°©ic_Ànb
 =
›t_Ànb
) {

974 
	`£nd_bôs
(
s
, (
STATIC_TREES
<<1)+
œ°
, 3);

975 
	`com¥ess_block
(
s
, (c⁄° 
˘_d©a
 *)
°©ic_…ªe
,

976 (c⁄° 
˘_d©a
 *)
°©ic_dåì
);

977 #ifde‡
DEBUG


978 
s
->
com¥es£d_Àn
 +3 + s->
°©ic_Àn
;

981 
	`£nd_bôs
(
s
, (
DYN_TREES
<<1)+
œ°
, 3);

982 
	`£nd_Æl_åìs
(
s
, s->
l_desc
.
max_code
+1, s->
d_desc
.max_code+1,

983 
max_blödex
+1);

984 
	`com¥ess_block
(
s
, (c⁄° 
˘_d©a
 *)s->
dyn_…ªe
,

985 (c⁄° 
˘_d©a
 *)
s
->
dyn_dåì
);

986 #ifde‡
DEBUG


987 
s
->
com¥es£d_Àn
 +3 + s->
›t_Àn
;

990 
	`As£π
 (
s
->
com¥es£d_Àn
 =s->
bôs_£¡
, "bad compressed size");

994 
	`öô_block
(
s
);

996 i‡(
œ°
) {

997 
	`bi_wödup
(
s
);

998 #ifde‡
DEBUG


999 
s
->
com¥es£d_Àn
 += 7;

1002 
	`Tø˚v
((
°dîr
,"\ncom¥À¿%lu(%luË", 
s
->
com¥es£d_Àn
>>3,

1003 
s
->
com¥es£d_Àn
-7*
œ°
));

1004 
	}
}

1010 
ZLIB_INTERNAL
 
	$_å_èŒy
 (
s
, 
di°
, 
lc
)

1011 
deÊ©e_°©e
 *
s
;

1012 
di°
;

1013 
lc
;

1015 
s
->
d_buf
[s->
œ°_lô
] = (
ush
)
di°
;

1016 
s
->
l_buf
[s->
œ°_lô
++] = (
uch
)
lc
;

1017 i‡(
di°
 == 0) {

1019 
s
->
dyn_…ªe
[
lc
].
Fªq
++;

1021 
s
->
m©ches
++;

1023 
di°
--;

1024 
	`As£π
((
ush
)
di°
 < (ush)
	`MAX_DIST
(
s
) &&

1025 (
ush
)
lc
 <(ush)(
MAX_MATCH
-
MIN_MATCH
) &&

1026 (
ush
)
	`d_code
(
di°
Ë< (ush)
D_CODES
, "_tr_tally: bad match");

1028 
s
->
dyn_…ªe
[
_Àngth_code
[
lc
]+
LITERALS
+1].
Fªq
++;

1029 
s
->
dyn_dåì
[
	`d_code
(
di°
)].
Fªq
++;

1032 #ifde‡
TRUNCATE_BLOCK


1034 i‡((
s
->
œ°_lô
 & 0x1fffË=0 && s->
Àvñ
 > 2) {

1036 
ulg
 
out_Àngth
 = (ulg)
s
->
œ°_lô
*8L;

1037 
ulg
 
ö_Àngth
 = (ulg)(()
s
->
°r°¨t
 - s->
block_°¨t
);

1038 
dcode
;

1039 
dcode
 = 0; dcodê< 
D_CODES
; dcode++) {

1040 
out_Àngth
 +(
ulg
)
s
->
dyn_dåì
[
dcode
].
Fªq
 *

1041 (5L+
exåa_dbôs
[
dcode
]);

1043 
out_Àngth
 >>= 3;

1044 
	`Tø˚v
((
°dîr
,"\nlast_lit %u, in %ld, out ~%ld(%ld%%) ",

1045 
s
->
œ°_lô
, 
ö_Àngth
, 
out_Àngth
,

1046 100L - 
out_Àngth
*100L/
ö_Àngth
));

1047 i‡(
s
->
m©ches
 < s->
œ°_lô
/2 && 
out_Àngth
 < 
ö_Àngth
/2)  1;

1050  (
s
->
œ°_lô
 =s->
lô_bufsize
-1);

1055 
	}
}

1060 
loˇl
 
	$com¥ess_block
(
s
, 
…ªe
, 
dåì
)

1061 
deÊ©e_°©e
 *
s
;

1062 c⁄° 
˘_d©a
 *
…ªe
;

1063 c⁄° 
˘_d©a
 *
dåì
;

1065 
di°
;

1066 
lc
;

1067 
lx
 = 0;

1068 
code
;

1069 
exåa
;

1071 i‡(
s
->
œ°_lô
 != 0) do {

1072 
di°
 = 
s
->
d_buf
[
lx
];

1073 
lc
 = 
s
->
l_buf
[
lx
++];

1074 i‡(
di°
 == 0) {

1075 
	`£nd_code
(
s
, 
lc
, 
…ªe
);

1076 
	`Tø˚cv
(
	`isgøph
(
lc
), (
°dîr
," '%c' ",Üc));

1079 
code
 = 
_Àngth_code
[
lc
];

1080 
	`£nd_code
(
s
, 
code
+
LITERALS
+1, 
…ªe
);

1081 
exåa
 = 
exåa_lbôs
[
code
];

1082 i‡(
exåa
 != 0) {

1083 
lc
 -
ba£_Àngth
[
code
];

1084 
	`£nd_bôs
(
s
, 
lc
, 
exåa
);

1086 
di°
--;

1087 
code
 = 
	`d_code
(
di°
);

1088 
	`As£π
 (
code
 < 
D_CODES
, "bad d_code");

1090 
	`£nd_code
(
s
, 
code
, 
dåì
);

1091 
exåa
 = 
exåa_dbôs
[
code
];

1092 i‡(
exåa
 != 0) {

1093 
di°
 -
ba£_di°
[
code
];

1094 
	`£nd_bôs
(
s
, 
di°
, 
exåa
);

1099 
	`As£π
((
uI¡
)(
s
->
≥ndög
Ë< s->
lô_bufsize
 + 2*
lx
,

1102 } 
lx
 < 
s
->
œ°_lô
);

1104 
	`£nd_code
(
s
, 
END_BLOCK
, 
…ªe
);

1105 
	}
}

1120 
loˇl
 
	$dëe˘_d©a_ty≥
(
s
)

1121 
deÊ©e_°©e
 *
s
;

1127 
bœck_mask
 = 0xf3ffc07fUL;

1128 
n
;

1131 
n
 = 0;Ç <31;Ç++, 
bœck_mask
 >>= 1)

1132 i‡((
bœck_mask
 & 1Ë&& (
s
->
dyn_…ªe
[
n
].
Fªq
 != 0))

1133  
Z_BINARY
;

1136 i‡(
s
->
dyn_…ªe
[9].
Fªq
 != 0 || s->dyn_ltree[10].Freq != 0

1137 || 
s
->
dyn_…ªe
[13].
Fªq
 != 0)

1138  
Z_TEXT
;

1139 
n
 = 32;Ç < 
LITERALS
;Ç++)

1140 i‡(
s
->
dyn_…ªe
[
n
].
Fªq
 != 0)

1141  
Z_TEXT
;

1146  
Z_BINARY
;

1147 
	}
}

1154 
loˇl
 
	$bi_ªvî£
(
code
, 
Àn
)

1155 
code
;

1156 
Àn
;

1158 
ªs
 = 0;

1160 
ªs
 |
code
 & 1;

1161 
code
 >>1, 
ªs
 <<= 1;

1162 } --
Àn
 > 0);

1163  
ªs
 >> 1;

1164 
	}
}

1169 
loˇl
 
	$bi_Êush
(
s
)

1170 
deÊ©e_°©e
 *
s
;

1172 i‡(
s
->
bi_vÆid
 == 16) {

1173 
	`put_sh‹t
(
s
, s->
bi_buf
);

1174 
s
->
bi_buf
 = 0;

1175 
s
->
bi_vÆid
 = 0;

1176 } i‡(
s
->
bi_vÆid
 >= 8) {

1177 
	`put_byã
(
s
, (
Byã
)s->
bi_buf
);

1178 
s
->
bi_buf
 >>= 8;

1179 
s
->
bi_vÆid
 -= 8;

1181 
	}
}

1186 
loˇl
 
	$bi_wödup
(
s
)

1187 
deÊ©e_°©e
 *
s
;

1189 i‡(
s
->
bi_vÆid
 > 8) {

1190 
	`put_sh‹t
(
s
, s->
bi_buf
);

1191 } i‡(
s
->
bi_vÆid
 > 0) {

1192 
	`put_byã
(
s
, (
Byã
)s->
bi_buf
);

1194 
s
->
bi_buf
 = 0;

1195 
s
->
bi_vÆid
 = 0;

1196 #ifde‡
DEBUG


1197 
s
->
bôs_£¡
 = (s->bits_sent+7) & ~7;

1199 
	}
}

1205 
loˇl
 
	$c›y_block
(
s
, 
buf
, 
Àn
, 
hódî
)

1206 
deÊ©e_°©e
 *
s
;

1207 
ch¨f
 *
buf
;

1208 
Àn
;

1209 
hódî
;

1211 
	`bi_wödup
(
s
);

1213 i‡(
hódî
) {

1214 
	`put_sh‹t
(
s
, (
ush
)
Àn
);

1215 
	`put_sh‹t
(
s
, (
ush
)~
Àn
);

1216 #ifde‡
DEBUG


1217 
s
->
bôs_£¡
 += 2*16;

1220 #ifde‡
DEBUG


1221 
s
->
bôs_£¡
 +(
ulg
)
Àn
<<3;

1223 
Àn
--) {

1224 
	`put_byã
(
s
, *
buf
++);

1226 
	}
}

	@zlib-1.2.8/trees.h

3 
loˇl
 c⁄° 
˘_d©a
 
	g°©ic_…ªe
[
L_CODES
+2] = {

64 
loˇl
 c⁄° 
˘_d©a
 
	g°©ic_dåì
[
D_CODES
] = {

73 c⁄° 
uch
 
ZLIB_INTERNAL
 
	g_di°_code
[
DIST_CODE_LEN
] = {

102 c⁄° 
uch
 
ZLIB_INTERNAL
 
	g_Àngth_code
[
MAX_MATCH
-
MIN_MATCH
+1]= {

118 
loˇl
 c⁄° 
	gba£_Àngth
[
LENGTH_CODES
] = {

123 
loˇl
 c⁄° 
	gba£_di°
[
D_CODES
] = {

	@zlib-1.2.8/uncompr.c

8 
	#ZLIB_INTERNAL


	)

9 
	~"zlib.h
"

24 
ZEXPORT
 
	$uncom¥ess
 (
de°
, 
de°Lí
, 
sour˚
, 
sour˚Lí
)

25 
Byãf
 *
de°
;

26 
uL⁄gf
 *
de°Lí
;

27 c⁄° 
Byãf
 *
sour˚
;

28 
uL⁄g
 
sour˚Lí
;

30 
z_°ªam
 
°ªam
;

31 
îr
;

33 
°ªam
.
√xt_ö
 = (
z_c⁄°
 
Byãf
 *)
sour˚
;

34 
°ªam
.
avaû_ö
 = (
uI¡
)
sour˚Lí
;

36 i‡((
uL⁄g
)
°ªam
.
avaû_ö
 !
sour˚Lí
Ë 
Z_BUF_ERROR
;

38 
°ªam
.
√xt_out
 = 
de°
;

39 
°ªam
.
avaû_out
 = (
uI¡
)*
de°Lí
;

40 i‡((
uL⁄g
)
°ªam
.
avaû_out
 !*
de°Lí
Ë 
Z_BUF_ERROR
;

42 
°ªam
.
zÆloc
 = (
Æloc_func
)0;

43 
°ªam
.
z‰ì
 = (
‰ì_func
)0;

45 
îr
 = 
	`öÊ©eInô
(&
°ªam
);

46 i‡(
îr
 !
Z_OK
) Érr;

48 
îr
 = 
	`öÊ©e
(&
°ªam
, 
Z_FINISH
);

49 i‡(
îr
 !
Z_STREAM_END
) {

50 
	`öÊ©eEnd
(&
°ªam
);

51 i‡(
îr
 =
Z_NEED_DICT
 || (î∏=
Z_BUF_ERROR
 && 
°ªam
.
avaû_ö
 == 0))

52  
Z_DATA_ERROR
;

53  
îr
;

55 *
de°Lí
 = 
°ªam
.
tŸÆ_out
;

57 
îr
 = 
	`öÊ©eEnd
(&
°ªam
);

58  
îr
;

59 
	}
}

	@zlib-1.2.8/zconf.h

8 #i‚de‡
ZCONF_H


9 
	#ZCONF_H


	)

17 #ifde‡
Z_PREFIX


18 
	#Z_PREFIX_SET


	)

21 
	#_di°_code
 
z__di°_code


	)

22 
	#_Àngth_code
 
z__Àngth_code


	)

23 
	#_å_Æign
 
z__å_Æign


	)

24 
	#_å_Êush_bôs
 
z__å_Êush_bôs


	)

25 
	#_å_Êush_block
 
z__å_Êush_block


	)

26 
	#_å_öô
 
z__å_öô


	)

27 
	#_å_°‹ed_block
 
z__å_°‹ed_block


	)

28 
	#_å_èŒy
 
z__å_èŒy


	)

29 
	#adÀr32
 
z_adÀr32


	)

30 
	#adÀr32_comböe
 
z_adÀr32_comböe


	)

31 
	#adÀr32_comböe64
 
z_adÀr32_comböe64


	)

32 #i‚de‡
Z_SOLO


33 
	#com¥ess
 
z_com¥ess


	)

34 
	#com¥ess2
 
z_com¥ess2


	)

35 
	#com¥essBound
 
z_com¥essBound


	)

37 
	#¸c32
 
z_¸c32


	)

38 
	#¸c32_comböe
 
z_¸c32_comböe


	)

39 
	#¸c32_comböe64
 
z_¸c32_comböe64


	)

40 
	#deÊ©e
 
z_deÊ©e


	)

41 
	#deÊ©eBound
 
z_deÊ©eBound


	)

42 
	#deÊ©eC›y
 
z_deÊ©eC›y


	)

43 
	#deÊ©eEnd
 
z_deÊ©eEnd


	)

44 
	#deÊ©eInô2_
 
z_deÊ©eInô2_


	)

45 
	#deÊ©eInô_
 
z_deÊ©eInô_


	)

46 
	#deÊ©eP¨ams
 
z_deÊ©eP¨ams


	)

47 
	#deÊ©ePídög
 
z_deÊ©ePídög


	)

48 
	#deÊ©ePrime
 
z_deÊ©ePrime


	)

49 
	#deÊ©eRe£t
 
z_deÊ©eRe£t


	)

50 
	#deÊ©eRe£tKìp
 
z_deÊ©eRe£tKìp


	)

51 
	#deÊ©eSëDi˘i⁄¨y
 
z_deÊ©eSëDi˘i⁄¨y


	)

52 
	#deÊ©eSëHódî
 
z_deÊ©eSëHódî


	)

53 
	#deÊ©eTu√
 
z_deÊ©eTu√


	)

54 
	#deÊ©e_c›yright
 
z_deÊ©e_c›yright


	)

55 
	#gë_¸c_èbÀ
 
z_gë_¸c_èbÀ


	)

56 #i‚de‡
Z_SOLO


57 
	#gz_îr‹
 
z_gz_îr‹


	)

58 
	#gz_ötmax
 
z_gz_ötmax


	)

59 
	#gz_°rwöîr‹
 
z_gz_°rwöîr‹


	)

60 
	#gzbuf„r
 
z_gzbuf„r


	)

61 
	#gz˛óªº
 
z_gz˛óªº


	)

62 
	#gz˛o£
 
z_gz˛o£


	)

63 
	#gz˛o£_r
 
z_gz˛o£_r


	)

64 
	#gz˛o£_w
 
z_gz˛o£_w


	)

65 
	#gzdúe˘
 
z_gzdúe˘


	)

66 
	#gzd›í
 
z_gzd›í


	)

67 
	#gzeof
 
z_gzeof


	)

68 
	#gzîr‹
 
z_gzîr‹


	)

69 
	#gzÊush
 
z_gzÊush


	)

70 
	#gzgëc
 
z_gzgëc


	)

71 
	#gzgëc_
 
z_gzgëc_


	)

72 
	#gzgës
 
z_gzgës


	)

73 
	#gzoff£t
 
z_gzoff£t


	)

74 
	#gzoff£t64
 
z_gzoff£t64


	)

75 
	#gz›í
 
z_gz›í


	)

76 
	#gz›í64
 
z_gz›í64


	)

77 #ifde‡
_WIN32


78 
	#gz›í_w
 
z_gz›í_w


	)

80 
	#gz¥ötf
 
z_gz¥ötf


	)

81 
	#gzv¥ötf
 
z_gzv¥ötf


	)

82 
	#gzputc
 
z_gzputc


	)

83 
	#gzputs
 
z_gzputs


	)

84 
	#gzªad
 
z_gzªad


	)

85 
	#gzªwöd
 
z_gzªwöd


	)

86 
	#gz£ek
 
z_gz£ek


	)

87 
	#gz£ek64
 
z_gz£ek64


	)

88 
	#gz£ç¨ams
 
z_gz£ç¨ams


	)

89 
	#gzãŒ
 
z_gzãŒ


	)

90 
	#gzãŒ64
 
z_gzãŒ64


	)

91 
	#gzungëc
 
z_gzungëc


	)

92 
	#gzwrôe
 
z_gzwrôe


	)

94 
	#öÊ©e
 
z_öÊ©e


	)

95 
	#öÊ©eBack
 
z_öÊ©eBack


	)

96 
	#öÊ©eBackEnd
 
z_öÊ©eBackEnd


	)

97 
	#öÊ©eBackInô_
 
z_öÊ©eBackInô_


	)

98 
	#öÊ©eC›y
 
z_öÊ©eC›y


	)

99 
	#öÊ©eEnd
 
z_öÊ©eEnd


	)

100 
	#öÊ©eGëHódî
 
z_öÊ©eGëHódî


	)

101 
	#öÊ©eInô2_
 
z_öÊ©eInô2_


	)

102 
	#öÊ©eInô_
 
z_öÊ©eInô_


	)

103 
	#öÊ©eM¨k
 
z_öÊ©eM¨k


	)

104 
	#öÊ©ePrime
 
z_öÊ©ePrime


	)

105 
	#öÊ©eRe£t
 
z_öÊ©eRe£t


	)

106 
	#öÊ©eRe£t2
 
z_öÊ©eRe£t2


	)

107 
	#öÊ©eSëDi˘i⁄¨y
 
z_öÊ©eSëDi˘i⁄¨y


	)

108 
	#öÊ©eGëDi˘i⁄¨y
 
z_öÊ©eGëDi˘i⁄¨y


	)

109 
	#öÊ©eSync
 
z_öÊ©eSync


	)

110 
	#öÊ©eSyncPoöt
 
z_öÊ©eSyncPoöt


	)

111 
	#öÊ©eUndîmöe
 
z_öÊ©eUndîmöe


	)

112 
	#öÊ©eRe£tKìp
 
z_öÊ©eRe£tKìp


	)

113 
	#öÊ©e_c›yright
 
z_öÊ©e_c›yright


	)

114 
	#öÊ©e_Á°
 
z_öÊ©e_Á°


	)

115 
	#öÊ©e_èbÀ
 
z_öÊ©e_èbÀ


	)

116 #i‚de‡
Z_SOLO


117 
	#uncom¥ess
 
z_uncom¥ess


	)

119 
	#zEº‹
 
z_zEº‹


	)

120 #i‚de‡
Z_SOLO


121 
	#zˇŒoc
 
z_zˇŒoc


	)

122 
	#zc‰ì
 
z_zc‰ì


	)

124 
	#zlibCompûeFœgs
 
z_zlibCompûeFœgs


	)

125 
	#zlibVîsi⁄
 
z_zlibVîsi⁄


	)

128 
	#Byã
 
z_Byã


	)

129 
	#Byãf
 
z_Byãf


	)

130 
	#Æloc_func
 
z_Æloc_func


	)

131 
	#ch¨f
 
z_ch¨f


	)

132 
	#‰ì_func
 
z_‰ì_func


	)

133 #i‚de‡
Z_SOLO


134 
	#gzFûe
 
z_gzFûe


	)

136 
	#gz_hódî
 
z_gz_hódî


	)

137 
	#gz_hódîp
 
z_gz_hódîp


	)

138 
	#ö_func
 
z_ö_func


	)

139 
	#ötf
 
z_ötf


	)

140 
	#out_func
 
z_out_func


	)

141 
	#uI¡
 
z_uI¡


	)

142 
	#uI¡f
 
z_uI¡f


	)

143 
	#uL⁄g
 
z_uL⁄g


	)

144 
	#uL⁄gf
 
z_uL⁄gf


	)

145 
	#voidp
 
z_voidp


	)

146 
	#voidpc
 
z_voidpc


	)

147 
	#voidpf
 
z_voidpf


	)

150 
	#gz_hódî_s
 
z_gz_hódî_s


	)

151 
	#öã∫Æ_°©e
 
z_öã∫Æ_°©e


	)

155 #i‡
deföed
(
__MSDOS__
Ë&& !deföed(
MSDOS
)

156 
	#MSDOS


	)

158 #i‡(
deföed
(
OS_2
Ë|| deföed(
__OS2__
)Ë&& !deföed(
OS2
)

159 
	#OS2


	)

161 #i‡
deföed
(
_WINDOWS
Ë&& !deföed(
WINDOWS
)

162 
	#WINDOWS


	)

164 #i‡
deföed
(
_WIN32
Ë|| deföed(
_WIN32_WCE
Ë|| deföed(
__WIN32__
)

165 #i‚de‡
WIN32


166 
	#WIN32


	)

169 #i‡(
deföed
(
MSDOS
Ë|| deföed(
OS2
Ë|| deföed(
WINDOWS
)Ë&& !deföed(
WIN32
)

170 #i‡!
deföed
(
__GNUC__
Ë&& !deföed(
__FLAT__
Ë&& !deföed(
__386__
)

171 #i‚de‡
SYS16BIT


172 
	#SYS16BIT


	)

181 #ifde‡
SYS16BIT


182 
	#MAXSEG_64K


	)

184 #ifde‡
MSDOS


185 
	#UNALIGNED_OK


	)

188 #ifde‡
__STDC_VERSION__


189 #i‚de‡
STDC


190 
	#STDC


	)

192 #i‡
__STDC_VERSION__
 >= 199901L

193 #i‚de‡
STDC99


194 
	#STDC99


	)

198 #i‡!
deföed
(
STDC
Ë&& (deföed(
__STDC__
Ë|| deföed(
__˝lu•lus
))

199 
	#STDC


	)

201 #i‡!
deföed
(
STDC
Ë&& (deföed(
__GNUC__
Ë|| deföed(
__BORLANDC__
))

202 
	#STDC


	)

204 #i‡!
deföed
(
STDC
Ë&& (deföed(
MSDOS
Ë|| deföed(
WINDOWS
Ë|| deföed(
WIN32
))

205 
	#STDC


	)

207 #i‡!
deföed
(
STDC
Ë&& (deföed(
OS2
Ë|| deföed(
__HOS_AIX__
))

208 
	#STDC


	)

211 #i‡
deföed
(
__OS400__
Ë&& !deföed(
STDC
)

212 
	#STDC


	)

215 #i‚de‡
STDC


217 c⁄°

	)

221 #i‡
deföed
(
ZLIB_CONST
Ë&& !deföed(
z_c⁄°
)

222 
	#z_c⁄°
 c⁄°

	)

224 
	#z_c⁄°


	)

228 #i‡
deföed
(
__MWERKS__
)||deföed(
≠∂ec
)||deföed(
THINK_C
)||deföed(
__SC__
)

229 
	#NO_DUMMY_DECL


	)

233 #i‚de‡
MAX_MEM_LEVEL


234 #ifde‡
MAXSEG_64K


235 
	#MAX_MEM_LEVEL
 8

	)

237 
	#MAX_MEM_LEVEL
 9

	)

246 #i‚de‡
MAX_WBITS


247 
	#MAX_WBITS
 15

	)

265 #i‚de‡
OF


266 #ifde‡
STDC


267 
	#OF
(
¨gs
Ë
	)
args

269 
	#OF
(
¨gs
Ë()

	)

273 #i‚de‡
Z_ARG


274 #i‡
deföed
(
STDC
Ë|| deföed(
Z_HAVE_STDARG_H
)

275 
	#Z_ARG
(
¨gs
Ë
	)
args

277 
	#Z_ARG
(
¨gs
Ë()

	)

287 #ifde‡
SYS16BIT


288 #i‡
deföed
(
M_I86SM
Ë|| deföed(
M_I86MM
)

290 
	#SMALL_MEDIUM


	)

291 #ifde‡
_MSC_VER


292 
	#FAR
 
_Ár


	)

294 
	#FAR
 
Ár


	)

297 #i‡(
deföed
(
__SMALL__
Ë|| deföed(
__MEDIUM__
))

299 
	#SMALL_MEDIUM


	)

300 #ifde‡
__BORLANDC__


301 
	#FAR
 
_Ár


	)

303 
	#FAR
 
Ár


	)

308 #i‡
deföed
(
WINDOWS
Ë|| deföed(
WIN32
)

312 #ifde‡
ZLIB_DLL


313 #i‡
deföed
(
WIN32
Ë&& (!deföed(
__BORLANDC__
) || (__BORLANDC__ >= 0x500))

314 #ifde‡
ZLIB_INTERNAL


315 
	#ZEXTERN
 
	`__de˛•ec
(
dŒexp‹t
)

	)

317 
	#ZEXTERN
 
	`__de˛•ec
(
dŒimp‹t
)

	)

325 #ifde‡
ZLIB_WINAPI


326 #ifde‡
FAR


327 #unde‡
FAR


329 
	~<wödows.h
>

332 
	#ZEXPORT
 
WINAPI


	)

333 #ifde‡
WIN32


334 
	#ZEXPORTVA
 
WINAPIV


	)

336 
	#ZEXPORTVA
 
FAR
 
CDECL


	)

341 #i‡
deföed
 (
__BEOS__
)

342 #ifde‡
ZLIB_DLL


343 #ifde‡
ZLIB_INTERNAL


344 
	#ZEXPORT
 
	`__de˛•ec
(
dŒexp‹t
)

	)

345 
	#ZEXPORTVA
 
	`__de˛•ec
(
dŒexp‹t
)

	)

347 
	#ZEXPORT
 
	`__de˛•ec
(
dŒimp‹t
)

	)

348 
	#ZEXPORTVA
 
	`__de˛•ec
(
dŒimp‹t
)

	)

353 #i‚de‡
ZEXTERN


354 
	#ZEXTERN
 

	)

356 #i‚de‡
ZEXPORT


357 
	#ZEXPORT


	)

359 #i‚de‡
ZEXPORTVA


360 
	#ZEXPORTVA


	)

363 #i‚de‡
FAR


364 
	#FAR


	)

367 #i‡!
deföed
(
__MACTYPES__
)

368 
	tByã
;

370 
	tuI¡
;

371 
	tuL⁄g
;

373 #ifde‡
SMALL_MEDIUM


375 
	#Byãf
 
Byã
 
FAR


	)

377 
Byã
 
	tFAR
 
	tByãf
;

379 
	tFAR
 
	tch¨f
;

380 
	tFAR
 
	tötf
;

381 
uI¡
 
	tFAR
 
	tuI¡f
;

382 
uL⁄g
 
	tFAR
 
	tuL⁄gf
;

384 #ifde‡
STDC


385 c⁄° *
	tvoidpc
;

386 
	tFAR
 *
	tvoidpf
;

387 *
	tvoidp
;

389 
Byã
 c⁄° *
	tvoidpc
;

390 
Byã
 
	tFAR
 *
	tvoidpf
;

391 
Byã
 *
	tvoidp
;

394 #i‡!
deföed
(
Z_U4
Ë&& !deföed(
Z_SOLO
Ë&& deföed(
STDC
)

395 
	~<limôs.h
>

396 #i‡(
UINT_MAX
 == 0xffffffffUL)

397 
	#Z_U4
 

	)

398 #ñi‡(
ULONG_MAX
 == 0xffffffffUL)

399 
	#Z_U4
 

	)

400 #ñi‡(
USHRT_MAX
 == 0xffffffffUL)

401 
	#Z_U4
 

	)

405 #ifde‡
Z_U4


406 
Z_U4
 
	tz_¸c_t
;

408 
	tz_¸c_t
;

412 
	#Z_HAVE_UNISTD_H


	)

416 
	#Z_HAVE_STDARG_H


	)

419 #ifde‡
STDC


420 #i‚de‡
Z_SOLO


421 
	~<sys/ty≥s.h
>

425 #i‡
deföed
(
STDC
Ë|| deföed(
Z_HAVE_STDARG_H
)

426 #i‚de‡
Z_SOLO


427 
	~<°d¨g.h
>

431 #ifde‡
_WIN32


432 #i‚de‡
Z_SOLO


433 
	~<°ddef.h
>

443 #i‡
deföed
(
_LARGEFILE64_SOURCE
) && -_LARGEFILE64_SOURCE - -1 == 1

444 #unde‡
_LARGEFILE64_SOURCE


447 #i‡
deföed
(
__WATCOMC__
Ë&& !deföed(
Z_HAVE_UNISTD_H
)

448 
	#Z_HAVE_UNISTD_H


	)

450 #i‚de‡
Z_SOLO


451 #i‡
deföed
(
Z_HAVE_UNISTD_H
Ë|| deföed(
_LARGEFILE64_SOURCE
)

452 
	~<uni°d.h
>

453 #ifde‡
VMS


454 
	~<unixio.h
>

456 #i‚de‡
z_off_t


457 
	#z_off_t
 
off_t


	)

462 #i‡
deföed
(
_LFS64_LARGEFILE
) && _LFS64_LARGEFILE-0

463 
	#Z_LFS64


	)

466 #i‡
deföed
(
_LARGEFILE64_SOURCE
Ë&& deföed(
Z_LFS64
)

467 
	#Z_LARGE64


	)

470 #i‡
deföed
(
_FILE_OFFSET_BITS
Ë&& _FILE_OFFSET_BITS-0 =64 && deföed(
Z_LFS64
)

471 
	#Z_WANT64


	)

474 #i‡!
deföed
(
SEEK_SET
Ë&& !deföed(
Z_SOLO
)

475 
	#SEEK_SET
 0

	)

476 
	#SEEK_CUR
 1

	)

477 
	#SEEK_END
 2

	)

480 #i‚de‡
z_off_t


481 
	#z_off_t
 

	)

484 #i‡!
deföed
(
_WIN32
Ë&& deföed(
Z_LARGE64
)

485 
	#z_off64_t
 
off64_t


	)

487 #i‡
deföed
(
_WIN32
Ë&& !deföed(
__GNUC__
Ë&& !deföed(
Z_SOLO
)

488 
	#z_off64_t
 
__öt64


	)

490 
	#z_off64_t
 
z_off_t


	)

495 #i‡
deföed
(
__MVS__
)

496 #¥agm®
m≠
(
deÊ©eInô_
,"DEIN")

497 #¥agm®
m≠
(
deÊ©eInô2_
,"DEIN2")

498 #¥agm®
m≠
(
deÊ©eEnd
,"DEEND")

499 #¥agm®
m≠
(
deÊ©eBound
,"DEBND")

500 #¥agm®
m≠
(
öÊ©eInô_
,"ININ")

501 #¥agm®
m≠
(
öÊ©eInô2_
,"ININ2")

502 #¥agm®
m≠
(
öÊ©eEnd
,"INEND")

503 #¥agm®
m≠
(
öÊ©eSync
,"INSY")

504 #¥agm®
m≠
(
öÊ©eSëDi˘i⁄¨y
,"INSEDI")

505 #¥agm®
m≠
(
com¥essBound
,"CMBND")

506 #¥agm®
m≠
(
öÊ©e_èbÀ
,"INTABL")

507 #¥agm®
m≠
(
öÊ©e_Á°
,"INFA")

508 #¥agm®
m≠
(
öÊ©e_c›yright
,"INCOPY")

	@zlib-1.2.8/zlib.h

31 #i‚de‡
ZLIB_H


32 
	#ZLIB_H


	)

34 
	~"zc⁄f.h
"

36 #ifde‡
__˝lu•lus


40 
	#ZLIB_VERSION
 "1.2.8"

	)

41 
	#ZLIB_VERNUM
 0x1280

	)

42 
	#ZLIB_VER_MAJOR
 1

	)

43 
	#ZLIB_VER_MINOR
 2

	)

44 
	#ZLIB_VER_REVISION
 8

	)

45 
	#ZLIB_VER_SUBREVISION
 0

	)

80 
voidpf
 (*
	tÆloc_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, 
	tuI¡
 
	tôems
, uI¡ 
	tsize
));

81 (*
‰ì_func
Ë
	tOF
((
	tvoidpf
 
	t›aque
, voidp‡
	taddªss
));

83 
öã∫Æ_°©e
;

85 
	sz_°ªam_s
 {

86 
z_c⁄°
 
Byãf
 *
√xt_ö
;

87 
uI¡
 
avaû_ö
;

88 
uL⁄g
 
tŸÆ_ö
;

90 
Byãf
 *
√xt_out
;

91 
uI¡
 
avaû_out
;

92 
uL⁄g
 
tŸÆ_out
;

94 
z_c⁄°
 *
msg
;

95 
öã∫Æ_°©e
 
FAR
 *
°©e
;

97 
Æloc_func
 
zÆloc
;

98 
‰ì_func
 
z‰ì
;

99 
voidpf
 
›aque
;

101 
d©a_ty≥
;

102 
uL⁄g
 
adÀr
;

103 
uL⁄g
 
ª£rved
;

104 } 
	tz_°ªam
;

106 
z_°ªam
 
	tFAR
 *
	tz_°ªamp
;

112 
	sgz_hódî_s
 {

113 
ãxt
;

114 
uL⁄g
 
time
;

115 
xÊags
;

116 
os
;

117 
Byãf
 *
exåa
;

118 
uI¡
 
exåa_Àn
;

119 
uI¡
 
exåa_max
;

120 
Byãf
 *
«me
;

121 
uI¡
 
«me_max
;

122 
Byãf
 *
commít
;

123 
uI¡
 
comm_max
;

124 
h¸c
;

125 
d⁄e
;

127 } 
	tgz_hódî
;

129 
gz_hódî
 
	tFAR
 *
	tgz_hódîp
;

164 
	#Z_NO_FLUSH
 0

	)

165 
	#Z_PARTIAL_FLUSH
 1

	)

166 
	#Z_SYNC_FLUSH
 2

	)

167 
	#Z_FULL_FLUSH
 3

	)

168 
	#Z_FINISH
 4

	)

169 
	#Z_BLOCK
 5

	)

170 
	#Z_TREES
 6

	)

173 
	#Z_OK
 0

	)

174 
	#Z_STREAM_END
 1

	)

175 
	#Z_NEED_DICT
 2

	)

176 
	#Z_ERRNO
 (-1)

	)

177 
	#Z_STREAM_ERROR
 (-2)

	)

178 
	#Z_DATA_ERROR
 (-3)

	)

179 
	#Z_MEM_ERROR
 (-4)

	)

180 
	#Z_BUF_ERROR
 (-5)

	)

181 
	#Z_VERSION_ERROR
 (-6)

	)

186 
	#Z_NO_COMPRESSION
 0

	)

187 
	#Z_BEST_SPEED
 1

	)

188 
	#Z_BEST_COMPRESSION
 9

	)

189 
	#Z_DEFAULT_COMPRESSION
 (-1)

	)

192 
	#Z_FILTERED
 1

	)

193 
	#Z_HUFFMAN_ONLY
 2

	)

194 
	#Z_RLE
 3

	)

195 
	#Z_FIXED
 4

	)

196 
	#Z_DEFAULT_STRATEGY
 0

	)

199 
	#Z_BINARY
 0

	)

200 
	#Z_TEXT
 1

	)

201 
	#Z_ASCII
 
Z_TEXT


	)

202 
	#Z_UNKNOWN
 2

	)

205 
	#Z_DEFLATED
 8

	)

208 
	#Z_NULL
 0

	)

210 
	#zlib_vîsi⁄
 
	`zlibVîsi⁄
()

	)

216 
ZEXTERN
 c⁄° * 
ZEXPORT
 
zlibVîsi⁄
 
OF
(());

246 
ZEXTERN
 
ZEXPORT
 
deÊ©e
 
OF
((
z_°ªamp
 
°rm
, 
Êush
));

353 
ZEXTERN
 
ZEXPORT
 
deÊ©eEnd
 
OF
((
z_°ªamp
 
°rm
));

392 
ZEXTERN
 
ZEXPORT
 
öÊ©e
 
OF
((
z_°ªamp
 
°rm
, 
Êush
));

508 
ZEXTERN
 
ZEXPORT
 
öÊ©eEnd
 
OF
((
z_°ªamp
 
°rm
));

587 
ZEXTERN
 
ZEXPORT
 
deÊ©eSëDi˘i⁄¨y
 
OF
((
z_°ªamp
 
°rm
,

588 c⁄° 
Byãf
 *
di˘i⁄¨y
,

589 
uI¡
 
di˘Lígth
));

631 
ZEXTERN
 
ZEXPORT
 
deÊ©eC›y
 
OF
((
z_°ªamp
 
de°
,

632 
z_°ªamp
 
sour˚
));

649 
ZEXTERN
 
ZEXPORT
 
deÊ©eRe£t
 
OF
((
z_°ªamp
 
°rm
));

660 
ZEXTERN
 
ZEXPORT
 
deÊ©eP¨ams
 
OF
((
z_°ªamp
 
°rm
,

661 
Àvñ
,

662 
°øãgy
));

681 
ZEXTERN
 
ZEXPORT
 
deÊ©eTu√
 
OF
((
z_°ªamp
 
°rm
,

682 
good_Àngth
,

683 
max_œzy
,

684 
ni˚_Àngth
,

685 
max_chaö
));

698 
ZEXTERN
 
uL⁄g
 
ZEXPORT
 
deÊ©eBound
 
OF
((
z_°ªamp
 
°rm
,

699 
uL⁄g
 
sour˚Lí
));

713 
ZEXTERN
 
ZEXPORT
 
deÊ©ePídög
 
OF
((
z_°ªamp
 
°rm
,

714 *
≥ndög
,

715 *
bôs
));

728 
ZEXTERN
 
ZEXPORT
 
deÊ©ePrime
 
OF
((
z_°ªamp
 
°rm
,

729 
bôs
,

730 
vÆue
));

745 
ZEXTERN
 
ZEXPORT
 
deÊ©eSëHódî
 
OF
((
z_°ªamp
 
°rm
,

746 
gz_hódîp
 
hód
));

819 
ZEXTERN
 
ZEXPORT
 
öÊ©eSëDi˘i⁄¨y
 
OF
((
z_°ªamp
 
°rm
,

820 c⁄° 
Byãf
 *
di˘i⁄¨y
,

821 
uI¡
 
di˘Lígth
));

842 
ZEXTERN
 
ZEXPORT
 
öÊ©eGëDi˘i⁄¨y
 
OF
((
z_°ªamp
 
°rm
,

843 
Byãf
 *
di˘i⁄¨y
,

844 
uI¡
 *
di˘Lígth
));

857 
ZEXTERN
 
ZEXPORT
 
öÊ©eSync
 
OF
((
z_°ªamp
 
°rm
));

876 
ZEXTERN
 
ZEXPORT
 
öÊ©eC›y
 
OF
((
z_°ªamp
 
de°
,

877 
z_°ªamp
 
sour˚
));

892 
ZEXTERN
 
ZEXPORT
 
öÊ©eRe£t
 
OF
((
z_°ªamp
 
°rm
));

902 
ZEXTERN
 
ZEXPORT
 
öÊ©eRe£t2
 
OF
((
z_°ªamp
 
°rm
,

903 
wödowBôs
));

914 
ZEXTERN
 
ZEXPORT
 
öÊ©ePrime
 
OF
((
z_°ªamp
 
°rm
,

915 
bôs
,

916 
vÆue
));

935 
ZEXTERN
 
ZEXPORT
 
öÊ©eM¨k
 
OF
((
z_°ªamp
 
°rm
));

963 
ZEXTERN
 
ZEXPORT
 
öÊ©eGëHódî
 
OF
((
z_°ªamp
 
°rm
,

964 
gz_hódîp
 
hód
));

1025 (*
ö_func
Ë
	tOF
((
	tFAR
 *,

1026 
	tz_c⁄°
 
	tFAR
 * FAR *));

1027 (*
out_func
Ë
	tOF
((
	tFAR
 *, FAR *, ));

1029 
ZEXTERN
 
ZEXPORT
 
öÊ©eBack
 
OF
((
z_°ªamp
 
°rm
,

1030 
ö_func
 
ö
, 
FAR
 *
ö_desc
,

1031 
out_func
 
out
, 
FAR
 *
out_desc
));

1099 
ZEXTERN
 
ZEXPORT
 
öÊ©eBackEnd
 
OF
((
z_°ªamp
 
°rm
));

1107 
ZEXTERN
 
uL⁄g
 
ZEXPORT
 
zlibCompûeFœgs
 
OF
(());

1148 #i‚de‡
Z_SOLO


1160 
ZEXTERN
 
ZEXPORT
 
com¥ess
 
OF
((
Byãf
 *
de°
, 
uL⁄gf
 *
de°Lí
,

1161 c⁄° 
Byãf
 *
sour˚
, 
uL⁄g
 
sour˚Lí
));

1174 
ZEXTERN
 
ZEXPORT
 
com¥ess2
 
OF
((
Byãf
 *
de°
, 
uL⁄gf
 *
de°Lí
,

1175 c⁄° 
Byãf
 *
sour˚
, 
uL⁄g
 
sour˚Lí
,

1176 
Àvñ
));

1190 
ZEXTERN
 
uL⁄g
 
ZEXPORT
 
com¥essBound
 
OF
((uL⁄g 
sour˚Lí
));

1197 
ZEXTERN
 
ZEXPORT
 
uncom¥ess
 
OF
((
Byãf
 *
de°
, 
uL⁄gf
 *
de°Lí
,

1198 c⁄° 
Byãf
 *
sour˚
, 
uL⁄g
 
sour˚Lí
));

1224 
gzFûe_s
 *
	tgzFûe
;

1264 
ZEXTERN
 
gzFûe
 
ZEXPORT
 
gzd›í
 
OF
((
fd
, c⁄° *
mode
));

1287 
ZEXTERN
 
ZEXPORT
 
gzbuf„r
 
OF
((
gzFûe
 
fûe
, 
size
));

1304 
ZEXTERN
 
ZEXPORT
 
gz£ç¨ams
 
OF
((
gzFûe
 
fûe
, 
Àvñ
, 
°øãgy
));

1313 
ZEXTERN
 
ZEXPORT
 
gzªad
 
OF
((
gzFûe
 
fûe
, 
voidp
 
buf
, 
Àn
));

1341 
ZEXTERN
 
ZEXPORT
 
gzwrôe
 
OF
((
gzFûe
 
fûe
,

1342 
voidpc
 
buf
, 
Àn
));

1349 
ZEXTERN
 
ZEXPORTVA
 
gz¥ötf
 
Z_ARG
((
gzFûe
 
fûe
, c⁄° *
f‹m©
, ...));

1364 
ZEXTERN
 
ZEXPORT
 
gzputs
 
OF
((
gzFûe
 
fûe
, c⁄° *
s
));

1372 
ZEXTERN
 * 
ZEXPORT
 
gzgës
 
OF
((
gzFûe
 
fûe
, *
buf
, 
Àn
));

1385 
ZEXTERN
 
ZEXPORT
 
gzputc
 
OF
((
gzFûe
 
fûe
, 
c
));

1391 
ZEXTERN
 
ZEXPORT
 
gzgëc
 
OF
((
gzFûe
 
fûe
));

1400 
ZEXTERN
 
ZEXPORT
 
gzungëc
 
OF
((
c
, 
gzFûe
 
fûe
));

1412 
ZEXTERN
 
ZEXPORT
 
gzÊush
 
OF
((
gzFûe
 
fûe
, 
Êush
));

1447 
ZEXTERN
 
ZEXPORT
 
gzªwöd
 
OF
((
gzFûe
 
fûe
));

1475 
ZEXTERN
 
ZEXPORT
 
gzeof
 
OF
((
gzFûe
 
fûe
));

1490 
ZEXTERN
 
ZEXPORT
 
gzdúe˘
 
OF
((
gzFûe
 
fûe
));

1511 
ZEXTERN
 
ZEXPORT
 
gz˛o£
 
OF
((
gzFûe
 
fûe
));

1524 
ZEXTERN
 
ZEXPORT
 
gz˛o£_r
 
OF
((
gzFûe
 
fûe
));

1525 
ZEXTERN
 
ZEXPORT
 
gz˛o£_w
 
OF
((
gzFûe
 
fûe
));

1536 
ZEXTERN
 c⁄° * 
ZEXPORT
 
gzîr‹
 
OF
((
gzFûe
 
fûe
, *
î∫um
));

1552 
ZEXTERN
 
ZEXPORT
 
gz˛óªº
 
OF
((
gzFûe
 
fûe
));

1569 
ZEXTERN
 
uL⁄g
 
ZEXPORT
 
adÀr32
 
OF
((uL⁄g 
adÀr
, c⁄° 
Byãf
 *
buf
, 
uI¡
 
Àn
));

1600 
ZEXTERN
 
uL⁄g
 
ZEXPORT
 
¸c32
 
OF
((uL⁄g 
¸c
, c⁄° 
Byãf
 *
buf
, 
uI¡
 
Àn
));

1633 
ZEXTERN
 
ZEXPORT
 
deÊ©eInô_
 
OF
((
z_°ªamp
 
°rm
, 
Àvñ
,

1634 c⁄° *
vîsi⁄
, 
°ªam_size
));

1635 
ZEXTERN
 
ZEXPORT
 
öÊ©eInô_
 
OF
((
z_°ªamp
 
°rm
,

1636 c⁄° *
vîsi⁄
, 
°ªam_size
));

1637 
ZEXTERN
 
ZEXPORT
 
deÊ©eInô2_
 
OF
((
z_°ªamp
 
°rm
, 
Àvñ
, 
mëhod
,

1638 
wödowBôs
, 
memLevñ
,

1639 
°øãgy
, c⁄° *
vîsi⁄
,

1640 
°ªam_size
));

1641 
ZEXTERN
 
ZEXPORT
 
öÊ©eInô2_
 
OF
((
z_°ªamp
 
°rm
, 
wödowBôs
,

1642 c⁄° *
vîsi⁄
, 
°ªam_size
));

1643 
ZEXTERN
 
ZEXPORT
 
öÊ©eBackInô_
 
OF
((
z_°ªamp
 
°rm
, 
wödowBôs
,

1644 
FAR
 *
wödow
,

1645 c⁄° *
vîsi⁄
,

1646 
°ªam_size
));

1647 
	#deÊ©eInô
(
°rm
, 
Àvñ
) \

1648 
	`deÊ©eInô_
((
°rm
), (
Àvñ
), 
ZLIB_VERSION
, ()(
z_°ªam
))

	)

1649 
	#öÊ©eInô
(
°rm
) \

1650 
	`öÊ©eInô_
((
°rm
), 
ZLIB_VERSION
, ()(
z_°ªam
))

	)

1651 
	#deÊ©eInô2
(
°rm
, 
Àvñ
, 
mëhod
, 
wödowBôs
, 
memLevñ
, 
°øãgy
) \

1652 
	`deÊ©eInô2_
((
°rm
),(
Àvñ
),(
mëhod
),(
wödowBôs
),(
memLevñ
),\

1653 (
°øãgy
), 
ZLIB_VERSION
, ()(
z_°ªam
))

	)

1654 
	#öÊ©eInô2
(
°rm
, 
wödowBôs
) \

1655 
	`öÊ©eInô2_
((
°rm
), (
wödowBôs
), 
ZLIB_VERSION
, \

1656 ()(
z_°ªam
))

	)

1657 
	#öÊ©eBackInô
(
°rm
, 
wödowBôs
, 
wödow
) \

1658 
	`öÊ©eBackInô_
((
°rm
), (
wödowBôs
), (
wödow
), \

1659 
ZLIB_VERSION
, ()(
z_°ªam
))

	)

1661 #i‚de‡
Z_SOLO


1670 
	sgzFûe_s
 {

1671 
have
;

1672 *
√xt
;

1673 
z_off64_t
 
pos
;

1675 
ZEXTERN
 
ZEXPORT
 
gzgëc_
 
OF
((
gzFûe
 
fûe
));

1676 #ifde‡
Z_PREFIX_SET


1677 #unde‡
z_gzgëc


1678 
	#z_gzgëc
(
g
) \

1679 ((
g
)->
have
 ? ((g)->have--, (g)->
pos
++, *((g)->
√xt
)++Ë: 
	`gzgëc
(g))

	)

1681 
	#gzgëc
(
g
) \

1682 ((
g
)->
have
 ? ((g)->have--, (g)->
pos
++, *((g)->
√xt
)++Ë: 
	`gzgëc
(g))

	)

1691 #ifde‡
Z_LARGE64


1692 
ZEXTERN
 
gzFûe
 
ZEXPORT
 
gz›í64
 
OF
((const *, const *));

1693 
ZEXTERN
 
z_off64_t
 
ZEXPORT
 
gz£ek64
 
OF
((
gzFûe
, z_off64_t, ));

1694 
ZEXTERN
 
z_off64_t
 
ZEXPORT
 
gzãŒ64
 
OF
((
gzFûe
));

1695 
ZEXTERN
 
z_off64_t
 
ZEXPORT
 
gzoff£t64
 
OF
((
gzFûe
));

1696 
ZEXTERN
 
uL⁄g
 
ZEXPORT
 
adÀr32_comböe64
 
OF
((uL⁄g, uL⁄g, 
z_off64_t
));

1697 
ZEXTERN
 
uL⁄g
 
ZEXPORT
 
¸c32_comböe64
 
OF
((uL⁄g, uL⁄g, 
z_off64_t
));

1700 #i‡!
deföed
(
ZLIB_INTERNAL
Ë&& deföed(
Z_WANT64
)

1701 #ifde‡
Z_PREFIX_SET


1702 
	#z_gz›í
 
z_gz›í64


	)

1703 
	#z_gz£ek
 
z_gz£ek64


	)

1704 
	#z_gzãŒ
 
z_gzãŒ64


	)

1705 
	#z_gzoff£t
 
z_gzoff£t64


	)

1706 
	#z_adÀr32_comböe
 
z_adÀr32_comböe64


	)

1707 
	#z_¸c32_comböe
 
z_¸c32_comböe64


	)

1709 
	#gz›í
 
gz›í64


	)

1710 
	#gz£ek
 
gz£ek64


	)

1711 
	#gzãŒ
 
gzãŒ64


	)

1712 
	#gzoff£t
 
gzoff£t64


	)

1713 
	#adÀr32_comböe
 
adÀr32_comböe64


	)

1714 
	#¸c32_comböe
 
¸c32_comböe64


	)

1716 #i‚de‡
Z_LARGE64


1717 
ZEXTERN
 
gzFûe
 
ZEXPORT
 
gz›í64
 
OF
((const *, const *));

1718 
ZEXTERN
 
z_off_t
 
ZEXPORT
 
gz£ek64
 
OF
((
gzFûe
, z_off_t, ));

1719 
ZEXTERN
 
z_off_t
 
ZEXPORT
 
gzãŒ64
 
OF
((
gzFûe
));

1720 
ZEXTERN
 
z_off_t
 
ZEXPORT
 
gzoff£t64
 
OF
((
gzFûe
));

1721 
ZEXTERN
 
uL⁄g
 
ZEXPORT
 
adÀr32_comböe64
 
OF
((uL⁄g, uL⁄g, 
z_off_t
));

1722 
ZEXTERN
 
uL⁄g
 
ZEXPORT
 
¸c32_comböe64
 
OF
((uL⁄g, uL⁄g, 
z_off_t
));

1725 
ZEXTERN
 
gzFûe
 
ZEXPORT
 
gz›í
 
OF
((const *, const *));

1726 
ZEXTERN
 
z_off_t
 
ZEXPORT
 
gz£ek
 
OF
((
gzFûe
, z_off_t, ));

1727 
ZEXTERN
 
z_off_t
 
ZEXPORT
 
gzãŒ
 
OF
((
gzFûe
));

1728 
ZEXTERN
 
z_off_t
 
ZEXPORT
 
gzoff£t
 
OF
((
gzFûe
));

1729 
ZEXTERN
 
uL⁄g
 
ZEXPORT
 
adÀr32_comböe
 
OF
((uL⁄g, uL⁄g, 
z_off_t
));

1730 
ZEXTERN
 
uL⁄g
 
ZEXPORT
 
¸c32_comböe
 
OF
((uL⁄g, uL⁄g, 
z_off_t
));

1735 
ZEXTERN
 
uL⁄g
 
ZEXPORT
 
adÀr32_comböe
 
OF
((uL⁄g, uL⁄g, 
z_off_t
));

1736 
ZEXTERN
 
uL⁄g
 
ZEXPORT
 
¸c32_comböe
 
OF
((uL⁄g, uL⁄g, 
z_off_t
));

1741 #i‡!
deföed
(
ZUTIL_H
Ë&& !deföed(
NO_DUMMY_DECL
)

1742 
	söã∫Æ_°©e
 {
dummy
;};

1746 
ZEXTERN
 c⁄° * 
ZEXPORT
 
zEº‹
 
OF
(());

1747 
ZEXTERN
 
ZEXPORT
 
öÊ©eSyncPoöt
 
OF
((
z_°ªamp
));

1748 
ZEXTERN
 c⁄° 
z_¸c_t
 
FAR
 * 
ZEXPORT
 
gë_¸c_èbÀ
 
OF
(());

1749 
ZEXTERN
 
ZEXPORT
 
öÊ©eUndîmöe
 
OF
((
z_°ªamp
, ));

1750 
ZEXTERN
 
ZEXPORT
 
öÊ©eRe£tKìp
 
OF
((
z_°ªamp
));

1751 
ZEXTERN
 
ZEXPORT
 
deÊ©eRe£tKìp
 
OF
((
z_°ªamp
));

1752 #i‡
deföed
(
_WIN32
Ë&& !deföed(
Z_SOLO
)

1753 
ZEXTERN
 
gzFûe
 
ZEXPORT
 
gz›í_w
 
OF
((c⁄° 
wch¨_t
 *
∑th
,

1754 c⁄° *
mode
));

1756 #i‡
deföed
(
STDC
Ë|| deföed(
Z_HAVE_STDARG_H
)

1757 #i‚de‡
Z_SOLO


1758 
ZEXTERN
 
ZEXPORTVA
 
gzv¥ötf
 
Z_ARG
((
gzFûe
 
fûe
,

1759 c⁄° *
f‹m©
,

1760 
va_li°
 
va
));

1764 #ifde‡
__˝lu•lus


	@zlib-1.2.8/zutil.c

8 
	~"zutû.h
"

9 #i‚de‡
Z_SOLO


10 
	~"gzguts.h
"

13 #i‚de‡
NO_DUMMY_DECL


14 
	söã∫Æ_°©e
 {
	mdummy
;};

17 
z_c⁄°
 * c⁄° 
	gz_îrmsg
[10] = {

30 c⁄° * 
ZEXPORT
 
	$zlibVîsi⁄
()

32  
ZLIB_VERSION
;

33 
	}
}

35 
uL⁄g
 
ZEXPORT
 
	$zlibCompûeFœgs
()

37 
uL⁄g
 
Êags
;

39 
Êags
 = 0;

40 ()((
uI¡
))) {

42 4: 
Êags
 += 1; ;

43 8: 
Êags
 += 2; ;

44 : 
Êags
 += 3;

46 ()((
uL⁄g
))) {

48 4: 
Êags
 += 1 << 2; ;

49 8: 
Êags
 += 2 << 2; ;

50 : 
Êags
 += 3 << 2;

52 ()((
voidpf
))) {

54 4: 
Êags
 += 1 << 4; ;

55 8: 
Êags
 += 2 << 4; ;

56 : 
Êags
 += 3 << 4;

58 ()((
z_off_t
))) {

60 4: 
Êags
 += 1 << 6; ;

61 8: 
Êags
 += 2 << 6; ;

62 : 
Êags
 += 3 << 6;

64 #ifde‡
DEBUG


65 
Êags
 += 1 << 8;

67 #i‡
	`deföed
(
ASMV
Ë|| deföed(
ASMINF
)

68 
Êags
 += 1 << 9;

70 #ifde‡
ZLIB_WINAPI


71 
Êags
 += 1 << 10;

73 #ifde‡
BUILDFIXED


74 
Êags
 += 1 << 12;

76 #ifde‡
DYNAMIC_CRC_TABLE


77 
Êags
 += 1 << 13;

79 #ifde‡
NO_GZCOMPRESS


80 
Êags
 += 1L << 16;

82 #ifde‡
NO_GZIP


83 
Êags
 += 1L << 17;

85 #ifde‡
PKZIP_BUG_WORKAROUND


86 
Êags
 += 1L << 20;

88 #ifde‡
FASTEST


89 
Êags
 += 1L << 21;

91 #i‡
	`deföed
(
STDC
Ë|| deföed(
Z_HAVE_STDARG_H
)

92 #ifde‡
NO_v¢¥ötf


93 
Êags
 += 1L << 25;

94 #ifde‡
HAS_v•rötf_void


95 
Êags
 += 1L << 26;

98 #ifde‡
HAS_v¢¥ötf_void


99 
Êags
 += 1L << 26;

103 
Êags
 += 1L << 24;

104 #ifde‡
NO_¢¥ötf


105 
Êags
 += 1L << 25;

106 #ifde‡
HAS_•rötf_void


107 
Êags
 += 1L << 26;

110 #ifde‡
HAS_¢¥ötf_void


111 
Êags
 += 1L << 26;

115  
Êags
;

116 
	}
}

118 #ifde‡
DEBUG


120 #i‚de‡
vîbo£


121 
	#vîbo£
 0

	)

123 
ZLIB_INTERNAL
 
	gz_vîbo£
 = 
vîbo£
;

125 
ZLIB_INTERNAL
 
	$z_îr‹
 (
m
)

126 *
m
;

128 
	`Ârötf
(
°dîr
, "%s\n", 
m
);

129 
	`exô
(1);

130 
	}
}

136 c⁄° * 
ZEXPORT
 
	$zEº‹
(
îr
)

137 
îr
;

139  
	`ERR_MSG
(
îr
);

140 
	}
}

142 #i‡
deföed
(
_WIN32_WCE
)

147 
	gî∫o
 = 0;

150 #i‚de‡
HAVE_MEMCPY


152 
ZLIB_INTERNAL
 
	$zmem˝y
(
de°
, 
sour˚
, 
Àn
)

153 
Byãf
* 
de°
;

154 c⁄° 
Byãf
* 
sour˚
;

155 
uI¡
 
Àn
;

157 i‡(
Àn
 == 0) ;

159 *
de°
++ = *
sour˚
++;

160 } --
Àn
 != 0);

161 
	}
}

163 
ZLIB_INTERNAL
 
	$zmemcmp
(
s1
, 
s2
, 
Àn
)

164 c⁄° 
Byãf
* 
s1
;

165 c⁄° 
Byãf
* 
s2
;

166 
uI¡
 
Àn
;

168 
uI¡
 
j
;

170 
j
 = 0; j < 
Àn
; j++) {

171 i‡(
s1
[
j
] !
s2
[j])  2*(s1[j] > s2[j])-1;

174 
	}
}

176 
ZLIB_INTERNAL
 
	$zmemzîo
(
de°
, 
Àn
)

177 
Byãf
* 
de°
;

178 
uI¡
 
Àn
;

180 i‡(
Àn
 == 0) ;

182 *
de°
++ = 0;

183 } --
Àn
 != 0);

184 
	}
}

187 #i‚de‡
Z_SOLO


189 #ifde‡
SYS16BIT


191 #ifde‡
__TURBOC__


194 
	#MY_ZCALLOC


	)

202 
	#MAX_PTR
 10

	)

205 
loˇl
 
	g√xt_±r
 = 0;

207 
	s±r_èbÀ_s
 {

208 
voidpf
 
	m‹g_±r
;

209 
voidpf
 
	m√w_±r
;

210 } 
	t±r_èbÀ
;

212 
loˇl
 
±r_èbÀ
 
	gèbÀ
[
MAX_PTR
];

220 
voidpf
 
ZLIB_INTERNAL
 
	$zˇŒoc
 (
voidpf
 
›aque
, 
ôems
, 
size
)

222 
voidpf
 
buf
 = 
›aque
;

223 
ulg
 
bsize
 = (ulg)
ôems
*
size
;

228 i‡(
bsize
 < 65520L) {

229 
buf
 = 
	`ÁrmÆloc
(
bsize
);

230 i‡(*(
ush
*)&
buf
 != 0)  buf;

232 
buf
 = 
	`ÁrmÆloc
(
bsize
 + 16L);

234 i‡(
buf
 =
NULL
 || 
√xt_±r
 >
MAX_PTR
)  NULL;

235 
èbÀ
[
√xt_±r
].
‹g_±r
 = 
buf
;

238 *((
ush
*)&
buf
+1Ë+((ush)((
uch
*)buf-0) + 15) >> 4;

239 *(
ush
*)&
buf
 = 0;

240 
èbÀ
[
√xt_±r
++].
√w_±r
 = 
buf
;

241  
buf
;

242 
	}
}

244 
ZLIB_INTERNAL
 
	$zc‰ì
 (
voidpf
 
›aque
, voidp‡
±r
)

246 
n
;

247 i‡(*(
ush
*)&
±r
 != 0) {

248 
	`Ár‰ì
(
±r
);

252 
n
 = 0;Ç < 
√xt_±r
;Ç++) {

253 i‡(
±r
 !
èbÀ
[
n
].
√w_±r
) ;

255 
	`Ár‰ì
(
èbÀ
[
n
].
‹g_±r
);

256 ++
n
 < 
√xt_±r
) {

257 
èbÀ
[
n
-1] =Åable[n];

259 
√xt_±r
--;

262 
±r
 = 
›aque
;

263 
	`As£π
(0, "zcfree:ÖtrÇot found");

264 
	}
}

269 #ifde‡
M_I86


272 
	#MY_ZCALLOC


	)

274 #i‡(!
deföed
(
_MSC_VER
) || (_MSC_VER <= 600))

275 
	#_hÆloc
 
hÆloc


	)

276 
	#_h‰ì
 
h‰ì


	)

279 
voidpf
 
ZLIB_INTERNAL
 
	$zˇŒoc
 (
voidpf
 
›aque
, 
uI¡
 
ôems
, uI¡ 
size
)

281 i‡(
›aque
) opaque = 0;

282  
	`_hÆloc
(()
ôems
, 
size
);

283 
	}
}

285 
ZLIB_INTERNAL
 
	$zc‰ì
 (
voidpf
 
›aque
, voidp‡
±r
)

287 i‡(
›aque
) opaque = 0;

288 
	`_h‰ì
(
±r
);

289 
	}
}

296 #i‚de‡
MY_ZCALLOC


298 #i‚de‡
STDC


299 
voidp
 
mÆloc
 
OF
((
uI¡
 
size
));

300 
voidp
 
ˇŒoc
 
OF
((
uI¡
 
ôems
, uI¡ 
size
));

301 
‰ì
 
OF
((
voidpf
 
±r
));

304 
voidpf
 
ZLIB_INTERNAL
 
	$zˇŒoc
 (
›aque
, 
ôems
, 
size
)

305 
voidpf
 
›aque
;

306 
ôems
;

307 
size
;

309 i‡(
›aque
Ë
ôems
 +
size
 - size;

310  (
uI¡
Ë> 2 ? (
voidpf
)
	`mÆloc
(
ôems
 * 
size
) :

311 (
voidpf
)
	`ˇŒoc
(
ôems
, 
size
);

312 
	}
}

314 
ZLIB_INTERNAL
 
	$zc‰ì
 (
›aque
, 
±r
)

315 
voidpf
 
›aque
;

316 
voidpf
 
±r
;

318 
	`‰ì
(
±r
);

319 i‡(
›aque
) ;

320 
	}
}

	@zlib-1.2.8/zutil.h

13 #i‚de‡
ZUTIL_H


14 
	#ZUTIL_H


	)

16 #ifde‡
HAVE_HIDDEN


17 
	#ZLIB_INTERNAL
 
	`__©åibuã__
((
	`visibûôy
 ("hiddí")))

	)

19 
	#ZLIB_INTERNAL


	)

22 
	~"zlib.h
"

24 #i‡
deföed
(
STDC
Ë&& !deföed(
Z_SOLO
)

25 #i‡!(
deföed
(
_WIN32_WCE
Ë&& deföed(
_MSC_VER
))

26 
	~<°ddef.h
>

28 
	~<°rög.h
>

29 
	~<°dlib.h
>

32 #ifde‡
Z_SOLO


33 
	t±rdiff_t
;

36 #i‚de‡
loˇl


37 
	#loˇl
 

	)

41 
	tuch
;

42 
uch
 
	tFAR
 
	tuchf
;

43 
	tush
;

44 
ush
 
	tFAR
 
	tushf
;

45 
	tulg
;

47 
z_c⁄°
 * c⁄° 
z_îrmsg
[10];

50 
	#ERR_MSG
(
îr
Ë
z_îrmsg
[
Z_NEED_DICT
-”º)]

	)

52 
	#ERR_RETURN
(
°rm
,
îr
) \

53  (
°rm
->
msg
 = 
	`ERR_MSG
(
îr
), (îr))

	)

58 #i‚de‡
DEF_WBITS


59 
	#DEF_WBITS
 
MAX_WBITS


	)

63 #i‡
MAX_MEM_LEVEL
 >= 8

64 
	#DEF_MEM_LEVEL
 8

	)

66 
	#DEF_MEM_LEVEL
 
MAX_MEM_LEVEL


	)

70 
	#STORED_BLOCK
 0

	)

71 
	#STATIC_TREES
 1

	)

72 
	#DYN_TREES
 2

	)

75 
	#MIN_MATCH
 3

	)

76 
	#MAX_MATCH
 258

	)

79 
	#PRESET_DICT
 0x20

	)

83 #i‡
deföed
(
MSDOS
Ë|| (deföed(
WINDOWS
Ë&& !deföed(
WIN32
))

84 
	#OS_CODE
 0x00

	)

85 #i‚de‡
Z_SOLO


86 #i‡
deföed
(
__TURBOC__
Ë|| deföed(
__BORLANDC__
)

87 #i‡(
__STDC__
 =1Ë&& (
deföed
(
__LARGE__
Ë|| deföed(
__COMPACT__
))

89 
_Cde˛
 
Ár‰ì
–*
block
 );

90 *
_Cde˛
 
ÁrmÆloc
–
nbyãs
 );

92 
	~<Æloc.h
>

95 
	~<mÆloc.h
>

100 #ifde‡
AMIGA


101 
	#OS_CODE
 0x01

	)

104 #i‡
deföed
(
VAXC
Ë|| deföed(
VMS
)

105 
	#OS_CODE
 0x02

	)

106 
	#F_OPEN
(
«me
, 
mode
) \

107 
	`f›í
((
«me
), (
mode
), "mbc=60", "˘x=°m", "rfm=fix", "mrs=512")

	)

110 #i‡
deföed
(
ATARI
Ë|| deföed(
©¨i°
)

111 
	#OS_CODE
 0x05

	)

114 #ifde‡
OS2


115 
	#OS_CODE
 0x06

	)

116 #i‡
deföed
(
M_I86
Ë&& !deföed(
Z_SOLO
)

117 
	~<mÆloc.h
>

121 #i‡
deföed
(
MACOS
Ë|| deföed(
TARGET_OS_MAC
)

122 
	#OS_CODE
 0x07

	)

123 #i‚de‡
Z_SOLO


124 #i‡
deföed
(
__MWERKS__
Ë&& 
__de°_os
 !
__be_os
 && __de°_o†!
__wö32_os


125 
	~<unix.h
>

127 #i‚de‡
fd›í


128 
	#fd›í
(
fd
,
mode
Ë
NULL


	)

134 #ifde‡
TOPS20


135 
	#OS_CODE
 0x0a

	)

138 #ifde‡
WIN32


139 #i‚de‡
__CYGWIN__


140 
	#OS_CODE
 0x0b

	)

144 #ifde‡
__50SERIES


145 
	#OS_CODE
 0x0f

	)

148 #i‡
deföed
(
_BEOS_
Ë|| deföed(
RISCOS
)

149 
	#fd›í
(
fd
,
mode
Ë
NULL


	)

152 #i‡(
deföed
(
_MSC_VER
Ë&& (_MSC_VER > 600)Ë&& !deföed 
__INTERIX


153 #i‡
deföed
(
_WIN32_WCE
)

154 
	#fd›í
(
fd
,
mode
Ë
NULL


	)

155 #i‚de‡
_PTRDIFF_T_DEFINED


156 
	t±rdiff_t
;

157 
	#_PTRDIFF_T_DEFINED


	)

160 
	#fd›í
(
fd
,
ty≥
Ë
	`_fd›í
(fd,ty≥)

	)

164 #i‡
deföed
(
__BORLANDC__
Ë&& !deföed(
MSDOS
)

165 #¥agm®
w¨n
 -8004

166 #¥agm®
w¨n
 -8008

167 #¥agm®
w¨n
 -8066

171 #i‡!
deföed
(
_WIN32
) && \

172 (!
deföed
(
_LARGEFILE64_SOURCE
Ë|| 
	g_LFS64_LARGEFILE
-0 == 0)

173 
ZEXTERN
 
uL⁄g
 
ZEXPORT
 
adÀr32_comböe64
 
OF
((uL⁄g, uL⁄g, 
z_off_t
));

174 
ZEXTERN
 
uL⁄g
 
ZEXPORT
 
¸c32_comböe64
 
OF
((uL⁄g, uL⁄g, 
z_off_t
));

179 #i‚de‡
OS_CODE


180 
	#OS_CODE
 0x03

	)

183 #i‚de‡
F_OPEN


184 
	#F_OPEN
(
«me
, 
mode
Ë
	`f›í
(“ame), (mode))

	)

189 #i‡
deföed
(
pyr
Ë|| deföed(
Z_SOLO
)

190 
	#NO_MEMCPY


	)

192 #i‡
deföed
(
SMALL_MEDIUM
Ë&& !deföed(
_MSC_VER
Ë&& !deföed(
__SC__
)

197 
	#NO_MEMCPY


	)

199 #i‡
deföed
(
STDC
Ë&& !deföed(
HAVE_MEMCPY
Ë&& !deföed(
NO_MEMCPY
)

200 
	#HAVE_MEMCPY


	)

202 #ifde‡
HAVE_MEMCPY


203 #ifde‡
SMALL_MEDIUM


204 
	#zmem˝y
 
_fmem˝y


	)

205 
	#zmemcmp
 
_fmemcmp


	)

206 
	#zmemzîo
(
de°
, 
Àn
Ë
	`_fmem£t
(de°, 0,Üí)

	)

208 
	#zmem˝y
 
mem˝y


	)

209 
	#zmemcmp
 
memcmp


	)

210 
	#zmemzîo
(
de°
, 
Àn
Ë
	`mem£t
(de°, 0,Üí)

	)

213 
ZLIB_INTERNAL
 
zmem˝y
 
OF
((
Byãf
* 
de°
, c⁄° Byãf* 
sour˚
, 
uI¡
 
Àn
));

214 
ZLIB_INTERNAL
 
zmemcmp
 
OF
((c⁄° 
Byãf
* 
s1
, c⁄° Byãf* 
s2
, 
uI¡
 
Àn
));

215 
ZLIB_INTERNAL
 
zmemzîo
 
OF
((
Byãf
* 
de°
, 
uI¡
 
Àn
));

219 #ifde‡
DEBUG


220 
	~<°dio.h
>

221 
ZLIB_INTERNAL
 
z_vîbo£
;

222 
ZLIB_INTERNAL
 
z_îr‹
 
OF
((*
m
));

223 
	#As£π
(
c⁄d
,
msg
Ë{if(!(c⁄d)Ë
	`z_îr‹
(msg);}

	)

224 
	#Tø˚
(
x
Ë{i‡(
z_vîbo£
>=0Ë
Ârötf
 x ;}

	)

225 
	#Tø˚v
(
x
Ë{i‡(
z_vîbo£
>0Ë
Ârötf
 x ;}

	)

226 
	#Tø˚vv
(
x
Ë{i‡(
z_vîbo£
>1Ë
Ârötf
 x ;}

	)

227 
	#Tø˚c
(
c
,
x
Ë{i‡(
z_vîbo£
>0 && (c)Ë
Ârötf
 x ;}

	)

228 
	#Tø˚cv
(
c
,
x
Ë{i‡(
z_vîbo£
>1 && (c)Ë
Ârötf
 x ;}

	)

230 
	#As£π
(
c⁄d
,
msg
)

	)

231 
	#Tø˚
(
x
)

	)

232 
	#Tø˚v
(
x
)

	)

233 
	#Tø˚vv
(
x
)

	)

234 
	#Tø˚c
(
c
,
x
)

	)

235 
	#Tø˚cv
(
c
,
x
)

	)

238 #i‚de‡
Z_SOLO


239 
voidpf
 
ZLIB_INTERNAL
 
zˇŒoc
 
OF
((voidp‡
›aque
, 
ôems
,

240 
size
));

241 
ZLIB_INTERNAL
 
zc‰ì
 
OF
((
voidpf
 
›aque
, voidp‡
±r
));

244 
	#ZALLOC
(
°rm
, 
ôems
, 
size
) \

245 (*((
°rm
)->
zÆloc
))((°rm)->
›aque
, (
ôems
), (
size
))

	)

246 
	#ZFREE
(
°rm
, 
addr
Ë(*((°rm)->
z‰ì
))((°rm)->
›aque
, (
voidpf
)◊ddr))

	)

247 
	#TRY_FREE
(
s
, 
p
Ë{i‡’Ë
	`ZFREE
(s,Ö);}

	)

250 
	#ZSWAP32
(
q
) ((((q) >> 24) & 0xff) + (((q) >> 8) & 0xff00) + \

251 (((
q
Ë& 0xff00Ë<< 8Ë+ (((qË& 0xffË<< 24))

	)

	@
1
.
0
79
2234
ioapi.c
ioapi.h
test.c
unzip.c
unzip.h
zlib-1.2.8/adler32.c
zlib-1.2.8/compress.c
zlib-1.2.8/contrib/blast/blast.c
zlib-1.2.8/contrib/blast/blast.h
zlib-1.2.8/contrib/infback9/infback9.c
zlib-1.2.8/contrib/infback9/infback9.h
zlib-1.2.8/contrib/infback9/inffix9.h
zlib-1.2.8/contrib/infback9/inflate9.h
zlib-1.2.8/contrib/infback9/inftree9.c
zlib-1.2.8/contrib/infback9/inftree9.h
zlib-1.2.8/contrib/inflate86/inffas86.c
zlib-1.2.8/contrib/iostream/test.cpp
zlib-1.2.8/contrib/iostream/zfstream.cpp
zlib-1.2.8/contrib/iostream/zfstream.h
zlib-1.2.8/contrib/iostream2/zstream.h
zlib-1.2.8/contrib/iostream2/zstream_test.cpp
zlib-1.2.8/contrib/iostream3/test.cc
zlib-1.2.8/contrib/iostream3/zfstream.cc
zlib-1.2.8/contrib/iostream3/zfstream.h
zlib-1.2.8/contrib/masmx64/inffas8664.c
zlib-1.2.8/contrib/minizip/crypt.h
zlib-1.2.8/contrib/minizip/ioapi.c
zlib-1.2.8/contrib/minizip/ioapi.h
zlib-1.2.8/contrib/minizip/iowin32.c
zlib-1.2.8/contrib/minizip/iowin32.h
zlib-1.2.8/contrib/minizip/miniunz.c
zlib-1.2.8/contrib/minizip/minizip.c
zlib-1.2.8/contrib/minizip/mztools.c
zlib-1.2.8/contrib/minizip/mztools.h
zlib-1.2.8/contrib/minizip/unzip.c
zlib-1.2.8/contrib/minizip/unzip.h
zlib-1.2.8/contrib/minizip/zip.c
zlib-1.2.8/contrib/minizip/zip.h
zlib-1.2.8/contrib/puff/puff.c
zlib-1.2.8/contrib/puff/puff.h
zlib-1.2.8/contrib/puff/pufftest.c
zlib-1.2.8/contrib/testzlib/testzlib.c
zlib-1.2.8/contrib/untgz/untgz.c
zlib-1.2.8/crc32.c
zlib-1.2.8/crc32.h
zlib-1.2.8/deflate.c
zlib-1.2.8/deflate.h
zlib-1.2.8/examples/enough.c
zlib-1.2.8/examples/fitblk.c
zlib-1.2.8/examples/gun.c
zlib-1.2.8/examples/gzappend.c
zlib-1.2.8/examples/gzjoin.c
zlib-1.2.8/examples/gzlog.c
zlib-1.2.8/examples/gzlog.h
zlib-1.2.8/examples/zpipe.c
zlib-1.2.8/examples/zran.c
zlib-1.2.8/gzclose.c
zlib-1.2.8/gzguts.h
zlib-1.2.8/gzlib.c
zlib-1.2.8/gzread.c
zlib-1.2.8/gzwrite.c
zlib-1.2.8/infback.c
zlib-1.2.8/inffast.c
zlib-1.2.8/inffast.h
zlib-1.2.8/inffixed.h
zlib-1.2.8/inflate.c
zlib-1.2.8/inflate.h
zlib-1.2.8/inftrees.c
zlib-1.2.8/inftrees.h
zlib-1.2.8/test/example.c
zlib-1.2.8/test/infcover.c
zlib-1.2.8/test/minigzip.c
zlib-1.2.8/trees.c
zlib-1.2.8/trees.h
zlib-1.2.8/uncompr.c
zlib-1.2.8/zconf.h
zlib-1.2.8/zlib.h
zlib-1.2.8/zutil.c
zlib-1.2.8/zutil.h
